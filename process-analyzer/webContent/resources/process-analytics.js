var woe=Object.defineProperty;var Aoe=(n,e,t)=>e in n?woe(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var x=(n,e,t)=>Aoe(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();var f=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Roe(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function y6(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function i(){return this instanceof i?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(i){var o=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:function(){return n[i]}})}),t}/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var VN;(function(n){(function(e){var t=typeof f=="object"?f:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),i=o(n);typeof t.Reflect>"u"?t.Reflect=n:i=o(t.Reflect,i),e(i);function o(r,s){return function(a,u){typeof r[a]!="function"&&Object.defineProperty(r,a,{configurable:!0,writable:!0,value:u}),s&&s(a,u)}}})(function(e){var t=Object.prototype.hasOwnProperty,i=typeof Symbol=="function",o=i&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",r=i&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",s=typeof Object.create=="function",a={__proto__:[]}instanceof Array,u=!s&&!a,h={create:s?function(){return Si(Object.create(null))}:a?function(){return Si({__proto__:null})}:function(){return Si({})},has:u?function(X,ne){return t.call(X,ne)}:function(X,ne){return ne in X},get:u?function(X,ne){return t.call(X,ne)?X[ne]:void 0}:function(X,ne){return X[ne]}},g=Object.getPrototypeOf(Function),y=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",S=!y&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:oi(),w=!y&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:_t(),P=!y&&typeof WeakMap=="function"?WeakMap:Zt(),E=new P;function A(X,ne,fe,ve){if(ae(fe)){if(!bi(X))throw new TypeError;if(!Ze(ne))throw new TypeError;return T(X,ne)}else{if(!bi(X))throw new TypeError;if(!et(ne))throw new TypeError;if(!et(ve)&&!ae(ve)&&!ot(ve))throw new TypeError;return ot(ve)&&(ve=void 0),fe=At(fe),$(X,ne,fe,ve)}}e("decorate",A);function L(X,ne){function fe(ve,we){if(!et(ve))throw new TypeError;if(!ae(we)&&!ii(we))throw new TypeError;Y(X,ne,ve,we)}return fe}e("metadata",L);function B(X,ne,fe,ve){if(!et(fe))throw new TypeError;return ae(ve)||(ve=At(ve)),Y(X,ne,fe,ve)}e("defineMetadata",B);function U(X,ne,fe){if(!et(ne))throw new TypeError;return ae(fe)||(fe=At(fe)),K(X,ne,fe)}e("hasMetadata",U);function p(X,ne,fe){if(!et(ne))throw new TypeError;return ae(fe)||(fe=At(fe)),Z(X,ne,fe)}e("hasOwnMetadata",p);function b(X,ne,fe){if(!et(ne))throw new TypeError;return ae(fe)||(fe=At(fe)),H(X,ne,fe)}e("getMetadata",b);function v(X,ne,fe){if(!et(ne))throw new TypeError;return ae(fe)||(fe=At(fe)),M(X,ne,fe)}e("getOwnMetadata",v);function R(X,ne){if(!et(X))throw new TypeError;return ae(ne)||(ne=At(ne)),te(X,ne)}e("getMetadataKeys",R);function D(X,ne){if(!et(X))throw new TypeError;return ae(ne)||(ne=At(ne)),ue(X,ne)}e("getOwnMetadataKeys",D);function j(X,ne,fe){if(!et(ne))throw new TypeError;ae(fe)||(fe=At(fe));var ve=Q(ne,fe,!1);if(ae(ve)||!ve.delete(X))return!1;if(ve.size>0)return!0;var we=E.get(ne);return we.delete(fe),we.size>0||E.delete(ne),!0}e("deleteMetadata",j);function T(X,ne){for(var fe=X.length-1;fe>=0;--fe){var ve=X[fe],we=ve(ne);if(!ae(we)&&!ot(we)){if(!Ze(we))throw new TypeError;ne=we}}return ne}function $(X,ne,fe,ve){for(var we=X.length-1;we>=0;--we){var Qt=X[we],Fe=Qt(ne,fe,ve);if(!ae(Fe)&&!ot(Fe)){if(!et(Fe))throw new TypeError;ve=Fe}}return ve}function Q(X,ne,fe){var ve=E.get(X);if(ae(ve)){if(!fe)return;ve=new S,E.set(X,ve)}var we=ve.get(ne);if(ae(we)){if(!fe)return;we=new S,ve.set(ne,we)}return we}function K(X,ne,fe){var ve=Z(X,ne,fe);if(ve)return!0;var we=gn(ne);return ot(we)?!1:K(X,we,fe)}function Z(X,ne,fe){var ve=Q(ne,fe,!1);return ae(ve)?!1:Ot(ve.has(X))}function H(X,ne,fe){var ve=Z(X,ne,fe);if(ve)return M(X,ne,fe);var we=gn(ne);if(!ot(we))return H(X,we,fe)}function M(X,ne,fe){var ve=Q(ne,fe,!1);if(!ae(ve))return ve.get(X)}function Y(X,ne,fe,ve){var we=Q(fe,ve,!0);we.set(X,ne)}function te(X,ne){var fe=ue(X,ne),ve=gn(X);if(ve===null)return fe;var we=te(ve,ne);if(we.length<=0)return fe;if(fe.length<=0)return we;for(var Qt=new w,Fe=[],xe=0,De=fe;xe<De.length;xe++){var Qe=De[xe],Xe=Qt.has(Qe);Xe||(Qt.add(Qe),Fe.push(Qe))}for(var oo=0,Zc=we;oo<Zc.length;oo++){var Qe=Zc[oo],Xe=Qt.has(Qe);Xe||(Qt.add(Qe),Fe.push(Qe))}return Fe}function ue(X,ne){var fe=[],ve=Q(X,ne,!1);if(ae(ve))return fe;for(var we=ve.keys(),Qt=je(we),Fe=0;;){var xe=xt(Qt);if(!xe)return fe.length=Fe,fe;var De=en(xe);try{fe[Fe]=De}catch(Qe){try{Rn(Qt)}finally{throw Qe}}Fe++}}function Re(X){if(X===null)return 1;switch(typeof X){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return X===null?1:6;default:return 6}}function ae(X){return X===void 0}function ot(X){return X===null}function Ft(X){return typeof X=="symbol"}function et(X){return typeof X=="object"?X!==null:typeof X=="function"}function ht(X,ne){switch(Re(X)){case 0:return X;case 1:return X;case 2:return X;case 3:return X;case 4:return X;case 5:return X}var fe="string",ve=he(X,o);if(ve!==void 0){var we=ve.call(X,fe);if(et(we))throw new TypeError;return we}return wt(X)}function wt(X,ne){var fe,ve;{var we=X.toString;if(Wt(we)){var ve=we.call(X);if(!et(ve))return ve}var fe=X.valueOf;if(Wt(fe)){var ve=fe.call(X);if(!et(ve))return ve}}throw new TypeError}function Ot(X){return!!X}function vt(X){return""+X}function At(X){var ne=ht(X);return Ft(ne)?ne:vt(ne)}function bi(X){return Array.isArray?Array.isArray(X):X instanceof Object?X instanceof Array:Object.prototype.toString.call(X)==="[object Array]"}function Wt(X){return typeof X=="function"}function Ze(X){return typeof X=="function"}function ii(X){switch(Re(X)){case 3:return!0;case 4:return!0;default:return!1}}function he(X,ne){var fe=X[ne];if(fe!=null){if(!Wt(fe))throw new TypeError;return fe}}function je(X){var ne=he(X,r);if(!Wt(ne))throw new TypeError;var fe=ne.call(X);if(!et(fe))throw new TypeError;return fe}function en(X){return X.value}function xt(X){var ne=X.next();return ne.done?!1:ne}function Rn(X){var ne=X.return;ne&&ne.call(X)}function gn(X){var ne=Object.getPrototypeOf(X);if(typeof X!="function"||X===g||ne!==g)return ne;var fe=X.prototype,ve=fe&&Object.getPrototypeOf(fe);if(ve==null||ve===Object.prototype)return ne;var we=ve.constructor;return typeof we!="function"||we===X?ne:we}function oi(){var X={},ne=[],fe=function(){function Fe(xe,De,Qe){this._index=0,this._keys=xe,this._values=De,this._selector=Qe}return Fe.prototype["@@iterator"]=function(){return this},Fe.prototype[r]=function(){return this},Fe.prototype.next=function(){var xe=this._index;if(xe>=0&&xe<this._keys.length){var De=this._selector(this._keys[xe],this._values[xe]);return xe+1>=this._keys.length?(this._index=-1,this._keys=ne,this._values=ne):this._index++,{value:De,done:!1}}return{value:void 0,done:!0}},Fe.prototype.throw=function(xe){throw this._index>=0&&(this._index=-1,this._keys=ne,this._values=ne),xe},Fe.prototype.return=function(xe){return this._index>=0&&(this._index=-1,this._keys=ne,this._values=ne),{value:xe,done:!0}},Fe}();return function(){function Fe(){this._keys=[],this._values=[],this._cacheKey=X,this._cacheIndex=-2}return Object.defineProperty(Fe.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Fe.prototype.has=function(xe){return this._find(xe,!1)>=0},Fe.prototype.get=function(xe){var De=this._find(xe,!1);return De>=0?this._values[De]:void 0},Fe.prototype.set=function(xe,De){var Qe=this._find(xe,!0);return this._values[Qe]=De,this},Fe.prototype.delete=function(xe){var De=this._find(xe,!1);if(De>=0){for(var Qe=this._keys.length,Xe=De+1;Xe<Qe;Xe++)this._keys[Xe-1]=this._keys[Xe],this._values[Xe-1]=this._values[Xe];return this._keys.length--,this._values.length--,xe===this._cacheKey&&(this._cacheKey=X,this._cacheIndex=-2),!0}return!1},Fe.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=X,this._cacheIndex=-2},Fe.prototype.keys=function(){return new fe(this._keys,this._values,ve)},Fe.prototype.values=function(){return new fe(this._keys,this._values,we)},Fe.prototype.entries=function(){return new fe(this._keys,this._values,Qt)},Fe.prototype["@@iterator"]=function(){return this.entries()},Fe.prototype[r]=function(){return this.entries()},Fe.prototype._find=function(xe,De){return this._cacheKey!==xe&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=xe)),this._cacheIndex<0&&De&&(this._cacheIndex=this._keys.length,this._keys.push(xe),this._values.push(void 0)),this._cacheIndex},Fe}();function ve(Fe,xe){return Fe}function we(Fe,xe){return xe}function Qt(Fe,xe){return[Fe,xe]}}function _t(){return function(){function X(){this._map=new S}return Object.defineProperty(X.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),X.prototype.has=function(ne){return this._map.has(ne)},X.prototype.add=function(ne){return this._map.set(ne,ne),this},X.prototype.delete=function(ne){return this._map.delete(ne)},X.prototype.clear=function(){this._map.clear()},X.prototype.keys=function(){return this._map.keys()},X.prototype.values=function(){return this._map.values()},X.prototype.entries=function(){return this._map.entries()},X.prototype["@@iterator"]=function(){return this.keys()},X.prototype[r]=function(){return this.keys()},X}()}function Zt(){var X=16,ne=h.create(),fe=ve();return function(){function De(){this._key=ve()}return De.prototype.has=function(Qe){var Xe=we(Qe,!1);return Xe!==void 0?h.has(Xe,this._key):!1},De.prototype.get=function(Qe){var Xe=we(Qe,!1);return Xe!==void 0?h.get(Xe,this._key):void 0},De.prototype.set=function(Qe,Xe){var oo=we(Qe,!0);return oo[this._key]=Xe,this},De.prototype.delete=function(Qe){var Xe=we(Qe,!1);return Xe!==void 0?delete Xe[this._key]:!1},De.prototype.clear=function(){this._key=ve()},De}();function ve(){var De;do De="@@WeakMap@@"+xe();while(h.has(ne,De));return ne[De]=!0,De}function we(De,Qe){if(!t.call(De,fe)){if(!Qe)return;Object.defineProperty(De,fe,{value:h.create()})}return De[fe]}function Qt(De,Qe){for(var Xe=0;Xe<Qe;++Xe)De[Xe]=Math.random()*255|0;return De}function Fe(De){return typeof Uint8Array=="function"?typeof crypto<"u"?crypto.getRandomValues(new Uint8Array(De)):typeof msCrypto<"u"?msCrypto.getRandomValues(new Uint8Array(De)):Qt(new Uint8Array(De),De):Qt(new Array(De),De)}function xe(){var De=Fe(X);De[6]=De[6]&79|64,De[8]=De[8]&191|128;for(var Qe="",Xe=0;Xe<X;++Xe){var oo=De[Xe];(Xe===4||Xe===6||Xe===8)&&(Qe+="-"),oo<16&&(Qe+="0"),Qe+=oo.toString(16).toLowerCase()}return Qe}}function Si(X){return X.__=void 0,delete X.__,X}})})(VN||(VN={}));var m={},Pt={},z={},Xd={},_o="named",zw="name",s0="unmanaged",Gw="optional",a0="inject",Hl="multi_inject",b6="inversify:tagged",S6="inversify:tagged_props",L3="inversify:paramtypes",ez="design:paramtypes",j3="post_construct",P_="pre_destroy";function Moe(){return[a0,Hl,zw,s0,_o,Gw]}var TD=Moe();const Ioe=Object.freeze(Object.defineProperty({__proto__:null,DESIGN_PARAM_TYPES:ez,INJECT_TAG:a0,MULTI_INJECT_TAG:Hl,NAMED_TAG:_o,NAME_TAG:zw,NON_CUSTOM_TAG_KEYS:TD,OPTIONAL_TAG:Gw,PARAM_TYPES:L3,POST_CONSTRUCT:j3,PRE_DESTROY:P_,TAGGED:b6,TAGGED_PROP:S6,UNMANAGED_TAG:s0},Symbol.toStringTag,{value:"Module"}));var Cn={Request:"Request",Singleton:"Singleton",Transient:"Transient"},zt={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},qm={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"},Toe=0;function Lu(){return Toe++}var Doe=function(){function n(e,t){this.id=Lu(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=zt.Invalid,this.constraint=function(i){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}return n.prototype.clone=function(){var e=new n(this.serviceIdentifier,this.scope);return e.activated=e.scope===Cn.Singleton?this.activated:!1,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e},n}(),Ooe="Cannot apply @injectable decorator multiple times.",tz="Metadata key was used more than once in a parameter:",iv="NULL argument",zN="Key Not Found",Loe="Ambiguous match found for serviceIdentifier:",joe="Could not unbind serviceIdentifier:",Noe="No matching bindings found for serviceIdentifier:",nz="Missing required @injectable annotation in:",Boe="Missing required @inject or @multiInject annotation in:",$oe=function(n){return"@inject called with undefined this could mean that the class ".concat(n," has ")+"a circular dependency problem. You can use a LazyServiceIdentifer to overcome this limitation."},koe="Circular dependency found:",Foe="Invalid binding type:",xoe="No snapshot available to restore.",Hoe="Invalid return type in middleware. Middleware must return!",Koe="Value provided to function binding must be a function!",Voe=function(n){return"You are attempting to construct ".concat(ire(n)," in a synchronous way ")+"but it has asynchronous dependencies."},zoe="The toSelf function can only be applied when a constructor is used as service identifier",iz="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",Goe=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return"The number of constructor arguments in the derived class "+"".concat(n[0]," must be >= than the number of constructor arguments of its base class.")},Uoe="Invalid Container constructor argument. Container options must be an object.",Yoe='Invalid Container option. Default scope must be a string ("singleton" or "transient").',qoe="Invalid Container option. Auto bind injectable must be a boolean",Woe="Invalid Container option. Skip base check must be a boolean",Zoe="Cannot apply @preDestroy decorator multiple times in the same class",Qoe="Cannot apply @postConstruct decorator multiple times in the same class",Xoe="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)",Joe=function(n,e){return"@postConstruct error in class ".concat(n,": ").concat(e)},ere=function(n,e){return"@preDestroy error in class ".concat(n,": ").concat(e)},DD=function(n,e){return"onDeactivation() error in class ".concat(n,": ").concat(e)},tre=function(n,e){return"It looks like there is a circular dependency in one of the '".concat(n,"' bindings. Please investigate bindings with ")+"service identifier '".concat(e,"'.")},nre="Maximum call stack size exceeded";function ire(n){return typeof n=="function"?"[function/class ".concat(n.name||"<anonymous>","]"):typeof n=="symbol"?n.toString():"'".concat(n,"'")}var oz=function(){function n(){}return n.prototype.getConstructorMetadata=function(e){var t=Reflect.getMetadata(L3,e),i=Reflect.getMetadata(b6,e);return{compilerGeneratedMetadata:t,userGeneratedMetadata:i||{}}},n.prototype.getPropertiesMetadata=function(e){var t=Reflect.getMetadata(S6,e)||[];return t},n}(),WE={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1};function rz(n){return n instanceof RangeError||n.message===nre}var ore=function(n,e){try{return n()}catch(t){throw rz(t)&&(t=e()),t}};function Bp(n){if(typeof n=="function"){var e=n;return e.name}else{if(typeof n=="symbol")return n.toString();var e=n;return e}}function GN(n,e,t){var i="",o=t(n,e);return o.length!==0&&(i=`
Registered bindings:`,o.forEach(function(r){var s="Object";r.implementationType!==null&&(s=Uw(r.implementationType)),i="".concat(i,`
 `).concat(s),r.constraint.metaData&&(i="".concat(i," - ").concat(r.constraint.metaData))})),i}function sz(n,e){return n.parentRequest===null?!1:n.parentRequest.serviceIdentifier===e?!0:sz(n.parentRequest,e)}function rre(n){function e(i,o){o===void 0&&(o=[]);var r=Bp(i.serviceIdentifier);return o.push(r),i.parentRequest!==null?e(i.parentRequest,o):o}var t=e(n);return t.reverse().join(" --> ")}function az(n){n.childRequests.forEach(function(e){if(sz(e,e.serviceIdentifier)){var t=rre(e);throw new Error("".concat(koe," ").concat(t))}else az(e)})}function sre(n,e){if(e.isTagged()||e.isNamed()){var t="",i=e.getNamedTag(),o=e.getCustomTags();return i!==null&&(t+=i.toString()+`
`),o!==null&&o.forEach(function(r){t+=r.toString()+`
`})," ".concat(n,`
 `).concat(n," - ").concat(t)}else return" ".concat(n)}function Uw(n){if(n.name)return n.name;var e=n.toString(),t=e.match(/^function\s*([^\s(]+)/);return t?t[1]:"Anonymous function: ".concat(e)}function are(n){return n.toString().slice(7,-1)}var cz=function(){function n(e){this.id=Lu(),this.container=e}return n.prototype.addPlan=function(e){this.plan=e},n.prototype.setCurrentRequest=function(e){this.currentRequest=e},n}(),or=function(){function n(e,t){this.key=e,this.value=t}return n.prototype.toString=function(){return this.key===_o?"named: ".concat(String(this.value).toString()," "):"tagged: { key:".concat(this.key.toString(),", value: ").concat(String(this.value)," }")},n}(),cre=function(){function n(e,t){this.parentContext=e,this.rootRequest=t}return n}(),OD=function(){function n(e){this._cb=e}return n.prototype.unwrap=function(){return this._cb()},n}(),dre=function(){function n(e){this.str=e}return n.prototype.startsWith=function(e){return this.str.indexOf(e)===0},n.prototype.endsWith=function(e){var t="",i=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},i)},n.prototype.contains=function(e){return this.str.indexOf(e)!==-1},n.prototype.equals=function(e){return this.str===e},n.prototype.value=function(){return this.str},n}(),Yw=function(){function n(e,t,i,o){this.id=Lu(),this.type=e,this.serviceIdentifier=i;var r=typeof t=="symbol"?are(t):t;this.name=new dre(r||""),this.identifier=t,this.metadata=new Array;var s=null;typeof o=="string"?s=new or(_o,o):o instanceof or&&(s=o),s!==null&&this.metadata.push(s)}return n.prototype.hasTag=function(e){for(var t=0,i=this.metadata;t<i.length;t++){var o=i[t];if(o.key===e)return!0}return!1},n.prototype.isArray=function(){return this.hasTag(Hl)},n.prototype.matchesArray=function(e){return this.matchesTag(Hl)(e)},n.prototype.isNamed=function(){return this.hasTag(_o)},n.prototype.isTagged=function(){return this.metadata.some(function(e){return TD.every(function(t){return e.key!==t})})},n.prototype.isOptional=function(){return this.matchesTag(Gw)(!0)},n.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter(function(e){return e.key===_o})[0]:null},n.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter(function(e){return TD.every(function(t){return e.key!==t})}):null},n.prototype.matchesNamedTag=function(e){return this.matchesTag(_o)(e)},n.prototype.matchesTag=function(e){var t=this;return function(i){for(var o=0,r=t.metadata;o<r.length;o++){var s=r[o];if(s.key===e&&s.value===i)return!0}return!1}},n}(),N3=function(n,e,t){if(t||arguments.length===2)for(var i=0,o=e.length,r;i<o;i++)(r||!(i in e))&&(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return n.concat(r||Array.prototype.slice.call(e))};function ure(n,e){var t=Uw(e);return dz(n,t,e,!1)}function dz(n,e,t,i){var o=n.getConstructorMetadata(t),r=o.compilerGeneratedMetadata;if(r===void 0){var s="".concat(nz," ").concat(e,".");throw new Error(s)}var a=o.userGeneratedMetadata,u=Object.keys(a),h=t.length===0&&u.length>0,g=u.length>t.length,y=h||g?u.length:t.length,S=fre(i,e,r,a,y),w=uz(n,t,e),P=N3(N3([],S,!0),w,!0);return P}function lre(n,e,t,i,o){var r=o[n.toString()]||[],s=fz(r),a=s.unmanaged!==!0,u=i[n],h=s.inject||s.multiInject;if(u=h||u,u instanceof OD&&(u=u.unwrap()),a){var g=u===Object,y=u===Function,S=u===void 0,w=g||y||S;if(!e&&w){var P="".concat(Boe," argument ").concat(n," in class ").concat(t,".");throw new Error(P)}var E=new Yw(qm.ConstructorArgument,s.targetName,u);return E.metadata=r,E}return null}function fre(n,e,t,i,o){for(var r=[],s=0;s<o;s++){var a=s,u=lre(a,n,e,t,i);u!==null&&r.push(u)}return r}function hre(n,e,t,i){var o=n||e;if(o===void 0){var r="".concat(nz," for property ").concat(String(t)," in class ").concat(i,".");throw new Error(r)}return o}function uz(n,e,t){for(var i=n.getPropertiesMetadata(e),o=[],r=Object.getOwnPropertySymbols(i),s=Object.keys(i),a=s.concat(r),u=0,h=a;u<h.length;u++){var g=h[u],y=i[g],S=fz(y),w=S.targetName||g,P=hre(S.inject,S.multiInject,g,t),E=new Yw(qm.ClassProperty,w,P);E.metadata=y,o.push(E)}var A=Object.getPrototypeOf(e.prototype).constructor;if(A!==Object){var L=uz(n,A,t);o=N3(N3([],o,!0),L,!0)}return o}function lz(n,e){var t=Object.getPrototypeOf(e.prototype).constructor;if(t!==Object){var i=Uw(t),o=dz(n,i,t,!0),r=o.map(function(u){return u.metadata.filter(function(h){return h.key===s0})}),s=[].concat.apply([],r).length,a=o.length-s;return a>0?a:lz(n,t)}else return 0}function fz(n){var e={};return n.forEach(function(t){e[t.key.toString()]=t.value}),{inject:e[a0],multiInject:e[Hl],targetName:e[zw],unmanaged:e[s0]}}var E6=function(){function n(e,t,i,o,r){this.id=Lu(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=i,this.target=r,this.childRequests=[],this.bindings=Array.isArray(o)?o:[o],this.requestScope=i===null?new Map:null}return n.prototype.addChildRequest=function(e,t,i){var o=new n(e,this.parentContext,this,t,i);return this.childRequests.push(o),o},n}();function B3(n){return n._bindingDictionary}function pre(n,e,t,i,o,r){var s=n?Hl:a0,a=new or(s,t),u=new Yw(e,i,t,a);if(o!==void 0){var h=new or(o,r);u.metadata.push(h)}return u}function UN(n,e,t,i,o){var r=w_(t.container,o.serviceIdentifier),s=[];return r.length===WE.NoBindingsAvailable&&t.container.options.autoBindInjectable&&typeof o.serviceIdentifier=="function"&&n.getConstructorMetadata(o.serviceIdentifier).compilerGeneratedMetadata&&(t.container.bind(o.serviceIdentifier).toSelf(),r=w_(t.container,o.serviceIdentifier)),e?s=r:s=r.filter(function(a){var u=new E6(a.serviceIdentifier,t,i,a,o);return a.constraint(u)}),mre(o.serviceIdentifier,s,o,t.container),s}function mre(n,e,t,i){switch(e.length){case WE.NoBindingsAvailable:if(t.isOptional())return e;var o=Bp(n),r=Noe;throw r+=sre(o,t),r+=GN(i,o,w_),new Error(r);case WE.OnlyOneBindingAvailable:return e;case WE.MultipleBindingsAvailable:default:if(t.isArray())return e;var o=Bp(n),r="".concat(Loe," ").concat(o);throw r+=GN(i,o,w_),new Error(r)}}function hz(n,e,t,i,o,r){var s,a;if(o===null){s=UN(n,e,i,null,r),a=new E6(t,i,null,s,r);var u=new cre(i,a);i.addPlan(u)}else s=UN(n,e,i,o,r),a=o.addChildRequest(r.serviceIdentifier,s,r);s.forEach(function(h){var g=null;if(r.isArray())g=a.addChildRequest(h.serviceIdentifier,h,r);else{if(h.cache)return;g=a}if(h.type===zt.Instance&&h.implementationType!==null){var y=ure(n,h.implementationType);if(!i.container.options.skipBaseClassChecks){var S=lz(n,h.implementationType);if(y.length<S){var w=Goe(Uw(h.implementationType));throw new Error(w)}}y.forEach(function(P){hz(n,!1,P.serviceIdentifier,i,g,P)})}})}function w_(n,e){var t=[],i=B3(n);return i.hasKey(e)?t=i.get(e):n.parent!==null&&(t=w_(n.parent,e)),t}function gre(n,e,t,i,o,r,s,a){a===void 0&&(a=!1);var u=new cz(e),h=pre(t,i,o,"",r,s);try{return hz(n,a,o,u,null,h),u}catch(g){throw rz(g)&&az(u.plan.rootRequest),g}}function vre(n,e,t,i){var o=new Yw(qm.Variable,"",e,new or(t,i)),r=new cz(n),s=new E6(e,r,null,[],o);return s}function go(n){var e=typeof n=="object"&&n!==null||typeof n=="function";return e&&typeof n.then=="function"}function pz(n){return go(n)?!0:Array.isArray(n)&&n.some(go)}var _re=function(n,e,t,i){function o(r){return r instanceof t?r:new t(function(s){s(r)})}return new(t||(t=Promise))(function(r,s){function a(g){try{h(i.next(g))}catch(y){s(y)}}function u(g){try{h(i.throw(g))}catch(y){s(y)}}function h(g){g.done?r(g.value):o(g.value).then(a,u)}h((i=i.apply(n,e||[])).next())})},yre=function(n,e){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,o,r,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(g){return u([h,g])}}function u(h){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,h[0]&&(t=0)),t;)try{if(i=1,o&&(r=h[0]&2?o.return:h[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,h[1])).done)return r;switch(o=0,r&&(h=[h[0]&2,r.value]),h[0]){case 0:case 1:r=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,o=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!r||h[1]>r[0]&&h[1]<r[3])){t.label=h[1];break}if(h[0]===6&&t.label<r[1]){t.label=r[1],r=h;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(h);break}r[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(n,t)}catch(g){h=[6,g],o=0}finally{i=r=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},bre=function(n,e){return e.scope===Cn.Singleton&&e.activated?e.cache:e.scope===Cn.Request&&n.has(e.id)?n.get(e.id):null},Sre=function(n,e,t){e.scope===Cn.Singleton&&Cre(e,t),e.scope===Cn.Request&&Ere(n,e,t)},Ere=function(n,e,t){n.has(e.id)||n.set(e.id,t)},Cre=function(n,e){n.cache=e,n.activated=!0,go(e)&&Pre(n,e)},Pre=function(n,e){return _re(void 0,void 0,void 0,function(){var t,i;return yre(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e];case 1:return t=o.sent(),n.cache=t,[3,3];case 2:throw i=o.sent(),n.cache=null,n.activated=!1,i;case 3:return[2]}})})},Qv;(function(n){n.DynamicValue="toDynamicValue",n.Factory="toFactory",n.Provider="toProvider"})(Qv||(Qv={}));var wre=function(n){return function(e){return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return t.forEach(function(o){return n.bind(o).toService(e)})}}},Are=function(n){var e=null;switch(n.type){case zt.ConstantValue:case zt.Function:e=n.cache;break;case zt.Constructor:case zt.Instance:e=n.implementationType;break;case zt.DynamicValue:e=n.dynamicValue;break;case zt.Provider:e=n.provider;break;case zt.Factory:e=n.factory;break}if(e===null){var t=Bp(n.serviceIdentifier);throw new Error("".concat(Foe," ").concat(t))}},Rre=function(n){switch(n.type){case zt.Factory:return{factory:n.factory,factoryType:Qv.Factory};case zt.Provider:return{factory:n.provider,factoryType:Qv.Provider};case zt.DynamicValue:return{factory:n.dynamicValue,factoryType:Qv.DynamicValue};default:throw new Error("Unexpected factory type ".concat(n.type))}},$p=function(){return $p=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},$p.apply(this,arguments)},mz=function(n,e,t,i){function o(r){return r instanceof t?r:new t(function(s){s(r)})}return new(t||(t=Promise))(function(r,s){function a(g){try{h(i.next(g))}catch(y){s(y)}}function u(g){try{h(i.throw(g))}catch(y){s(y)}}function h(g){g.done?r(g.value):o(g.value).then(a,u)}h((i=i.apply(n,e||[])).next())})},gz=function(n,e){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,o,r,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(g){return u([h,g])}}function u(h){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,h[0]&&(t=0)),t;)try{if(i=1,o&&(r=h[0]&2?o.return:h[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,h[1])).done)return r;switch(o=0,r&&(h=[h[0]&2,r.value]),h[0]){case 0:case 1:r=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,o=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!r||h[1]>r[0]&&h[1]<r[3])){t.label=h[1];break}if(h[0]===6&&t.label<r[1]){t.label=r[1],r=h;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(h);break}r[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(n,t)}catch(g){h=[6,g],o=0}finally{i=r=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},Mre=function(n,e,t){if(t||arguments.length===2)for(var i=0,o=e.length,r;i<o;i++)(r||!(i in e))&&(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return n.concat(r||Array.prototype.slice.call(e))};function Ire(n,e){return n.reduce(function(t,i){var o=e(i),r=i.target.type;return r===qm.ConstructorArgument?t.constructorInjections.push(o):(t.propertyRequests.push(i),t.propertyInjections.push(o)),t.isAsync||(t.isAsync=pz(o)),t},{constructorInjections:[],propertyInjections:[],propertyRequests:[],isAsync:!1})}function Tre(n,e,t){var i;if(e.length>0){var o=Ire(e,t),r=$p($p({},o),{constr:n});o.isAsync?i=Dre(r):i=vz(r)}else i=new n;return i}function vz(n){var e,t=new((e=n.constr).bind.apply(e,Mre([void 0],n.constructorInjections,!1)));return n.propertyRequests.forEach(function(i,o){var r=i.target.identifier,s=n.propertyInjections[o];(!i.target.isOptional()||s!==void 0)&&(t[r]=s)}),t}function Dre(n){return mz(this,void 0,void 0,function(){var e,t;return gz(this,function(i){switch(i.label){case 0:return[4,YN(n.constructorInjections)];case 1:return e=i.sent(),[4,YN(n.propertyInjections)];case 2:return t=i.sent(),[2,vz($p($p({},n),{constructorInjections:e,propertyInjections:t}))]}})})}function YN(n){return mz(this,void 0,void 0,function(){var e,t,i,o;return gz(this,function(r){for(e=[],t=0,i=n;t<i.length;t++)o=i[t],Array.isArray(o)?e.push(Promise.all(o)):e.push(o);return[2,Promise.all(e)]})})}function qN(n,e){var t=Ore(n,e);return go(t)?t.then(function(){return e}):e}function Ore(n,e){var t,i;if(Reflect.hasMetadata(j3,n)){var o=Reflect.getMetadata(j3,n);try{return(i=(t=e)[o.value])===null||i===void 0?void 0:i.call(t)}catch(r){if(r instanceof Error)throw new Error(Joe(n.name,r.message))}}}function Lre(n,e){n.scope!==Cn.Singleton&&jre(n,e)}function jre(n,e){var t="Class cannot be instantiated in ".concat(n.scope===Cn.Request?"request":"transient"," scope.");if(typeof n.onDeactivation=="function")throw new Error(DD(e.name,t));if(Reflect.hasMetadata(P_,e))throw new Error(ere(e.name,t))}function Nre(n,e,t,i){Lre(n,e);var o=Tre(e,t,i);return go(o)?o.then(function(r){return qN(e,r)}):qN(e,o)}var Bre=function(n,e,t,i){function o(r){return r instanceof t?r:new t(function(s){s(r)})}return new(t||(t=Promise))(function(r,s){function a(g){try{h(i.next(g))}catch(y){s(y)}}function u(g){try{h(i.throw(g))}catch(y){s(y)}}function h(g){g.done?r(g.value):o(g.value).then(a,u)}h((i=i.apply(n,e||[])).next())})},$re=function(n,e){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,o,r,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(g){return u([h,g])}}function u(h){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,h[0]&&(t=0)),t;)try{if(i=1,o&&(r=h[0]&2?o.return:h[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,h[1])).done)return r;switch(o=0,r&&(h=[h[0]&2,r.value]),h[0]){case 0:case 1:r=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,o=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!r||h[1]>r[0]&&h[1]<r[3])){t.label=h[1];break}if(h[0]===6&&t.label<r[1]){t.label=r[1],r=h;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(h);break}r[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(n,t)}catch(g){h=[6,g],o=0}finally{i=r=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},C6=function(n){return function(e){e.parentContext.setCurrentRequest(e);var t=e.bindings,i=e.childRequests,o=e.target&&e.target.isArray(),r=!e.parentRequest||!e.parentRequest.target||!e.target||!e.parentRequest.target.matchesArray(e.target.serviceIdentifier);if(o&&r)return i.map(function(a){var u=C6(n);return u(a)});if(e.target.isOptional()&&t.length===0)return;var s=t[0];return Hre(n,e,s)}},kre=function(n,e){var t=Rre(n);return ore(function(){return t.factory.bind(n)(e)},function(){return new Error(tre(t.factoryType,e.currentRequest.serviceIdentifier.toString()))})},Fre=function(n,e,t){var i,o=e.childRequests;switch(Are(t),t.type){case zt.ConstantValue:case zt.Function:i=t.cache;break;case zt.Constructor:i=t.implementationType;break;case zt.Instance:i=Nre(t,t.implementationType,o,C6(n));break;default:i=kre(t,e.parentContext)}return i},xre=function(n,e,t){var i=bre(n,e);return i!==null||(i=t(),Sre(n,e,i)),i},Hre=function(n,e,t){return xre(n,t,function(){var i=Fre(n,e,t);return go(i)?i=i.then(function(o){return WN(e,t,o)}):i=WN(e,t,i),i})};function WN(n,e,t){var i=Kre(n.parentContext,e,t),o=Gre(n.parentContext.container),r,s=o.next();do{r=s.value;var a=n.parentContext,u=n.serviceIdentifier,h=zre(r,u);go(i)?i=_z(h,a,i):i=Vre(h,a,i),s=o.next()}while(s.done!==!0&&!B3(r).hasKey(n.serviceIdentifier));return i}var Kre=function(n,e,t){var i;return typeof e.onActivation=="function"?i=e.onActivation(n,t):i=t,i},Vre=function(n,e,t){for(var i=n.next();!i.done;){if(t=i.value(e,t),go(t))return _z(n,e,t);i=n.next()}return t},_z=function(n,e,t){return Bre(void 0,void 0,void 0,function(){var i,o;return $re(this,function(r){switch(r.label){case 0:return[4,t];case 1:i=r.sent(),o=n.next(),r.label=2;case 2:return o.done?[3,4]:[4,o.value(e,i)];case 3:return i=r.sent(),o=n.next(),[3,2];case 4:return[2,i]}})})},zre=function(n,e){var t=n._activations;return t.hasKey(e)?t.get(e).values():[].values()},Gre=function(n){for(var e=[n],t=n.parent;t!==null;)e.push(t),t=t.parent;var i=function(){var r=e.pop();return r!==void 0?{done:!1,value:r}:{done:!0,value:void 0}},o={next:i};return o};function Ure(n){var e=C6(n.plan.rootRequest.requestScope);return e(n.plan.rootRequest)}var ks=function(n,e){var t=n.parentRequest;return t!==null?e(t)?!0:ks(t,e):!1},hp=function(n){return function(e){var t=function(i){return i!==null&&i.target!==null&&i.target.matchesTag(n)(e)};return t.metaData=new or(n,e),t}},jv=hp(_o),ZE=function(n){return function(e){var t=null;if(e!==null)if(t=e.bindings[0],typeof n=="string"){var i=t.serviceIdentifier;return i===n}else{var o=e.bindings[0].implementationType;return n===o}return!1}},$3=function(){function n(e){this._binding=e}return n.prototype.when=function(e){return this._binding.constraint=e,new li(this._binding)},n.prototype.whenTargetNamed=function(e){return this._binding.constraint=jv(e),new li(this._binding)},n.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){if(e===null)return!1;var t=e.target!==null&&!e.target.isNamed()&&!e.target.isTagged();return t},new li(this._binding)},n.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=hp(e)(t),new li(this._binding)},n.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return t!==null&&ZE(e)(t.parentRequest)},new li(this._binding)},n.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return t!==null&&jv(e)(t.parentRequest)},new li(this._binding)},n.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(i){return i!==null&&hp(e)(t)(i.parentRequest)},new li(this._binding)},n.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&ks(t,ZE(e))},new li(this._binding)},n.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return t!==null&&!ks(t,ZE(e))},new li(this._binding)},n.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&ks(t,jv(e))},new li(this._binding)},n.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return t!==null&&!ks(t,jv(e))},new li(this._binding)},n.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(i){return i!==null&&ks(i,hp(e)(t))},new li(this._binding)},n.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(i){return i!==null&&!ks(i,hp(e)(t))},new li(this._binding)},n.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&ks(t,e)},new li(this._binding)},n.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return t!==null&&!ks(t,e)},new li(this._binding)},n}(),li=function(){function n(e){this._binding=e}return n.prototype.onActivation=function(e){return this._binding.onActivation=e,new $3(this._binding)},n.prototype.onDeactivation=function(e){return this._binding.onDeactivation=e,new $3(this._binding)},n}(),Wa=function(){function n(e){this._binding=e,this._bindingWhenSyntax=new $3(this._binding),this._bindingOnSyntax=new li(this._binding)}return n.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},n.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},n.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},n.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},n.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},n.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},n.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},n.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},n.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},n.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},n.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},n.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},n.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},n.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},n.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},n.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},n.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},n}(),Yre=function(){function n(e){this._binding=e}return n.prototype.inRequestScope=function(){return this._binding.scope=Cn.Request,new Wa(this._binding)},n.prototype.inSingletonScope=function(){return this._binding.scope=Cn.Singleton,new Wa(this._binding)},n.prototype.inTransientScope=function(){return this._binding.scope=Cn.Transient,new Wa(this._binding)},n}(),ZN=function(){function n(e){this._binding=e,this._bindingWhenSyntax=new $3(this._binding),this._bindingOnSyntax=new li(this._binding),this._bindingInSyntax=new Yre(e)}return n.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},n.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},n.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},n.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},n.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},n.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},n.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},n.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},n.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},n.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},n.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},n.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},n.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},n.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},n.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},n.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},n.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},n.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},n.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},n.prototype.onDeactivation=function(e){return this._bindingOnSyntax.onDeactivation(e)},n}(),qre=function(){function n(e){this._binding=e}return n.prototype.to=function(e){return this._binding.type=zt.Instance,this._binding.implementationType=e,new ZN(this._binding)},n.prototype.toSelf=function(){if(typeof this._binding.serviceIdentifier!="function")throw new Error("".concat(zoe));var e=this._binding.serviceIdentifier;return this.to(e)},n.prototype.toConstantValue=function(e){return this._binding.type=zt.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=Cn.Singleton,new Wa(this._binding)},n.prototype.toDynamicValue=function(e){return this._binding.type=zt.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new ZN(this._binding)},n.prototype.toConstructor=function(e){return this._binding.type=zt.Constructor,this._binding.implementationType=e,this._binding.scope=Cn.Singleton,new Wa(this._binding)},n.prototype.toFactory=function(e){return this._binding.type=zt.Factory,this._binding.factory=e,this._binding.scope=Cn.Singleton,new Wa(this._binding)},n.prototype.toFunction=function(e){if(typeof e!="function")throw new Error(Koe);var t=this.toConstantValue(e);return this._binding.type=zt.Function,this._binding.scope=Cn.Singleton,t},n.prototype.toAutoFactory=function(e){return this._binding.type=zt.Factory,this._binding.factory=function(t){var i=function(){return t.container.get(e)};return i},this._binding.scope=Cn.Singleton,new Wa(this._binding)},n.prototype.toAutoNamedFactory=function(e){return this._binding.type=zt.Factory,this._binding.factory=function(t){return function(i){return t.container.getNamed(e,i)}},new Wa(this._binding)},n.prototype.toProvider=function(e){return this._binding.type=zt.Provider,this._binding.provider=e,this._binding.scope=Cn.Singleton,new Wa(this._binding)},n.prototype.toService=function(e){this.toDynamicValue(function(t){return t.container.get(e)})},n}(),Wre=function(){function n(){}return n.of=function(e,t,i,o,r){var s=new n;return s.bindings=e,s.middleware=t,s.deactivations=o,s.activations=i,s.moduleActivationStore=r,s},n}();function Zre(n){return typeof n=="object"&&n!==null&&"clone"in n&&typeof n.clone=="function"}var bl=function(){function n(){this._map=new Map}return n.prototype.getMap=function(){return this._map},n.prototype.add=function(e,t){if(e==null)throw new Error(iv);if(t==null)throw new Error(iv);var i=this._map.get(e);i!==void 0?i.push(t):this._map.set(e,[t])},n.prototype.get=function(e){if(e==null)throw new Error(iv);var t=this._map.get(e);if(t!==void 0)return t;throw new Error(zN)},n.prototype.remove=function(e){if(e==null)throw new Error(iv);if(!this._map.delete(e))throw new Error(zN)},n.prototype.removeIntersection=function(e){var t=this;this.traverse(function(i,o){var r=e.hasKey(i)?e.get(i):void 0;if(r!==void 0){var s=o.filter(function(a){return!r.some(function(u){return a===u})});t._setValue(i,s)}})},n.prototype.removeByCondition=function(e){var t=this,i=[];return this._map.forEach(function(o,r){for(var s=[],a=0,u=o;a<u.length;a++){var h=u[a],g=e(h);g?i.push(h):s.push(h)}t._setValue(r,s)}),i},n.prototype.hasKey=function(e){if(e==null)throw new Error(iv);return this._map.has(e)},n.prototype.clone=function(){var e=new n;return this._map.forEach(function(t,i){t.forEach(function(o){return e.add(i,Zre(o)?o.clone():o)})}),e},n.prototype.traverse=function(e){this._map.forEach(function(t,i){e(i,t)})},n.prototype._setValue=function(e,t){t.length>0?this._map.set(e,t):this._map.delete(e)},n}(),Qre=function(){function n(){this._map=new Map}return n.prototype.remove=function(e){if(this._map.has(e)){var t=this._map.get(e);return this._map.delete(e),t}return this._getEmptyHandlersStore()},n.prototype.addDeactivation=function(e,t,i){this._getModuleActivationHandlers(e).onDeactivations.add(t,i)},n.prototype.addActivation=function(e,t,i){this._getModuleActivationHandlers(e).onActivations.add(t,i)},n.prototype.clone=function(){var e=new n;return this._map.forEach(function(t,i){e._map.set(i,{onActivations:t.onActivations.clone(),onDeactivations:t.onDeactivations.clone()})}),e},n.prototype._getModuleActivationHandlers=function(e){var t=this._map.get(e);return t===void 0&&(t=this._getEmptyHandlersStore(),this._map.set(e,t)),t},n.prototype._getEmptyHandlersStore=function(){var e={onActivations:new bl,onDeactivations:new bl};return e},n}(),k3=function(){return k3=Object.assign||function(n){for(var e,t=1,i=arguments.length;t<i;t++){e=arguments[t];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o])}return n},k3.apply(this,arguments)},gr=function(n,e,t,i){function o(r){return r instanceof t?r:new t(function(s){s(r)})}return new(t||(t=Promise))(function(r,s){function a(g){try{h(i.next(g))}catch(y){s(y)}}function u(g){try{h(i.throw(g))}catch(y){s(y)}}function h(g){g.done?r(g.value):o(g.value).then(a,u)}h((i=i.apply(n,e||[])).next())})},vr=function(n,e){var t={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},i,o,r,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(h){return function(g){return u([h,g])}}function u(h){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,h[0]&&(t=0)),t;)try{if(i=1,o&&(r=h[0]&2?o.return:h[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,h[1])).done)return r;switch(o=0,r&&(h=[h[0]&2,r.value]),h[0]){case 0:case 1:r=h;break;case 4:return t.label++,{value:h[1],done:!1};case 5:t.label++,o=h[1],h=[0];continue;case 7:h=t.ops.pop(),t.trys.pop();continue;default:if(r=t.trys,!(r=r.length>0&&r[r.length-1])&&(h[0]===6||h[0]===2)){t=0;continue}if(h[0]===3&&(!r||h[1]>r[0]&&h[1]<r[3])){t.label=h[1];break}if(h[0]===6&&t.label<r[1]){t.label=r[1],r=h;break}if(r&&t.label<r[2]){t.label=r[2],t.ops.push(h);break}r[2]&&t.ops.pop(),t.trys.pop();continue}h=e.call(n,t)}catch(g){h=[6,g],o=0}finally{i=r=0}if(h[0]&5)throw h[1];return{value:h[0]?h[1]:void 0,done:!0}}},Xre=function(n,e,t){if(t||arguments.length===2)for(var i=0,o=e.length,r;i<o;i++)(r||!(i in e))&&(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return n.concat(r||Array.prototype.slice.call(e))},yz=function(){function n(e){var t=e||{};if(typeof t!="object")throw new Error("".concat(Uoe));if(t.defaultScope===void 0)t.defaultScope=Cn.Transient;else if(t.defaultScope!==Cn.Singleton&&t.defaultScope!==Cn.Transient&&t.defaultScope!==Cn.Request)throw new Error("".concat(Yoe));if(t.autoBindInjectable===void 0)t.autoBindInjectable=!1;else if(typeof t.autoBindInjectable!="boolean")throw new Error("".concat(qoe));if(t.skipBaseClassChecks===void 0)t.skipBaseClassChecks=!1;else if(typeof t.skipBaseClassChecks!="boolean")throw new Error("".concat(Woe));this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=Lu(),this._bindingDictionary=new bl,this._snapshots=[],this._middleware=null,this._activations=new bl,this._deactivations=new bl,this.parent=null,this._metadataReader=new oz,this._moduleActivationStore=new Qre}return n.merge=function(e,t){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var r=new n,s=Xre([e,t],i,!0).map(function(h){return B3(h)}),a=B3(r);function u(h,g){h.traverse(function(y,S){S.forEach(function(w){g.add(w.serviceIdentifier,w.clone())})})}return s.forEach(function(h){u(h,a)}),r},n.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var i=this._getContainerModuleHelpersFactory(),o=0,r=e;o<r.length;o++){var s=r[o],a=i(s.id);s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}},n.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return gr(this,void 0,void 0,function(){var i,o,r,s,a;return vr(this,function(u){switch(u.label){case 0:i=this._getContainerModuleHelpersFactory(),o=0,r=e,u.label=1;case 1:return o<r.length?(s=r[o],a=i(s.id),[4,s.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)]):[3,4];case 2:u.sent(),u.label=3;case 3:return o++,[3,1];case 4:return[2]}})})},n.prototype.unload=function(){for(var e=this,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];t.forEach(function(o){var r=e._removeModuleBindings(o.id);e._deactivateSingletons(r),e._removeModuleHandlers(o.id)})},n.prototype.unloadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return gr(this,void 0,void 0,function(){var i,o,r,s;return vr(this,function(a){switch(a.label){case 0:i=0,o=e,a.label=1;case 1:return i<o.length?(r=o[i],s=this._removeModuleBindings(r.id),[4,this._deactivateSingletonsAsync(s)]):[3,4];case 2:a.sent(),this._removeModuleHandlers(r.id),a.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},n.prototype.bind=function(e){var t=this.options.defaultScope||Cn.Transient,i=new Doe(e,t);return this._bindingDictionary.add(e,i),new qre(i)},n.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},n.prototype.rebindAsync=function(e){return gr(this,void 0,void 0,function(){return vr(this,function(t){switch(t.label){case 0:return[4,this.unbindAsync(e)];case 1:return t.sent(),[2,this.bind(e)]}})})},n.prototype.unbind=function(e){if(this._bindingDictionary.hasKey(e)){var t=this._bindingDictionary.get(e);this._deactivateSingletons(t)}this._removeServiceFromDictionary(e)},n.prototype.unbindAsync=function(e){return gr(this,void 0,void 0,function(){var t;return vr(this,function(i){switch(i.label){case 0:return this._bindingDictionary.hasKey(e)?(t=this._bindingDictionary.get(e),[4,this._deactivateSingletonsAsync(t)]):[3,2];case 1:i.sent(),i.label=2;case 2:return this._removeServiceFromDictionary(e),[2]}})})},n.prototype.unbindAll=function(){var e=this;this._bindingDictionary.traverse(function(t,i){e._deactivateSingletons(i)}),this._bindingDictionary=new bl},n.prototype.unbindAllAsync=function(){return gr(this,void 0,void 0,function(){var e,t=this;return vr(this,function(i){switch(i.label){case 0:return e=[],this._bindingDictionary.traverse(function(o,r){e.push(t._deactivateSingletonsAsync(r))}),[4,Promise.all(e)];case 1:return i.sent(),this._bindingDictionary=new bl,[2]}})})},n.prototype.onActivation=function(e,t){this._activations.add(e,t)},n.prototype.onDeactivation=function(e,t){this._deactivations.add(e,t)},n.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},n.prototype.isCurrentBound=function(e){return this._bindingDictionary.hasKey(e)},n.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,_o,t)},n.prototype.isBoundTagged=function(e,t,i){var o=!1;if(this._bindingDictionary.hasKey(e)){var r=this._bindingDictionary.get(e),s=vre(this,e,t,i);o=r.some(function(a){return a.constraint(s)})}return!o&&this.parent&&(o=this.parent.isBoundTagged(e,t,i)),o},n.prototype.snapshot=function(){this._snapshots.push(Wre.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))},n.prototype.restore=function(){var e=this._snapshots.pop();if(e===void 0)throw new Error(xoe);this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore},n.prototype.createChild=function(e){var t=new n(e||this.options);return t.parent=this,t},n.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce(function(o,r){return r(o)},i)},n.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},n.prototype.get=function(e){var t=this._getNotAllArgs(e,!1);return this._getButThrowIfAsync(t)},n.prototype.getAsync=function(e){return gr(this,void 0,void 0,function(){var t;return vr(this,function(i){return t=this._getNotAllArgs(e,!1),[2,this._get(t)]})})},n.prototype.getTagged=function(e,t,i){var o=this._getNotAllArgs(e,!1,t,i);return this._getButThrowIfAsync(o)},n.prototype.getTaggedAsync=function(e,t,i){return gr(this,void 0,void 0,function(){var o;return vr(this,function(r){return o=this._getNotAllArgs(e,!1,t,i),[2,this._get(o)]})})},n.prototype.getNamed=function(e,t){return this.getTagged(e,_o,t)},n.prototype.getNamedAsync=function(e,t){return this.getTaggedAsync(e,_o,t)},n.prototype.getAll=function(e){var t=this._getAllArgs(e);return this._getButThrowIfAsync(t)},n.prototype.getAllAsync=function(e){var t=this._getAllArgs(e);return this._getAll(t)},n.prototype.getAllTagged=function(e,t,i){var o=this._getNotAllArgs(e,!0,t,i);return this._getButThrowIfAsync(o)},n.prototype.getAllTaggedAsync=function(e,t,i){var o=this._getNotAllArgs(e,!0,t,i);return this._getAll(o)},n.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,_o,t)},n.prototype.getAllNamedAsync=function(e,t){return this.getAllTaggedAsync(e,_o,t)},n.prototype.resolve=function(e){var t=this.isBound(e);t||this.bind(e).toSelf();var i=this.get(e);return t||this.unbind(e),i},n.prototype._preDestroy=function(e,t){var i,o;if(Reflect.hasMetadata(P_,e)){var r=Reflect.getMetadata(P_,e);return(o=(i=t)[r.value])===null||o===void 0?void 0:o.call(i)}},n.prototype._removeModuleHandlers=function(e){var t=this._moduleActivationStore.remove(e);this._activations.removeIntersection(t.onActivations),this._deactivations.removeIntersection(t.onDeactivations)},n.prototype._removeModuleBindings=function(e){return this._bindingDictionary.removeByCondition(function(t){return t.moduleId===e})},n.prototype._deactivate=function(e,t){var i=this,o=Object.getPrototypeOf(t).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){var r=this._deactivateContainer(t,this._deactivations.get(e.serviceIdentifier).values());if(go(r))return this._handleDeactivationError(r.then(function(){return i._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,t,o)}),o)}var s=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,t,o);if(go(s))return this._handleDeactivationError(s,o)}catch(a){if(a instanceof Error)throw new Error(DD(o.name,a.message))}},n.prototype._handleDeactivationError=function(e,t){return gr(this,void 0,void 0,function(){var i;return vr(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,e];case 1:return o.sent(),[3,3];case 2:if(i=o.sent(),i instanceof Error)throw new Error(DD(t.name,i.message));return[3,3];case 3:return[2]}})})},n.prototype._deactivateContainer=function(e,t){for(var i=this,o=t.next();o.value;){var r=o.value(e);if(go(r))return r.then(function(){return i._deactivateContainerAsync(e,t)});o=t.next()}},n.prototype._deactivateContainerAsync=function(e,t){return gr(this,void 0,void 0,function(){var i;return vr(this,function(o){switch(o.label){case 0:i=t.next(),o.label=1;case 1:return i.value?[4,i.value(e)]:[3,3];case 2:return o.sent(),i=t.next(),[3,1];case 3:return[2]}})})},n.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(g,y){g._binding.moduleId=y},i=function(g){return function(y){var S=e.bind(y);return t(S,g),S}},o=function(){return function(g){return e.unbind(g)}},r=function(){return function(g){return e.unbindAsync(g)}},s=function(){return function(g){return e.isBound(g)}},a=function(g){return function(y){var S=e.rebind(y);return t(S,g),S}},u=function(g){return function(y,S){e._moduleActivationStore.addActivation(g,y,S),e.onActivation(y,S)}},h=function(g){return function(y,S){e._moduleActivationStore.addDeactivation(g,y,S),e.onDeactivation(y,S)}};return function(g){return{bindFunction:i(g),isboundFunction:s(),onActivationFunction:u(g),onDeactivationFunction:h(g),rebindFunction:a(g),unbindFunction:o(),unbindAsyncFunction:r()}}},n.prototype._getAll=function(e){return Promise.all(this._get(e))},n.prototype._get=function(e){var t=k3(k3({},e),{contextInterceptor:function(o){return o},targetType:qm.Variable});if(this._middleware){var i=this._middleware(t);if(i==null)throw new Error(Hoe);return i}return this._planAndResolve()(t)},n.prototype._getButThrowIfAsync=function(e){var t=this._get(e);if(pz(t))throw new Error(Voe(e.serviceIdentifier));return t},n.prototype._getAllArgs=function(e){var t={avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e};return t},n.prototype._getNotAllArgs=function(e,t,i,o){var r={avoidConstraints:!1,isMultiInject:t,serviceIdentifier:e,key:i,value:o};return r},n.prototype._planAndResolve=function(){var e=this;return function(t){var i=gre(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);i=t.contextInterceptor(i);var o=Ure(i);return o}},n.prototype._deactivateIfSingleton=function(e){var t=this;if(e.activated)return go(e.cache)?e.cache.then(function(i){return t._deactivate(e,i)}):this._deactivate(e,e.cache)},n.prototype._deactivateSingletons=function(e){for(var t=0,i=e;t<i.length;t++){var o=i[t],r=this._deactivateIfSingleton(o);if(go(r))throw new Error(Xoe)}},n.prototype._deactivateSingletonsAsync=function(e){return gr(this,void 0,void 0,function(){var t=this;return vr(this,function(i){switch(i.label){case 0:return[4,Promise.all(e.map(function(o){return t._deactivateIfSingleton(o)}))];case 1:return i.sent(),[2]}})})},n.prototype._propagateContainerDeactivationThenBindingAndPreDestroy=function(e,t,i){return this.parent?this._deactivate.bind(this.parent)(e,t):this._bindingDeactivationAndPreDestroy(e,t,i)},n.prototype._propagateContainerDeactivationThenBindingAndPreDestroyAsync=function(e,t,i){return gr(this,void 0,void 0,function(){return vr(this,function(o){switch(o.label){case 0:return this.parent?[4,this._deactivate.bind(this.parent)(e,t)]:[3,2];case 1:return o.sent(),[3,4];case 2:return[4,this._bindingDeactivationAndPreDestroyAsync(e,t,i)];case 3:o.sent(),o.label=4;case 4:return[2]}})})},n.prototype._removeServiceFromDictionary=function(e){try{this._bindingDictionary.remove(e)}catch{throw new Error("".concat(joe," ").concat(Bp(e)))}},n.prototype._bindingDeactivationAndPreDestroy=function(e,t,i){var o=this;if(typeof e.onDeactivation=="function"){var r=e.onDeactivation(t);if(go(r))return r.then(function(){return o._preDestroy(i,t)})}return this._preDestroy(i,t)},n.prototype._bindingDeactivationAndPreDestroyAsync=function(e,t,i){return gr(this,void 0,void 0,function(){return vr(this,function(o){switch(o.label){case 0:return typeof e.onDeactivation!="function"?[3,2]:[4,e.onDeactivation(t)];case 1:o.sent(),o.label=2;case 2:return[4,this._preDestroy(i,t)];case 3:return o.sent(),[2]}})})},n}(),bz=function(){function n(e){this.id=Lu(),this.registry=e}return n}(),Jre=function(){function n(e){this.id=Lu(),this.registry=e}return n}();function ese(n){for(var e=new Set,t=0,i=n;t<i.length;t++){var o=i[t];if(e.has(o))return o;e.add(o)}}function tse(n){return n.prototype!==void 0}function nse(n){if(n!==void 0)throw new Error(iz)}function P6(n,e,t,i){nse(e),Sz(b6,n,t.toString(),i)}function ise(n,e,t){if(tse(n))throw new Error(iz);Sz(S6,n.constructor,e,t)}function ose(n){var e=[];if(Array.isArray(n)){e=n;var t=ese(e.map(function(i){return i.key}));if(t!==void 0)throw new Error("".concat(tz," ").concat(t.toString()))}else e=[n];return e}function Sz(n,e,t,i){var o=ose(i),r={};Reflect.hasOwnMetadata(n,e)&&(r=Reflect.getMetadata(n,e));var s=r[t];if(s===void 0)s=[];else for(var a=function(y){if(o.some(function(S){return S.key===y.key}))throw new Error("".concat(tz," ").concat(y.key.toString()))},u=0,h=s;u<h.length;u++){var g=h[u];a(g)}s.push.apply(s,o),r[t]=s,Reflect.defineMetadata(n,r,e)}function c0(n){return function(e,t,i){typeof i=="number"?P6(e,t,i,n):ise(e,t,n)}}function QN(n,e){Reflect.decorate(n,e)}function rse(n,e){return function(t,i){e(t,i,n)}}function sse(n,e,t){typeof t=="number"?QN([rse(t,n)],e):typeof t=="string"?Reflect.decorate([n],e,t):QN([n],e)}function le(){return function(n){if(Reflect.hasOwnMetadata(L3,n))throw new Error(Ooe);var e=Reflect.getMetadata(ez,n)||[];return Reflect.defineMetadata(L3,e,n),n}}function ase(n,e){return c0(new or(n,e))}function cse(n){return c0(new or(_o,n))}function Ez(n){return function(e){return function(t,i,o){if(e===void 0){var r=typeof t=="function"?t.name:t.constructor.name;throw new Error($oe(r))}return c0(new or(n,e))(t,i,o)}}}var be=Ez(a0);function Wm(){return c0(new or(Gw,!0))}function dse(){return function(n,e,t){var i=new or(s0,!0);P6(n,e,t,i)}}var w6=Ez(Hl);function use(n){return function(e,t,i){var o=new or(zw,n);P6(e,t,i,o)}}function Cz(n,e){return function(){return function(t,i){var o=new or(n,i);if(Reflect.hasOwnMetadata(n,t.constructor))throw new Error(e);Reflect.defineMetadata(n,o,t.constructor)}}}var qw=Cz(j3,Qoe),lse=Cz(P_,Zoe),LD;LD||(LD={});var fse=Ioe;const hse=Object.freeze(Object.defineProperty({__proto__:null,AsyncContainerModule:Jre,BindingScopeEnum:Cn,BindingTypeEnum:zt,Container:yz,ContainerModule:bz,LazyServiceIdentifer:OD,LazyServiceIdentifier:OD,METADATA_KEY:fse,MetadataReader:oz,TargetTypeEnum:qm,createTaggedDecorator:c0,decorate:sse,getServiceIdentifierAsString:Bp,id:Lu,inject:be,injectable:le,get interfaces(){return LD},multiBindToService:wre,multiInject:w6,named:cse,namedConstraint:jv,optional:Wm,postConstruct:qw,preDestroy:lse,tagged:ase,taggedConstraint:hp,targetName:use,traverseAncerstors:ks,typeConstraint:ZE,unmanaged:dse},Symbol.toStringTag,{value:"Module"})),k=y6(hse);var d0={},Jd={};Object.defineProperty(Jd,"__esModule",{value:!0});Jd.isLabeledAction=Jd.LabeledAction=void 0;let pse=class{constructor(e,t,i){this.label=e,this.actions=t,this.icon=i}};Jd.LabeledAction=pse;function mse(n){return n!==void 0&&n.label!==void 0&&n.actions!==void 0}Jd.isLabeledAction=mse;var ju={},se={},Ji={};Object.defineProperty(Ji,"__esModule",{value:!0});var Pz=Ji.safeAssign=Ji.hasOwnProperty=Ji.isObject=void 0;function wz(n){return typeof n=="object"&&n!==null}Ji.isObject=wz;function gse(n,e,t){if(!wz(n))return!1;if(Array.isArray(e))for(const i of e){if(!Object.prototype.hasOwnProperty.call(n,i)||typeof t=="string"&&typeof n[i]!==t)return!1;if(typeof t=="function"&&!t(n[i]))return!1}else{if(!Object.prototype.hasOwnProperty.call(n,e))return!1;if(typeof t=="string")return typeof n[e]===t;if(typeof t=="function")return t(n[e])}return!0}Ji.hasOwnProperty=gse;function vse(n,e){return Object.assign(n,e)}Pz=Ji.safeAssign=vse;Object.defineProperty(se,"__esModule",{value:!0});se.ReconnectAction=se.ApplyLabelEditAction=se.DeleteElementAction=se.CreateElementAction=se.HoverFeedbackAction=se.MoveAction=se.RedoAction=se.UndoAction=se.BringToFrontAction=se.ViewportResult=se.GetViewportAction=se.SetViewportAction=se.FitToScreenAction=se.CenterAction=se.LayoutAction=se.OpenAction=se.CollapseExpandAllAction=se.CollapseExpandAction=se.SelectionResult=se.GetSelectionAction=se.SelectAllAction=se.SelectAction=se.LoggingAction=se.ComputedBoundsAction=se.RequestBoundsAction=se.SetBoundsAction=se.SetPopupModelAction=se.RequestPopupModelAction=se.UpdateModelAction=se.SetModelAction=se.RequestModelAction=se.RejectAction=se.isResponseAction=se.setRequestContext=se.generateRequestId=se.isRequestAction=se.isAction=se.isActionMessage=void 0;const Ww=Ji;function _se(n){return(0,Ww.hasOwnProperty)(n,"action")}se.isActionMessage=_se;function yse(n){return(0,Ww.hasOwnProperty)(n,"kind","string")}se.isAction=yse;function bse(n){return(0,Ww.hasOwnProperty)(n,"requestId","string")}se.isRequestAction=bse;let Az="",Sse=1;function Zm(){return`${Az}_${Sse++}`}se.generateRequestId=Zm;function Ese(n){Az=n}se.setRequestContext=Ese;function Cse(n){return(0,Ww.hasOwnProperty)(n,"responseId","string")&&n.responseId!==""}se.isResponseAction=Cse;var XN;(function(n){n.KIND="rejectRequest";function e(t){return{kind:n.KIND,message:t.message,detail:t.detail,responseId:t.requestId}}n.create=e})(XN||(se.RejectAction=XN={}));var JN;(function(n){n.KIND="requestModel";function e(t){return{kind:n.KIND,options:t,requestId:Zm()}}n.create=e})(JN||(se.RequestModelAction=JN={}));var eB;(function(n){n.KIND="setModel";function e(t,i=""){return{kind:n.KIND,newRoot:t,responseId:i}}n.create=e})(eB||(se.SetModelAction=eB={}));var tB;(function(n){n.KIND="updateModel";function e(t,i={}){return Array.isArray(t)?{kind:n.KIND,matches:t,animate:i.animate,cause:i.cause}:{kind:n.KIND,newRoot:t,animate:i.animate,cause:i.cause}}n.create=e})(tB||(se.UpdateModelAction=tB={}));var nB;(function(n){n.KIND="requestPopupModel";function e(t){return{kind:n.KIND,elementId:t.elementId,bounds:t.bounds,requestId:Zm()}}n.create=e})(nB||(se.RequestPopupModelAction=nB={}));var iB;(function(n){n.KIND="setPopupModel";function e(t,i=""){return{kind:n.KIND,newRoot:t,responseId:i}}n.create=e})(iB||(se.SetPopupModelAction=iB={}));var oB;(function(n){n.KIND="setBounds";function e(t){return{kind:n.KIND,bounds:t}}n.create=e})(oB||(se.SetBoundsAction=oB={}));var rB;(function(n){n.KIND="requestBounds";function e(t){return{kind:n.KIND,newRoot:t,requestId:Zm()}}n.create=e})(rB||(se.RequestBoundsAction=rB={}));var sB;(function(n){n.KIND="computedBounds";function e(t,i={}){var o;return{kind:n.KIND,bounds:t,revision:i.revision,alignments:i.alignments,responseId:(o=i.requestId)!==null&&o!==void 0?o:""}}n.create=e})(sB||(se.ComputedBoundsAction=sB={}));var aB;(function(n){n.KIND="logging";function e(t){return Object.assign({kind:n.KIND},t)}n.create=e})(aB||(se.LoggingAction=aB={}));var cB;(function(n){n.KIND="elementSelected";function e(t){var i,o;return{kind:n.KIND,selectedElementsIDs:(i=t.selectedElementsIDs)!==null&&i!==void 0?i:[],deselectedElementsIDs:(o=t.deselectedElementsIDs)!==null&&o!==void 0?o:[]}}n.create=e})(cB||(se.SelectAction=cB={}));var dB;(function(n){n.KIND="allSelected";function e(t={}){var i;return{kind:n.KIND,select:(i=t.select)!==null&&i!==void 0?i:!0}}n.create=e})(dB||(se.SelectAllAction=dB={}));var uB;(function(n){n.KIND="getSelection";function e(){return{kind:n.KIND,requestId:Zm()}}n.create=e})(uB||(se.GetSelectionAction=uB={}));var lB;(function(n){n.KIND="selectionResult";function e(t,i){return{kind:n.KIND,selectedElementsIDs:t,responseId:i}}n.create=e})(lB||(se.SelectionResult=lB={}));var fB;(function(n){n.KIND="collapseExpand";function e(t){var i,o;return{kind:n.KIND,expandIds:(i=t.expandIds)!==null&&i!==void 0?i:[],collapseIds:(o=t.collapseIds)!==null&&o!==void 0?o:[]}}n.create=e})(fB||(se.CollapseExpandAction=fB={}));var hB;(function(n){n.KIND="collapseExpandAll";function e(t={}){var i;return{kind:n.KIND,expand:(i=t.expand)!==null&&i!==void 0?i:!0}}n.create=e})(hB||(se.CollapseExpandAllAction=hB={}));var pB;(function(n){n.KIND="open";function e(t){return{kind:n.KIND,elementId:t}}n.create=e})(pB||(se.OpenAction=pB={}));var mB;(function(n){n.KIND="layout";function e(t={}){return{kind:n.KIND,layoutType:t.layoutType,elementIds:t.elementIds}}n.create=e})(mB||(se.LayoutAction=mB={}));var gB;(function(n){n.KIND="center";function e(t,i={}){var o,r;return{kind:n.KIND,elementIds:t,animate:(o=i.animate)!==null&&o!==void 0?o:!0,retainZoom:(r=i.retainZoom)!==null&&r!==void 0?r:!1,zoomScale:i.zoomScale}}n.create=e})(gB||(se.CenterAction=gB={}));var vB;(function(n){n.KIND="fit";function e(t,i={}){var o;return{kind:n.KIND,elementIds:t,padding:i.padding,maxZoom:i.maxZoom,animate:(o=i.animate)!==null&&o!==void 0?o:!0}}n.create=e})(vB||(se.FitToScreenAction=vB={}));var _B;(function(n){n.KIND="viewport";function e(t,i,o={}){var r;return{kind:n.KIND,elementId:t,newViewport:i,animate:(r=o.animate)!==null&&r!==void 0?r:!0}}n.create=e})(_B||(se.SetViewportAction=_B={}));var yB;(function(n){n.KIND="getViewport";function e(){return{kind:n.KIND,requestId:Zm()}}n.create=e})(yB||(se.GetViewportAction=yB={}));var bB;(function(n){n.KIND="viewportResult";function e(t,i,o){return{kind:n.KIND,viewport:t,canvasBounds:i,responseId:o}}n.create=e})(bB||(se.ViewportResult=bB={}));var SB;(function(n){n.KIND="bringToFront";function e(t){return{kind:n.KIND,elementIDs:t}}n.create=e})(SB||(se.BringToFrontAction=SB={}));var EB;(function(n){n.KIND="undo";function e(){return{kind:n.KIND}}n.create=e})(EB||(se.UndoAction=EB={}));var CB;(function(n){n.KIND="redo";function e(){return{kind:n.KIND}}n.create=e})(CB||(se.RedoAction=CB={}));var PB;(function(n){n.KIND="move";function e(t,i={}){var o,r,s;return{kind:n.KIND,moves:t,animate:(o=i.animate)!==null&&o!==void 0?o:!0,finished:(r=i.finished)!==null&&r!==void 0?r:!1,stoppable:(s=i.stoppable)!==null&&s!==void 0?s:!1}}n.create=e})(PB||(se.MoveAction=PB={}));var wB;(function(n){n.KIND="hoverFeedback";function e(t){return{kind:n.KIND,mouseoverElement:t.mouseoverElement,mouseIsOver:t.mouseIsOver}}n.create=e})(wB||(se.HoverFeedbackAction=wB={}));var AB;(function(n){n.KIND="createElement";function e(t,i){return{kind:n.KIND,elementSchema:t,containerId:i.containerId}}n.create=e})(AB||(se.CreateElementAction=AB={}));var RB;(function(n){n.KIND="delete";function e(t){return{kind:n.KIND,elementIds:t}}n.create=e})(RB||(se.DeleteElementAction=RB={}));var MB;(function(n){n.KIND="applyLabelEdit";function e(t,i){return{kind:n.KIND,labelId:t,text:i}}n.create=e})(MB||(se.ApplyLabelEditAction=MB={}));var IB;(function(n){n.KIND="reconnect";function e(t){return{kind:n.KIND,routableId:t.routableId,newSourceId:t.newSourceId,newTargetId:t.newTargetId}}n.create=e})(IB||(se.ReconnectAction=IB={}));var Pf={};Object.defineProperty(Pf,"__esModule",{value:!0});Pf.Deferred=void 0;class Pse{constructor(){this._state="unresolved",this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),this.promise.then(e=>this._state="resolved",e=>this._state="rejected")}set state(e){this._state==="unresolved"&&(this._state=e)}get state(){return this._state}}Pf.Deferred=Pse;var me={};Object.defineProperty(me,"__esModule",{value:!0});me.TYPES=void 0;me.TYPES={Action:Symbol("Action"),IActionDispatcher:Symbol("IActionDispatcher"),IActionDispatcherProvider:Symbol("IActionDispatcherProvider"),IActionHandlerInitializer:Symbol("IActionHandlerInitializer"),ActionHandlerRegistration:Symbol("ActionHandlerRegistration"),ActionHandlerRegistryProvider:Symbol("ActionHandlerRegistryProvider"),IAnchorComputer:Symbol("IAnchor"),AnimationFrameSyncer:Symbol("AnimationFrameSyncer"),IButtonHandlerRegistration:Symbol("IButtonHandlerRegistration"),ICommandPaletteActionProvider:Symbol("ICommandPaletteActionProvider"),ICommandPaletteActionProviderRegistry:Symbol("ICommandPaletteActionProviderRegistry"),CommandRegistration:Symbol("CommandRegistration"),ICommandStack:Symbol("ICommandStack"),CommandStackOptions:Symbol("CommandStackOptions"),ICommandStackProvider:Symbol("ICommandStackProvider"),IContextMenuItemProvider:Symbol.for("IContextMenuProvider"),IContextMenuProviderRegistry:Symbol.for("IContextMenuProviderRegistry"),IContextMenuService:Symbol.for("IContextMenuService"),IContextMenuServiceProvider:Symbol.for("IContextMenuServiceProvider"),DOMHelper:Symbol("DOMHelper"),IDiagramLocker:Symbol("IDiagramLocker"),IEdgeRouter:Symbol("IEdgeRouter"),IEdgeRoutePostprocessor:Symbol("IEdgeRoutePostprocessor"),IEditLabelValidationDecorator:Symbol("IEditLabelValidationDecorator"),IEditLabelValidator:Symbol("IEditLabelValidator"),HiddenModelViewer:Symbol("HiddenModelViewer"),HiddenVNodePostprocessor:Symbol("HiddenVNodeDecorator"),HoverState:Symbol("HoverState"),KeyListener:Symbol("KeyListener"),LayoutRegistration:Symbol("LayoutRegistration"),LayoutRegistry:Symbol("LayoutRegistry"),Layouter:Symbol("Layouter"),LogLevel:Symbol("LogLevel"),ILogger:Symbol("ILogger"),IModelFactory:Symbol("IModelFactory"),IModelLayoutEngine:Symbol("IModelLayoutEngine"),ModelRendererFactory:Symbol("ModelRendererFactory"),ModelSource:Symbol("ModelSource"),ModelSourceProvider:Symbol("ModelSourceProvider"),ModelViewer:Symbol("ModelViewer"),MouseListener:Symbol("MouseListener"),PatcherProvider:Symbol("PatcherProvider"),IPopupModelProvider:Symbol("IPopupModelProvider"),PopupModelViewer:Symbol("PopupModelViewer"),PopupMouseListener:Symbol("PopupMouseListener"),PopupVNodePostprocessor:Symbol("PopupVNodeDecorator"),SModelElementRegistration:Symbol("SModelElementRegistration"),SModelRegistry:Symbol("SModelRegistry"),ISnapper:Symbol("ISnapper"),SvgExporter:Symbol("SvgExporter"),IUIExtension:Symbol("IUIExtension"),UIExtensionRegistry:Symbol("UIExtensionRegistry"),IVNodePostprocessor:Symbol("IVNodePostprocessor"),ViewRegistration:Symbol("ViewRegistration"),ViewRegistry:Symbol("ViewRegistry"),IViewer:Symbol("IViewer"),ViewerOptions:Symbol("ViewerOptions"),IViewerProvider:Symbol("IViewerProvider")};var $n={},pn={},Zw=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(pn,"__esModule",{value:!0});pn.MultiInstanceRegistry=pn.InstanceRegistry=pn.FactoryRegistry=pn.ProviderRegistry=void 0;const Qw=k;let jD=class{constructor(){this.elements=new Map}register(e,t){if(e===void 0)throw new Error("Key is undefined");if(this.hasKey(e))throw new Error("Key is already registered: "+e);this.elements.set(e,t)}deregister(e){if(e===void 0)throw new Error("Key is undefined");this.elements.delete(e)}hasKey(e){return this.elements.has(e)}get(e,t){const i=this.elements.get(e);return i?new i(t):this.missing(e,t)}missing(e,t){throw new Error("Unknown registry key: "+e)}};pn.ProviderRegistry=jD;pn.ProviderRegistry=jD=Zw([(0,Qw.injectable)()],jD);let ND=class{constructor(){this.elements=new Map}register(e,t){if(e===void 0)throw new Error("Key is undefined");if(this.hasKey(e))throw new Error(`Key is already registered: ${e}. Use \`overrideModelElement\` instead.`);this.elements.set(e,t)}override(e,t){if(e===void 0)throw new Error("Key is undefined");if(!this.hasKey(e))throw new Error(`Key is not registered: ${e}. Use \`configureModelElement\` instead.`);this.elements.set(e,t)}deregister(e){if(e===void 0)throw new Error("Key is undefined");this.elements.delete(e)}hasKey(e){return this.elements.has(e)}get(e,t){const i=this.elements.get(e);return i?i(t):this.missing(e,t)}missing(e,t){throw new Error("Unknown registry key: "+e)}};pn.FactoryRegistry=ND;pn.FactoryRegistry=ND=Zw([(0,Qw.injectable)()],ND);let BD=class{constructor(){this.elements=new Map}register(e,t){if(e===void 0)throw new Error("Key is undefined");if(this.hasKey(e))throw new Error(`Key is already registered: ${e}. Use \`overrideModelElement\` instead.`);this.elements.set(e,t)}override(e,t){if(e===void 0)throw new Error("Key is undefined");if(!this.hasKey(e))throw new Error(`Key is not registered: ${e}. Use \`configureModelElement\` instead.`);this.elements.set(e,t)}deregister(e){if(e===void 0)throw new Error("Key is undefined");this.elements.delete(e)}hasKey(e){return this.elements.has(e)}get(e){const t=this.elements.get(e);return t||this.missing(e)}missing(e){throw new Error("Unknown registry key: "+e)}};pn.InstanceRegistry=BD;pn.InstanceRegistry=BD=Zw([(0,Qw.injectable)()],BD);let $D=class{constructor(){this.elements=new Map}register(e,t){if(e===void 0)throw new Error("Key is undefined");const i=this.elements.get(e);i!==void 0?i.push(t):this.elements.set(e,[t])}deregisterAll(e){if(e===void 0)throw new Error("Key is undefined");this.elements.delete(e)}get(e){const t=this.elements.get(e);return t!==void 0?t:[]}};pn.MultiInstanceRegistry=$D;pn.MultiInstanceRegistry=$D=Zw([(0,Qw.injectable)()],$D);var ke={},Te={};Object.defineProperty(Te,"__esModule",{value:!0});Te.almostEquals=Te.toRadians=Te.toDegrees=Te.Bounds=Te.isBounds=Te.Dimension=Te.centerOfLine=Te.angleBetweenPoints=Te.angleOfPoint=Te.Point=void 0;const wse=Ji;var TB;(function(n){n.ORIGIN=Object.freeze({x:0,y:0});function e(S,w){return{x:S.x+w.x,y:S.y+w.y}}n.add=e;function t(S,w){return{x:S.x-w.x,y:S.y-w.y}}n.subtract=t;function i(S,w){return S.x===w.x&&S.y===w.y}n.equals=i;function o(S,w,P){const E=t(w,S),A=r(E),L={x:A.x*P,y:A.y*P};return e(S,L)}n.shiftTowards=o;function r(S){const w=s(S);return w===0||w===1?n.ORIGIN:{x:S.x/w,y:S.y/w}}n.normalize=r;function s(S){return Math.sqrt(Math.pow(S.x,2)+Math.pow(S.y,2))}n.magnitude=s;function a(S,w,P){return{x:(1-P)*S.x+P*w.x,y:(1-P)*S.y+P*w.y}}n.linear=a;function u(S,w){const P=w.x-S.x,E=w.y-S.y;return Math.sqrt(P*P+E*E)}n.euclideanDistance=u;function h(S,w){return Math.abs(w.x-S.x)+Math.abs(w.y-S.y)}n.manhattanDistance=h;function g(S,w){return Math.max(Math.abs(w.x-S.x),Math.abs(w.y-S.y))}n.maxDistance=g;function y(S,w){return S.x*w.x+S.y*w.y}n.dotProduct=y})(TB||(Te.Point=TB={}));function Ase(n){return Math.atan2(n.y,n.x)}Te.angleOfPoint=Ase;function Rse(n,e){const t=Math.sqrt((n.x*n.x+n.y*n.y)*(e.x*e.x+e.y*e.y));if(isNaN(t)||t===0)return NaN;const i=n.x*e.x+n.y*e.y;return Math.acos(i/t)}Te.angleBetweenPoints=Rse;function Mse(n,e){const t={x:n.x>e.x?e.x:n.x,y:n.y>e.y?e.y:n.y,width:Math.abs(e.x-n.x),height:Math.abs(e.y-n.y)};return kD.center(t)}Te.centerOfLine=Mse;var Xv;(function(n){n.EMPTY=Object.freeze({width:-1,height:-1});function e(t){return t.width>=0&&t.height>=0}n.isValid=e})(Xv||(Te.Dimension=Xv={}));function Ise(n){return(0,wse.hasOwnProperty)(n,["x","y","width","height"])}Te.isBounds=Ise;var kD;(function(n){n.EMPTY=Object.freeze({x:0,y:0,width:-1,height:-1});function e(r,s){if(!Xv.isValid(r))return Xv.isValid(s)?s:n.EMPTY;if(!Xv.isValid(s))return r;const a=Math.min(r.x,s.x),u=Math.min(r.y,s.y),h=Math.max(r.x+(r.width>=0?r.width:0),s.x+(s.width>=0?s.width:0)),g=Math.max(r.y+(r.height>=0?r.height:0),s.y+(s.height>=0?s.height:0));return{x:a,y:u,width:h-a,height:g-u}}n.combine=e;function t(r,s){return{x:r.x+s.x,y:r.y+s.y,width:r.width,height:r.height}}n.translate=t;function i(r){return{x:r.x+(r.width>=0?.5*r.width:0),y:r.y+(r.height>=0?.5*r.height:0)}}n.center=i;function o(r,s){return s.x>=r.x&&s.x<=r.x+r.width&&s.y>=r.y&&s.y<=r.y+r.height}n.includes=o})(kD||(Te.Bounds=kD={}));function Tse(n){return n*180/Math.PI}Te.toDegrees=Tse;function Dse(n){return n*Math.PI/180}Te.toRadians=Dse;function Ose(n,e){return Math.abs(n-e)<.001}Te.almostEquals=Ose;var Io={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.mapIterable=n.filterIterable=n.DONE_RESULT=n.toArray=n.FluentIterableImpl=void 0;class e{constructor(u,h){this.startFn=u,this.nextFn=h}[Symbol.iterator](){const u={state:this.startFn(),next:()=>this.nextFn(u.state),[Symbol.iterator]:()=>u};return u}filter(u){return i(this,u)}map(u){return o(this,u)}forEach(u){const h=this[Symbol.iterator]();let g=0,y;do y=h.next(),y.value!==void 0&&u(y.value,g),g++;while(!y.done)}indexOf(u){const h=this[Symbol.iterator]();let g=0,y;do{if(y=h.next(),y.value===u)return g;g++}while(!y.done);return-1}}n.FluentIterableImpl=e;function t(a){if(a.constructor===Array)return a;const u=[];return a.forEach(h=>u.push(h)),u}n.toArray=t,n.DONE_RESULT=Object.freeze({done:!0,value:void 0});function i(a,u){return new e(()=>r(a),h=>{let g;do g=h.next();while(!g.done&&!u(g.value));return g})}n.filterIterable=i;function o(a,u){return new e(()=>r(a),h=>{const{done:g,value:y}=h.next();return g?n.DONE_RESULT:{done:!1,value:u(y)}})}n.mapIterable=o;function r(a){const u=a[Symbol.iterator];if(typeof u=="function")return u.call(a);const h=a.length;return typeof h=="number"&&h>=0?new s(a):{next:()=>n.DONE_RESULT}}class s{constructor(u){this.array=u,this.index=0}next(){return this.index<this.array.length?{done:!1,value:this.array[this.index++]}:n.DONE_RESULT}[Symbol.iterator](){return this}}})(Io);Object.defineProperty(ke,"__esModule",{value:!0});ke.ModelIndexImpl=ke.createRandomId=ke.SModelRootImpl=ke.SChildElementImpl=ke.SParentElementImpl=ke.isParent=ke.SModelElementImpl=void 0;const FD=Te,Lse=Io;class Rz{get root(){let e=this;for(;e;){if(e instanceof Iz)return e;e instanceof Mz?e=e.parent:e=void 0}throw new Error("Element has no root")}get index(){return this.root.index}hasFeature(e){return this.features!==void 0&&this.features.has(e)}}ke.SModelElementImpl=Rz;function jse(n){const e=n.children;return e!==void 0&&e.constructor===Array}ke.isParent=jse;class A_ extends Rz{constructor(){super(...arguments),this.children=[]}add(e,t){const i=this.children;if(t===void 0)i.push(e);else{if(t<0||t>this.children.length)throw new Error(`Child index ${t} out of bounds (0..${i.length})`);i.splice(t,0,e)}e.parent=this,this.index.add(e)}remove(e){const t=this.children,i=t.indexOf(e);if(i<0)throw new Error(`No such child ${e.id}`);t.splice(i,1),this.index.remove(e)}removeAll(e){const t=this.children;if(e!==void 0){for(let i=t.length-1;i>=0;i--)if(e(t[i])){const o=t.splice(i,1)[0];this.index.remove(o)}}else t.forEach(i=>{this.index.remove(i)}),t.splice(0,t.length)}move(e,t){const i=this.children,o=i.indexOf(e);if(o===-1)throw new Error(`No such child ${e.id}`);if(t<0||t>i.length-1)throw new Error(`Child index ${t} out of bounds (0..${i.length})`);i.splice(o,1),i.splice(t,0,e)}localToParent(e){return(0,FD.isBounds)(e)?e:{x:e.x,y:e.y,width:-1,height:-1}}parentToLocal(e){return(0,FD.isBounds)(e)?e:{x:e.x,y:e.y,width:-1,height:-1}}}ke.SParentElementImpl=A_;class Mz extends A_{}ke.SChildElementImpl=Mz;class Iz extends A_{constructor(e=new Dz){super(),this.canvasBounds=FD.Bounds.EMPTY,Object.defineProperty(this,"index",{value:e,writable:!1})}}ke.SModelRootImpl=Iz;const DB="0123456789abcdefghijklmnopqrstuvwxyz";function Tz(n=8){let e="";for(let t=0;t<n;t++)e+=DB.charAt(Math.floor(Math.random()*DB.length));return e}ke.createRandomId=Tz;class Dz{constructor(){this.id2element=new Map}add(e){if(e.id){if(this.contains(e))throw new Error("Duplicate ID in model: "+e.id)}else do e.id=Tz();while(this.contains(e));if(this.id2element.set(e.id,e),e instanceof A_)for(const t of e.children)this.add(t)}remove(e){if(this.id2element.delete(e.id),e instanceof A_)for(const t of e.children)this.remove(t)}contains(e){return this.id2element.has(e.id)}getById(e){return this.id2element.get(e)}getAttachedElements(e){return[]}all(){return(0,Lse.mapIterable)(this.id2element,([e,t])=>t)}}ke.ModelIndexImpl=Dz;var A6=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Oz=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},OB=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty($n,"__esModule",{value:!0});$n.createFeatureSet=$n.EMPTY_ROOT=$n.SModelFactory=$n.SModelRegistry=void 0;const Jv=k,Lz=me,Nse=pn,Oh=ke;let F3=class extends Nse.FactoryRegistry{constructor(e){super(),e.forEach(t=>{let i=this.getDefaultFeatures(t.constr);if(!i&&t.features&&t.features.enable&&(i=[]),i){const o=jz(i,t.features);t.isOverride?this.override(t.type,()=>{const r=new t.constr;return r.features=o,r}):this.register(t.type,()=>{const r=new t.constr;return r.features=o,r})}else t.isOverride?this.override(t.type,()=>new t.constr):this.register(t.type,()=>new t.constr)})}getDefaultFeatures(e){let t=e;do{const i=t.DEFAULT_FEATURES;if(i)return i;t=Object.getPrototypeOf(t)}while(t)}};$n.SModelRegistry=F3;$n.SModelRegistry=F3=A6([(0,Jv.injectable)(),OB(0,(0,Jv.multiInject)(Lz.TYPES.SModelElementRegistration)),OB(0,(0,Jv.optional)()),Oz("design:paramtypes",[Array])],F3);let x3=class{createElement(e,t){let i;if(this.registry.hasKey(e.type)){const o=this.registry.get(e.type,void 0);if(!(o instanceof Oh.SChildElementImpl))throw new Error(`Element with type ${e.type} was expected to be an SChildElement.`);i=o}else i=new Oh.SChildElementImpl;return this.initializeChild(i,e,t)}createRoot(e){let t;if(this.registry.hasKey(e.type)){const i=this.registry.get(e.type,void 0);if(!(i instanceof Oh.SModelRootImpl))throw new Error(`Element with type ${e.type} was expected to be an SModelRoot.`);t=i}else t=new Oh.SModelRootImpl;return this.initializeRoot(t,e)}createSchema(e){const t={};for(const i in e)if(!this.isReserved(e,i)){const o=e[i];typeof o!="function"&&(t[i]=o)}return e instanceof Oh.SParentElementImpl&&(t.children=e.children.map(i=>this.createSchema(i))),t}initializeElement(e,t){for(const i in t)if(!this.isReserved(e,i)){const o=t[i];typeof o!="function"&&(e[i]=o)}return e}isReserved(e,t){if(["children","parent","index"].indexOf(t)>=0)return!0;let i=e;do{const o=Object.getOwnPropertyDescriptor(i,t);if(o!==void 0)return o.get!==void 0;i=Object.getPrototypeOf(i)}while(i);return!1}initializeParent(e,t){return this.initializeElement(e,t),(0,Oh.isParent)(t)&&(e.children=t.children.map(i=>this.createElement(i,e))),e}initializeChild(e,t,i){return this.initializeParent(e,t),i!==void 0&&(e.parent=i),e}initializeRoot(e,t){return this.initializeParent(e,t),e.index.add(e),e}};$n.SModelFactory=x3;A6([(0,Jv.inject)(Lz.TYPES.SModelRegistry),Oz("design:type",F3)],x3.prototype,"registry",void 0);$n.SModelFactory=x3=A6([(0,Jv.injectable)()],x3);$n.EMPTY_ROOT=Object.freeze({type:"NONE",id:"EMPTY"});function jz(n,e){const t=new Set(n);if(e&&e.enable)for(const i of e.enable)t.add(i);if(e&&e.disable)for(const i of e.disable)t.delete(i);return t}$n.createFeatureSet=jz;var Pa={},Bse=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Pa,"__esModule",{value:!0});Pa.AnimationFrameSyncer=void 0;const $se=k;let xD=class{constructor(){this.tasks=[],this.endTasks=[],this.triggered=!1}isAvailable(){return typeof requestAnimationFrame=="function"}onNextFrame(e){this.tasks.push(e),this.trigger()}onEndOfNextFrame(e){this.endTasks.push(e),this.trigger()}trigger(){this.triggered||(this.triggered=!0,this.isAvailable()?requestAnimationFrame(e=>this.run(e)):setTimeout(e=>this.run(e)))}run(e){const t=this.tasks,i=this.endTasks;this.triggered=!1,this.tasks=[],this.endTasks=[],t.forEach(o=>o.call(void 0,e)),i.forEach(o=>o.call(void 0,e))}};Pa.AnimationFrameSyncer=xD;Pa.AnimationFrameSyncer=xD=Bse([(0,$se.injectable)()],xD);var Qm=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},u0=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(ju,"__esModule",{value:!0});ju.ActionDispatcher=void 0;const Xm=k,vd=se,kse=Pf,l0=me,Fse=$n,xse=Pa;(0,vd.setRequestContext)("client");let eu=class{constructor(){this.postponedActions=[],this.requests=new Map}initialize(){return this.initialized||(this.initialized=this.actionHandlerRegistryProvider().then(e=>{this.actionHandlerRegistry=e,this.handleAction(vd.SetModelAction.create(Fse.EMPTY_ROOT)).catch(()=>{})})),this.initialized}dispatch(e){return this.initialize().then(()=>{if(this.blockUntil!==void 0)return this.handleBlocked(e,this.blockUntil);if(this.diagramLocker.isAllowed(e))return this.handleAction(e)})}dispatchAll(e){return Promise.all(e.map(t=>this.dispatch(t)))}request(e){if(!e.requestId)return Promise.reject(new Error("Request without requestId"));const t=new kse.Deferred;return this.requests.set(e.requestId,t),this.dispatch(e).catch(()=>{}),t.promise}handleAction(e){if(e.kind===vd.UndoAction.KIND)return this.commandStack.undo().then(()=>{});if(e.kind===vd.RedoAction.KIND)return this.commandStack.redo().then(()=>{});if((0,vd.isResponseAction)(e)){const o=this.requests.get(e.responseId);if(o!==void 0){if(this.requests.delete(e.responseId),e.kind===vd.RejectAction.KIND){const r=e;o.reject(new Error(r.message)),this.logger.warn(this,`Request with id ${e.responseId} failed.`,r.message,r.detail)}else o.resolve(e);return Promise.resolve()}this.logger.log(this,"No matching request for response",e)}const t=this.actionHandlerRegistry.get(e.kind);if(t.length===0){this.logger.warn(this,"Missing handler for action",e);const o=new Error(`Missing handler for action '${e.kind}'`);if((0,vd.isRequestAction)(e)){const r=this.requests.get(e.requestId);r!==void 0&&(this.requests.delete(e.requestId),r.reject(o))}return Promise.reject(o)}this.logger.log(this,"Handle",e);const i=[];for(const o of t){const r=o.handle(e);(0,vd.isAction)(r)?i.push(this.dispatch(r)):r!==void 0&&(i.push(this.commandStack.execute(r)),this.blockUntil=r.blockUntil)}return Promise.all(i)}handleBlocked(e,t){if(t(e)){this.blockUntil=void 0;const i=this.handleAction(e),o=this.postponedActions;this.postponedActions=[];for(const r of o)this.dispatch(r.action).then(r.resolve,r.reject);return i}else return this.logger.log(this,"Action is postponed due to block condition",e),new Promise((i,o)=>{this.postponedActions.push({action:e,resolve:i,reject:o})})}};ju.ActionDispatcher=eu;Qm([(0,Xm.inject)(l0.TYPES.ActionHandlerRegistryProvider),u0("design:type",Function)],eu.prototype,"actionHandlerRegistryProvider",void 0);Qm([(0,Xm.inject)(l0.TYPES.ICommandStack),u0("design:type",Object)],eu.prototype,"commandStack",void 0);Qm([(0,Xm.inject)(l0.TYPES.ILogger),u0("design:type",Object)],eu.prototype,"logger",void 0);Qm([(0,Xm.inject)(l0.TYPES.AnimationFrameSyncer),u0("design:type",xse.AnimationFrameSyncer)],eu.prototype,"syncer",void 0);Qm([(0,Xm.inject)(l0.TYPES.IDiagramLocker),u0("design:type",Object)],eu.prototype,"diagramLocker",void 0);ju.ActionDispatcher=eu=Qm([(0,Xm.injectable)()],eu);var Wo={},wa={};Object.defineProperty(wa,"__esModule",{value:!0});wa.isInjectable=void 0;function Hse(n){return Reflect.getMetadata("inversify:paramtypes",n)!==void 0}wa.isInjectable=Hse;var Kse=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Vse=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},nE=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Wo,"__esModule",{value:!0});Wo.onAction=Wo.configureActionHandler=Wo.ActionHandlerRegistry=void 0;const ov=k,H3=me,zse=pn,Gse=wa;let HD=class extends zse.MultiInstanceRegistry{constructor(e,t){super(),e.forEach(i=>this.register(i.actionKind,i.factory())),t.forEach(i=>this.initializeActionHandler(i))}initializeActionHandler(e){e.initialize(this)}};Wo.ActionHandlerRegistry=HD;Wo.ActionHandlerRegistry=HD=Kse([(0,ov.injectable)(),nE(0,(0,ov.multiInject)(H3.TYPES.ActionHandlerRegistration)),nE(0,(0,ov.optional)()),nE(1,(0,ov.multiInject)(H3.TYPES.IActionHandlerInitializer)),nE(1,(0,ov.optional)()),Vse("design:paramtypes",[Array,Array])],HD);function Use(n,e,t){if(typeof t=="function"){if(!(0,Gse.isInjectable)(t))throw new Error(`Action handlers should be @injectable: ${t.name}`);n.isBound(t)||n.bind(t).toSelf()}n.bind(H3.TYPES.ActionHandlerRegistration).toDynamicValue(i=>({actionKind:e,factory:()=>i.container.get(t)}))}Wo.configureActionHandler=Use;function Yse(n,e,t){n.bind(H3.TYPES.ActionHandlerRegistration).toConstantValue({actionKind:e,factory:()=>({handle:t})})}Wo.onAction=Yse;var wf={},qse=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(wf,"__esModule",{value:!0});wf.DefaultDiagramLocker=void 0;const Wse=k;let KD=class{isAllowed(e){return!0}};wf.DefaultDiagramLocker=KD;wf.DefaultDiagramLocker=KD=qse([(0,Wse.injectable)()],KD);var Lr={},Jm={};Object.defineProperty(Jm,"__esModule",{value:!0});Jm.easeInOut=void 0;function Zse(n){return n<.5?n*n*2:1-(1-n)*(1-n)*2}Jm.easeInOut=Zse;Object.defineProperty(Lr,"__esModule",{value:!0});Lr.CompoundAnimation=Lr.Animation=void 0;const Nz=Jm;class Bz{constructor(e,t=Nz.easeInOut){this.context=e,this.ease=t,this.stopped=!1}start(){return this.stopped=!1,new Promise((e,t)=>{let i,o=0;const r=s=>{o++;let a;i===void 0?(i=s,a=0):a=s-i;const u=Math.min(1,a/this.context.duration),h=this.tween(this.ease(u),this.context);this.context.modelChanged.update(h),u===1?(this.context.logger.log(this,o*1e3/this.context.duration+" fps"),e(h)):this.stopped?(this.context.logger.log(this,"Animation stopped at "+u*100+"%"),e(h)):this.context.syncer.onNextFrame(r)};if(this.context.syncer.isAvailable())this.context.syncer.onNextFrame(r);else{const s=this.tween(1,this.context);e(s)}})}stop(){this.stopped=!0}}Lr.Animation=Bz;class Qse extends Bz{constructor(e,t,i=[],o=Nz.easeInOut){super(t,o),this.model=e,this.context=t,this.components=i,this.ease=o}include(e){return this.components.push(e),this}tween(e,t){for(const i of this.components)i.tween(e,t);return this.model}}Lr.CompoundAnimation=Qse;var ze={},Fr={},Xw={};Object.defineProperty(Xw,"__esModule",{value:!0});Xw.ServerActionHandlerRegistry=void 0;class Xse{constructor(){this.handlers=new Map}getHandler(e){return this.handlers.get(e)}onAction(e,t){this.handlers.has(e)?this.handlers.get(e).push(t):this.handlers.set(e,[t])}removeActionHandler(e,t){const i=this.handlers.get(e);if(i){const o=i.indexOf(t);o>=0&&i.splice(o,1)}}}Xw.ServerActionHandlerRegistry=Xse;var Jw={},Nn={};Object.defineProperty(Nn,"__esModule",{value:!0});Nn.SModelIndex=Nn.findElement=Nn.getSubType=Nn.getBasicType=Nn.applyBounds=Nn.cloneModel=void 0;function Jse(n){return JSON.parse(JSON.stringify(n))}Nn.cloneModel=Jse;function eae(n,e){const t=new kz;t.add(n);for(const i of e.bounds){const o=t.getById(i.elementId);if(o){const r=o;i.newPosition&&(r.position={x:i.newPosition.x,y:i.newPosition.y}),i.newSize&&(r.size={width:i.newSize.width,height:i.newSize.height})}}if(e.alignments)for(const i of e.alignments){const o=t.getById(i.elementId);if(o){const r=o;r.alignment={x:i.newAlignment.x,y:i.newAlignment.y}}}}Nn.applyBounds=eae;function tae(n){if(!n.type)return"";const e=n.type.indexOf(":");return e>=0?n.type.substring(0,e):n.type}Nn.getBasicType=tae;function nae(n){if(!n.type)return"";const e=n.type.indexOf(":");return e>=0?n.type.substring(e+1):n.type}Nn.getSubType=nae;function $z(n,e){if(n.id===e)return n;if(n.children)for(const t of n.children){const i=$z(t,e);if(i!==void 0)return i}}Nn.findElement=$z;class kz{constructor(){this.id2element=new Map,this.id2parent=new Map}add(e){if(e.id){if(this.contains(e))throw new Error("Duplicate ID in model: "+e.id)}else throw new Error("Model element has no ID.");if(this.id2element.set(e.id,e),Array.isArray(e.children))for(const t of e.children)this.add(t),this.id2parent.set(t.id,e);return this}remove(e){if(this.id2element.delete(e.id),Array.isArray(e.children))for(const t of e.children)this.id2parent.delete(t.id),this.remove(t);return this}contains(e){return this.id2element.has(e.id)}getById(e){return this.id2element.get(e)}getParent(e){return this.id2parent.get(e)}getRoot(e){let t=e;for(;t;){const i=this.id2parent.get(t.id);if(i===void 0)return t;t=i}throw new Error("Element has no root")}}Nn.SModelIndex=kz;Object.defineProperty(Jw,"__esModule",{value:!0});Jw.DiagramServer=void 0;const uo=se,iae=Pf,HI=Nn;class oae{constructor(e,t){this.state={currentRoot:{type:"NONE",id:"ROOT"},revision:0},this.requests=new Map,this.dispatch=e,this.diagramGenerator=t.DiagramGenerator,this.layoutEngine=t.ModelLayoutEngine,this.actionHandlerRegistry=t.ServerActionHandlerRegistry}setModel(e){return e.revision=++this.state.revision,this.state.currentRoot=e,this.submitModel(e,!1)}updateModel(e){return e.revision=++this.state.revision,this.state.currentRoot=e,this.submitModel(e,!0)}get needsClientLayout(){return this.state.options&&this.state.options.needsClientLayout!==void 0?!!this.state.options.needsClientLayout:!0}get needsServerLayout(){return this.state.options&&this.state.options.needsServerLayout!==void 0?!!this.state.options.needsServerLayout:!1}accept(e){if((0,uo.isResponseAction)(e)){const t=e.responseId,i=this.requests.get(t);if(i){if(this.requests.delete(t),e.kind===uo.RejectAction.KIND){const o=e;i.reject(new Error(o.message)),console.warn(`Request with id ${e.responseId} failed: ${o.message}`,o.detail)}else i.resolve(e);return Promise.resolve()}console.info("No matching request for response:",e)}return this.handleAction(e)}request(e){e.requestId||(e.requestId="server_"+(0,uo.generateRequestId)());const t=new iae.Deferred;return this.requests.set(e.requestId,t),this.dispatch(e).catch(i=>{this.requests.delete(e.requestId),t.reject(i)}),t.promise}rejectRemoteRequest(e,t){e&&(0,uo.isRequestAction)(e)&&this.dispatch({kind:uo.RejectAction.KIND,responseId:e.requestId,message:t.message,detail:t.stack})}handleAction(e){var t,i;const o=(t=this.actionHandlerRegistry)===null||t===void 0?void 0:t.getHandler(e.kind);if(o&&o.length===1)return(i=o[0](e,this.state,this))!==null&&i!==void 0?i:Promise.resolve();if(o&&o.length>1)return Promise.all(o.map(r=>{var s;return(s=r(e,this.state,this))!==null&&s!==void 0?s:Promise.resolve()}));switch(e.kind){case uo.RequestModelAction.KIND:return this.handleRequestModel(e);case uo.ComputedBoundsAction.KIND:return this.handleComputedBounds(e);case uo.LayoutAction.KIND:return this.handleLayout(e)}return console.warn(`Unhandled action from client: ${e.kind}`),Promise.resolve()}async handleRequestModel(e){var t;this.state.options=e.options;try{const i=await this.diagramGenerator.generate({options:(t=this.state.options)!==null&&t!==void 0?t:{},state:this.state});i.revision=++this.state.revision,this.state.currentRoot=i,await this.submitModel(this.state.currentRoot,!1,e)}catch(i){this.rejectRemoteRequest(e,i),console.error("Failed to generate diagram:",i)}}async submitModel(e,t,i){if(this.needsClientLayout)if(!this.needsServerLayout)this.dispatch({kind:uo.RequestBoundsAction.KIND,newRoot:e});else{const o=uo.RequestBoundsAction.create(e),r=await this.request(o),s=this.state.currentRoot;r.revision===s.revision?((0,HI.applyBounds)(s,r),await this.doSubmitModel(s,t,i)):this.rejectRemoteRequest(i,new Error(`Model revision does not match: ${r.revision}`))}else await this.doSubmitModel(e,t,i)}async doSubmitModel(e,t,i){if(e.revision!==this.state.revision)return;this.needsServerLayout&&this.layoutEngine&&(e=await this.layoutEngine.layout(e));const o=e.type;if(i&&i.kind===uo.RequestModelAction.KIND){const r=i.requestId,s=uo.SetModelAction.create(e,r);await this.dispatch(s)}else t&&o===this.state.lastSubmittedModelType?await this.dispatch({kind:uo.UpdateModelAction.KIND,newRoot:e,cause:i}):await this.dispatch({kind:uo.SetModelAction.KIND,newRoot:e});this.state.lastSubmittedModelType=o}handleComputedBounds(e){return e.revision!==this.state.currentRoot.revision?Promise.reject():((0,HI.applyBounds)(this.state.currentRoot,e),Promise.resolve())}async handleLayout(e){if(this.layoutEngine){if(!this.needsServerLayout){let t=(0,HI.cloneModel)(this.state.currentRoot);t=await this.layoutEngine.layout(t),t.revision=++this.state.revision,this.state.currentRoot=t}await this.doSubmitModel(this.state.currentRoot,!0,e)}}}Jw.DiagramServer=oae;var Fz={};Object.defineProperty(Fz,"__esModule",{value:!0});var Kl={};Object.defineProperty(Kl,"__esModule",{value:!0});Kl.isZoomable=Kl.isScrollable=void 0;const xz=Ji;function rae(n){return(0,xz.hasOwnProperty)(n,"scroll")}Kl.isScrollable=rae;function sae(n){return(0,xz.hasOwnProperty)(n,"zoom")}Kl.isZoomable=sae;var R6={};Object.defineProperty(R6,"__esModule",{value:!0});(function(n){var e=f&&f.__createBinding||(Object.create?function(i,o,r,s){s===void 0&&(s=r);var a=Object.getOwnPropertyDescriptor(o,r);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,s,a)}:function(i,o,r,s){s===void 0&&(s=r),i[s]=o[r]}),t=f&&f.__exportStar||function(i,o){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(o,r)&&e(o,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),t(Xw,n),t(se,n),t(Jw,n),t(Fz,n),t(Kl,n),t(Pf,n),t(Te,n),t(R6,n),t(Nn,n),t(Ji,n)})(Fr);var eg=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(ze,"__esModule",{value:!0});ze.ResetCommand=ze.SystemCommand=ze.PopupCommand=ze.HiddenCommand=ze.MergeableCommand=ze.Command=ze.isStoppableCommand=void 0;const tg=k,aae=Fr;function cae(n){return n&&(0,aae.hasOwnProperty)(n,"stoppableCommandKey")&&"stopExecution"in n&&typeof n.stopExecution=="function"}ze.isStoppableCommand=cae;let tu=class{};ze.Command=tu;ze.Command=tu=eg([(0,tg.injectable)()],tu);let VD=class extends tu{merge(e,t){return!1}};ze.MergeableCommand=VD;ze.MergeableCommand=VD=eg([(0,tg.injectable)()],VD);let zD=class extends tu{undo(e){return e.logger.error(this,"Cannot undo a hidden command"),e.root}redo(e){return e.logger.error(this,"Cannot redo a hidden command"),e.root}};ze.HiddenCommand=zD;ze.HiddenCommand=zD=eg([(0,tg.injectable)()],zD);let GD=class extends tu{};ze.PopupCommand=GD;ze.PopupCommand=GD=eg([(0,tg.injectable)()],GD);let UD=class extends tu{};ze.SystemCommand=UD;ze.SystemCommand=UD=eg([(0,tg.injectable)()],UD);let YD=class extends tu{};ze.ResetCommand=YD;ze.ResetCommand=YD=eg([(0,tg.injectable)()],YD);var wn={},dae=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},uae=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},LB=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(wn,"__esModule",{value:!0});wn.configureCommand=wn.CommandActionHandlerInitializer=wn.CommandActionHandler=void 0;const QE=k,lae=wa,qD=me;class Hz{constructor(e){this.commandRegistration=e}handle(e){return this.commandRegistration.factory(e)}}wn.CommandActionHandler=Hz;let WD=class{constructor(e){this.registrations=e}initialize(e){this.registrations.forEach(t=>e.register(t.kind,new Hz(t)))}};wn.CommandActionHandlerInitializer=WD;wn.CommandActionHandlerInitializer=WD=dae([(0,QE.injectable)(),LB(0,(0,QE.multiInject)(qD.TYPES.CommandRegistration)),LB(0,(0,QE.optional)()),uae("design:paramtypes",[Array])],WD);function fae(n,e){if(!(0,lae.isInjectable)(e))throw new Error(`Commands should be @injectable: ${e.name}`);n.isBound(e)||n.bind(e).toSelf(),n.bind(qD.TYPES.CommandRegistration).toDynamicValue(t=>({kind:e.KIND,factory:i=>{const o=new QE.Container;return o.parent=t.container,o.bind(qD.TYPES.Action).toConstantValue(i),o.get(e)}}))}wn.configureCommand=fae;var eA={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.overrideCommandStackOptions=n.configureCommandStackOptions=n.defaultCommandStackOptions=void 0;const e=Ji,t=me,i=()=>({defaultDuration:250,undoHistoryLimit:50});n.defaultCommandStackOptions=i;function o(s,a){const u=Object.assign(Object.assign({},(0,n.defaultCommandStackOptions)()),a);s.isBound(t.TYPES.CommandStackOptions)?s.rebind(t.TYPES.CommandStackOptions).toConstantValue(u):s.bind(t.TYPES.CommandStackOptions).toConstantValue(u)}n.configureCommandStackOptions=o;function r(s,a){const u=s.get(t.TYPES.CommandStackOptions);return(0,e.safeAssign)(u,a),u}n.overrideCommandStackOptions=r})(eA);var Af={},Rf=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},kd=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Af,"__esModule",{value:!0});Af.CommandStack=void 0;const Mf=k,f0=me,KI=$n,hae=ke,pae=Pa,cd=ze;let sc=class{constructor(){this.undoStack=[],this.redoStack=[],this.stoppableCommands=new Map,this.offStack=[]}initialize(){this.currentPromise=Promise.resolve({main:{model:this.modelFactory.createRoot(KI.EMPTY_ROOT),modelChanged:!1},hidden:{model:this.modelFactory.createRoot(KI.EMPTY_ROOT),modelChanged:!1},popup:{model:this.modelFactory.createRoot(KI.EMPTY_ROOT),modelChanged:!1}})}get currentModel(){return this.currentPromise.then(e=>e.main.model)}executeAll(e){return e.forEach(t=>{this.logger.log(this,"Executing",t),this.handleCommand(t,t.execute,this.mergeOrPush)}),this.thenUpdate()}execute(e){return this.logger.log(this,"Executing",e),this.handleCommand(e,e.execute,this.mergeOrPush),this.thenUpdate()}undo(){this.undoOffStackSystemCommands(),this.undoPreceedingSystemCommands();const e=this.undoStack[this.undoStack.length-1];return e!==void 0&&!this.isBlockUndo(e)&&(this.undoStack.pop(),this.logger.log(this,"Undoing",e),this.handleCommand(e,e.undo,(t,i)=>{this.redoStack.push(t)})),this.thenUpdate()}redo(){this.undoOffStackSystemCommands();const e=this.redoStack.pop();return e!==void 0&&(this.logger.log(this,"Redoing",e),this.handleCommand(e,e.redo,(t,i)=>{this.pushToUndoStack(t)})),this.redoFollowingSystemCommands(),this.thenUpdate()}handleCommand(e,t,i){if((0,cd.isStoppableCommand)(e)){const o=this.stoppableCommands.get(e.stoppableCommandKey);o&&o.stopExecution(),this.stoppableCommands.set(e.stoppableCommandKey,e)}this.currentPromise=this.currentPromise.then(o=>new Promise(r=>{let s;e instanceof cd.HiddenCommand?s="hidden":e instanceof cd.PopupCommand?s="popup":s="main";const a=this.createContext(o.main.model);let u;try{u=t.call(e,a)}catch(g){this.logger.error(this,"Failed to execute command:",g),u=o[s].model}const h=jB(o);u instanceof Promise?u.then(g=>{s==="main"&&i.call(this,e,a),h[s]={model:g,modelChanged:!0},r(h)}):u instanceof hae.SModelRootImpl?(s==="main"&&i.call(this,e,a),h[s]={model:u,modelChanged:!0},r(h)):(s==="main"&&i.call(this,e,a),h[s]={model:u.model,modelChanged:o[s].modelChanged||u.modelChanged,cause:u.cause},r(h))}))}pushToUndoStack(e){this.undoStack.push(e),this.options.undoHistoryLimit>=0&&this.undoStack.length>this.options.undoHistoryLimit&&this.undoStack.splice(0,this.undoStack.length-this.options.undoHistoryLimit)}thenUpdate(){return this.currentPromise=this.currentPromise.then(e=>{const t=jB(e);return e.hidden.modelChanged&&(this.updateHidden(e.hidden.model,e.hidden.cause),t.hidden.modelChanged=!1,t.hidden.cause=void 0),e.main.modelChanged&&(this.update(e.main.model,e.main.cause),t.main.modelChanged=!1,t.main.cause=void 0),e.popup.modelChanged&&(this.updatePopup(e.popup.model,e.popup.cause),t.popup.modelChanged=!1,t.popup.cause=void 0),t}),this.currentModel}update(e,t){this.modelViewer===void 0&&(this.modelViewer=this.viewerProvider.modelViewer),this.modelViewer.update(e,t)}updateHidden(e,t){this.hiddenModelViewer===void 0&&(this.hiddenModelViewer=this.viewerProvider.hiddenModelViewer),this.hiddenModelViewer.update(e,t)}updatePopup(e,t){this.popupModelViewer===void 0&&(this.popupModelViewer=this.viewerProvider.popupModelViewer),this.popupModelViewer.update(e,t)}mergeOrPush(e,t){if(this.isBlockUndo(e)){this.undoStack=[],this.redoStack=[],this.offStack=[],this.pushToUndoStack(e);return}if(this.isPushToOffStack(e)&&this.redoStack.length>0){if(this.offStack.length>0){const i=this.offStack[this.offStack.length-1];if(i instanceof cd.MergeableCommand&&i.merge(e,t))return}this.offStack.push(e);return}if(this.isPushToUndoStack(e)){if(this.offStack.forEach(i=>this.undoStack.push(i)),this.offStack=[],this.redoStack=[],this.undoStack.length>0){const i=this.undoStack[this.undoStack.length-1];if(i instanceof cd.MergeableCommand&&i.merge(e,t))return}this.pushToUndoStack(e)}}undoOffStackSystemCommands(){let e=this.offStack.pop();for(;e!==void 0;)this.logger.log(this,"Undoing off-stack",e),this.handleCommand(e,e.undo,()=>{}),e=this.offStack.pop()}undoPreceedingSystemCommands(){let e=this.undoStack[this.undoStack.length-1];for(;e!==void 0&&this.isPushToOffStack(e);)this.undoStack.pop(),this.logger.log(this,"Undoing",e),this.handleCommand(e,e.undo,(t,i)=>{this.redoStack.push(t)}),e=this.undoStack[this.undoStack.length-1]}redoFollowingSystemCommands(){let e=this.redoStack[this.redoStack.length-1];for(;e!==void 0&&this.isPushToOffStack(e);)this.redoStack.pop(),this.logger.log(this,"Redoing ",e),this.handleCommand(e,e.redo,(t,i)=>{this.pushToUndoStack(t)}),e=this.redoStack[this.redoStack.length-1]}createContext(e){return{root:e,modelChanged:this,modelFactory:this.modelFactory,duration:this.options.defaultDuration,logger:this.logger,syncer:this.syncer}}isPushToOffStack(e){return e instanceof cd.SystemCommand}isPushToUndoStack(e){return!(e instanceof cd.HiddenCommand)}isBlockUndo(e){return e instanceof cd.ResetCommand}};Af.CommandStack=sc;Rf([(0,Mf.inject)(f0.TYPES.IModelFactory),kd("design:type",Object)],sc.prototype,"modelFactory",void 0);Rf([(0,Mf.inject)(f0.TYPES.IViewerProvider),kd("design:type",Object)],sc.prototype,"viewerProvider",void 0);Rf([(0,Mf.inject)(f0.TYPES.ILogger),kd("design:type",Object)],sc.prototype,"logger",void 0);Rf([(0,Mf.inject)(f0.TYPES.AnimationFrameSyncer),kd("design:type",pae.AnimationFrameSyncer)],sc.prototype,"syncer",void 0);Rf([(0,Mf.inject)(f0.TYPES.CommandStackOptions),kd("design:type",Object)],sc.prototype,"options",void 0);Rf([(0,Mf.postConstruct)(),kd("design:type",Function),kd("design:paramtypes",[]),kd("design:returntype",void 0)],sc.prototype,"initialize",null);Af.CommandStack=sc=Rf([(0,Mf.injectable)()],sc);function jB(n){return{main:Object.assign({},n.main),hidden:Object.assign({},n.hidden),popup:Object.assign({},n.popup)}}var Co={},sn={};Object.defineProperty(sn,"__esModule",{value:!0});sn.isSVGGraphicsElement=sn.hitsMouseEvent=sn.getWindowScroll=sn.isCrossSite=sn.isMac=sn.isCtrlOrCmd=void 0;const mae=Fr;function gae(n){return Kz()?n.metaKey:n.ctrlKey}sn.isCtrlOrCmd=gae;function Kz(){return window.navigator.userAgent.indexOf("Mac")!==-1}sn.isMac=Kz;function vae(n){if(n&&typeof window<"u"&&window.location){let e="";return window.location.protocol&&(e+=window.location.protocol+"//"),window.location.host&&(e+=window.location.host),e.length>0&&!n.startsWith(e)}return!1}sn.isCrossSite=vae;function _ae(){return typeof window>"u"?mae.Point.ORIGIN:{x:window.pageXOffset,y:window.pageYOffset}}sn.getWindowScroll=_ae;function yae(n,e){const t=n.getBoundingClientRect();return e.clientX>=t.left&&e.clientX<=t.right&&e.clientY>=t.top&&e.clientY<=t.bottom}sn.hitsMouseEvent=yae;function bae(n){return typeof n.getBBox=="function"}sn.isSVGGraphicsElement=bae;var M6=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Vz=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Sae=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Co,"__esModule",{value:!0});Co.InitializeCanvasBoundsCommand=Co.InitializeCanvasBoundsAction=Co.CanvasBoundsInitializer=void 0;const K3=k,rv=Te,zz=me,Eae=ke,Cae=ze,Pae=sn;let V3=class{decorate(e,t){return t instanceof Eae.SModelRootImpl&&!rv.Dimension.isValid(t.canvasBounds)&&(this.rootAndVnode=[t,e]),e}postUpdate(){if(this.rootAndVnode!==void 0){const e=this.rootAndVnode[1].elm,t=this.rootAndVnode[0].canvasBounds;if(e!==void 0){const i=this.getBoundsInPage(e);(0,rv.almostEquals)(i.x,t.x)&&(0,rv.almostEquals)(i.y,t.y)&&(0,rv.almostEquals)(i.width,t.width)&&(0,rv.almostEquals)(i.height,t.width)||this.actionDispatcher.dispatch(z3.create(i))}this.rootAndVnode=void 0}}getBoundsInPage(e){const t=e.getBoundingClientRect(),i=(0,Pae.getWindowScroll)();return{x:t.left+i.x,y:t.top+i.y,width:t.width,height:t.height}}};Co.CanvasBoundsInitializer=V3;M6([(0,K3.inject)(zz.TYPES.IActionDispatcher),Vz("design:type",Object)],V3.prototype,"actionDispatcher",void 0);Co.CanvasBoundsInitializer=V3=M6([(0,K3.injectable)()],V3);var z3;(function(n){n.KIND="initializeCanvasBounds";function e(t){return{kind:n.KIND,newCanvasBounds:t}}n.create=e})(z3||(Co.InitializeCanvasBoundsAction=z3={}));let G3=class extends Cae.SystemCommand{constructor(e){super(),this.action=e}execute(e){return this.newCanvasBounds=this.action.newCanvasBounds,e.root.canvasBounds=this.newCanvasBounds,e.root}undo(e){return e.root}redo(e){return e.root}};Co.InitializeCanvasBoundsCommand=G3;G3.KIND=z3.KIND;Co.InitializeCanvasBoundsCommand=G3=M6([(0,K3.injectable)(),Sae(0,(0,K3.inject)(zz.TYPES.Action)),Vz("design:paramtypes",[Object])],G3);var Nu={},wae=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Aae=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Rae=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Nu,"__esModule",{value:!0});Nu.SetModelCommand=void 0;const NB=k,Mae=se,Iae=ze,Tae=me,Dae=Co;let U3=class extends Iae.ResetCommand{constructor(e){super(),this.action=e}execute(e){return this.oldRoot=e.modelFactory.createRoot(e.root),this.newRoot=e.modelFactory.createRoot(this.action.newRoot),this.newRoot}undo(e){return this.oldRoot}redo(e){return this.newRoot}get blockUntil(){return e=>e.kind===Dae.InitializeCanvasBoundsCommand.KIND}};Nu.SetModelCommand=U3;U3.KIND=Mae.SetModelAction.KIND;Nu.SetModelCommand=U3=wae([(0,NB.injectable)(),Rae(0,(0,NB.inject)(Tae.TYPES.Action)),Aae("design:paramtypes",[Object])],U3);var yt={};Object.defineProperty(yt,"__esModule",{value:!0});yt.transformToRootBounds=yt.containsSome=yt.translateBounds=yt.translatePoint=yt.findParentByFeature=yt.findParent=yt.registerModelElement=void 0;const Oae=me,R_=ke;function Lae(n,e,t,i,o){n.bind(Oae.TYPES.SModelElementRegistration).toConstantValue({type:e,constr:t,features:i,isOverride:o})}yt.registerModelElement=Lae;function jae(n,e){let t=n;for(;t!==void 0;){if(e(t))return t;t instanceof R_.SChildElementImpl?t=t.parent:t=void 0}return t}yt.findParent=jae;function Nae(n,e){let t=n;for(;t!==void 0;){if(e(t))return t;t instanceof R_.SChildElementImpl?t=t.parent:t=void 0}return t}yt.findParentByFeature=Nae;function ZD(n,e,t){if(e!==t){for(;e instanceof R_.SChildElementImpl;)if(n=e.localToParent(n),e=e.parent,e===t)return n;const i=[];for(;t instanceof R_.SChildElementImpl;)i.push(t),t=t.parent;if(e!==t)throw new Error("Incompatible source and target: "+e.id+", "+t.id);for(let o=i.length-1;o>=0;o--)n=i[o].parentToLocal(n)}return n}yt.translatePoint=ZD;function Bae(n,e,t){const i=ZD(n,e,t),o=ZD({x:n.x+n.width,y:n.y+n.height},e,t);return{x:i.x,y:i.y,width:o.x-i.x,height:o.y-i.y}}yt.translateBounds=Bae;function $ae(n,e){const t=o=>n.index.getById(o.id)!==void 0,i=o=>o.some(r=>t(r)||i(r.children));return i([e])}yt.containsSome=$ae;function kae(n,e){for(;n instanceof R_.SChildElementImpl;)e=n.localToParent(e),n=n.parent;return e}yt.transformToRootBounds=kae;var Po={},I6=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},T6=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},QD=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Po,"__esModule",{value:!0});Po.SetUIExtensionVisibilityCommand=Po.SetUIExtensionVisibilityAction=Po.UIExtensionRegistry=void 0;const bp=k,Fae=pn,xae=ze,D6=me;let Y3=class extends Fae.InstanceRegistry{constructor(e=[]){super(),e.forEach(t=>this.register(t.id(),t))}};Po.UIExtensionRegistry=Y3;Po.UIExtensionRegistry=Y3=I6([(0,bp.injectable)(),QD(0,(0,bp.multiInject)(D6.TYPES.IUIExtension)),QD(0,(0,bp.optional)()),T6("design:paramtypes",[Array])],Y3);var XD;(function(n){n.KIND="setUIExtensionVisibility";function e(t){var i;return{kind:n.KIND,extensionId:t.extensionId,visible:t.visible,contextElementsId:(i=t.contextElementsId)!==null&&i!==void 0?i:[]}}n.create=e})(XD||(Po.SetUIExtensionVisibilityAction=XD={}));let M_=class extends xae.SystemCommand{constructor(e){super(),this.action=e}execute(e){const t=this.registry.get(this.action.extensionId);return t&&(this.action.visible?t.show(e.root,...this.action.contextElementsId):t.hide()),{model:e.root,modelChanged:!1}}undo(e){return{model:e.root,modelChanged:!1}}redo(e){return{model:e.root,modelChanged:!1}}};Po.SetUIExtensionVisibilityCommand=M_;M_.KIND=XD.KIND;I6([(0,bp.inject)(D6.TYPES.UIExtensionRegistry),T6("design:type",Y3)],M_.prototype,"registry",void 0);Po.SetUIExtensionVisibilityCommand=M_=I6([(0,bp.injectable)(),QD(0,(0,bp.inject)(D6.TYPES.Action)),T6("design:paramtypes",[Object])],M_);var aa={},O6=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Gz=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(aa,"__esModule",{value:!0});aa.AbstractUIExtension=aa.isUIExtension=void 0;const L6=k,VI=Fr,Uz=me;function Hae(n){return(0,VI.hasOwnProperty)(n,"id","function")&&(0,VI.hasOwnProperty)(n,"show","function")&&(0,VI.hasOwnProperty)(n,"hide","function")}aa.isUIExtension=Hae;let I_=class{show(e,...t){this.activeElement=document.activeElement,!(!this.containerElement&&!this.initialize())&&(this.onBeforeShow(this.containerElement,e,...t),this.setContainerVisible(!0))}hide(){this.setContainerVisible(!1),this.restoreFocus(),this.activeElement=null}restoreFocus(){const e=this.activeElement;e&&e.focus()}initialize(){const e=document.getElementById(this.options.baseDiv);return e?(this.containerElement=this.getOrCreateContainer(e.id),this.initializeContents(this.containerElement),e&&e.insertBefore(this.containerElement,e.firstChild),!0):(this.logger.warn(this,`Could not obtain sprotty base container for initializing UI extension ${this.id}`,this),!1)}getOrCreateContainer(e){let t=document.getElementById(this.id());return t===null&&(t=document.createElement("div"),t.id=e+"_"+this.id(),t.classList.add(this.containerClass())),t}setContainerVisible(e){this.containerElement&&(e?(this.containerElement.style.visibility="visible",this.containerElement.style.opacity="1"):(this.containerElement.style.visibility="hidden",this.containerElement.style.opacity="0"))}onBeforeShow(e,t,...i){}};aa.AbstractUIExtension=I_;O6([(0,L6.inject)(Uz.TYPES.ViewerOptions),Gz("design:type",Object)],I_.prototype,"options",void 0);O6([(0,L6.inject)(Uz.TYPES.ILogger),Gz("design:type",Object)],I_.prototype,"logger",void 0);aa.AbstractUIExtension=I_=O6([(0,L6.injectable)()],I_);var gi={},ft={};Object.defineProperty(ft,"__esModule",{value:!0});ft.getAttrs=ft.on=ft.mergeStyle=ft.copyClassesFromElement=ft.copyClassesFromVNode=ft.setNamespace=ft.setClass=ft.setAttr=void 0;function Kae(n,e,t){qz(n)[e]=t}ft.setAttr=Kae;function j6(n,e,t){Wz(n)[e]=t}ft.setClass=j6;function Yz(n,e){n.data===void 0&&(n.data={}),n.data.ns=e;const t=n.children;if(t!==void 0)for(let i=0;i<t.length;i++){const o=t[i];typeof o!="string"&&Yz(o,e)}}ft.setNamespace=Yz;function Vae(n,e){const t=Wz(n);Object.keys(t).forEach(i=>j6(e,i,!0))}ft.copyClassesFromVNode=Vae;function zae(n,e){const t=n.classList;for(let i=0;i<t.length;i++){const o=t.item(i);o&&j6(e,o,!0)}}ft.copyClassesFromElement=zae;function Gae(n,e){T_(n).style=Object.assign(Object.assign({},T_(n).style||{}),e)}ft.mergeStyle=Gae;function Uae(n,e,t){const i=Yae(n);if(i[e])throw new Error("EventListener for "+e+" already registered on VNode");i[e]=t}ft.on=Uae;function qz(n){const e=T_(n);return e.attrs||(e.attrs={}),e.attrs}ft.getAttrs=qz;function T_(n){return n.data||(n.data={}),n.data}function Wz(n){const e=T_(n);return e.class||(e.class={}),e.class}function Yae(n){const e=T_(n);return e.on||(e.on={}),e.on}var N6=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Zz=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},BB=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(gi,"__esModule",{value:!0});gi.KeyListener=gi.KeyTool=void 0;const e_=k,Qz=me,qae=ke,zI=ft;let q3=class{constructor(e=[]){this.keyListeners=e}register(e){this.keyListeners.push(e)}deregister(e){const t=this.keyListeners.indexOf(e);t>=0&&this.keyListeners.splice(t,1)}handleEvent(e,t,i){const o=this.keyListeners.map(r=>r[e].apply(r,[t,i])).reduce((r,s)=>r.concat(s));o.length>0&&(i.preventDefault(),this.actionDispatcher.dispatchAll(o))}keyDown(e,t){this.handleEvent("keyDown",e,t)}keyUp(e,t){this.handleEvent("keyUp",e,t)}focus(){}decorate(e,t){return t instanceof qae.SModelRootImpl&&((0,zI.on)(e,"focus",this.focus.bind(this,t)),(0,zI.on)(e,"keydown",this.keyDown.bind(this,t)),(0,zI.on)(e,"keyup",this.keyUp.bind(this,t))),e}postUpdate(){}};gi.KeyTool=q3;N6([(0,e_.inject)(Qz.TYPES.IActionDispatcher),Zz("design:type",Object)],q3.prototype,"actionDispatcher",void 0);gi.KeyTool=q3=N6([(0,e_.injectable)(),BB(0,(0,e_.multiInject)(Qz.TYPES.KeyListener)),BB(0,(0,e_.optional)()),Zz("design:paramtypes",[Array])],q3);let JD=class{keyDown(e,t){return[]}keyUp(e,t){return[]}};gi.KeyListener=JD;gi.KeyListener=JD=N6([(0,e_.injectable)()],JD);var Ut={},Aa={},Xz=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Wae=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Aa,"__esModule",{value:!0});Aa.DOMHelper=void 0;const Jz=k,Zae=me;let W3=class{getPrefix(){return this.viewerOptions!==void 0&&this.viewerOptions.baseDiv!==void 0?this.viewerOptions.baseDiv+"_":""}createUniqueDOMElementId(e){return this.getPrefix()+e.id}findSModelIdByDOMElement(e){return e.id.replace(this.getPrefix(),"")}};Aa.DOMHelper=W3;Xz([(0,Jz.inject)(Zae.TYPES.ViewerOptions),Wae("design:type",Object)],W3.prototype,"viewerOptions",void 0);Aa.DOMHelper=W3=Xz([(0,Jz.injectable)()],W3);var ng=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},tA=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Z3=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Ut,"__esModule",{value:!0});Ut.MousePositionTracker=Ut.MouseListener=Ut.PopupMouseTool=Ut.MouseTool=void 0;const ea=k,Qae=se,Xae=ke,nA=me,Jae=Aa,_r=ft;let kp=class{constructor(e=[]){this.mouseListeners=e}register(e){this.mouseListeners.push(e)}deregister(e){const t=this.mouseListeners.indexOf(e);t>=0&&this.mouseListeners.splice(t,1)}getTargetElement(e,t){let i=t.target;const o=e.index;for(;i;){if(i.id){const r=o.getById(this.domHelper.findSModelIdByDOMElement(i));if(r!==void 0)return r}i=i.parentNode}}handleEvent(e,t,i){this.focusOnMouseEvent(e,t);const o=this.getTargetElement(t,i);if(!o)return;const r=this.mouseListeners.map(s=>s[e](o,i)).reduce((s,a)=>s.concat(a));if(r.length>0){i.preventDefault();for(const s of r)(0,Qae.isAction)(s)?this.actionDispatcher.dispatch(s):s.then(a=>{this.actionDispatcher.dispatch(a)})}}focusOnMouseEvent(e,t){if(document&&e==="mouseDown"){const i=document.getElementById(this.domHelper.createUniqueDOMElementId(t));i!==null&&typeof i.focus=="function"&&i.focus()}}mouseOver(e,t){this.handleEvent("mouseOver",e,t)}mouseOut(e,t){this.handleEvent("mouseOut",e,t)}mouseEnter(e,t){this.handleEvent("mouseEnter",e,t)}mouseLeave(e,t){this.handleEvent("mouseLeave",e,t)}mouseDown(e,t){this.handleEvent("mouseDown",e,t)}mouseMove(e,t){this.handleEvent("mouseMove",e,t)}mouseUp(e,t){this.handleEvent("mouseUp",e,t)}wheel(e,t){this.handleEvent("wheel",e,t)}contextMenu(e,t){t.preventDefault(),this.handleEvent("contextMenu",e,t)}doubleClick(e,t){this.handleEvent("doubleClick",e,t)}decorate(e,t){return t instanceof Xae.SModelRootImpl&&((0,_r.on)(e,"mouseover",this.mouseOver.bind(this,t)),(0,_r.on)(e,"mouseout",this.mouseOut.bind(this,t)),(0,_r.on)(e,"mouseenter",this.mouseEnter.bind(this,t)),(0,_r.on)(e,"mouseleave",this.mouseLeave.bind(this,t)),(0,_r.on)(e,"mousedown",this.mouseDown.bind(this,t)),(0,_r.on)(e,"mouseup",this.mouseUp.bind(this,t)),(0,_r.on)(e,"mousemove",this.mouseMove.bind(this,t)),(0,_r.on)(e,"wheel",this.wheel.bind(this,t)),(0,_r.on)(e,"contextmenu",this.contextMenu.bind(this,t)),(0,_r.on)(e,"dblclick",this.doubleClick.bind(this,t)),(0,_r.on)(e,"dragover",i=>this.handleEvent("dragOver",t,i)),(0,_r.on)(e,"drop",i=>this.handleEvent("drop",t,i))),e=this.mouseListeners.reduce((i,o)=>o.decorate(i,t),e),e}postUpdate(){}};Ut.MouseTool=kp;ng([(0,ea.inject)(nA.TYPES.IActionDispatcher),tA("design:type",Object)],kp.prototype,"actionDispatcher",void 0);ng([(0,ea.inject)(nA.TYPES.DOMHelper),tA("design:type",Jae.DOMHelper)],kp.prototype,"domHelper",void 0);Ut.MouseTool=kp=ng([(0,ea.injectable)(),Z3(0,(0,ea.multiInject)(nA.TYPES.MouseListener)),Z3(0,(0,ea.optional)()),tA("design:paramtypes",[Array])],kp);let e2=class extends kp{constructor(e=[]){super(e),this.mouseListeners=e}};Ut.PopupMouseTool=e2;Ut.PopupMouseTool=e2=ng([(0,ea.injectable)(),Z3(0,(0,ea.multiInject)(nA.TYPES.PopupMouseListener)),Z3(0,(0,ea.optional)()),tA("design:paramtypes",[Array])],e2);let Q3=class{mouseOver(e,t){return[]}mouseOut(e,t){return[]}mouseEnter(e,t){return[]}mouseLeave(e,t){return[]}mouseDown(e,t){return[]}mouseMove(e,t){return[]}mouseUp(e,t){return[]}wheel(e,t){return[]}doubleClick(e,t){return[]}contextMenu(e,t){return[]}dragOver(e,t){return[]}drop(e,t){return[]}decorate(e,t){return e}};Ut.MouseListener=Q3;Ut.MouseListener=Q3=ng([(0,ea.injectable)()],Q3);let t2=class extends Q3{mouseMove(e,t){return this.lastPosition=e.root.parentToLocal({x:t.offsetX,y:t.offsetY}),[]}get lastPositionOnDiagram(){return this.lastPosition}};Ut.MousePositionTracker=t2;Ut.MousePositionTracker=t2=ng([(0,ea.injectable)()],t2);var ac={};function ece(n,e){return document.createElement(n,e)}function tce(n,e,t){return document.createElementNS(n,e,t)}function nce(){return Ll(document.createDocumentFragment())}function ice(n){return document.createTextNode(n)}function oce(n){return document.createComment(n)}function rce(n,e,t){if(Xa(n)){let i=n;for(;i&&Xa(i);)i=Ll(i).parent;n=i??n}Xa(e)&&(e=Ll(e,n)),t&&Xa(t)&&(t=Ll(t).firstChildNode),n.insertBefore(e,t)}function sce(n,e){n.removeChild(e)}function ace(n,e){Xa(e)&&(e=Ll(e,n)),n.appendChild(e)}function eG(n){if(Xa(n)){for(;n&&Xa(n);)n=Ll(n).parent;return n??null}return n.parentNode}function cce(n){var e;if(Xa(n)){const t=Ll(n),i=eG(t);if(i&&t.lastChildNode){const o=Array.from(i.childNodes),r=o.indexOf(t.lastChildNode);return(e=o[r+1])!==null&&e!==void 0?e:null}return null}return n.nextSibling}function dce(n){return n.tagName}function uce(n,e){n.textContent=e}function lce(n){return n.textContent}function fce(n){return n.nodeType===1}function hce(n){return n.nodeType===3}function pce(n){return n.nodeType===8}function Xa(n){return n.nodeType===11}function Ll(n,e){var t,i,o;const r=n;return(t=r.parent)!==null&&t!==void 0||(r.parent=e??null),(i=r.firstChildNode)!==null&&i!==void 0||(r.firstChildNode=n.firstChild),(o=r.lastChildNode)!==null&&o!==void 0||(r.lastChildNode=n.lastChild),r}const B6={createElement:ece,createElementNS:tce,createTextNode:ice,createDocumentFragment:nce,createComment:oce,insertBefore:rce,removeChild:sce,appendChild:ace,parentNode:eG,nextSibling:cce,tagName:dce,setTextContent:uce,getTextContent:lce,isElement:fce,isText:hce,isComment:pce,isDocumentFragment:Xa};function Yi(n,e,t,i,o){const r=e===void 0?void 0:e.key;return{sel:n,data:e,children:t,text:i,elm:o,key:r}}const D_=Array.isArray;function jl(n){return typeof n=="string"||typeof n=="number"||n instanceof String||n instanceof Number}function GI(n){return n===void 0}function lo(n){return n!==void 0}const UI=Yi("",{},[],void 0,void 0);function sv(n,e){var t,i;const o=n.key===e.key,r=((t=n.data)===null||t===void 0?void 0:t.is)===((i=e.data)===null||i===void 0?void 0:i.is),s=n.sel===e.sel,a=!n.sel&&n.sel===e.sel?typeof n.text==typeof e.text:!0;return s&&o&&r&&a}function mce(){throw new Error("The document fragment is not supported on this platform.")}function gce(n,e){return n.isElement(e)}function vce(n,e){return n.isDocumentFragment(e)}function _ce(n,e,t){var i;const o={};for(let r=e;r<=t;++r){const s=(i=n[r])===null||i===void 0?void 0:i.key;s!==void 0&&(o[s]=r)}return o}const yce=["create","update","remove","destroy","pre","post"];function bce(n,e,t){const i={create:[],update:[],remove:[],destroy:[],pre:[],post:[]},o=e!==void 0?e:B6;for(const P of yce)for(const E of n){const A=E[P];A!==void 0&&i[P].push(A)}function r(P){const E=P.id?"#"+P.id:"",A=P.getAttribute("class"),L=A?"."+A.split(" ").join("."):"";return Yi(o.tagName(P).toLowerCase()+E+L,{},[],void 0,P)}function s(P){return Yi(void 0,{},[],void 0,P)}function a(P,E){return function(){if(--E===0){const L=o.parentNode(P);o.removeChild(L,P)}}}function u(P,E){var A,L,B,U;let p,b=P.data;if(b!==void 0){const D=(A=b.hook)===null||A===void 0?void 0:A.init;lo(D)&&(D(P),b=P.data)}const v=P.children,R=P.sel;if(R==="!")GI(P.text)&&(P.text=""),P.elm=o.createComment(P.text);else if(R!==void 0){const D=R.indexOf("#"),j=R.indexOf(".",D),T=D>0?D:R.length,$=j>0?j:R.length,Q=D!==-1||j!==-1?R.slice(0,Math.min(T,$)):R,K=P.elm=lo(b)&&lo(p=b.ns)?o.createElementNS(p,Q,b):o.createElement(Q,b);for(T<$&&K.setAttribute("id",R.slice(T+1,$)),j>0&&K.setAttribute("class",R.slice($+1).replace(/\./g," ")),p=0;p<i.create.length;++p)i.create[p](UI,P);if(D_(v))for(p=0;p<v.length;++p){const H=v[p];H!=null&&o.appendChild(K,u(H,E))}else jl(P.text)&&o.appendChild(K,o.createTextNode(P.text));const Z=P.data.hook;lo(Z)&&((L=Z.create)===null||L===void 0||L.call(Z,UI,P),Z.insert&&E.push(P))}else if(!((B=t==null?void 0:t.experimental)===null||B===void 0)&&B.fragments&&P.children){for(P.elm=((U=o.createDocumentFragment)!==null&&U!==void 0?U:mce)(),p=0;p<i.create.length;++p)i.create[p](UI,P);for(p=0;p<P.children.length;++p){const D=P.children[p];D!=null&&o.appendChild(P.elm,u(D,E))}}else P.elm=o.createTextNode(P.text);return P.elm}function h(P,E,A,L,B,U){for(;L<=B;++L){const p=A[L];p!=null&&o.insertBefore(P,u(p,U),E)}}function g(P){var E,A;const L=P.data;if(L!==void 0){(A=(E=L==null?void 0:L.hook)===null||E===void 0?void 0:E.destroy)===null||A===void 0||A.call(E,P);for(let B=0;B<i.destroy.length;++B)i.destroy[B](P);if(P.children!==void 0)for(let B=0;B<P.children.length;++B){const U=P.children[B];U!=null&&typeof U!="string"&&g(U)}}}function y(P,E,A,L){for(var B,U;A<=L;++A){let p,b;const v=E[A];if(v!=null)if(lo(v.sel)){g(v),p=i.remove.length+1,b=a(v.elm,p);for(let D=0;D<i.remove.length;++D)i.remove[D](v,b);const R=(U=(B=v==null?void 0:v.data)===null||B===void 0?void 0:B.hook)===null||U===void 0?void 0:U.remove;lo(R)?R(v,b):b()}else v.children?(g(v),y(P,v.children,0,v.children.length-1)):o.removeChild(P,v.elm)}}function S(P,E,A,L){let B=0,U=0,p=E.length-1,b=E[0],v=E[p],R=A.length-1,D=A[0],j=A[R],T,$,Q,K;for(;B<=p&&U<=R;)b==null?b=E[++B]:v==null?v=E[--p]:D==null?D=A[++U]:j==null?j=A[--R]:sv(b,D)?(w(b,D,L),b=E[++B],D=A[++U]):sv(v,j)?(w(v,j,L),v=E[--p],j=A[--R]):sv(b,j)?(w(b,j,L),o.insertBefore(P,b.elm,o.nextSibling(v.elm)),b=E[++B],j=A[--R]):sv(v,D)?(w(v,D,L),o.insertBefore(P,v.elm,b.elm),v=E[--p],D=A[++U]):(T===void 0&&(T=_ce(E,B,p)),$=T[D.key],GI($)?o.insertBefore(P,u(D,L),b.elm):(Q=E[$],Q.sel!==D.sel?o.insertBefore(P,u(D,L),b.elm):(w(Q,D,L),E[$]=void 0,o.insertBefore(P,Q.elm,b.elm))),D=A[++U]);U<=R&&(K=A[R+1]==null?null:A[R+1].elm,h(P,K,A,U,R,L)),B<=p&&y(P,E,B,p)}function w(P,E,A){var L,B,U,p,b,v,R,D;const j=(L=E.data)===null||L===void 0?void 0:L.hook;(B=j==null?void 0:j.prepatch)===null||B===void 0||B.call(j,P,E);const T=E.elm=P.elm;if(P===E)return;if(E.data!==void 0||lo(E.text)&&E.text!==P.text){(U=E.data)!==null&&U!==void 0||(E.data={}),(p=P.data)!==null&&p!==void 0||(P.data={});for(let K=0;K<i.update.length;++K)i.update[K](P,E);(R=(v=(b=E.data)===null||b===void 0?void 0:b.hook)===null||v===void 0?void 0:v.update)===null||R===void 0||R.call(v,P,E)}const $=P.children,Q=E.children;GI(E.text)?lo($)&&lo(Q)?$!==Q&&S(T,$,Q,A):lo(Q)?(lo(P.text)&&o.setTextContent(T,""),h(T,null,Q,0,Q.length-1,A)):lo($)?y(T,$,0,$.length-1):lo(P.text)&&o.setTextContent(T,""):P.text!==E.text&&(lo($)&&y(T,$,0,$.length-1),o.setTextContent(T,E.text)),(D=j==null?void 0:j.postpatch)===null||D===void 0||D.call(j,P,E)}return function(E,A){let L,B,U;const p=[];for(L=0;L<i.pre.length;++L)i.pre[L]();for(gce(o,E)?E=r(E):vce(o,E)&&(E=s(E)),sv(E,A)?w(E,A,p):(B=E.elm,U=o.parentNode(B),u(A,p),U!==null&&(o.insertBefore(U,A.elm,o.nextSibling(B)),y(U,[E],0,0))),L=0;L<p.length;++L)p[L].data.hook.insert(p[L]);for(L=0;L<i.post.length;++L)i.post[L]();return A}}function iA(n,e,t){if(n.ns="http://www.w3.org/2000/svg",t!=="foreignObject"&&e!==void 0)for(let i=0;i<e.length;++i){const o=e[i];if(typeof o=="string")continue;const r=o.data;r!==void 0&&iA(r,o.children,o.sel)}}function Hs(n,e,t){let i={},o,r,s;if(t!==void 0?(e!==null&&(i=e),D_(t)?o=t:jl(t)?r=t.toString():t&&t.sel&&(o=[t])):e!=null&&(D_(e)?o=e:jl(e)?r=e.toString():e&&e.sel?o=[e]:i=e),o!==void 0)for(s=0;s<o.length;++s)jl(o[s])&&(o[s]=Yi(void 0,void 0,void 0,o[s],void 0));return n[0]==="s"&&n[1]==="v"&&n[2]==="g"&&(n.length===3||n[3]==="."||n[3]==="#")&&iA(i,o,n),Yi(n,i,o,r,void 0)}function Sce(n){let e,t;if(D_(n)?e=n:jl(e)?t=n:e&&e.sel&&(e=[n]),e!==void 0)for(let i=0;i<e.length;++i)jl(e[i])&&(e[i]=Yi(void 0,void 0,void 0,e[i],void 0));return Yi(void 0,{},e,t,void 0)}function XE(n,e){var t;const i=(t=e.data)===null||t===void 0?void 0:t.ns;n.data.fn=e.data.fn,n.data.args=e.data.args,e.data=n.data,e.children=n.children,e.text=n.text,e.elm=n.elm,i&&iA(e.data,e.children,e.sel)}function Ece(n){const e=n.data,t=e.fn(...e.args);XE(t,n)}function Cce(n,e){let t;const i=n.data,o=e.data,r=i.args,s=o.args;if(i.fn!==o.fn||r.length!==s.length){XE(o.fn(...s),e);return}for(t=0;t<s.length;++t)if(r[t]!==s[t]){XE(o.fn(...s),e);return}XE(n,e)}const Pce=function(e,t,i,o){return o===void 0&&(o=i,i=t,t=void 0),Hs(e,{key:t,hook:{init:Ece,prepatch:Cce},fn:i,args:o})};function wce(n,e){const t=n.data.attachData;e.data.attachData.placeholder=t.placeholder,e.data.attachData.real=t.real,n.elm=n.data.attachData.real}function Ace(n,e){e.elm=e.data.attachData.placeholder}function Rce(n){n.elm!==void 0&&n.elm.parentNode.removeChild(n.elm),n.elm=n.data.attachData.real}function Mce(n,e){const t=e.elm,i=e.data.attachData,o=document.createElement("span");e.elm=o,i.target.appendChild(t),i.real=t,i.placeholder=o}function Ice(n,e){e.data===void 0&&(e.data={}),e.data.hook===void 0&&(e.data.hook={});const t=e.data,i=e.data.hook;return t.attachData={target:n,placeholder:void 0,real:void 0},i.create=Mce,i.prepatch=wce,i.postpatch=Ace,i.destroy=Rce,e}function tG(n,e){const t=e!==void 0?e:B6;let i;if(t.isElement(n)){const o=n.id?"#"+n.id:"",r=n.getAttribute("class"),s=r?"."+r.split(" ").join("."):"",a=t.tagName(n).toLowerCase()+o+s,u={},h={},g={},y=[];let S,w,P;const E=n.attributes,A=n.childNodes;for(w=0,P=E.length;w<P;w++)S=E[w].nodeName,S[0]==="d"&&S[1]==="a"&&S[2]==="t"&&S[3]==="a"&&S[4]==="-"?h[S.slice(5)]=E[w].nodeValue||"":S!=="id"&&S!=="class"&&(u[S]=E[w].nodeValue);for(w=0,P=A.length;w<P;w++)y.push(tG(A[w],e));return Object.keys(u).length>0&&(g.attrs=u),Object.keys(h).length>0&&(g.dataset=h),a[0]==="s"&&a[1]==="v"&&a[2]==="g"&&(a.length===3||a[3]==="."||a[3]==="#")&&iA(g,y,a),Yi(a,g,y,void 0,n)}else return t.isText(n)?(i=t.getTextContent(n),Yi(void 0,void 0,void 0,i,n)):t.isComment(n)?(i=t.getTextContent(n),Yi("!",{},[],i,n)):Yi("",{},[],void 0,n)}const Tce="http://www.w3.org/1999/xlink",Dce="http://www.w3.org/XML/1998/namespace",$B=58,Oce=120;function kB(n,e){let t;const i=e.elm;let o=n.data.attrs,r=e.data.attrs;if(!(!o&&!r)&&o!==r){o=o||{},r=r||{};for(t in r){const s=r[t];o[t]!==s&&(s===!0?i.setAttribute(t,""):s===!1?i.removeAttribute(t):t.charCodeAt(0)!==Oce?i.setAttribute(t,s):t.charCodeAt(3)===$B?i.setAttributeNS(Dce,t,s):t.charCodeAt(5)===$B?i.setAttributeNS(Tce,t,s):i.setAttribute(t,s))}for(t in o)t in r||i.removeAttribute(t)}}const Lce={create:kB,update:kB};function FB(n,e){let t,i;const o=e.elm;let r=n.data.class,s=e.data.class;if(!(!r&&!s)&&r!==s){r=r||{},s=s||{};for(i in r)r[i]&&!Object.prototype.hasOwnProperty.call(s,i)&&o.classList.remove(i);for(i in s)t=s[i],t!==r[i]&&o.classList[t?"add":"remove"](i)}}const jce={create:FB,update:FB},xB=/[A-Z]/g;function HB(n,e){const t=e.elm;let i=n.data.dataset,o=e.data.dataset,r;if(!i&&!o||i===o)return;i=i||{},o=o||{};const s=t.dataset;for(r in i)o[r]||(s?r in s&&delete s[r]:t.removeAttribute("data-"+r.replace(xB,"-$&").toLowerCase()));for(r in o)i[r]!==o[r]&&(s?s[r]=o[r]:t.setAttribute("data-"+r.replace(xB,"-$&").toLowerCase(),o[r]))}const Nce={create:HB,update:HB};function nG(n,e,t){if(typeof n=="function")n.call(e,t,e);else if(typeof n=="object")for(let i=0;i<n.length;i++)nG(n[i],e,t)}function Bce(n,e){const t=n.type,i=e.data.on;i&&i[t]&&nG(i[t],e,n)}function $ce(){return function n(e){Bce(e,n.vnode)}}function YI(n,e){const t=n.data.on,i=n.listener,o=n.elm,r=e&&e.data.on,s=e&&e.elm;let a;if(t!==r){if(t&&i)if(r)for(a in t)r[a]||o.removeEventListener(a,i,!1);else for(a in t)o.removeEventListener(a,i,!1);if(r){const u=e.listener=n.listener||$ce();if(u.vnode=e,t)for(a in r)t[a]||s.addEventListener(a,u,!1);else for(a in r)s.addEventListener(a,u,!1)}}}const kce={create:YI,update:YI,destroy:YI};function KB(n,e){let t,i,o;const r=e.elm;let s=n.data.props,a=e.data.props;if(!(!s&&!a)&&s!==a){s=s||{},a=a||{};for(t in a)i=a[t],o=s[t],o!==i&&(t!=="value"||r[t]!==i)&&(r[t]=i)}}const Fce={create:KB,update:KB},VB=typeof window<"u"&&window.requestAnimationFrame.bind(window)||setTimeout,xce=function(n){VB(function(){VB(n)})};let n2=!1;function Hce(n,e,t){xce(function(){n[e]=t})}function zB(n,e){let t,i;const o=e.elm;let r=n.data.style,s=e.data.style;if(!r&&!s||r===s)return;r=r||{},s=s||{};const a="delayed"in r;for(i in r)s[i]||(i[0]==="-"&&i[1]==="-"?o.style.removeProperty(i):o.style[i]="");for(i in s)if(t=s[i],i==="delayed"&&s.delayed)for(const u in s.delayed)t=s.delayed[u],(!a||t!==r.delayed[u])&&Hce(o.style,u,t);else i!=="remove"&&t!==r[i]&&(i[0]==="-"&&i[1]==="-"?o.style.setProperty(i,t):o.style[i]=t)}function Kce(n){let e,t;const i=n.elm,o=n.data.style;if(!(!o||!(e=o.destroy)))for(t in e)i.style[t]=e[t]}function Vce(n,e){const t=n.data.style;if(!t||!t.remove){e();return}n2||(n.elm.offsetLeft,n2=!0);let i;const o=n.elm;let r=0;const s=t.remove;let a=0;const u=[];for(i in s)u.push(i),o.style[i]=s[i];const g=getComputedStyle(o)["transition-property"].split(", ");for(;r<g.length;++r)u.indexOf(g[r])!==-1&&a++;o.addEventListener("transitionend",function(y){y.target===o&&--a,a===0&&e()})}function zce(){n2=!1}const Gce={pre:zce,create:zB,update:zB,destroy:Kce,remove:Vce};function Uce(n,...e){const t=$6(e,[]);return t.length===1&&!t[0].sel&&t[0].text?Yi(void 0,void 0,void 0,t[0].text,void 0):Yi(void 0,n??{},t,void 0,void 0)}function $6(n,e){for(const t of n)t!=null&&t!==!1&&t!==""&&(Array.isArray(t)?$6(t,e):typeof t=="string"||typeof t=="number"||typeof t=="boolean"?e.push(Yi(void 0,void 0,void 0,String(t),void 0)):e.push(t));return e}function i2(n,e,...t){const i=$6(t,[]);return typeof n=="function"?n(e,i):i.length===1&&!i[0].sel&&i[0].text?Hs(n,e,i[0].text):Hs(n,e,i)}i2||(i2={});const Yce=Object.freeze(Object.defineProperty({__proto__:null,Fragment:Uce,array:D_,attachTo:Ice,attributesModule:Lce,classModule:jce,datasetModule:Nce,eventListenersModule:kce,fragment:Sce,h:Hs,htmlDomApi:B6,init:bce,get jsx(){return i2},primitive:jl,propsModule:Fce,styleModule:Gce,thunk:Pce,toVNode:tG,vnode:Yi},Symbol.toStringTag,{value:"Module"})),ig=y6(Yce);var qce=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(ac,"__esModule",{value:!0});ac.isThunk=ac.ThunkView=void 0;const Wce=ig,Zce=k;let o2=class{render(e,t){return(0,Wce.h)(this.selector(e),{key:e.id,hook:{init:this.init.bind(this),prepatch:this.prepatch.bind(this)},fn:()=>this.renderAndDecorate(e,t),args:this.watchedArgs(e),thunk:!0})}renderAndDecorate(e,t){const i=this.doRender(e,t);return t.decorate(i,e),i}copyToThunk(e,t){t.elm=e.elm,e.data.fn=t.data.fn,e.data.args=t.data.args,t.data=e.data,t.children=e.children,t.text=e.text,t.elm=e.elm}init(e){const t=e.data,i=t.fn.apply(void 0,t.args);this.copyToThunk(i,e)}prepatch(e,t){const i=e.data,o=t.data;this.equals(i.args,o.args)?this.copyToThunk(e,t):this.copyToThunk(o.fn.apply(void 0,o.args),t)}equals(e,t){if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let i=0;i<t.length;++i)if(!this.equals(e[i],t[i]))return!1}else if(typeof e=="object"&&typeof t=="object"){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(i!=="parent"&&i!=="root"&&(!(i in t)||!this.equals(e[i],t[i])))return!1}else if(e!==t)return!1;return!0}};ac.ThunkView=o2;ac.ThunkView=o2=qce([(0,Zce.injectable)()],o2);function Qce(n){return"thunk"in n}ac.isThunk=Qce;var rn={},ti={};Object.defineProperty(ti,"__esModule",{value:!0});ti.JSX=ti.svg=ti.html=void 0;const Xce=ig,GB=["hook","on","style","class","props","attrs","dataset"],Jce="http://www.w3.org/2000/svg";function ede(n,e,t){const i={};if(t&&(i.ns=t),n===null)return i;return GB.forEach(r=>{n[r]&&(i[r]=n[r])}),Object.keys(n).forEach(r=>{if(r==="key"||r==="classNames"||r==="selector")return;const s=r.indexOf("-");if(s>0){const a=r.slice(0,s);GB.includes(a)?o(a,r.slice(s+1),n[r]):o(e,r,n[r])}else i[r]||o(e,r,n[r])}),i;function o(r,s,a){const u=i[r]||(i[r]={});u[s]=a}}function k6(n,e="props"){return(t,i,...o)=>{const r=typeof t=="function";return(0,Xce.jsx)(t,r?i:ede(i,e,n),o)}}ti.JSX=k6;const tde=k6();ti.html=tde;const nde=k6(Jce,"attrs");ti.svg=nde;var oA=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},iG=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},UB=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}},Nv;Object.defineProperty(rn,"__esModule",{value:!0});rn.MissingView=rn.EmptyView=rn.configureView=rn.overrideModelElement=rn.configureModelElement=rn.ViewRegistry=rn.findArgValue=void 0;const oG=ti,Sp=k,F6=me,ide=pn,ode=wa,rde=$n,rG=yt,sde=Fr;function ade(n,e){for(;n!==void 0&&!(e in n)&&n.parentArgs;)n=n.parentArgs;return n?n[e]:void 0}rn.findArgValue=ade;let X3=class extends ide.InstanceRegistry{constructor(e){super(),this.registerDefaults(),e.forEach(t=>{t.isOverride?this.override(t.type,t.factory()):this.register(t.type,t.factory())})}registerDefaults(){this.register(rde.EMPTY_ROOT.type,new J3)}missing(e){return this.logger.warn(this,`no registered view for type '${e}', please configure a view in the ContainerModule`),new O_}};rn.ViewRegistry=X3;oA([(0,Sp.inject)(F6.TYPES.ILogger),iG("design:type",Object)],X3.prototype,"logger",void 0);rn.ViewRegistry=X3=oA([(0,Sp.injectable)(),UB(0,(0,Sp.multiInject)(F6.TYPES.ViewRegistration)),UB(0,(0,Sp.optional)()),iG("design:paramtypes",[Array])],X3);function cde(n,e,t,i,o){(0,rG.registerModelElement)(n,e,t,o),x6(n,e,i)}rn.configureModelElement=cde;function dde(n,e,t,i,o){(0,rG.registerModelElement)(n,e,t,o,!0),x6(n,e,i,!0)}rn.overrideModelElement=dde;function x6(n,e,t,i){if(typeof t=="function"){if(!(0,ode.isInjectable)(t))throw new Error(`Views should be @injectable: ${t.name}`);n.isBound(t)||n.bind(t).toSelf()}n.bind(F6.TYPES.ViewRegistration).toDynamicValue(o=>({type:e,factory:()=>o.container.get(t),isOverride:i}))}rn.configureView=x6;let J3=class{render(e,t){return(0,oG.svg)("svg",{"class-sprotty-empty":!0})}};rn.EmptyView=J3;rn.EmptyView=J3=oA([(0,Sp.injectable)()],J3);let O_=Nv=class{render(e,t){const i=e.position||this.getPostion(e.type);return(0,oG.svg)("text",{"class-sprotty-missing":!0,x:i.x,y:i.y},'missing "',e.type,'" view')}getPostion(e){let t=Nv.positionMap.get(e);return t||(t=sde.Point.ORIGIN,Nv.positionMap.forEach(i=>t=i.y>=t.y?{x:0,y:i.y+20}:t),Nv.positionMap.set(e,t)),t}};rn.MissingView=O_;O_.positionMap=new Map;rn.MissingView=O_=Nv=oA([(0,Sp.injectable)()],O_);var If={},H6=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},sG=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(If,"__esModule",{value:!0});If.ViewerCache=void 0;const K6=k,aG=me,ude=Pa;let L_=class{update(e,t){if(t!==void 0)this.delegate.update(e,t),this.cachedModel=void 0;else{const i=this.cachedModel===void 0;this.cachedModel=e,i&&this.scheduleUpdate()}}scheduleUpdate(){this.syncer.onEndOfNextFrame(()=>{this.cachedModel&&(this.delegate.update(this.cachedModel),this.cachedModel=void 0)})}};If.ViewerCache=L_;H6([(0,K6.inject)(aG.TYPES.IViewer),sG("design:type",Object)],L_.prototype,"delegate",void 0);H6([(0,K6.inject)(aG.TYPES.AnimationFrameSyncer),sG("design:type",ude.AnimationFrameSyncer)],L_.prototype,"syncer",void 0);If.ViewerCache=L_=H6([(0,K6.injectable)()],L_);var rA={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.overrideViewerOptions=n.configureViewerOptions=n.defaultViewerOptions=void 0;const e=Ji,t=me,i=()=>({baseDiv:"sprotty",baseClass:"sprotty",hiddenDiv:"sprotty-hidden",hiddenClass:"sprotty-hidden",popupDiv:"sprotty-popup",popupClass:"sprotty-popup",popupClosedClass:"sprotty-popup-closed",needsClientLayout:!0,needsServerLayout:!1,popupOpenDelay:1e3,popupCloseDelay:300,zoomLimits:{min:.01,max:10},horizontalScrollLimits:{min:-1e5,max:1e5},verticalScrollLimits:{min:-1e5,max:1e5}});n.defaultViewerOptions=i;function o(s,a){const u=Object.assign(Object.assign({},(0,n.defaultViewerOptions)()),a);s.isBound(t.TYPES.ViewerOptions)?s.rebind(t.TYPES.ViewerOptions).toConstantValue(u):s.bind(t.TYPES.ViewerOptions).toConstantValue(u)}n.configureViewerOptions=o;function r(s,a){const u=s.get(t.TYPES.ViewerOptions);return(0,e.safeAssign)(u,a),u}n.overrideViewerOptions=r})(rA);var Xn={},ws=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},As=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Ar=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Xn,"__esModule",{value:!0});Xn.PopupModelViewer=Xn.HiddenModelViewer=Xn.ModelViewer=Xn.PatcherProvider=Xn.ModelRenderer=void 0;const hn=k,Lh=ig,j_=ti,lde=sn,fde=Co,cG=$n,$i=me,hde=ac,Go=ft;class V6{constructor(e,t,i,o={}){this.viewRegistry=e,this.targetKind=t,this.postprocessors=i,this.args=o}decorate(e,t){return(0,hde.isThunk)(e)?e:this.postprocessors.reduce((i,o)=>o.decorate(i,t),e)}renderElement(e){const i=this.viewRegistry.get(e.type).render(e,this,this.args);if(i)return this.decorate(i,e)}renderChildren(e,t){const i=t?new V6(this.viewRegistry,this.targetKind,this.postprocessors,Object.assign(Object.assign({},t),{parentArgs:this.args})):this;return e.children.map(o=>i.renderElement(o)).filter(o=>o!==void 0)}postUpdate(e){this.postprocessors.forEach(t=>t.postUpdate(e))}}Xn.ModelRenderer=V6;let Fp=class{constructor(){this.patcher=(0,Lh.init)(this.createModules())}createModules(){return[Lh.propsModule,Lh.attributesModule,Lh.classModule,Lh.styleModule,Lh.eventListenersModule]}};Xn.PatcherProvider=Fp;Xn.PatcherProvider=Fp=ws([(0,hn.injectable)(),As("design:paramtypes",[])],Fp);let xp=class{constructor(e,t,i){this.renderer=e("main",i),this.patcher=t.patcher}update(e,t){var i;this.logger.log(this,"rendering",e);const o=(0,j_.html)("div",{id:this.options.baseDiv},this.renderer.renderElement(e));if(this.lastVDOM!==void 0){const r=this.hasFocus();(0,Go.copyClassesFromVNode)(this.lastVDOM,o),this.lastVDOM=this.patcher.call(this,this.lastVDOM,o),this.restoreFocus(r)}else if(typeof document<"u"){let r=null;if(this.options.shadowRoot){const s=(i=document.getElementById(this.options.shadowRoot))===null||i===void 0?void 0:i.shadowRoot;s&&(r=s.getElementById(this.options.baseDiv))}else r=document.getElementById(this.options.baseDiv);r!==null?(typeof window<"u"&&window.addEventListener("resize",()=>{this.onWindowResize(o)}),(0,Go.copyClassesFromElement)(r,o),(0,Go.setClass)(o,this.options.baseClass,!0),this.lastVDOM=this.patcher.call(this,r,o)):this.logger.error(this,"element not in DOM:",this.options.baseDiv)}this.renderer.postUpdate(t)}hasFocus(){if(typeof document<"u"&&document.activeElement&&this.lastVDOM.children&&this.lastVDOM.children.length>0){const e=this.lastVDOM.children[0];if(typeof e=="object"){const t=e.elm;return document.activeElement===t}}return!1}restoreFocus(e){if(e&&this.lastVDOM.children&&this.lastVDOM.children.length>0){const t=this.lastVDOM.children[0];if(typeof t=="object"){const i=t.elm;i&&typeof i.focus=="function"&&i.focus()}}}onWindowResize(e){const t=document.getElementById(this.options.baseDiv);if(t!==null){const i=this.getBoundsInPage(t);this.actiondispatcher.dispatch(fde.InitializeCanvasBoundsAction.create(i))}}getBoundsInPage(e){const t=e.getBoundingClientRect(),i=(0,lde.getWindowScroll)();return{x:t.left+i.x,y:t.top+i.y,width:t.width,height:t.height}}};Xn.ModelViewer=xp;ws([(0,hn.inject)($i.TYPES.ViewerOptions),As("design:type",Object)],xp.prototype,"options",void 0);ws([(0,hn.inject)($i.TYPES.ILogger),As("design:type",Object)],xp.prototype,"logger",void 0);ws([(0,hn.inject)($i.TYPES.IActionDispatcher),As("design:type",Object)],xp.prototype,"actiondispatcher",void 0);Xn.ModelViewer=xp=ws([(0,hn.injectable)(),Ar(0,(0,hn.inject)($i.TYPES.ModelRendererFactory)),Ar(1,(0,hn.inject)($i.TYPES.PatcherProvider)),Ar(2,(0,hn.multiInject)($i.TYPES.IVNodePostprocessor)),Ar(2,(0,hn.optional)()),As("design:paramtypes",[Function,Fp,Array])],xp);let N_=class{constructor(e,t,i){this.hiddenRenderer=e("hidden",i),this.patcher=t.patcher}update(e,t){this.logger.log(this,"rendering hidden");let i;if(e.type===cG.EMPTY_ROOT.type)i=(0,j_.html)("div",{id:this.options.hiddenDiv});else{const o=this.hiddenRenderer.renderElement(e);o&&(0,Go.setAttr)(o,"opacity",0),i=(0,j_.html)("div",{id:this.options.hiddenDiv},o)}if(this.lastHiddenVDOM!==void 0)(0,Go.copyClassesFromVNode)(this.lastHiddenVDOM,i),this.lastHiddenVDOM=this.patcher.call(this,this.lastHiddenVDOM,i);else{let o=document.getElementById(this.options.hiddenDiv);o===null?(o=document.createElement("div"),document.body.appendChild(o)):(0,Go.copyClassesFromElement)(o,i),(0,Go.setClass)(i,this.options.baseClass,!0),(0,Go.setClass)(i,this.options.hiddenClass,!0),this.lastHiddenVDOM=this.patcher.call(this,o,i)}this.hiddenRenderer.postUpdate(t)}};Xn.HiddenModelViewer=N_;ws([(0,hn.inject)($i.TYPES.ViewerOptions),As("design:type",Object)],N_.prototype,"options",void 0);ws([(0,hn.inject)($i.TYPES.ILogger),As("design:type",Object)],N_.prototype,"logger",void 0);Xn.HiddenModelViewer=N_=ws([(0,hn.injectable)(),Ar(0,(0,hn.inject)($i.TYPES.ModelRendererFactory)),Ar(1,(0,hn.inject)($i.TYPES.PatcherProvider)),Ar(2,(0,hn.multiInject)($i.TYPES.HiddenVNodePostprocessor)),Ar(2,(0,hn.optional)()),As("design:paramtypes",[Function,Fp,Array])],N_);let B_=class{constructor(e,t,i){this.modelRendererFactory=e,this.popupRenderer=this.modelRendererFactory("popup",i),this.patcher=t.patcher}update(e,t){this.logger.log(this,"rendering popup",e);const i=e.type===cG.EMPTY_ROOT.type;let o;if(i)o=(0,j_.html)("div",{id:this.options.popupDiv});else{const r=e.canvasBounds,s={top:r.y+"px",left:r.x+"px"};o=(0,j_.html)("div",{id:this.options.popupDiv,style:s},this.popupRenderer.renderElement(e))}if(this.lastPopupVDOM!==void 0)(0,Go.copyClassesFromVNode)(this.lastPopupVDOM,o),(0,Go.setClass)(o,this.options.popupClosedClass,i),this.lastPopupVDOM=this.patcher.call(this,this.lastPopupVDOM,o);else if(typeof document<"u"){let r=document.getElementById(this.options.popupDiv);r===null?(r=document.createElement("div"),document.body.appendChild(r)):(0,Go.copyClassesFromElement)(r,o),(0,Go.setClass)(o,this.options.popupClass,!0),(0,Go.setClass)(o,this.options.popupClosedClass,i),this.lastPopupVDOM=this.patcher.call(this,r,o)}this.popupRenderer.postUpdate(t)}};Xn.PopupModelViewer=B_;ws([(0,hn.inject)($i.TYPES.ViewerOptions),As("design:type",Object)],B_.prototype,"options",void 0);ws([(0,hn.inject)($i.TYPES.ILogger),As("design:type",Object)],B_.prototype,"logger",void 0);Xn.PopupModelViewer=B_=ws([(0,hn.injectable)(),Ar(0,(0,hn.inject)($i.TYPES.ModelRendererFactory)),Ar(1,(0,hn.inject)($i.TYPES.PatcherProvider)),Ar(2,(0,hn.multiInject)($i.TYPES.PopupVNodePostprocessor)),Ar(2,(0,hn.optional)()),As("design:paramtypes",[Function,Fp,Array])],B_);var Tf={},pde=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Tf,"__esModule",{value:!0});Tf.FocusFixPostprocessor=void 0;const mde=k,gde=ft;let r2=class{decorate(e,t){return e.sel&&e.sel.startsWith("svg")&&(0,gde.setAttr)(e,"tabindex",0),e}postUpdate(){}};Tf.FocusFixPostprocessor=r2;Tf.FocusFixPostprocessor=r2=pde([(0,mde.injectable)()],r2);var h0={},Zo={},sA=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},dG=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Zo,"__esModule",{value:!0});Zo.ConsoleLogger=Zo.NullLogger=Zo.LogLevel=void 0;const aA=k,uG=me;var Pd;(function(n){n[n.none=0]="none",n[n.error=1]="error",n[n.warn=2]="warn",n[n.info=3]="info",n[n.log=4]="log"})(Pd||(Zo.LogLevel=Pd={}));let s2=class{constructor(){this.logLevel=Pd.none}error(e,t,...i){}warn(e,t,...i){}info(e,t,...i){}log(e,t,...i){}};Zo.NullLogger=s2;Zo.NullLogger=s2=sA([(0,aA.injectable)()],s2);let $_=class{constructor(){this.logLevel=Pd.log,this.viewOptions={baseDiv:""}}error(e,t,...i){if(this.logLevel>=Pd.error)try{console.error.apply(e,this.consoleArguments(e,t,i))}catch{}}warn(e,t,...i){if(this.logLevel>=Pd.warn)try{console.warn.apply(e,this.consoleArguments(e,t,i))}catch{}}info(e,t,...i){if(this.logLevel>=Pd.info)try{console.info.apply(e,this.consoleArguments(e,t,i))}catch{}}log(e,t,...i){if(this.logLevel>=Pd.log)try{console.log.apply(e,this.consoleArguments(e,t,i))}catch{}}consoleArguments(e,t,i){let o;return typeof e=="object"?o=e.constructor.name:o=e,[new Date().toLocaleTimeString()+" "+this.viewOptions.baseDiv+" "+o+": "+t,...i]}};Zo.ConsoleLogger=$_;sA([(0,aA.inject)(uG.TYPES.LogLevel),dG("design:type",Number)],$_.prototype,"logLevel",void 0);sA([(0,aA.inject)(uG.TYPES.ViewerOptions),dG("design:type",Object)],$_.prototype,"viewOptions",void 0);Zo.ConsoleLogger=$_=sA([(0,aA.injectable)()],$_);var p0={},z6=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},lG=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(p0,"__esModule",{value:!0});p0.IdPostprocessor=void 0;const G6=k,fG=me,vde=Aa,_de=ft;let k_=class{decorate(e,t){const i=(0,_de.getAttrs)(e);return i.id!==void 0&&this.logger.warn(e,"Overriding id of vnode ("+i.id+"). Make sure not to set it manually in view."),i.id=this.domHelper.createUniqueDOMElementId(t),e.key||(e.key=t.id),e}postUpdate(){}};p0.IdPostprocessor=k_;z6([(0,G6.inject)(fG.TYPES.ILogger),lG("design:type",Object)],k_.prototype,"logger",void 0);z6([(0,G6.inject)(fG.TYPES.DOMHelper),lG("design:type",vde.DOMHelper)],k_.prototype,"domHelper",void 0);p0.IdPostprocessor=k_=z6([(0,G6.injectable)()],k_);var m0={},yde=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(m0,"__esModule",{value:!0});m0.CssClassPostprocessor=void 0;const bde=Nn,YB=ft,Sde=k;let a2=class{decorate(e,t){if(t.cssClasses)for(const o of t.cssClasses)(0,YB.setClass)(e,o,!0);const i=(0,bde.getSubType)(t);return i&&i!==t.type&&(0,YB.setClass)(e,i,!0),e}postUpdate(){}};m0.CssClassPostprocessor=a2;m0.CssClassPostprocessor=a2=yde([(0,Sde.injectable)()],a2);Object.defineProperty(h0,"__esModule",{value:!0});const Ede=k,Ue=me,qI=Co,qB=Zo,Cde=ju,WB=Wo,Pde=Af,wde=eA,ZB=$n,Ade=Pa,dd=Xn,Rde=rA,jh=Ut,QB=gi,XB=Tf,Mde=rn,iE=If,Ide=Aa,oE=p0,rE=wn,WI=m0,Tde=Nu,JB=Po,Dde=wf,Ode=new Ede.ContainerModule((n,e,t)=>{n(Ue.TYPES.ILogger).to(qB.NullLogger).inSingletonScope(),n(Ue.TYPES.LogLevel).toConstantValue(qB.LogLevel.warn),n(Ue.TYPES.SModelRegistry).to(ZB.SModelRegistry).inSingletonScope(),n(WB.ActionHandlerRegistry).toSelf().inSingletonScope(),n(Ue.TYPES.ActionHandlerRegistryProvider).toProvider(o=>()=>new Promise(r=>{r(o.container.get(WB.ActionHandlerRegistry))})),n(Ue.TYPES.ViewRegistry).to(Mde.ViewRegistry).inSingletonScope(),n(Ue.TYPES.IModelFactory).to(ZB.SModelFactory).inSingletonScope(),n(Ue.TYPES.IActionDispatcher).to(Cde.ActionDispatcher).inSingletonScope(),n(Ue.TYPES.IActionDispatcherProvider).toProvider(o=>()=>new Promise(r=>{r(o.container.get(Ue.TYPES.IActionDispatcher))})),n(Ue.TYPES.IDiagramLocker).to(Dde.DefaultDiagramLocker).inSingletonScope(),n(Ue.TYPES.IActionHandlerInitializer).to(rE.CommandActionHandlerInitializer),n(Ue.TYPES.ICommandStack).to(Pde.CommandStack).inSingletonScope(),n(Ue.TYPES.ICommandStackProvider).toProvider(o=>()=>new Promise(r=>{r(o.container.get(Ue.TYPES.ICommandStack))})),n(Ue.TYPES.CommandStackOptions).toConstantValue((0,wde.defaultCommandStackOptions)()),n(dd.ModelViewer).toSelf().inSingletonScope(),n(dd.HiddenModelViewer).toSelf().inSingletonScope(),n(dd.PopupModelViewer).toSelf().inSingletonScope(),n(Ue.TYPES.ModelViewer).toDynamicValue(o=>{const r=o.container.createChild();return r.bind(Ue.TYPES.IViewer).toService(dd.ModelViewer),r.bind(iE.ViewerCache).toSelf(),r.get(iE.ViewerCache)}).inSingletonScope(),n(Ue.TYPES.PopupModelViewer).toDynamicValue(o=>{const r=o.container.createChild();return r.bind(Ue.TYPES.IViewer).toService(dd.PopupModelViewer),r.bind(iE.ViewerCache).toSelf(),r.get(iE.ViewerCache)}).inSingletonScope(),n(Ue.TYPES.HiddenModelViewer).toService(dd.HiddenModelViewer),n(Ue.TYPES.IViewerProvider).toDynamicValue(o=>({get modelViewer(){return o.container.get(Ue.TYPES.ModelViewer)},get hiddenModelViewer(){return o.container.get(Ue.TYPES.HiddenModelViewer)},get popupModelViewer(){return o.container.get(Ue.TYPES.PopupModelViewer)}})),n(Ue.TYPES.ViewerOptions).toConstantValue((0,Rde.defaultViewerOptions)()),n(Ue.TYPES.PatcherProvider).to(dd.PatcherProvider).inSingletonScope(),n(Ue.TYPES.DOMHelper).to(Ide.DOMHelper).inSingletonScope(),n(Ue.TYPES.ModelRendererFactory).toFactory(o=>(r,s,a={})=>{const u=o.container.get(Ue.TYPES.ViewRegistry);return new dd.ModelRenderer(u,r,s,a)}),n(oE.IdPostprocessor).toSelf().inSingletonScope(),n(Ue.TYPES.IVNodePostprocessor).toService(oE.IdPostprocessor),n(Ue.TYPES.HiddenVNodePostprocessor).toService(oE.IdPostprocessor),n(WI.CssClassPostprocessor).toSelf().inSingletonScope(),n(Ue.TYPES.IVNodePostprocessor).toService(WI.CssClassPostprocessor),n(Ue.TYPES.HiddenVNodePostprocessor).toService(WI.CssClassPostprocessor),n(jh.MouseTool).toSelf().inSingletonScope(),n(Ue.TYPES.IVNodePostprocessor).toService(jh.MouseTool),n(QB.KeyTool).toSelf().inSingletonScope(),n(Ue.TYPES.IVNodePostprocessor).toService(QB.KeyTool),n(XB.FocusFixPostprocessor).toSelf().inSingletonScope(),n(Ue.TYPES.IVNodePostprocessor).toService(XB.FocusFixPostprocessor),n(Ue.TYPES.PopupVNodePostprocessor).toService(oE.IdPostprocessor),n(jh.PopupMouseTool).toSelf().inSingletonScope(),n(Ue.TYPES.PopupVNodePostprocessor).toService(jh.PopupMouseTool),n(Ue.TYPES.AnimationFrameSyncer).to(Ade.AnimationFrameSyncer).inSingletonScope();const i={bind:n,isBound:t};(0,rE.configureCommand)(i,qI.InitializeCanvasBoundsCommand),n(qI.CanvasBoundsInitializer).toSelf().inSingletonScope(),n(Ue.TYPES.IVNodePostprocessor).toService(qI.CanvasBoundsInitializer),(0,rE.configureCommand)(i,Tde.SetModelCommand),n(Ue.TYPES.UIExtensionRegistry).to(JB.UIExtensionRegistry).inSingletonScope(),(0,rE.configureCommand)(i,JB.SetUIExtensionVisibilityCommand),n(jh.MousePositionTracker).toSelf().inSingletonScope(),n(Ue.TYPES.MouseListener).toService(jh.MousePositionTracker)});h0.default=Ode;var hs={},$t={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SShapeElementImpl=n.findChildrenAtPosition=n.getAbsoluteClientBounds=n.getAbsoluteBounds=n.isAlignable=n.isSizeable=n.isLayoutableChild=n.isLayoutContainer=n.isBoundsAware=n.alignFeature=n.layoutableChildFeature=n.layoutContainerFeature=n.boundsFeature=void 0;const e=Te,t=ke,i=yt,o=sn;n.boundsFeature=Symbol("boundsFeature"),n.layoutContainerFeature=Symbol("layoutContainerFeature"),n.layoutableChildFeature=Symbol("layoutableChildFeature"),n.alignFeature=Symbol("alignFeature");function r(E){return"bounds"in E}n.isBoundsAware=r;function s(E){return r(E)&&E.hasFeature(n.layoutContainerFeature)&&"layout"in E}n.isLayoutContainer=s;function a(E){return r(E)&&E.hasFeature(n.layoutableChildFeature)}n.isLayoutableChild=a;function u(E){return E.hasFeature(n.boundsFeature)&&r(E)}n.isSizeable=u;function h(E){return E.hasFeature(n.alignFeature)&&"alignment"in E}n.isAlignable=h;function g(E){const A=(0,i.findParentByFeature)(E,r);if(A!==void 0){let L=A.bounds,B=A;for(;B instanceof t.SChildElementImpl;){const U=B.parent;L=U.localToParent(L),B=U}return L}else if(E instanceof t.SModelRootImpl){const L=E.canvasBounds;return{x:0,y:0,width:L.width,height:L.height}}else return e.Bounds.EMPTY}n.getAbsoluteBounds=g;function y(E,A,L){let B=0,U=0,p=0,b=0;const v=A.createUniqueDOMElementId(E),R=document.getElementById(v);if(R){const j=R.getBoundingClientRect(),T=(0,o.getWindowScroll)();B=j.left+T.x,U=j.top+T.y,p=j.width,b=j.height}let D=document.getElementById(L.baseDiv);if(D)for(;D.offsetParent instanceof HTMLElement&&(D=D.offsetParent);)B-=D.offsetLeft,U-=D.offsetTop;return{x:B,y:U,width:p,height:b}}n.getAbsoluteClientBounds=y;function S(E,A){const L=[];return w(E,A,L),L}n.findChildrenAtPosition=S;function w(E,A,L){E.children.forEach(B=>{if(r(B)&&e.Bounds.includes(B.bounds,A)&&L.push(B),B instanceof t.SParentElementImpl){const U=B.parentToLocal(A);w(B,U,L)}})}class P extends t.SChildElementImpl{constructor(){super(...arguments),this.position=e.Point.ORIGIN,this.size=e.Dimension.EMPTY}get bounds(){return{x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height}}set bounds(A){this.position={x:A.x,y:A.y},this.size={width:A.width,height:A.height}}localToParent(A){const L={x:A.x+this.position.x,y:A.y+this.position.y,width:-1,height:-1};return(0,e.isBounds)(A)&&(L.width=A.width,L.height=A.height),L}parentToLocal(A){const L={x:A.x-this.position.x,y:A.y-this.position.y,width:-1,height:-1};return(0,e.isBounds)(A)&&(L.width=A.width,L.height=A.height),L}}n.SShapeElementImpl=P})($t);var hG=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},pG=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},mG=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(hs,"__esModule",{value:!0});hs.RequestBoundsCommand=hs.SetBoundsCommand=void 0;const eC=k,U6=se,gG=ze,vG=me,Lde=$t;let tC=class extends gG.SystemCommand{constructor(e){super(),this.action=e,this.bounds=[]}execute(e){return this.action.bounds.forEach(t=>{const i=e.root.index.getById(t.elementId);i&&(0,Lde.isBoundsAware)(i)&&this.bounds.push({element:i,oldBounds:i.bounds,newPosition:t.newPosition,newSize:t.newSize})}),this.redo(e)}undo(e){return this.bounds.forEach(t=>t.element.bounds=t.oldBounds),e.root}redo(e){return this.bounds.forEach(t=>{t.newPosition?t.element.bounds=Object.assign(Object.assign({},t.newPosition),t.newSize):t.element.bounds=Object.assign({x:t.element.bounds.x,y:t.element.bounds.y},t.newSize)}),e.root}};hs.SetBoundsCommand=tC;tC.KIND=U6.SetBoundsAction.KIND;hs.SetBoundsCommand=tC=hG([(0,eC.injectable)(),mG(0,(0,eC.inject)(vG.TYPES.Action)),pG("design:paramtypes",[Object])],tC);let nC=class extends gG.HiddenCommand{constructor(e){super(),this.action=e}execute(e){return{model:e.modelFactory.createRoot(this.action.newRoot),modelChanged:!0,cause:this.action}}get blockUntil(){return e=>e.kind===U6.ComputedBoundsAction.KIND}};hs.RequestBoundsCommand=nC;nC.KIND=U6.RequestBoundsAction.KIND;hs.RequestBoundsCommand=nC=hG([(0,eC.injectable)(),mG(0,(0,eC.inject)(vG.TYPES.Action)),pG("design:paramtypes",[Object])],nC);var cA={},qi={},g0=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},dA=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},e$=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(qi,"__esModule",{value:!0});qi.configureLayout=qi.StatefulLayouter=qi.Layouter=qi.LayoutRegistry=void 0;const Nl=k,jde=Te,v0=me,Nde=pn,t$=$t,Bde=wa;let F_=class extends Nde.InstanceRegistry{constructor(e=[]){super(),e.forEach(t=>{this.hasKey(t.layoutKind)?this.logger.warn("Layout kind is already defined: ",t.layoutKind):this.register(t.layoutKind,t.factory())})}};qi.LayoutRegistry=F_;g0([(0,Nl.inject)(v0.TYPES.ILogger),dA("design:type",Object)],F_.prototype,"logger",void 0);qi.LayoutRegistry=F_=g0([(0,Nl.injectable)(),e$(0,(0,Nl.multiInject)(v0.TYPES.LayoutRegistration)),e$(0,(0,Nl.optional)()),dA("design:paramtypes",[Array])],F_);let x_=class{layout(e){new _G(e,this.layoutRegistry,this.logger).layout()}};qi.Layouter=x_;g0([(0,Nl.inject)(v0.TYPES.LayoutRegistry),dA("design:type",F_)],x_.prototype,"layoutRegistry",void 0);g0([(0,Nl.inject)(v0.TYPES.ILogger),dA("design:type",Object)],x_.prototype,"logger",void 0);qi.Layouter=x_=g0([(0,Nl.injectable)()],x_);class _G{constructor(e,t,i){this.element2boundsData=e,this.layoutRegistry=t,this.log=i,this.toBeLayouted=[],e.forEach((o,r)=>{(0,t$.isLayoutContainer)(r)&&this.toBeLayouted.push(r)})}getBoundsData(e){let t=this.element2boundsData.get(e),i=e.bounds;return(0,t$.isLayoutContainer)(e)&&this.toBeLayouted.indexOf(e)>=0&&(i=this.doLayout(e)),t||(t={bounds:i,boundsChanged:!1,alignmentChanged:!1},this.element2boundsData.set(e,t)),t}layout(){for(;this.toBeLayouted.length>0;){const e=this.toBeLayouted[0];this.doLayout(e)}}doLayout(e){const t=this.toBeLayouted.indexOf(e);t>=0&&this.toBeLayouted.splice(t,1);const i=this.layoutRegistry.get(e.layout);i&&i.layout(e,this);const o=this.element2boundsData.get(e);return o!==void 0&&o.bounds!==void 0?o.bounds:(this.log.error(e,"Layout failed"),jde.Bounds.EMPTY)}}qi.StatefulLayouter=_G;function $de(n,e,t){if(typeof t=="function"){if(!(0,Bde.isInjectable)(t))throw new Error(`Layouts be @injectable: ${t.name}`);n.isBound(t)||n.bind(t).toSelf()}n.bind(v0.TYPES.LayoutRegistration).toDynamicValue(i=>({layoutKind:e,factory:()=>i.container.get(t)}))}qi.configureLayout=$de;(function(n){var e=f&&f.__decorate||function(w,P,E,A){var L=arguments.length,B=L<3?P:A===null?A=Object.getOwnPropertyDescriptor(P,E):A,U;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")B=Reflect.decorate(w,P,E,A);else for(var p=w.length-1;p>=0;p--)(U=w[p])&&(B=(L<3?U(B):L>3?U(P,E,B):U(P,E))||B);return L>3&&B&&Object.defineProperty(P,E,B),B},t=f&&f.__metadata||function(w,P){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(w,P)};Object.defineProperty(n,"__esModule",{value:!0}),n.ATTR_BBOX_ELEMENT=n.HiddenBoundsUpdater=n.BoundsData=void 0;const i=k,o=se,r=Te,s=sn,a=ke,u=me,h=qi,g=$t;class y{}n.BoundsData=y;let S=class{constructor(){this.element2boundsData=new Map}decorate(P,E){return((0,g.isSizeable)(E)||(0,g.isLayoutContainer)(E))&&this.element2boundsData.set(E,{vnode:P,bounds:E.bounds,boundsChanged:!1,alignmentChanged:!1}),E instanceof a.SModelRootImpl&&(this.root=E),P}postUpdate(P){if(P===void 0||P.kind!==o.RequestBoundsAction.KIND)return;const E=P;this.getBoundsFromDOM(),this.layouter.layout(this.element2boundsData);const A=[],L=[];this.element2boundsData.forEach((U,p)=>{if(U.boundsChanged&&U.bounds!==void 0){const b={elementId:p.id,newSize:{width:U.bounds.width,height:U.bounds.height}};p instanceof a.SChildElementImpl&&(0,g.isLayoutContainer)(p.parent)&&(b.newPosition={x:U.bounds.x,y:U.bounds.y}),A.push(b)}U.alignmentChanged&&U.alignment!==void 0&&L.push({elementId:p.id,newAlignment:U.alignment})});const B=this.root!==void 0?this.root.revision:void 0;this.actionDispatcher.dispatch(o.ComputedBoundsAction.create(A,{revision:B,alignments:L,requestId:E.requestId})),this.element2boundsData.clear()}getBoundsFromDOM(){this.element2boundsData.forEach((P,E)=>{if(P.bounds&&(0,g.isSizeable)(E)){const A=P.vnode;if(A&&A.elm){const L=this.getBounds(A.elm,E);(0,g.isAlignable)(E)&&!((0,r.almostEquals)(L.x,0)&&(0,r.almostEquals)(L.y,0))&&(P.alignment={x:-L.x,y:-L.y},P.alignmentChanged=!0);const B={x:E.bounds.x,y:E.bounds.y,width:L.width,height:L.height};(0,r.almostEquals)(B.x,E.bounds.x)&&(0,r.almostEquals)(B.y,E.bounds.y)&&(0,r.almostEquals)(B.width,E.bounds.width)&&(0,r.almostEquals)(B.height,E.bounds.height)||(P.bounds=B,P.boundsChanged=!0)}}})}getBounds(P,E){if(!(0,s.isSVGGraphicsElement)(P))return this.logger.error(this,"Not an SVG element:",P),r.Bounds.EMPTY;if(P.tagName==="g"){for(const L of Array.from(P.children))if(L.getAttribute(n.ATTR_BBOX_ELEMENT)!==null)return this.getBounds(L,E)}const A=P.getBBox();return{x:A.x,y:A.y,width:A.width,height:A.height}}};n.HiddenBoundsUpdater=S,e([(0,i.inject)(u.TYPES.ILogger),t("design:type",Object)],S.prototype,"logger",void 0),e([(0,i.inject)(u.TYPES.IActionDispatcher),t("design:type",Object)],S.prototype,"actionDispatcher",void 0),e([(0,i.inject)(u.TYPES.Layouter),t("design:type",h.Layouter)],S.prototype,"layouter",void 0),n.HiddenBoundsUpdater=S=e([(0,i.injectable)()],S),n.ATTR_BBOX_ELEMENT="bboxElement"})(cA);var Df={},Bu={},kde=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Bu,"__esModule",{value:!0});Bu.AbstractLayout=void 0;const ZI=Te,n$=ke,QI=$t,Fde=k;let c2=class{layout(e,t){const i=t.getBoundsData(e),o=this.getLayoutOptions(e),r=this.getChildrenSize(e,o,t),s=o.paddingFactor*(o.resizeContainer?Math.max(r.width,o.minWidth):Math.max(0,this.getFixedContainerBounds(e,o,t).width)-o.paddingLeft-o.paddingRight),a=o.paddingFactor*(o.resizeContainer?Math.max(r.height,o.minHeight):Math.max(0,this.getFixedContainerBounds(e,o,t).height)-o.paddingTop-o.paddingBottom);if(s>0&&a>0){const u=this.layoutChildren(e,t,o,s,a);i.bounds=this.getFinalContainerBounds(e,u,o,s,a),i.boundsChanged=!0}}getFinalContainerBounds(e,t,i,o,r){return{x:e.bounds.x,y:e.bounds.y,width:Math.max(i.minWidth,o+i.paddingLeft+i.paddingRight),height:Math.max(i.minHeight,r+i.paddingTop+i.paddingBottom)}}getFixedContainerBounds(e,t,i){let o=e;for(;;){if((0,QI.isBoundsAware)(o)){const r=o.bounds;if((0,QI.isLayoutContainer)(o)&&t.resizeContainer&&i.log.error(o,"Resizable container found while detecting fixed bounds"),ZI.Dimension.isValid(r))return r}if(o instanceof n$.SChildElementImpl)o=o.parent;else return i.log.error(o,"Cannot detect fixed bounds"),ZI.Bounds.EMPTY}}layoutChildren(e,t,i,o,r){let s={x:i.paddingLeft+.5*(o-o/i.paddingFactor),y:i.paddingTop+.5*(r-r/i.paddingFactor)};return e.children.forEach(a=>{if((0,QI.isLayoutableChild)(a)){const u=t.getBoundsData(a),h=u.bounds,g=this.getChildLayoutOptions(a,i);h!==void 0&&ZI.Dimension.isValid(h)&&(s=this.layoutChild(a,u,h,g,i,s,o,r))}}),s}getDx(e,t,i){switch(e){case"left":return 0;case"center":return .5*(i-t.width);case"right":return i-t.width}}getDy(e,t,i){switch(e){case"top":return 0;case"center":return .5*(i-t.height);case"bottom":return i-t.height}}getChildLayoutOptions(e,t){const i=e.layoutOptions;return i===void 0?t:this.spread(t,i)}getLayoutOptions(e){let t=e;const i=[];for(;t!==void 0;){const o=t.layoutOptions;if(o!==void 0&&i.push(o),t instanceof n$.SChildElementImpl)t=t.parent;else break}return i.reverse().reduce((o,r)=>this.spread(o,r),this.getDefaultLayoutOptions())}};Bu.AbstractLayout=c2;Bu.AbstractLayout=c2=kde([(0,Fde.injectable)()],c2);var xde=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Df,"__esModule",{value:!0});Df.VBoxLayouter=void 0;const Hde=k,Kde=Te,Vde=Bu,zde=$t;let iC=class extends Vde.AbstractLayout{getChildrenSize(e,t,i){let o=-1,r=0,s=!0;return e.children.forEach(a=>{if((0,zde.isLayoutableChild)(a)){const u=i.getBoundsData(a).bounds;u!==void 0&&Kde.Dimension.isValid(u)&&(r+=u.height,s?s=!1:r+=t.vGap,o=Math.max(o,u.width))}}),{width:o,height:r}}layoutChild(e,t,i,o,r,s,a,u){const h=this.getDx(o.hAlign,i,a);return t.bounds={x:r.paddingLeft+e.bounds.x-i.x+h,y:s.y+e.bounds.y-i.y,width:i.width,height:i.height},t.boundsChanged=!0,{x:s.x,y:s.y+i.height+r.vGap}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,vGap:1,hAlign:"center",minWidth:0,minHeight:0}}spread(e,t){return Object.assign(Object.assign({},e),t)}};Df.VBoxLayouter=iC;iC.KIND="vbox";Df.VBoxLayouter=iC=xde([(0,Hde.injectable)()],iC);var Of={},Gde=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Of,"__esModule",{value:!0});Of.HBoxLayouter=void 0;const Ude=k,Yde=Te,qde=Bu,Wde=$t;let oC=class extends qde.AbstractLayout{getChildrenSize(e,t,i){let o=0,r=-1,s=!0;return e.children.forEach(a=>{if((0,Wde.isLayoutableChild)(a)){const u=i.getBoundsData(a).bounds;u!==void 0&&Yde.Dimension.isValid(u)&&(s?s=!1:o+=t.hGap,o+=u.width,r=Math.max(r,u.height))}}),{width:o,height:r}}layoutChild(e,t,i,o,r,s,a,u){const h=this.getDy(o.vAlign,i,u);return t.bounds={x:s.x+e.bounds.x-i.x,y:r.paddingTop+e.bounds.y-i.y+h,width:i.width,height:i.height},t.boundsChanged=!0,{x:s.x+i.width+r.hGap,y:s.y}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,hGap:1,vAlign:"center",minWidth:0,minHeight:0}}spread(e,t){return Object.assign(Object.assign({},e),t)}};Of.HBoxLayouter=oC;oC.KIND="hbox";Of.HBoxLayouter=oC=Gde([(0,Ude.injectable)()],oC);var og={},Zde=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(og,"__esModule",{value:!0});og.StackLayouter=void 0;const Qde=k,Xde=Te,Jde=Bu,eue=$t;let rC=class extends Jde.AbstractLayout{getChildrenSize(e,t,i){let o=-1,r=-1;return e.children.forEach(s=>{if((0,eue.isLayoutableChild)(s)){const a=i.getBoundsData(s).bounds;a!==void 0&&Xde.Dimension.isValid(a)&&(o=Math.max(o,a.width),r=Math.max(r,a.height))}}),{width:o,height:r}}layoutChild(e,t,i,o,r,s,a,u){const h=this.getDx(o.hAlign,i,a),g=this.getDy(o.vAlign,i,u);return t.bounds={x:r.paddingLeft+e.bounds.x-i.x+h,y:r.paddingTop+e.bounds.y-i.y+g,width:i.width,height:i.height},t.boundsChanged=!0,s}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,hAlign:"center",vAlign:"center",minWidth:0,minHeight:0}}spread(e,t){return Object.assign(Object.assign({},e),t)}};og.StackLayouter=rC;rC.KIND="stack";og.StackLayouter=rC=Zde([(0,Qde.injectable)()],rC);var Fc={},tue=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Fc,"__esModule",{value:!0});Fc.ShapeView=void 0;const nue=k,iue=Te,oue=$t;let d2=class{isVisible(e,t){if(t.targetKind==="hidden"||!iue.Dimension.isValid(e.bounds))return!0;const i=(0,oue.getAbsoluteBounds)(e),o=e.root.canvasBounds;return i.x<=o.width&&i.x+i.width>=0&&i.y<=o.height&&i.y+i.height>=0}};Fc.ShapeView=d2;Fc.ShapeView=d2=tue([(0,nue.injectable)()],d2);var ps={},rue=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},sue=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},i$=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(ps,"__esModule",{value:!0});ps.configureButtonHandler=ps.ButtonHandlerRegistry=void 0;const XI=k,aue=pn,yG=me,cue=wa;let u2=class extends aue.InstanceRegistry{constructor(e){super(),e.forEach(t=>this.register(t.TYPE,t.factory()))}};ps.ButtonHandlerRegistry=u2;ps.ButtonHandlerRegistry=u2=rue([(0,XI.injectable)(),i$(0,(0,XI.multiInject)(yG.TYPES.IButtonHandlerRegistration)),i$(0,(0,XI.optional)()),sue("design:paramtypes",[Array])],u2);function due(n,e,t){if(typeof t=="function"){if(!(0,cue.isInjectable)(t))throw new Error(`Button handlers should be @injectable: ${t.name}`);n.isBound(t)||n.bind(t).toSelf()}n.bind(yG.TYPES.IButtonHandlerRegistration).toDynamicValue(i=>({TYPE:e,factory:()=>i.container.get(t)}))}ps.configureButtonHandler=due;var rg={},Lf={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isFadeable=n.fadeFeature=void 0,n.fadeFeature=Symbol("fadeFeature");function e(t){return t.hasFeature(n.fadeFeature)&&t.opacity!==void 0}n.isFadeable=e})(Lf);Object.defineProperty(rg,"__esModule",{value:!0});rg.SButtonImpl=void 0;const l2=$t,uue=Lf;class bG extends l2.SShapeElementImpl{constructor(){super(...arguments),this.enabled=!0}}rg.SButtonImpl=bG;bG.DEFAULT_FEATURES=[l2.boundsFeature,l2.layoutableChildFeature,uue.fadeFeature];var ms={},uA={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.name=n.isNameable=n.nameFeature=void 0,n.nameFeature=Symbol("nameableFeature");function e(i){return i.hasFeature(n.nameFeature)}n.isNameable=e;function t(i){if(e(i))return i.name}n.name=t})(uA);var SG=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},EG=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},f2=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(ms,"__esModule",{value:!0});ms.RevealNamedElementActionProvider=ms.CommandPaletteActionProviderRegistry=void 0;const t_=k,JI=se,o$=Jd,CG=me,lue=Io,r$=uA;let h2=class{constructor(e=[]){this.actionProviders=e}getActions(e,t,i,o){const r=this.actionProviders.map(s=>s.getActions(e,t,i,o));return Promise.all(r).then(s=>s.reduce((a,u)=>u!==void 0?a.concat(u):a))}};ms.CommandPaletteActionProviderRegistry=h2;ms.CommandPaletteActionProviderRegistry=h2=SG([(0,t_.injectable)(),f2(0,(0,t_.multiInject)(CG.TYPES.ICommandPaletteActionProvider)),f2(0,(0,t_.optional)()),EG("design:paramtypes",[Array])],h2);let p2=class{constructor(e){this.logger=e}getActions(e,t,i,o){return o!==void 0&&o%2===0?Promise.resolve(this.createSelectActions(e)):Promise.resolve([new o$.LabeledAction("Select all",[JI.SelectAllAction.create()])])}createSelectActions(e){return(0,lue.toArray)(e.index.all().filter(i=>(0,r$.isNameable)(i))).map(i=>new o$.LabeledAction(`Reveal ${(0,r$.name)(i)}`,[JI.SelectAction.create({selectedElementsIDs:[i.id]}),JI.CenterAction.create([i.id])],"eye"))}};ms.RevealNamedElementActionProvider=p2;ms.RevealNamedElementActionProvider=p2=SG([(0,t_.injectable)(),f2(0,(0,t_.inject)(CG.TYPES.ILogger)),EG("design:paramtypes",[Object])],p2);var cc={},lA={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.codiconCSSClasses=n.codiconCSSString=n.ANIMATION_SPIN=n.ACTION_ITEM=void 0,n.ACTION_ITEM="action-item",n.ANIMATION_SPIN="animation-spin";function e(i,o=!1,r=!1,s=[]){return t(i,o,r,s).join(" ")}n.codiconCSSString=e;function t(i,o=!1,r=!1,s=[]){const a=["codicon",`codicon-${i}`];return o&&a.push(n.ACTION_ITEM),r&&a.push(n.ANIMATION_SPIN),s.length>0&&a.push(...s),a}n.codiconCSSClasses=t})(lA);var qt={};Object.defineProperty(qt,"__esModule",{value:!0});qt.getActualCode=Gi=qt.matchesKeystroke=void 0;const fue=sn;function hue(n,e,...t){if(PG(n)!==e)return!1;if((0,fue.isMac)()){if(n.ctrlKey!==t.findIndex(i=>i==="ctrl")>=0||n.metaKey!==t.findIndex(i=>i==="meta"||i==="ctrlCmd")>=0)return!1}else if(n.ctrlKey!==t.findIndex(i=>i==="ctrl"||i==="ctrlCmd")>=0||n.metaKey!==t.findIndex(i=>i==="meta")>=0)return!1;return!(n.altKey!==t.findIndex(i=>i==="alt")>=0||n.shiftKey!==t.findIndex(i=>i==="shift")>=0)}var Gi=qt.matchesKeystroke=hue;function PG(n){if(n.keyCode){const e=m2[n.keyCode];if(e!==void 0)return e}return n.code}qt.getActualCode=PG;const m2=new Array(256);(()=>{function n(e,t){m2[t]===void 0&&(m2[t]=e)}n("Pause",3),n("Backspace",8),n("Tab",9),n("Enter",13),n("ShiftLeft",16),n("ShiftRight",16),n("ControlLeft",17),n("ControlRight",17),n("AltLeft",18),n("AltRight",18),n("CapsLock",20),n("Escape",27),n("Space",32),n("PageUp",33),n("PageDown",34),n("End",35),n("Home",36),n("ArrowLeft",37),n("ArrowUp",38),n("ArrowRight",39),n("ArrowDown",40),n("Insert",45),n("Delete",46),n("Digit1",49),n("Digit2",50),n("Digit3",51),n("Digit4",52),n("Digit5",53),n("Digit6",54),n("Digit7",55),n("Digit8",56),n("Digit9",57),n("Digit0",48),n("KeyA",65),n("KeyB",66),n("KeyC",67),n("KeyD",68),n("KeyE",69),n("KeyF",70),n("KeyG",71),n("KeyH",72),n("KeyI",73),n("KeyJ",74),n("KeyK",75),n("KeyL",76),n("KeyM",77),n("KeyN",78),n("KeyO",79),n("KeyP",80),n("KeyQ",81),n("KeyR",82),n("KeyS",83),n("KeyT",84),n("KeyU",85),n("KeyV",86),n("KeyW",87),n("KeyX",88),n("KeyY",89),n("KeyZ",90),n("OSLeft",91),n("MetaLeft",91),n("OSRight",92),n("MetaRight",92),n("ContextMenu",93),n("Numpad0",96),n("Numpad1",97),n("Numpad2",98),n("Numpad3",99),n("Numpad4",100),n("Numpad5",101),n("Numpad6",102),n("Numpad7",103),n("Numpad8",104),n("Numpad9",105),n("NumpadMultiply",106),n("NumpadAdd",107),n("NumpadSeparator",108),n("NumpadSubtract",109),n("NumpadDecimal",110),n("NumpadDivide",111),n("F1",112),n("F2",113),n("F3",114),n("F4",115),n("F5",116),n("F6",117),n("F7",118),n("F8",119),n("F9",120),n("F10",121),n("F11",122),n("F12",123),n("F13",124),n("F14",125),n("F15",126),n("F16",127),n("F17",128),n("F18",129),n("F19",130),n("F20",131),n("F21",132),n("F22",133),n("F23",134),n("F24",135),n("NumLock",144),n("ScrollLock",145),n("Semicolon",186),n("Equal",187),n("Comma",188),n("Minus",189),n("Period",190),n("Slash",191),n("Backquote",192),n("IntlRo",193),n("BracketLeft",219),n("Backslash",220),n("BracketRight",221),n("Quote",222),n("IntlYen",255)})();var no={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isSelected=n.isSelectable=n.selectFeature=void 0,n.selectFeature=Symbol("selectFeature");function e(i){return i.hasFeature(n.selectFeature)}n.isSelectable=e;function t(i){return i!==void 0&&e(i)&&i.selected}n.isSelected=t})(no);var wG={exports:{}};(function(n,e){(function(t,i){n.exports=i()})(f,function(){function t(i){var o=document,r=i.container||o.createElement("div"),s=i.preventSubmit||0;r.id=r.id||"autocomplete-"+b();var a=r.style,u=i.debounceWaitMs||0,h=i.disableAutoSelect||!1,g=r.parentElement,y=[],S="",w=2,P=i.showOnFocus,E,A=0,L,B=!1,U=!1;if(i.minLength!==void 0&&(w=i.minLength),!i.input)throw new Error("input undefined");var p=i.input;r.className=[r.className,"autocomplete",i.className||""].join(" ").trim(),r.setAttribute("role","listbox"),p.setAttribute("role","combobox"),p.setAttribute("aria-expanded","false"),p.setAttribute("aria-autocomplete","list"),p.setAttribute("aria-controls",r.id),p.setAttribute("aria-owns",r.id),p.setAttribute("aria-activedescendant",""),p.setAttribute("aria-haspopup","listbox"),a.position="absolute";function b(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function v(){var he=r.parentNode;he&&he.removeChild(r)}function R(){L&&window.clearTimeout(L)}function D(){r.parentNode||(g||o.body).appendChild(r)}function j(){return!!r.parentNode}function T(){A++,y=[],S="",E=void 0,p.setAttribute("aria-activedescendant",""),p.setAttribute("aria-expanded","false"),v()}function $(){if(!j())return;p.setAttribute("aria-expanded","true"),a.height="auto",a.width=p.offsetWidth+"px";var he=0,je;function en(){var xt=o.documentElement,Rn=xt.clientTop||o.body.clientTop||0,gn=xt.clientLeft||o.body.clientLeft||0,oi=window.pageYOffset||xt.scrollTop,_t=window.pageXOffset||xt.scrollLeft;je=p.getBoundingClientRect();var Zt=je.top+p.offsetHeight+oi-Rn,Si=je.left+_t-gn;a.top=Zt+"px",a.left=Si+"px",he=window.innerHeight-(je.top+p.offsetHeight),he<0&&(he=0),a.top=Zt+"px",a.bottom="",a.left=Si+"px",a.maxHeight=he+"px"}en(),en(),i.customize&&je&&i.customize(p,je,r,he)}function Q(){r.textContent="",p.setAttribute("aria-activedescendant","");var he=function(gn,oi,_t){var Zt=o.createElement("div");return Zt.textContent=gn.label||"",Zt};i.render&&(he=i.render);var je=function(gn,oi){var _t=o.createElement("div");return _t.textContent=gn,_t};i.renderGroup&&(je=i.renderGroup);var en=o.createDocumentFragment(),xt=b();if(y.forEach(function(gn,oi){if(gn.group&&gn.group!==xt){xt=gn.group;var _t=je(gn.group,S);_t&&(_t.className+=" group",en.appendChild(_t))}var Zt=he(gn,S,oi);Zt&&(Zt.id=r.id+"_"+oi,Zt.setAttribute("role","option"),Zt.addEventListener("click",function(Si){U=!0;try{i.onSelect(gn,p)}finally{U=!1}T(),Si.preventDefault(),Si.stopPropagation()}),gn===E&&(Zt.className+=" selected",Zt.setAttribute("aria-selected","true"),p.setAttribute("aria-activedescendant",Zt.id)),en.appendChild(Zt))}),r.appendChild(en),y.length<1)if(i.emptyMsg){var Rn=o.createElement("div");Rn.id=r.id+"_"+b(),Rn.className="empty",Rn.textContent=i.emptyMsg,r.appendChild(Rn),p.setAttribute("aria-activedescendant",Rn.id)}else{T();return}D(),$(),Y()}function K(){j()&&Q()}function Z(){K()}function H(he){he.target!==r?K():he.preventDefault()}function M(){U||Ot(0)}function Y(){var he=r.getElementsByClassName("selected");if(he.length>0){var je=he[0],en=je.previousElementSibling;if(en&&en.className.indexOf("group")!==-1&&!en.previousElementSibling&&(je=en),je.offsetTop<r.scrollTop)r.scrollTop=je.offsetTop;else{var xt=je.offsetTop+je.offsetHeight,Rn=r.scrollTop+r.offsetHeight;xt>Rn&&(r.scrollTop+=xt-Rn)}}}function te(){var he=y.indexOf(E);E=he===-1?void 0:y[(he+y.length-1)%y.length],Re(he)}function ue(){var he=y.indexOf(E);E=y.length<1?void 0:he===-1?y[0]:y[(he+1)%y.length],Re(he)}function Re(he){y.length>0&&(ot(he),ae(y.indexOf(E)),Y())}function ae(he){var je=o.getElementById(r.id+"_"+he);je&&(je.classList.add("selected"),je.setAttribute("aria-selected","true"),p.setAttribute("aria-activedescendant",je.id))}function ot(he){var je=o.getElementById(r.id+"_"+he);je&&(je.classList.remove("selected"),je.removeAttribute("aria-selected"),p.removeAttribute("aria-activedescendant"))}function Ft(he,je){var en=j();if(je==="Escape")T();else{if(!en||y.length<1)return;je==="ArrowUp"?te():ue()}he.preventDefault(),en&&he.stopPropagation()}function et(he){if(E){s===2&&he.preventDefault(),U=!0;try{i.onSelect(E,p)}finally{U=!1}T()}s===1&&he.preventDefault()}function ht(he){var je=he.key;switch(je){case"ArrowUp":case"ArrowDown":case"Escape":Ft(he,je);break;case"Enter":et(he);break}}function wt(){P&&Ot(1)}function Ot(he){p.value.length>=w||he===1?(R(),L=window.setTimeout(function(){return vt(p.value,he,p.selectionStart||0)},he===0||he===2?u:0)):T()}function vt(he,je,en){if(!B){var xt=++A;i.fetch(he,function(Rn){A===xt&&Rn&&(y=Rn,S=he,E=y.length<1||h?void 0:y[0],Q())},je,en)}}function At(he){if(i.keyup){i.keyup({event:he,fetch:function(){return Ot(0)}});return}!j()&&he.key==="ArrowDown"&&Ot(0)}function bi(he){i.click&&i.click({event:he,fetch:function(){return Ot(2)}})}function Wt(){setTimeout(function(){o.activeElement!==p&&T()},200)}function Ze(){vt(p.value,3,p.selectionStart||0)}r.addEventListener("mousedown",function(he){he.stopPropagation(),he.preventDefault()}),r.addEventListener("focus",function(){return p.focus()}),v();function ii(){p.removeEventListener("focus",wt),p.removeEventListener("keyup",At),p.removeEventListener("click",bi),p.removeEventListener("keydown",ht),p.removeEventListener("input",M),p.removeEventListener("blur",Wt),window.removeEventListener("resize",Z),o.removeEventListener("scroll",H,!0),p.removeAttribute("role"),p.removeAttribute("aria-expanded"),p.removeAttribute("aria-autocomplete"),p.removeAttribute("aria-controls"),p.removeAttribute("aria-activedescendant"),p.removeAttribute("aria-owns"),p.removeAttribute("aria-haspopup"),R(),T(),B=!0}return p.addEventListener("keyup",At),p.addEventListener("click",bi),p.addEventListener("keydown",ht),p.addEventListener("input",M),p.addEventListener("blur",Wt),p.addEventListener("focus",wt),window.addEventListener("resize",Z),o.addEventListener("scroll",H,!0),{destroy:ii,fetch:Ze}}return t})})(wG);var AG=wG.exports,sg=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},_0=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},pue=f&&f.__importDefault||function(n){return n&&n.__esModule?n:{default:n}},JE;Object.defineProperty(cc,"__esModule",{value:!0});cc.CommandPaletteKeyListener=cc.CommandPalette=void 0;const ag=k,mue=se,gue=Jd,fA=me,vue=aa,s$=Po,_ue=Aa,yue=gi,a$=lA,g2=Io,Y6=qt,c$=$t,RG=no,bue=ms,d$=Ut,Sue=pue(AG);let Qo=JE=class extends vue.AbstractUIExtension{constructor(){super(...arguments),this.loadingIndicatorClasses=(0,a$.codiconCSSClasses)("loading",!1,!0,["loading"]),this.xOffset=20,this.yOffset=20,this.defaultWidth=400,this.debounceWaitMs=100,this.noCommandsMsg="No commands available",this.paletteIndex=0}id(){return JE.ID}containerClass(){return"command-palette"}show(e,...t){super.show(e,...t),this.paletteIndex=0,this.contextActions=void 0,this.inputElement.value="",this.autoCompleteResult=(0,Sue.default)(this.autocompleteSettings(e)),this.inputElement.focus()}initializeContents(e){e.style.position="absolute",this.inputElement=document.createElement("input"),this.inputElement.style.width="100%",this.inputElement.addEventListener("keydown",t=>this.hideIfEscapeEvent(t)),this.inputElement.addEventListener("keydown",t=>this.cylceIfInvokePaletteKey(t)),this.inputElement.onblur=()=>window.setTimeout(()=>this.hide(),200),e.appendChild(this.inputElement)}hideIfEscapeEvent(e){(0,Y6.matchesKeystroke)(e,"Escape")&&this.hide()}cylceIfInvokePaletteKey(e){JE.isInvokePaletteKey(e)&&this.cycle()}cycle(){this.contextActions=void 0,this.paletteIndex++}onBeforeShow(e,t,...i){let o=this.xOffset,r=this.yOffset;const s=(0,g2.toArray)(t.index.all().filter(a=>(0,RG.isSelectable)(a)&&a.selected));if(s.length===1){const a=(0,c$.getAbsoluteClientBounds)(s[0],this.domHelper,this.viewerOptions);o+=a.x+a.width,r+=a.y}else{const a=(0,c$.getAbsoluteClientBounds)(t,this.domHelper,this.viewerOptions);o+=a.x,r+=a.y}e.style.left=`${o}px`,e.style.top=`${r}px`,e.style.width=`${this.defaultWidth}px`}autocompleteSettings(e){return{input:this.inputElement,emptyMsg:this.noCommandsMsg,className:"command-palette-suggestions",debounceWaitMs:this.debounceWaitMs,showOnFocus:!0,minLength:-1,fetch:(t,i)=>this.updateAutoCompleteActions(i,t,e),onSelect:t=>this.onSelect(t),render:(t,i)=>this.renderLabeledActionSuggestion(t,i),customize:(t,i,o,r)=>{this.customizeSuggestionContainer(o,i,r)}}}onSelect(e){this.executeAction(e),this.hide()}updateAutoCompleteActions(e,t,i){this.onLoading(),this.contextActions?(e(this.filterActions(t,this.contextActions)),this.onLoaded("success")):this.actionProviderRegistry.getActions(i,t,this.mousePositionTracker.lastPositionOnDiagram,this.paletteIndex).then(o=>{this.contextActions=o,e(this.filterActions(t,o)),this.onLoaded("success")}).catch(o=>{this.logger.error(this,"Failed to obtain actions from command palette action providers",o),this.onLoaded("error")})}onLoading(){this.loadingIndicator&&this.containerElement.contains(this.loadingIndicator)||(this.loadingIndicator=document.createElement("span"),this.loadingIndicator.classList.add(...this.loadingIndicatorClasses),this.containerElement.appendChild(this.loadingIndicator))}onLoaded(e){this.containerElement.contains(this.loadingIndicator)&&this.containerElement.removeChild(this.loadingIndicator)}renderLabeledActionSuggestion(e,t){const i=document.createElement("div"),o=Cue(t).split(" ").join("|"),r=new RegExp(o,"gi");return e.icon&&this.renderIcon(i,e.icon),t.length>0?i.innerHTML+=e.label.replace(r,s=>"<em>"+s+"</em>").replace(/ /g,"&nbsp;"):i.innerHTML+=e.label.replace(/ /g,"&nbsp;"),i}renderIcon(e,t){e.innerHTML+=`<span class="icon ${this.getCodicon(t)}"></span>`}getFontAwesomeIcon(e){return`fa fa-${e}`}getCodicon(e){return(0,a$.codiconCSSString)(e)}filterActions(e,t){return(0,g2.toArray)(t.filter(i=>{const o=i.label.toLowerCase();return e.split(" ").every(s=>o.indexOf(s.toLowerCase())!==-1)}))}customizeSuggestionContainer(e,t,i){e.style.position="fixed",this.containerElement&&this.containerElement.appendChild(e)}hide(){super.hide(),this.autoCompleteResult&&this.autoCompleteResult.destroy()}executeAction(e){this.actionDispatcherProvider().then(t=>t.dispatchAll(Eue(e))).catch(t=>this.logger.error(this,"No action dispatcher available to execute command palette action",t))}};cc.CommandPalette=Qo;Qo.ID="command-palette";Qo.isInvokePaletteKey=n=>(0,Y6.matchesKeystroke)(n,"Space","ctrl");sg([(0,ag.inject)(fA.TYPES.IActionDispatcherProvider),_0("design:type",Function)],Qo.prototype,"actionDispatcherProvider",void 0);sg([(0,ag.inject)(fA.TYPES.ICommandPaletteActionProviderRegistry),_0("design:type",bue.CommandPaletteActionProviderRegistry)],Qo.prototype,"actionProviderRegistry",void 0);sg([(0,ag.inject)(fA.TYPES.ViewerOptions),_0("design:type",Object)],Qo.prototype,"viewerOptions",void 0);sg([(0,ag.inject)(fA.TYPES.DOMHelper),_0("design:type",_ue.DOMHelper)],Qo.prototype,"domHelper",void 0);sg([(0,ag.inject)(d$.MousePositionTracker),_0("design:type",d$.MousePositionTracker)],Qo.prototype,"mousePositionTracker",void 0);cc.CommandPalette=Qo=JE=sg([(0,ag.injectable)()],Qo);function Eue(n){return(0,gue.isLabeledAction)(n)?n.actions:(0,mue.isAction)(n)?[n]:[]}function Cue(n){return n.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}class Pue extends yue.KeyListener{keyDown(e,t){if((0,Y6.matchesKeystroke)(t,"Escape"))return[s$.SetUIExtensionVisibilityAction.create({extensionId:Qo.ID,visible:!1,contextElementsId:[]})];if(Qo.isInvokePaletteKey(t)){const i=(0,g2.toArray)(e.index.all().filter(o=>(0,RG.isSelectable)(o)&&o.selected).map(o=>o.id));return[s$.SetUIExtensionVisibilityAction.create({extensionId:Qo.ID,visible:!0,contextElementsId:i})]}return[]}}cc.CommandPaletteKeyListener=Pue;var hA={};Object.defineProperty(hA,"__esModule",{value:!0});hA.toAnchor=void 0;function wue(n){return n instanceof HTMLElement?{x:n.offsetLeft,y:n.offsetTop}:n}hA.toAnchor=wue;var gs={},jf={};(function(n){var e=f&&f.__decorate||function(S,w,P,E){var A=arguments.length,L=A<3?w:E===null?E=Object.getOwnPropertyDescriptor(w,P):E,B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(S,w,P,E);else for(var U=S.length-1;U>=0;U--)(B=S[U])&&(L=(A<3?B(L):A>3?B(w,P,L):B(w,P))||L);return A>3&&L&&Object.defineProperty(w,P,L),L},t=f&&f.__metadata||function(S,w){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(S,w)},i=f&&f.__param||function(S,w){return function(P,E){w(P,E,S)}};Object.defineProperty(n,"__esModule",{value:!0}),n.DeleteElementCommand=n.ResolvedDelete=n.isDeletable=n.deletableFeature=void 0;const o=k,r=se,s=ze,a=ke,u=me;n.deletableFeature=Symbol("deletableFeature");function h(S){return S instanceof a.SChildElementImpl&&S.hasFeature(n.deletableFeature)}n.isDeletable=h;class g{}n.ResolvedDelete=g;let y=class extends s.Command{constructor(w){super(),this.action=w,this.resolvedDeletes=[]}execute(w){const P=w.root.index;for(const E of this.action.elementIds){const A=P.getById(E);A&&h(A)&&(this.resolvedDeletes.push({child:A,parent:A.parent}),A.parent.remove(A))}return w.root}undo(w){for(const P of this.resolvedDeletes)P.parent.add(P.child);return w.root}redo(w){for(const P of this.resolvedDeletes)P.parent.remove(P.child);return w.root}};n.DeleteElementCommand=y,y.KIND=r.DeleteElementAction.KIND,n.DeleteElementCommand=y=e([(0,o.injectable)(),i(0,(0,o.inject)(u.TYPES.Action)),t("design:paramtypes",[Object])],y)})(jf);var MG=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Aue=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},u$=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(gs,"__esModule",{value:!0});gs.DeleteContextMenuItemProvider=gs.ContextMenuProviderRegistry=void 0;const e3=k,Rue=me,Mue=jf,Iue=no,Tue=Fr;let v2=class{constructor(e=[]){this.menuProviders=e}getItems(e,t){const i=this.menuProviders.map(o=>o.getItems(e,t));return Promise.all(i).then(this.flattenAndRestructure)}flattenAndRestructure(e){let t=e.reduce((o,r)=>r!==void 0?o.concat(r):o,[]);const i=t.filter(o=>o.parentId);for(const o of i)if(o.parentId){const r=o.parentId.split(".");let s,a=t;for(const u of r)s=a.find(h=>u===h.id),s&&s.children&&(a=s.children);s&&(s.children?s.children.push(o):s.children=[o],t=t.filter(u=>u!==o))}return t}};gs.ContextMenuProviderRegistry=v2;gs.ContextMenuProviderRegistry=v2=MG([(0,e3.injectable)(),u$(0,(0,e3.multiInject)(Rue.TYPES.IContextMenuItemProvider)),u$(0,(0,e3.optional)()),Aue("design:paramtypes",[Array])],v2);let _2=class{getItems(e,t){const i=Array.from(e.index.all().filter(Iue.isSelected).filter(Mue.isDeletable));return Promise.resolve([{id:"delete",label:"Delete",sortString:"d",group:"edit",actions:[Tue.DeleteElementAction.create(i.map(o=>o.id))],isEnabled:()=>i.length>0}])}};gs.DeleteContextMenuItemProvider=_2;gs.DeleteContextMenuItemProvider=_2=MG([(0,e3.injectable)()],_2);var Nf={},IG=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},TG=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},l$=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Nf,"__esModule",{value:!0});Nf.ContextMenuMouseListener=void 0;const y2=k,Due=se,Oue=yt,b2=me,Lue=Ut,sE=no,jue=gs;let sC=class extends Lue.MouseListener{constructor(e,t){super(),this.contextMenuService=e,this.menuProvider=t}contextMenu(e,t){return this.showContextMenu(e,t),[]}async showContextMenu(e,t){let i;try{i=await this.contextMenuService()}catch{return}let o=!1;const r=(0,Oue.findParentByFeature)(e,sE.isSelectable);r&&(o=r.selected,r.selected=!0);const s=e.root,a={x:t.x,y:t.y};if(e.id===s.id||(0,sE.isSelected)(r)){const u=await this.menuProvider.getItems(s,a),h=()=>{r&&(r.selected=o)};i.show(u,a,h)}else{if((0,sE.isSelectable)(e)){const h={selectedElementsIDs:[e.id],deselectedElementsIDs:Array.from(s.index.all().filter(sE.isSelected),g=>g.id)};await this.actionDispatcher.dispatch(Due.SelectAction.create(h))}const u=await this.menuProvider.getItems(s,a);i.show(u,a)}}};Nf.ContextMenuMouseListener=sC;IG([(0,y2.inject)(b2.TYPES.IActionDispatcher),TG("design:type",Object)],sC.prototype,"actionDispatcher",void 0);Nf.ContextMenuMouseListener=sC=IG([l$(0,(0,y2.inject)(b2.TYPES.IContextMenuServiceProvider)),l$(1,(0,y2.inject)(b2.TYPES.IContextMenuProviderRegistry)),TG("design:paramtypes",[Function,jue.ContextMenuProviderRegistry])],sC);var Vl={},Bf={},Sn={},$f={},an={},$u={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.hasPopupFeature=n.popupFeature=n.isHoverable=n.hoverFeedbackFeature=void 0,n.hoverFeedbackFeature=Symbol("hoverFeedbackFeature");function e(i){return i.hasFeature(n.hoverFeedbackFeature)}n.isHoverable=e,n.popupFeature=Symbol("popupFeature");function t(i){return i.hasFeature(n.popupFeature)}n.hasPopupFeature=t})($u);var xc={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isMoveable=n.isLocateable=n.moveFeature=void 0;const e=Ji;n.moveFeature=Symbol("moveFeature");function t(o){return(0,e.hasOwnProperty)(o,"position")}n.isLocateable=t;function i(o){return o.hasFeature(n.moveFeature)&&t(o)}n.isMoveable=i})(xc);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.edgeInProgressTargetHandleID=n.edgeInProgressID=n.SDanglingAnchorImpl=n.SRoutingHandleImpl=n.SConnectableElementImpl=n.getRouteBounds=n.getAbsoluteRouteBounds=n.isConnectable=n.connectableFeature=n.SRoutableElementImpl=void 0;const e=Te,t=ke,i=$t,o=jf,r=no,s=$u,a=xc;class u extends t.SChildElementImpl{constructor(){super(...arguments),this.routingPoints=[]}get source(){return this.index.getById(this.sourceId)}get target(){return this.index.getById(this.targetId)}get bounds(){return this.routingPoints.reduce((A,L)=>e.Bounds.combine(A,{x:L.x,y:L.y,width:0,height:0}),e.Bounds.EMPTY)}}n.SRoutableElementImpl=u,n.connectableFeature=Symbol("connectableFeature");function h(E){return E.hasFeature(n.connectableFeature)&&E.canConnect}n.isConnectable=h;function g(E,A=E.routingPoints){let L=y(A),B=E;for(;B instanceof t.SChildElementImpl;){const U=B.parent;L=U.localToParent(L),B=U}return L}n.getAbsoluteRouteBounds=g;function y(E){const A={x:NaN,y:NaN,width:0,height:0};for(const L of E)isNaN(A.x)?(A.x=L.x,A.y=L.y):(L.x<A.x?(A.width+=A.x-L.x,A.x=L.x):L.x>A.x+A.width&&(A.width=L.x-A.x),L.y<A.y?(A.height+=A.y-L.y,A.y=L.y):L.y>A.y+A.height&&(A.height=L.y-A.y));return A}n.getRouteBounds=y;class S extends i.SShapeElementImpl{constructor(){super(...arguments),this.strokeWidth=0}get anchorKind(){}get incomingEdges(){return this.index.all().filter(L=>L instanceof u).filter(L=>L.targetId===this.id)}get outgoingEdges(){return this.index.all().filter(L=>L instanceof u).filter(L=>L.sourceId===this.id)}canConnect(A,L){return!0}}n.SConnectableElementImpl=S;class w extends t.SChildElementImpl{constructor(){super(...arguments),this.editMode=!1,this.hoverFeedback=!1,this.selected=!1}hasFeature(A){return w.DEFAULT_FEATURES.indexOf(A)!==-1}}n.SRoutingHandleImpl=w,w.DEFAULT_FEATURES=[r.selectFeature,a.moveFeature,s.hoverFeedbackFeature];class P extends S{constructor(){super(),this.type="dangling-anchor",this.size={width:0,height:0}}}n.SDanglingAnchorImpl=P,P.DEFAULT_FEATURES=[o.deletableFeature],n.edgeInProgressID="edge-in-progress",n.edgeInProgressTargetHandleID=n.edgeInProgressID+"-target-anchor"})(an);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_EDGE_PLACEMENT=n.EdgePlacement=n.checkEdgePlacement=n.isEdgeLayoutable=n.edgeLayoutFeature=void 0;const e=ke,t=$t,i=an;n.edgeLayoutFeature=Symbol("edgeLayout");function o(a){return a instanceof e.SChildElementImpl&&a.parent instanceof i.SRoutableElementImpl&&(0,t.isBoundsAware)(a)&&a.hasFeature(n.edgeLayoutFeature)}n.isEdgeLayoutable=o;function r(a){return"edgePlacement"in a}n.checkEdgePlacement=r;class s extends Object{}n.EdgePlacement=s,n.DEFAULT_EDGE_PLACEMENT={rotate:!0,side:"top",position:.5,offset:7,moveMode:"edge"}})($f);var kf={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isWithEditableLabel=n.withEditLabelFeature=n.isEditableLabel=n.editLabelFeature=n.canEditRouting=n.editFeature=void 0;const e=an;n.editFeature=Symbol("editFeature");function t(r){return r instanceof e.SRoutableElementImpl&&r.hasFeature(n.editFeature)}n.canEditRouting=t,n.editLabelFeature=Symbol("editLabelFeature");function i(r){return"text"in r&&r.hasFeature(n.editLabelFeature)}n.isEditableLabel=i,n.withEditLabelFeature=Symbol("withEditLabelFeature");function o(r){return"editableLabel"in r&&r.hasFeature(n.withEditLabelFeature)}n.isWithEditableLabel=o})(kf);var Ff={},Rs={},ei={};Object.defineProperty(ei,"__esModule",{value:!0});ei.limit=ei.intersection=ei.PointToPointLine=ei.Diamond=void 0;const ip=Fr;class Nue{constructor(e){this.bounds=e}get topPoint(){return{x:this.bounds.x+this.bounds.width/2,y:this.bounds.y}}get rightPoint(){return{x:this.bounds.x+this.bounds.width,y:this.bounds.y+this.bounds.height/2}}get bottomPoint(){return{x:this.bounds.x+this.bounds.width/2,y:this.bounds.y+this.bounds.height}}get leftPoint(){return{x:this.bounds.x,y:this.bounds.y+this.bounds.height/2}}get topRightSideLine(){return new Bv(this.topPoint,this.rightPoint)}get topLeftSideLine(){return new Bv(this.topPoint,this.leftPoint)}get bottomRightSideLine(){return new Bv(this.bottomPoint,this.rightPoint)}get bottomLeftSideLine(){return new Bv(this.bottomPoint,this.leftPoint)}closestSideLine(e){const t=ip.Bounds.center(this.bounds);return e.x>t.x?e.y>t.y?this.bottomRightSideLine:this.topRightSideLine:e.y>t.y?this.bottomLeftSideLine:this.topLeftSideLine}}ei.Diamond=Nue;class Bv{constructor(e,t){this.p1=e,this.p2=t}get a(){return this.p1.y-this.p2.y}get b(){return this.p2.x-this.p1.x}get c(){return this.p2.x*this.p1.y-this.p1.x*this.p2.y}get angle(){return Math.atan2(-this.a,this.b)}get slope(){if(this.b!==0)return this.a/this.b}get slopeOrMax(){return this.slope===void 0?Number.MAX_SAFE_INTEGER:this.slope}get direction(){const e=(0,ip.toDegrees)(this.angle),t=e<0?360+e:e;if(t===90)return"south";if(t===0||t===360)return"east";if(t===270)return"north";if(t===180)return"west";if(t>0&&t<90)return"south-east";if(t>90&&t<180)return"south-west";if(t>180&&t<270)return"north-west";if(t>270&&t<360)return"north-east";throw new Error(`Cannot determine direction of line (${this.p1.x},${this.p1.y}) to (${this.p2.x},${this.p2.y})`)}intersection(e){if(this.hasIndistinctPoints(e))return;const t=this.p1.x,i=this.p1.y,o=this.p2.x,r=this.p2.y,s=e.p1.x,a=e.p1.y,u=e.p2.x,h=e.p2.y,g=(h-a)*(o-t)-(u-s)*(r-i);if(g===0)return;const y=(u-s)*(i-a)-(h-a)*(t-s),S=(o-t)*(i-a)-(r-i)*(t-s);if(y===0&&S===0)return;const w=y/g,P=S/g;if(w<0||w>1||P<0||P>1)return;const E=t+w*(o-t),A=i+w*(r-i);return{x:E,y:A}}hasIndistinctPoints(e){return ip.Point.equals(this.p1,e.p1)||ip.Point.equals(this.p1,e.p2)||ip.Point.equals(this.p2,e.p1)||ip.Point.equals(this.p2,e.p2)}}ei.PointToPointLine=Bv;function Bue(n,e){return{x:(n.c*e.b-e.c*n.b)/(n.a*e.b-e.a*n.b),y:(n.a*e.c-e.a*n.c)/(n.a*e.b-e.a*n.b)}}ei.intersection=Bue;function $ue(n,e){return n<e.min?e.min:n>e.max?e.max:n}ei.limit=$ue;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.limitViewport=n.isViewport=n.viewportFeature=void 0;const e=Fr,t=ke,i=ei;n.viewportFeature=Symbol("viewportFeature");function o(s){return s instanceof t.SModelRootImpl&&s.hasFeature(n.viewportFeature)&&"zoom"in s&&"scroll"in s}n.isViewport=o;function r(s,a,u,h,g){a&&!e.Dimension.isValid(a)&&(a=void 0);let y=g?(0,i.limit)(s.zoom,g):s.zoom;if(a&&u){const P=a.width/(u.max-u.min);y<P&&(y=P)}if(a&&h){const P=a.height/(h.max-h.min);y<P&&(y=P)}let S;if(u){const P=u.min,E=a?u.max-a.width/y:u.max;S=(0,i.limit)(s.scroll.x,{min:P,max:E})}else S=s.scroll.x;let w;if(h){const P=h.min,E=a?h.max-a.height/y:h.max;w=(0,i.limit)(s.scroll.y,{min:P,max:E})}else w=s.scroll.y;return{scroll:{x:S,y:w},zoom:y}}n.limitViewport=r})(Rs);var y0={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isExportable=n.exportFeature=void 0,n.exportFeature=Symbol("exportFeature");function e(t){return t.hasFeature(n.exportFeature)}n.isExportable=e})(y0);Object.defineProperty(Ff,"__esModule",{value:!0});Ff.ViewportRootElementImpl=void 0;const av=Te,kue=ke,Fue=Rs,xue=y0;class DG extends kue.SModelRootImpl{constructor(e){super(e),this.scroll={x:0,y:0},this.zoom=1,this.position=av.Point.ORIGIN,this.size=av.Dimension.EMPTY}get bounds(){return{x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height}}set bounds(e){this.position={x:e.x,y:e.y},this.size={width:e.width,height:e.height}}localToParent(e){const t={x:(e.x-this.scroll.x)*this.zoom,y:(e.y-this.scroll.y)*this.zoom,width:-1,height:-1};return(0,av.isBounds)(e)&&(t.width=e.width*this.zoom,t.height=e.height*this.zoom),t}parentToLocal(e){const t={x:e.x/this.zoom+this.scroll.x,y:e.y/this.zoom+this.scroll.y,width:-1,height:-1};return(0,av.isBounds)(e)&&av.Dimension.isValid(e)&&(t.width=e.width/this.zoom,t.height=e.height/this.zoom),t}}Ff.ViewportRootElementImpl=DG;DG.DEFAULT_FEATURES=[Fue.viewportFeature,xue.exportFeature];Object.defineProperty(Sn,"__esModule",{value:!0});Sn.SGraphIndex=Sn.SCompartmentImpl=Sn.SLabelImpl=Sn.SEdgeImpl=Sn.SPortImpl=Sn.SNodeImpl=Sn.SGraphImpl=void 0;const Hue=Te,Kue=ke,rs=$t,Vue=$f,OG=jf,zue=kf,b0=Lf,aC=$u,Gue=xc,S0=an,q6=no,Uue=Ff,Yue=Io;class que extends Uue.ViewportRootElementImpl{constructor(e=new Hp){super(e)}}Sn.SGraphImpl=que;class LG extends S0.SConnectableElementImpl{constructor(){super(...arguments),this.selected=!1,this.hoverFeedback=!1,this.opacity=1}canConnect(e,t){return this.children.find(i=>i instanceof W6)===void 0}get incomingEdges(){const e=this.index;return e instanceof Hp?e.getIncomingEdges(this):this.index.all().filter(i=>i instanceof nu).filter(i=>i.targetId===this.id)}get outgoingEdges(){const e=this.index;return e instanceof Hp?e.getOutgoingEdges(this):this.index.all().filter(i=>i instanceof nu).filter(i=>i.sourceId===this.id)}}Sn.SNodeImpl=LG;LG.DEFAULT_FEATURES=[S0.connectableFeature,OG.deletableFeature,q6.selectFeature,rs.boundsFeature,Gue.moveFeature,rs.layoutContainerFeature,b0.fadeFeature,aC.hoverFeedbackFeature,aC.popupFeature];class W6 extends S0.SConnectableElementImpl{constructor(){super(...arguments),this.selected=!1,this.hoverFeedback=!1,this.opacity=1}get incomingEdges(){const e=this.index;return e instanceof Hp?e.getIncomingEdges(this):super.incomingEdges.filter(t=>t instanceof nu)}get outgoingEdges(){const e=this.index;return e instanceof Hp?e.getOutgoingEdges(this):super.outgoingEdges.filter(t=>t instanceof nu)}}Sn.SPortImpl=W6;W6.DEFAULT_FEATURES=[S0.connectableFeature,q6.selectFeature,rs.boundsFeature,b0.fadeFeature,aC.hoverFeedbackFeature];class nu extends S0.SRoutableElementImpl{constructor(){super(...arguments),this.selected=!1,this.hoverFeedback=!1,this.opacity=1}}Sn.SEdgeImpl=nu;nu.DEFAULT_FEATURES=[zue.editFeature,OG.deletableFeature,q6.selectFeature,b0.fadeFeature,aC.hoverFeedbackFeature];class jG extends rs.SShapeElementImpl{constructor(){super(...arguments),this.selected=!1,this.alignment=Hue.Point.ORIGIN,this.opacity=1}}Sn.SLabelImpl=jG;jG.DEFAULT_FEATURES=[rs.boundsFeature,rs.alignFeature,rs.layoutableChildFeature,Vue.edgeLayoutFeature,b0.fadeFeature];class NG extends rs.SShapeElementImpl{constructor(){super(...arguments),this.opacity=1}}Sn.SCompartmentImpl=NG;NG.DEFAULT_FEATURES=[rs.boundsFeature,rs.layoutContainerFeature,rs.layoutableChildFeature,b0.fadeFeature];class Hp extends Kue.ModelIndexImpl{constructor(){super(...arguments),this.outgoing=new Map,this.incoming=new Map}add(e){if(super.add(e),e instanceof nu){if(e.sourceId){const t=this.outgoing.get(e.sourceId);t===void 0?this.outgoing.set(e.sourceId,[e]):t.push(e)}if(e.targetId){const t=this.incoming.get(e.targetId);t===void 0?this.incoming.set(e.targetId,[e]):t.push(e)}}}remove(e){if(super.remove(e),e instanceof nu){const t=this.outgoing.get(e.sourceId);if(t!==void 0){const o=t.indexOf(e);o>=0&&(t.length===1?this.outgoing.delete(e.sourceId):t.splice(o,1))}const i=this.incoming.get(e.targetId);if(i!==void 0){const o=i.indexOf(e);o>=0&&(i.length===1?this.incoming.delete(e.targetId):i.splice(o,1))}}}getAttachedElements(e){return new Yue.FluentIterableImpl(()=>({outgoing:this.outgoing.get(e.id),incoming:this.incoming.get(e.id),nextOutgoingIndex:0,nextIncomingIndex:0}),t=>{let i=t.nextOutgoingIndex;if(t.outgoing!==void 0&&i<t.outgoing.length)return t.nextOutgoingIndex=i+1,{done:!1,value:t.outgoing[i]};if(i=t.nextIncomingIndex,t.incoming!==void 0)for(;i<t.incoming.length;){const o=t.incoming[i];if(o.sourceId!==o.targetId)return t.nextIncomingIndex=i+1,{done:!1,value:o};i++}return{done:!0,value:void 0}})}getIncomingEdges(e){return this.incoming.get(e.id)||[]}getOutgoingEdges(e){return this.outgoing.get(e.id)||[]}}Sn.SGraphIndex=Hp;var vi={},Hc={},Ra={};(function(n){var e=f&&f.__decorate||function(u,h,g,y){var S=arguments.length,w=S<3?h:y===null?y=Object.getOwnPropertyDescriptor(h,g):y,P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(u,h,g,y);else for(var E=u.length-1;E>=0;E--)(P=u[E])&&(w=(S<3?P(w):S>3?P(h,g,w):P(h,g))||w);return S>3&&w&&Object.defineProperty(h,g,w),w},t=f&&f.__metadata||function(u,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,h)},i=f&&f.__param||function(u,h){return function(g,y){h(g,y,u)}};Object.defineProperty(n,"__esModule",{value:!0}),n.AnchorComputerRegistry=n.RECTANGULAR_ANCHOR_KIND=n.ELLIPTIC_ANCHOR_KIND=n.DIAMOND_ANCHOR_KIND=void 0;const o=k,r=me,s=pn;n.DIAMOND_ANCHOR_KIND="diamond",n.ELLIPTIC_ANCHOR_KIND="elliptic",n.RECTANGULAR_ANCHOR_KIND="rectangular";let a=class extends s.InstanceRegistry{constructor(h){super(),h.forEach(g=>this.register(g.kind,g))}get defaultAnchorKind(){return n.RECTANGULAR_ANCHOR_KIND}get(h,g){return super.get(`${h}:${g||this.defaultAnchorKind}`)}};n.AnchorComputerRegistry=a,n.AnchorComputerRegistry=a=e([(0,o.injectable)(),i(0,(0,o.multiInject)(r.TYPES.IAnchorComputer)),t("design:paramtypes",[Array])],a)})(Ra);var Xo={},BG=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Wue=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Xo,"__esModule",{value:!0});Xo.AbstractEdgeRouter=Xo.DefaultAnchors=Xo.Side=void 0;const $G=k,po=Te,S2=yt,ci=an,f$=Ra,h$=an;var Et;(function(n){n[n.RIGHT=0]="RIGHT",n[n.LEFT=1]="LEFT",n[n.TOP=2]="TOP",n[n.BOTTOM=3]="BOTTOM"})(Et||(Xo.Side=Et={}));class E2{constructor(e,t,i){this.element=e,this.kind=i;const o=e.bounds;this.bounds=(0,S2.translateBounds)(o,e.parent,t),this.left={x:this.bounds.x,y:this.bounds.y+.5*this.bounds.height,kind:i},this.right={x:this.bounds.x+this.bounds.width,y:this.bounds.y+.5*this.bounds.height,kind:i},this.top={x:this.bounds.x+.5*this.bounds.width,y:this.bounds.y,kind:i},this.bottom={x:this.bounds.x+.5*this.bounds.width,y:this.bounds.y+this.bounds.height,kind:i}}get(e){return this[Et[e].toLowerCase()]}getNearestSide(e){const t=po.Point.euclideanDistance(e,this.left),i=po.Point.euclideanDistance(e,this.right),o=po.Point.euclideanDistance(e,this.top),r=po.Point.euclideanDistance(e,this.bottom);let s=Et.LEFT,a=t;return i<a&&(a=i,s=Et.RIGHT),o<a&&(a=o,s=Et.TOP),r<a&&(a=r,s=Et.BOTTOM),s}}Xo.DefaultAnchors=E2;let cC=class{findOrthogonalIntersection(e,t){const i=(u,h)=>{const g=po.Point.subtract(h,u),y=po.Point.subtract(t,u),S=po.Point.dotProduct(y,g)/po.Point.dotProduct(g,g);return S>=0&&S<=1?po.Point.linear(u,h,S):S<0?u:h},o=this.route(e);let r=o[0],s=0;for(let u=0;u<o.length-1;++u){const h=i(o[u],o[u+1]);po.Point.euclideanDistance(t,h)<po.Point.euclideanDistance(t,r)&&(r=h,s=u)}const a=po.Point.subtract(o[s+1],o[s]);return{point:r,derivative:a}}pointAt(e,t){const i=this.calculateSegment(e,t);if(!i)return;const{segmentStart:o,segmentEnd:r,lambda:s}=i;return po.Point.linear(o,r,s)}derivativeAt(e,t){const i=this.calculateSegment(e,t);if(!i)return;const{segmentStart:o,segmentEnd:r}=i;return{x:r.x-o.x,y:r.y-o.y}}calculateSegment(e,t){if(t<0||t>1)return;const i=this.route(e);if(i.length<2)return;const o=[];let r=0;for(let u=0;u<i.length-1;++u)o[u]=po.Point.euclideanDistance(i[u],i[u+1]),r+=o[u];let s=0;const a=t*r;for(let u=0;u<i.length-1;++u){const h=s+o[u];if(o[u]>1e-8&&h>=a){const g=Math.max(0,a-s)/o[u];return{segmentStart:i[u],segmentEnd:i[u+1],lambda:g}}s=h}return{segmentEnd:i.pop(),segmentStart:i.pop(),lambda:1}}addHandle(e,t,i,o){const r=new ci.SRoutingHandleImpl;return r.kind=t,r.pointIndex=o,r.type=i,t==="target"&&e.id===ci.edgeInProgressID&&(r.id=ci.edgeInProgressTargetHandleID),e.add(r),r}getHandlePosition(e,t,i){switch(i.kind){case"source":return e.source instanceof ci.SDanglingAnchorImpl?e.source.position:t[0];case"target":return e.target instanceof ci.SDanglingAnchorImpl?e.target.position:t[t.length-1];default:const o=this.getInnerHandlePosition(e,t,i);if(o!==void 0)return o;if(i.pointIndex>=0&&i.pointIndex<e.routingPoints.length)return e.routingPoints[i.pointIndex]}}findRouteSegment(e,t,i){const o=a=>a.pointIndex!==void 0?a.pointIndex:a.kind==="target"?e.routingPoints.length:-2;let r,s;for(const a of t){const u=o(a);u<=i&&(r===void 0||u>o(r))&&(r=a),u>i&&(s===void 0||u<o(s))&&(s=a)}return{start:r,end:s}}getTranslatedAnchor(e,t,i,o,r=0){const s=(0,S2.translatePoint)(t,i,e.parent),a=this.getAnchorComputer(e),u=.5*e.strokeWidth,h=a.getAnchor(e,s,r+u);return(0,S2.translatePoint)(h,e.parent,o.parent)}getAnchorComputer(e){return this.anchorRegistry.get(this.kind,e.anchorKind)}applyHandleMoves(e,t){const i=t.slice();t.forEach(o=>{const r=o.handle;if(r.kind==="source"&&!(e.source instanceof ci.SDanglingAnchorImpl)){const s=new ci.SDanglingAnchorImpl;s.id=e.id+"_dangling-source",s.original=e.source,s.position=o.toPosition,r.root.add(s),r.danglingAnchor=s,e.sourceId=s.id}else if(r.kind==="target"&&!(e.target instanceof ci.SDanglingAnchorImpl)){const s=new ci.SDanglingAnchorImpl;s.id=e.id+"_dangling-target",s.original=e.target,s.position=o.toPosition,r.root.add(s),r.danglingAnchor=s,e.targetId=s.id}r.danglingAnchor&&(r.danglingAnchor.position=o.toPosition,i.splice(i.indexOf(o),1))}),i.length>0&&this.applyInnerHandleMoves(e,i),this.cleanupRoutingPoints(e,e.routingPoints,!0,!0)}cleanupRoutingPoints(e,t,i,o){const r=new E2(e.source,e.parent,"source"),s=new E2(e.target,e.parent,"target");this.resetRoutingPointsOnReconnect(e,t,i,r,s)}resetRoutingPointsOnReconnect(e,t,i,o,r){if(t.length===0||e.source instanceof ci.SDanglingAnchorImpl||e.target instanceof ci.SDanglingAnchorImpl){const s=this.getOptions(e),a=this.calculateDefaultCorners(e,o,r,s);if(t.splice(0,t.length,...a),i){let u=-2;e.children.forEach(h=>{h instanceof ci.SRoutingHandleImpl&&(h.kind==="target"?h.pointIndex=t.length:h.kind==="line"&&h.pointIndex>=t.length?e.remove(h):u=Math.max(h.pointIndex,u))});for(let h=u;h<t.length-1;++h)this.addHandle(e,"manhattan-50%","volatile-routing-point",h)}return!0}return!1}applyReconnect(e,t,i){let o=!1;if(t){const r=e.root.index.getById(t);r instanceof h$.SConnectableElementImpl&&(e.sourceId=r.id,o=!0)}if(i){const r=e.root.index.getById(i);r instanceof h$.SConnectableElementImpl&&(e.targetId=r.id,o=!0)}if(o){if(e.index.remove(e),e.id===ci.edgeInProgressID){const r=h=>`${e.sourceId}_to_${e.targetId}_${h}`;let s=0,a=r(s);for(;e.index.getById(a)!==void 0;)a=r(++s);e.id=a;const u=e.children.find(h=>h.id===ci.edgeInProgressTargetHandleID);u instanceof ci.SRoutingHandleImpl&&(e.remove(u),u.danglingAnchor&&u.danglingAnchor.parent.remove(u.danglingAnchor))}e.index.add(e),this.getSelfEdgeIndex(e)>-1&&(e.routingPoints=[],this.cleanupRoutingPoints(e,e.routingPoints,!0,!0))}}takeSnapshot(e){return{routingPoints:e.routingPoints.slice(),routingHandles:e.children.filter(t=>t instanceof ci.SRoutingHandleImpl).map(t=>t),routedPoints:this.route(e),router:this,source:e.source,target:e.target}}applySnapshot(e,t){e.routingPoints=t.routingPoints,e.removeAll(i=>i instanceof ci.SRoutingHandleImpl),e.routerKind=t.router.kind,t.routingHandles.forEach(i=>e.add(i)),t.source&&(e.sourceId=t.source.id),t.target&&(e.targetId=t.target.id),e.root.index.remove(e),e.root.index.add(e)}calculateDefaultCorners(e,t,i,o){const r=this.getSelfEdgeIndex(e);if(r>=0){const s=o.standardDistance,a=o.selfEdgeOffset*Math.min(t.bounds.width,t.bounds.height);switch(r%4){case 0:return[{x:t.get(Et.RIGHT).x+s,y:t.get(Et.RIGHT).y+a},{x:t.get(Et.RIGHT).x+s,y:t.get(Et.BOTTOM).y+s},{x:t.get(Et.BOTTOM).x+a,y:t.get(Et.BOTTOM).y+s}];case 1:return[{x:t.get(Et.BOTTOM).x-a,y:t.get(Et.BOTTOM).y+s},{x:t.get(Et.LEFT).x-s,y:t.get(Et.BOTTOM).y+s},{x:t.get(Et.LEFT).x-s,y:t.get(Et.LEFT).y+a}];case 2:return[{x:t.get(Et.LEFT).x-s,y:t.get(Et.LEFT).y-a},{x:t.get(Et.LEFT).x-s,y:t.get(Et.TOP).y-s},{x:t.get(Et.TOP).x-a,y:t.get(Et.TOP).y-s}];case 3:return[{x:t.get(Et.TOP).x+a,y:t.get(Et.TOP).y-s},{x:t.get(Et.RIGHT).x+s,y:t.get(Et.TOP).y-s},{x:t.get(Et.RIGHT).x+s,y:t.get(Et.RIGHT).y-a}]}}return[]}getSelfEdgeIndex(e){return!e.source||e.source!==e.target?-1:e.source.outgoingEdges.filter(t=>t.target===e.source).indexOf(e)}commitRoute(e,t){const i=[];for(let o=1;o<t.length-1;++o)i.push({x:t[o].x,y:t[o].y});e.routingPoints=i}};Xo.AbstractEdgeRouter=cC;BG([(0,$G.inject)(f$.AnchorComputerRegistry),Wue("design:type",f$.AnchorComputerRegistry)],cC.prototype,"anchorRegistry",void 0);Xo.AbstractEdgeRouter=cC=BG([(0,$G.injectable)()],cC);var kG=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Zue=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},C2;Object.defineProperty(Hc,"__esModule",{value:!0});Hc.PolylineEdgeRouter=void 0;const FG=k,Nh=Te,p$=an,m$=Ra,Que=Xo;let H_=C2=class extends Que.AbstractEdgeRouter{get kind(){return C2.KIND}getOptions(e){return{minimalPointDistance:2,removeAngleThreshold:.1,standardDistance:20,selfEdgeOffset:.25}}route(e){const t=e.source,i=e.target;if(t===void 0||i===void 0)return[];let o,r;const s=this.getOptions(e),a=e.routingPoints.length>0?e.routingPoints:[];this.cleanupRoutingPoints(e,a,!1,!1);const u=a!==void 0?a.length:0;if(u===0){const g=Nh.Bounds.center(i.bounds);o=this.getTranslatedAnchor(t,g,i.parent,e,e.sourceAnchorCorrection);const y=Nh.Bounds.center(t.bounds);r=this.getTranslatedAnchor(i,y,t.parent,e,e.targetAnchorCorrection)}else{const g=a[0];o=this.getTranslatedAnchor(t,g,e.parent,e,e.sourceAnchorCorrection);const y=a[u-1];r=this.getTranslatedAnchor(i,y,e.parent,e,e.targetAnchorCorrection)}const h=[];h.push({kind:"source",x:o.x,y:o.y});for(let g=0;g<u;g++){const y=a[g];(g>0&&g<u-1||g===0&&Nh.Point.maxDistance(o,y)>=s.minimalPointDistance+(e.sourceAnchorCorrection||0)||g===u-1&&Nh.Point.maxDistance(y,r)>=s.minimalPointDistance+(e.targetAnchorCorrection||0))&&h.push({kind:"linear",x:y.x,y:y.y,pointIndex:g})}return h.push({kind:"target",x:r.x,y:r.y}),this.filterEditModeHandles(h,e,s)}filterEditModeHandles(e,t,i){if(t.children.length===0)return e;let o=0;for(;o<e.length;){const r=e[o];if(r.pointIndex!==void 0){const s=t.children.find(a=>a instanceof p$.SRoutingHandleImpl&&a.kind==="junction"&&a.pointIndex===r.pointIndex);if(s!==void 0&&s.editMode&&o>0&&o<e.length-1){const a=e[o-1],u=e[o+1],h={x:a.x-r.x,y:a.y-r.y},g={x:u.x-r.x,y:u.y-r.y},y=(0,Nh.angleBetweenPoints)(h,g);if(Math.abs(Math.PI-y)<i.removeAngleThreshold){e.splice(o,1);continue}}}o++}return e}createRoutingHandles(e){const t=e.routingPoints.length;this.addHandle(e,"source","routing-point",-2),this.addHandle(e,"line","volatile-routing-point",-1);for(let i=0;i<t;i++)this.addHandle(e,"junction","routing-point",i),this.addHandle(e,"line","volatile-routing-point",i);this.addHandle(e,"target","routing-point",t)}getInnerHandlePosition(e,t,i){if(i.kind==="line"){const{start:o,end:r}=this.findRouteSegment(e,t,i.pointIndex);if(o!==void 0&&r!==void 0)return(0,Nh.centerOfLine)(o,r)}}applyInnerHandleMoves(e,t){t.forEach(i=>{const o=i.handle,r=e.routingPoints;let s=o.pointIndex;o.kind==="line"&&(o.kind="junction",o.type="routing-point",r.splice(s+1,0,i.fromPosition||r[Math.max(s,0)]),e.children.forEach(a=>{a instanceof p$.SRoutingHandleImpl&&(a===o||a.pointIndex>s)&&a.pointIndex++}),this.addHandle(e,"line","volatile-routing-point",s),s++,this.addHandle(e,"line","volatile-routing-point",s)),s>=0&&s<r.length&&(r[s]=i.toPosition)})}};Hc.PolylineEdgeRouter=H_;H_.KIND="polyline";kG([(0,FG.inject)(m$.AnchorComputerRegistry),Zue("design:type",m$.AnchorComputerRegistry)],H_.prototype,"anchorRegistry",void 0);Hc.PolylineEdgeRouter=H_=C2=kG([(0,FG.injectable)()],H_);var xG=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},HG=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Xue=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(vi,"__esModule",{value:!0});vi.EdgeRouting=vi.EdgeRouterRegistry=void 0;const dC=k,Jue=ke,KG=me,ele=rn,tle=pn,nle=an,ile=Hc;function ole(n){return n.routeAll!==void 0}let uC=class extends tle.InstanceRegistry{constructor(e){super(),e.forEach(t=>this.register(t.kind,t))}get defaultKind(){return ile.PolylineEdgeRouter.KIND}get(e){return super.get(e||this.defaultKind)}routeAllChildren(e){const t=this.doRouteAllChildren(e);for(const i of this.postProcessors)i.apply(t,e);return t}doRouteAllChildren(e){const t=new VG,i=new Map,o=[e];for(;o.length>0;){const r=o.shift();for(const s of r.children){if(s instanceof nle.SRoutableElementImpl){const a=s.routerKind||this.defaultKind;i.has(a)?i.get(a).push(s):i.set(a,[s])}s instanceof Jue.SParentElementImpl&&o.push(s)}}return i.forEach((r,s)=>{const a=this.get(s);if(ole(a))t.setAll(a.routeAll(r,e));else for(const u of r)t.set(u.id,this.route(u))}),t}route(e,t){const i=(0,ele.findArgValue)(t,"edgeRouting");if(i){const r=i.get(e.id);if(r)return r}return this.get(e.routerKind).route(e)}};vi.EdgeRouterRegistry=uC;xG([(0,dC.multiInject)(KG.TYPES.IEdgeRoutePostprocessor),(0,dC.optional)(),HG("design:type",Array)],uC.prototype,"postProcessors",void 0);vi.EdgeRouterRegistry=uC=xG([(0,dC.injectable)(),Xue(0,(0,dC.multiInject)(KG.TYPES.IEdgeRouter)),HG("design:paramtypes",[Array])],uC);class VG{constructor(){this.routesMap=new Map}set(e,t){this.routesMap.set(e,t)}setAll(e){e.routes.forEach((t,i)=>this.set(i,t))}get(e){return this.routesMap.get(e)}get routes(){return this.routesMap}}vi.EdgeRouting=VG;var Z6=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},zG=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Bf,"__esModule",{value:!0});Bf.EdgeLayoutPostprocessor=void 0;const Q6=k,di=Te,rle=ke,sle=ft,ale=Sn,aE=$t,eT=$f,g$=vi,cle=me;let K_=class{decorate(e,t){var i,o;if((0,eT.isEdgeLayoutable)(t)&&t.parent instanceof ale.SEdgeImpl&&t.bounds!==di.Bounds.EMPTY){const r=t.bounds,s=(0,eT.checkEdgePlacement)(t),a=this.getEdgePlacement(t),u=t.parent,h=Math.min(1,Math.max(0,a.position)),g=this.edgeRouterRegistry.get(u.routerKind),y=g.pointAt(u,h);let S="";const w=`translate(${((i=y==null?void 0:y.x)!==null&&i!==void 0?i:0)+r.x}, ${((o=y==null?void 0:y.y)!==null&&o!==void 0?o:0)+r.y})`;if(s){if(y){let P;if(a.moveMode&&a.moveMode!=="edge")P=g.derivativeAt(u,h),a.moveMode==="free"?S+=w:S+=`translate(${y.x}, ${y.y})`;else{const E=g.findOrthogonalIntersection(u,di.Point.add(y,r));E&&(P=E.derivative,S+=`translate(${E.point.x}, ${E.point.y})`)}if(P){const E=(0,di.toDegrees)(Math.atan2(P.y,P.x));if(a.rotate){let A=E;Math.abs(E)>90&&(E<0?A+=180:E>0&&(A-=180)),S+=` rotate(${A})`;const L=this.getRotatedAlignment(t,a,A!==E);S+=` translate(${L.x}, ${L.y})`}else{const A=this.getAlignment(t,a,E);S+=` translate(${A.x}, ${A.y})`}}}}else S+=w;(0,sle.setAttr)(e,"transform",S)}return e}getRotatedAlignment(e,t,i){let o=(0,aE.isAlignable)(e)?e.alignment.x:0,r=(0,aE.isAlignable)(e)?e.alignment.y:0;const s=e.bounds;if(t.side==="on")return{x:o-.5*s.height,y:r-.5*s.height};if(i)switch(t.position<.3333333?o-=s.width+t.offset:t.position<.6666666?o-=.5*s.width:o+=t.offset,t.side){case"left":case"bottom":r-=t.offset+s.height;break;case"right":case"top":r+=t.offset}else switch(t.position<.3333333?o+=t.offset:t.position<.6666666?o-=.5*s.width:o-=s.width+t.offset,t.side){case"right":case"bottom":r+=-t.offset-s.height;break;case"left":case"top":r+=t.offset}return{x:o,y:r}}getEdgePlacement(e){let t=e;const i=[];for(;t!==void 0;){const o=t.edgePlacement;if(o!==void 0&&i.push(o),t instanceof rle.SChildElementImpl)t=t.parent;else break}return i.reverse().reduce((o,r)=>Object.assign(Object.assign({},o),r),eT.DEFAULT_EDGE_PLACEMENT)}getAlignment(e,t,i){const o=e.bounds,r=(0,aE.isAlignable)(e)?e.alignment.x-o.width:0,s=(0,aE.isAlignable)(e)?e.alignment.y-o.height:0;if(t.side==="on")return{x:r+.5*o.width,y:s+.5*o.height};const a=this.getQuadrant(i),u={x:t.offset,y:s+.5*o.height},h={x:t.offset,y:s+o.height+t.offset},g={x:-o.width-t.offset,y:s+o.height+t.offset},y={x:-o.width-t.offset,y:s+.5*o.height},S={x:-o.width-t.offset,y:s-t.offset},w={x:t.offset,y:s-t.offset};switch(t.side){case"left":switch(a.orientation){case"west":return di.Point.linear(h,g,a.position);case"north":return di.Point.linear(g,S,a.position);case"east":return di.Point.linear(S,w,a.position);case"south":return di.Point.linear(w,h,a.position)}break;case"right":switch(a.orientation){case"west":return di.Point.linear(S,w,a.position);case"north":return di.Point.linear(w,h,a.position);case"east":return di.Point.linear(h,g,a.position);case"south":return di.Point.linear(g,S,a.position)}break;case"top":switch(a.orientation){case"west":return di.Point.linear(S,w,a.position);case"north":return this.linearFlip(w,u,y,S,a.position);case"east":return di.Point.linear(S,w,a.position);case"south":return this.linearFlip(w,u,y,S,a.position)}break;case"bottom":switch(a.orientation){case"west":return di.Point.linear(h,g,a.position);case"north":return this.linearFlip(g,y,u,h,a.position);case"east":return di.Point.linear(h,g,a.position);case"south":return this.linearFlip(g,y,u,h,a.position)}break}return{x:0,y:0}}getQuadrant(e){return Math.abs(e)>135?{orientation:"west",position:(e>0?e-135:e+225)/90}:e<-45?{orientation:"north",position:(e+135)/90}:e<45?{orientation:"east",position:(e+45)/90}:{orientation:"south",position:(e-45)/90}}linearFlip(e,t,i,o,r){return r<.5?di.Point.linear(e,t,2*r):di.Point.linear(i,o,2*r-1)}postUpdate(){}};Bf.EdgeLayoutPostprocessor=K_;Z6([(0,Q6.inject)(g$.EdgeRouterRegistry),zG("design:type",g$.EdgeRouterRegistry)],K_.prototype,"edgeRouterRegistry",void 0);Z6([(0,Q6.inject)(cle.TYPES.ILogger),zG("design:type",Object)],K_.prototype,"logger",void 0);Bf.EdgeLayoutPostprocessor=K_=Z6([(0,Q6.injectable)()],K_);Object.defineProperty(Vl,"__esModule",{value:!0});const dle=k,v$=me,tT=Bf,ule=new dle.ContainerModule(n=>{n(tT.EdgeLayoutPostprocessor).toSelf().inSingletonScope(),n(v$.TYPES.IVNodePostprocessor).toService(tT.EdgeLayoutPostprocessor),n(v$.TYPES.HiddenVNodePostprocessor).toService(tT.EdgeLayoutPostprocessor)});Vl.default=ule;var E0={},lle=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},fle=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},hle=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(E0,"__esModule",{value:!0});E0.CreateElementCommand=void 0;const _$=k,ple=se,mle=ze,gle=ke,vle=me;let lC=class extends mle.Command{constructor(e){super(),this.action=e}execute(e){const t=e.root.index.getById(this.action.containerId);return t instanceof gle.SParentElementImpl&&(this.container=t,this.newElement=e.modelFactory.createElement(this.action.elementSchema),this.container.add(this.newElement)),e.root}undo(e){return this.container.remove(this.newElement),e.root}redo(e){return this.container.add(this.newElement),e.root}};E0.CreateElementCommand=lC;lC.KIND=ple.CreateElementAction.KIND;E0.CreateElementCommand=lC=lle([(0,_$.injectable)(),hle(0,(0,_$.inject)(vle.TYPES.Action)),fle("design:paramtypes",[Object])],lC);var X6={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isCreatingOnDrag=n.creatingOnDragFeature=void 0,n.creatingOnDragFeature=Symbol("creatingOnDragFeature");function e(t){return t.hasFeature(n.creatingOnDragFeature)&&t.createAction!==void 0}n.isCreatingOnDrag=e})(X6);var ta={},zn={},C0=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(zn,"__esModule",{value:!0});zn.EmptyGroupView=zn.DiamondNodeView=zn.RectangularNodeView=zn.CircularNodeView=zn.SvgViewportView=void 0;const dc=ti,Kp=Sn,J6=Fc,_le=ei,P0=k;let P2=class{render(e,t,i){const o=`scale(${e.zoom}) translate(${-e.scroll.x},${-e.scroll.y})`;return(0,dc.svg)("svg",null,(0,dc.svg)("g",{transform:o},t.renderChildren(e)))}};zn.SvgViewportView=P2;zn.SvgViewportView=P2=C0([(0,P0.injectable)()],P2);let w2=class extends J6.ShapeView{render(e,t,i){if(!this.isVisible(e,t))return;const o=this.getRadius(e);return(0,dc.svg)("g",null,(0,dc.svg)("circle",{"class-sprotty-node":e instanceof Kp.SNodeImpl,"class-sprotty-port":e instanceof Kp.SPortImpl,"class-mouseover":e.hoverFeedback,"class-selected":e.selected,r:o,cx:o,cy:o}),t.renderChildren(e))}getRadius(e){const t=Math.min(e.size.width,e.size.height);return t>0?t/2:0}};zn.CircularNodeView=w2;zn.CircularNodeView=w2=C0([(0,P0.injectable)()],w2);let A2=class extends J6.ShapeView{render(e,t,i){if(this.isVisible(e,t))return(0,dc.svg)("g",null,(0,dc.svg)("rect",{"class-sprotty-node":e instanceof Kp.SNodeImpl,"class-sprotty-port":e instanceof Kp.SPortImpl,"class-mouseover":e.hoverFeedback,"class-selected":e.selected,x:"0",y:"0",width:Math.max(e.size.width,0),height:Math.max(e.size.height,0)}),t.renderChildren(e))}};zn.RectangularNodeView=A2;zn.RectangularNodeView=A2=C0([(0,P0.injectable)()],A2);let R2=class extends J6.ShapeView{render(e,t,i){if(!this.isVisible(e,t))return;const o=new _le.Diamond({height:Math.max(e.size.height,0),width:Math.max(e.size.width,0),x:0,y:0}),r=`${cE(o.topPoint)} ${cE(o.rightPoint)} ${cE(o.bottomPoint)} ${cE(o.leftPoint)}`;return(0,dc.svg)("g",null,(0,dc.svg)("polygon",{"class-sprotty-node":e instanceof Kp.SNodeImpl,"class-sprotty-port":e instanceof Kp.SPortImpl,"class-mouseover":e.hoverFeedback,"class-selected":e.selected,points:r}),t.renderChildren(e))}};zn.DiamondNodeView=R2;zn.DiamondNodeView=R2=C0([(0,P0.injectable)()],R2);function cE(n){return`${n.x},${n.y}`}let M2=class{render(e,t){return(0,dc.svg)("g",null)}};zn.EmptyGroupView=M2;zn.EmptyGroupView=M2=C0([(0,P0.injectable)()],M2);var _n={},yle=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},ble=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Sle=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(_n,"__esModule",{value:!0});_n.getEditableLabel=_n.EditLabelKeyListener=_n.EditLabelMouseListener=_n.ApplyLabelEditCommand=_n.ResolvedLabelEdit=_n.isApplyLabelEditAction=_n.isEditLabelAction=_n.EditLabelAction=void 0;const Ele=k,fC=se,Cle=ze,Ple=me,wle=Ut,Ale=gi,Rle=qt,Mle=no,Ile=Io,I2=kf;var V_;(function(n){n.KIND="EditLabel";function e(t){return{kind:n.KIND,labelId:t}}n.create=e})(V_||(_n.EditLabelAction=V_={}));function Tle(n){return(0,fC.isAction)(n)&&n.kind===V_.KIND&&"labelId"in n}_n.isEditLabelAction=Tle;function Dle(n){return(0,fC.isAction)(n)&&n.kind===fC.ApplyLabelEditAction.KIND&&"labelId"in n&&"text"in n}_n.isApplyLabelEditAction=Dle;class Ole{}_n.ResolvedLabelEdit=Ole;let hC=class extends Cle.Command{constructor(e){super(),this.action=e}execute(e){const i=e.root.index.getById(this.action.labelId);return i&&(0,I2.isEditableLabel)(i)&&(this.resolvedLabelEdit={label:i,oldLabel:i.text,newLabel:this.action.text},i.text=this.action.text),e.root}undo(e){return this.resolvedLabelEdit&&(this.resolvedLabelEdit.label.text=this.resolvedLabelEdit.oldLabel),e.root}redo(e){return this.resolvedLabelEdit&&(this.resolvedLabelEdit.label.text=this.resolvedLabelEdit.newLabel),e.root}};_n.ApplyLabelEditCommand=hC;hC.KIND=fC.ApplyLabelEditAction.KIND;_n.ApplyLabelEditCommand=hC=yle([Sle(0,(0,Ele.inject)(Ple.TYPES.Action)),ble("design:paramtypes",[Object])],hC);class Lle extends wle.MouseListener{doubleClick(e,t){const i=e7(e);return i?[V_.create(i.id)]:[]}}_n.EditLabelMouseListener=Lle;class jle extends Ale.KeyListener{keyDown(e,t){if((0,Rle.matchesKeystroke)(t,"F2")){const i=(0,Ile.toArray)(e.index.all().filter(o=>(0,Mle.isSelectable)(o)&&o.selected)).map(e7).filter(o=>o!==void 0);if(i.length===1)return[V_.create(i[0].id)]}return[]}}_n.EditLabelKeyListener=jle;function e7(n){if((0,I2.isEditableLabel)(n))return n;if((0,I2.isWithEditableLabel)(n)&&n.editableLabel)return n.editableLabel}_n.getEditableLabel=e7;var ca={},vs={},rr={},sr={},pA=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},t7=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(sr,"__esModule",{value:!0});sr.SvgExporter=sr.ExportSvgAction=void 0;const mA=k,y$=Te,Nle=$t,Ble=ju,n7=me;var T2;(function(n){n.KIND="exportSvg";function e(t,i){return{kind:n.KIND,svg:t,responseId:i}}n.create=e})(T2||(sr.ExportSvgAction=T2={}));let Vp=class{export(e,t){if(typeof document<"u"){const i=document.getElementById(this.options.hiddenDiv);if(i===null){this.log.warn(this,`Element with id ${this.options.hiddenDiv} not found. Nothing to export.`);return}const o=i.querySelector("svg");if(o===null){this.log.warn(this,`No svg element found in ${this.options.hiddenDiv} div. Nothing to export.`);return}const r=this.createSvg(o,e);this.actionDispatcher.dispatch(T2.create(r,t?t.requestId:""))}}createSvg(e,t){const i=new XMLSerializer,o=i.serializeToString(e),r=document.createElement("iframe");if(document.body.appendChild(r),!r.contentWindow)throw new Error("IFrame has no contentWindow");const s=r.contentWindow.document;s.open(),s.write(o),s.close();const a=s.querySelector("svg");a.removeAttribute("opacity"),this.copyStyles(e,a,["width","height","opacity","inline-size"]),a.setAttribute("version","1.1");const u=this.getBounds(t);a.setAttribute("viewBox",`${u.x} ${u.y} ${u.width} ${u.height}`);const h=i.serializeToString(a);return document.body.removeChild(r),h}copyStyles(e,t,i){const o=getComputedStyle(e),r=getComputedStyle(t);let s="";for(let a=0;a<o.length;a++){const u=o[a];if(i.indexOf(u)===-1){const h=o.getPropertyValue(u);r.getPropertyValue(u)!==h&&(s+=u+":"+h+";")}}s!==""&&t.setAttribute("style",s);for(let a=0;a<e.childNodes.length;++a){const u=e.childNodes[a],h=t.childNodes[a];u instanceof Element&&this.copyStyles(u,h,[])}}getBounds(e){const t=[y$.Bounds.EMPTY];return e.children.forEach(i=>{(0,Nle.isBoundsAware)(i)&&t.push(i.bounds)}),t.reduce((i,o)=>y$.Bounds.combine(i,o))}};sr.SvgExporter=Vp;pA([(0,mA.inject)(n7.TYPES.ViewerOptions),t7("design:type",Object)],Vp.prototype,"options",void 0);pA([(0,mA.inject)(n7.TYPES.IActionDispatcher),t7("design:type",Ble.ActionDispatcher)],Vp.prototype,"actionDispatcher",void 0);pA([(0,mA.inject)(n7.TYPES.ILogger),t7("design:type",Object)],Vp.prototype,"log",void 0);sr.SvgExporter=Vp=pA([(0,mA.injectable)()],Vp);var gA=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},GG=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(rr,"__esModule",{value:!0});rr.ComputedBoundsApplicator=rr.ModelSource=void 0;const vA=k,$le=se,kle=Nn,UG=me,Fle=sr;let z_=class{initialize(e){e.register($le.RequestModelAction.KIND,this),e.register(Fle.ExportSvgAction.KIND,this)}};rr.ModelSource=z_;gA([(0,vA.inject)(UG.TYPES.IActionDispatcher),GG("design:type",Object)],z_.prototype,"actionDispatcher",void 0);gA([(0,vA.inject)(UG.TYPES.ViewerOptions),GG("design:type",Object)],z_.prototype,"viewerOptions",void 0);rr.ModelSource=z_=gA([(0,vA.injectable)()],z_);let D2=class{apply(e,t){const i=new kle.SModelIndex;i.add(e);for(const o of t.bounds){const r=i.getById(o.elementId);r!==void 0&&this.applyBounds(r,o.newPosition,o.newSize)}if(t.alignments!==void 0)for(const o of t.alignments){const r=i.getById(o.elementId);r!==void 0&&this.applyAlignment(r,o.newAlignment)}return i}applyAlignment(e,t){const i=e;i.alignment={x:t.x,y:t.y}}applyBounds(e,t,i){const o=e;t&&(o.position=Object.assign({},t)),o.size=Object.assign({},i)}};rr.ComputedBoundsApplicator=D2;rr.ComputedBoundsApplicator=D2=gA([(0,vA.injectable)()],D2);var YG=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},qG=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},xle=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(vs,"__esModule",{value:!0});vs.CommitModelCommand=vs.CommitModelAction=void 0;const O2=k,Hle=ze,WG=me,Kle=rr;var L2;(function(n){n.KIND="commitModel";function e(){return{kind:n.KIND}}n.create=e})(L2||(vs.CommitModelAction=L2={}));let G_=class extends Hle.SystemCommand{constructor(e){super(),this.action=e}execute(e){return this.newModel=e.modelFactory.createSchema(e.root),this.doCommit(this.newModel,e.root,!0)}doCommit(e,t,i){const o=this.modelSource.commitModel(e);return o instanceof Promise?o.then(r=>(i&&(this.originalModel=r),t)):(i&&(this.originalModel=o),t)}undo(e){return this.doCommit(this.originalModel,e.root,!1)}redo(e){return this.doCommit(this.newModel,e.root,!1)}};vs.CommitModelCommand=G_;G_.KIND=L2.KIND;YG([(0,O2.inject)(WG.TYPES.ModelSource),qG("design:type",Kle.ModelSource)],G_.prototype,"modelSource",void 0);vs.CommitModelCommand=G_=YG([(0,O2.injectable)(),xle(0,(0,O2.inject)(WG.TYPES.Action)),qG("design:paramtypes",[Object])],G_);var uc={},Vle=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},zle=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(uc,"__esModule",{value:!0});uc.ZoomMouseListener=uc.getZoom=void 0;const Gle=k,Ule=se,b$=Te,ZG=yt,Yle=me,qle=Ut,Wle=sn,QG=Rs,Zle=ei;function Qle(n){let e=1;const t=(0,ZG.findParentByFeature)(n,QG.isViewport);return t&&(e=t.zoom),e}uc.getZoom=Qle;class XG extends qle.MouseListener{wheel(e,t){const i=(0,ZG.findParentByFeature)(e,QG.isViewport);if(!i)return[];const o=this.isScrollMode(t)?this.processScroll(i,t):this.processZoom(i,e,t);return o?[Ule.SetViewportAction.create(i.id,o,{animate:!1})]:[]}isScrollMode(e){return e.altKey}processScroll(e,t){return{scroll:{x:e.scroll.x+t.deltaX,y:e.scroll.y+t.deltaY},zoom:e.zoom}}processZoom(e,t,i){const o=this.getZoomFactor(i);if(o>1&&(0,b$.almostEquals)(e.zoom,this.viewerOptions.zoomLimits.max)||o<1&&(0,b$.almostEquals)(e.zoom,this.viewerOptions.zoomLimits.min))return;const r=(0,Zle.limit)(e.zoom*o,this.viewerOptions.zoomLimits),s=this.getViewportOffset(t.root,i),a=1/r-1/e.zoom;return{scroll:{x:e.scroll.x-a*s.x,y:e.scroll.y-a*s.y},zoom:r}}getViewportOffset(e,t){const i=e.canvasBounds,o=(0,Wle.getWindowScroll)();return{x:t.clientX+o.x-i.x,y:t.clientY+o.y-i.y}}getZoomFactor(e){return e.deltaMode===e.DOM_DELTA_PAGE?Math.exp(-e.deltaY*.5):e.deltaMode===e.DOM_DELTA_LINE?Math.exp(-e.deltaY*.05):Math.exp(-e.deltaY*.005)}}uc.ZoomMouseListener=XG;Vle([(0,Gle.inject)(Yle.TYPES.ViewerOptions),zle("design:type",Object)],XG.prototype,"viewerOptions",void 0);var xf=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},w0=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},j2;Object.defineProperty(ca,"__esModule",{value:!0});ca.EditLabelUI=ca.EditLabelActionHandler=void 0;const lc=k,Xle=se,A0=me,Jle=aa,efe=Po,tfe=Aa,nfe=vs,S$=qt,ife=$t,E$=uc,ofe=_n,rfe=kf;let N2=class{handle(e){if((0,ofe.isEditLabelAction)(e))return efe.SetUIExtensionVisibilityAction.create({extensionId:da.ID,visible:!0,contextElementsId:[e.labelId]})}};ca.EditLabelActionHandler=N2;ca.EditLabelActionHandler=N2=xf([(0,lc.injectable)()],N2);let da=j2=class extends Jle.AbstractUIExtension{constructor(){super(...arguments),this.validationTimeout=void 0,this.isActive=!1,this.blockApplyEditOnInvalidInput=!0,this.isCurrentLabelValid=!0}id(){return j2.ID}containerClass(){return"label-edit"}get labelId(){return this.label?this.label.id:"unknown"}initializeContents(e){e.style.position="absolute",this.inputElement=document.createElement("input"),this.textAreaElement=document.createElement("textarea"),[this.inputElement,this.textAreaElement].forEach(t=>{t.onkeydown=i=>this.applyLabelEditOnEvent(i,"Enter"),this.configureAndAdd(t,e)})}configureAndAdd(e,t){e.style.visibility="hidden",e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.addEventListener("keydown",i=>this.hideIfEscapeEvent(i)),e.addEventListener("keyup",i=>this.validateLabelIfContentChange(i,e.value)),e.addEventListener("blur",()=>window.setTimeout(()=>this.applyLabelEdit(),200)),t.appendChild(e)}get editControl(){return this.label&&this.label.isMultiLine?this.textAreaElement:this.inputElement}hideIfEscapeEvent(e){(0,S$.matchesKeystroke)(e,"Escape")&&this.hide()}applyLabelEditOnEvent(e,t,...i){(0,S$.matchesKeystroke)(e,t||"Enter",...i)&&(e.preventDefault(),this.applyLabelEdit())}validateLabelIfContentChange(e,t){(this.previousLabelContent===void 0||this.previousLabelContent!==t)&&(this.previousLabelContent=t,this.performLabelValidation(e,this.editControl.value))}async applyLabelEdit(){var e;if(this.isActive){if(((e=this.label)===null||e===void 0?void 0:e.text)===this.editControl.value){this.hide();return}if(this.blockApplyEditOnInvalidInput&&(await this.validateLabel(this.editControl.value)).severity==="error"){this.editControl.focus();return}this.actionDispatcherProvider().then(t=>t.dispatchAll([Xle.ApplyLabelEditAction.create(this.labelId,this.editControl.value),nfe.CommitModelAction.create()])).catch(t=>this.logger.error(this,"No action dispatcher available to execute apply label edit action",t)),this.hide()}}performLabelValidation(e,t){this.validationTimeout&&window.clearTimeout(this.validationTimeout),this.validationTimeout=window.setTimeout(()=>this.validateLabel(t),200)}async validateLabel(e){if(this.labelValidator&&this.label)try{const t=await this.labelValidator.validate(e,this.label);return this.isCurrentLabelValid=t.severity!=="error",this.showValidationResult(t),t}catch(t){this.logger.error(this,"Error validating edited label",t)}return this.isCurrentLabelValid=!0,{severity:"ok",message:void 0}}showValidationResult(e){this.clearValidationResult(),this.validationDecorator&&this.validationDecorator.decorate(this.editControl,e)}clearValidationResult(){this.validationDecorator&&this.validationDecorator.dispose(this.editControl)}show(e,...t){!sfe(t,e)||this.isActive||(super.show(e,...t),this.isActive=!0)}hide(){this.editControl.style.visibility="hidden",super.hide(),this.clearValidationResult(),this.isActive=!1,this.isCurrentLabelValid=!0,this.previousLabelContent=void 0,this.labelElement&&(this.labelElement.style.visibility="visible")}onBeforeShow(e,t,...i){this.label=JG(i,t)[0],this.previousLabelContent=this.label.text,this.setPosition(e),this.applyTextContents(),this.applyFontStyling(),this.editControl.style.visibility="visible",this.editControl.focus()}setPosition(e){let t=0,i=0,o=100,r=20;if(this.label){const s=(0,E$.getZoom)(this.label),a=(0,ife.getAbsoluteClientBounds)(this.label,this.domHelper,this.viewerOptions);t=a.x+(this.label.editControlPositionCorrection?this.label.editControlPositionCorrection.x:0)*s,i=a.y+(this.label.editControlPositionCorrection?this.label.editControlPositionCorrection.y:0)*s,r=(this.label.editControlDimension?this.label.editControlDimension.height:r)*s,o=(this.label.editControlDimension?this.label.editControlDimension.width:o)*s}e.style.left=`${t}px`,e.style.top=`${i}px`,e.style.width=`${o}px`,this.editControl.style.width=`${o}px`,e.style.height=`${r}px`,this.editControl.style.height=`${r}px`}applyTextContents(){this.label&&(this.editControl.value=this.label.text,this.editControl instanceof HTMLTextAreaElement?(this.editControl.selectionStart=0,this.editControl.selectionEnd=0,this.editControl.scrollTop=0,this.editControl.scrollLeft=0):this.editControl.setSelectionRange(0,this.editControl.value.length))}applyFontStyling(){if(this.label&&(this.labelElement=document.getElementById(this.domHelper.createUniqueDOMElementId(this.label)),this.labelElement)){this.labelElement.style.visibility="hidden";const e=window.getComputedStyle(this.labelElement);this.editControl.style.font=e.font,this.editControl.style.fontStyle=e.fontStyle,this.editControl.style.fontFamily=e.fontFamily,this.editControl.style.fontSize=afe(e.fontSize,(0,E$.getZoom)(this.label)),this.editControl.style.fontWeight=e.fontWeight,this.editControl.style.lineHeight=e.lineHeight}}};ca.EditLabelUI=da;da.ID="editLabelUi";xf([(0,lc.inject)(A0.TYPES.IActionDispatcherProvider),w0("design:type",Function)],da.prototype,"actionDispatcherProvider",void 0);xf([(0,lc.inject)(A0.TYPES.ViewerOptions),w0("design:type",Object)],da.prototype,"viewerOptions",void 0);xf([(0,lc.inject)(A0.TYPES.DOMHelper),w0("design:type",tfe.DOMHelper)],da.prototype,"domHelper",void 0);xf([(0,lc.inject)(A0.TYPES.IEditLabelValidator),(0,lc.optional)(),w0("design:type",Object)],da.prototype,"labelValidator",void 0);xf([(0,lc.inject)(A0.TYPES.IEditLabelValidationDecorator),(0,lc.optional)(),w0("design:type",Object)],da.prototype,"validationDecorator",void 0);ca.EditLabelUI=da=j2=xf([(0,lc.injectable)()],da);function sfe(n,e){return JG(n,e).length===1}function JG(n,e){return n.map(t=>e.index.getById(t)).filter(rfe.isEditableLabel)}function afe(n,e){return n.replace(/\d+(\.\d+)?/,t=>String(Number.parseInt(t,10)*e))}var _s={},eU=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},tU=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},cfe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(_s,"__esModule",{value:!0});_s.SwitchEditModeCommand=_s.SwitchEditModeAction=void 0;const B2=k,dfe=ze,ufe=ke,lfe=me,qr=an,C$=vi,P$=kf;var $2;(function(n){n.KIND="switchEditMode";function e(t){var i,o;return{kind:n.KIND,elementsToActivate:(i=t.elementsToActivate)!==null&&i!==void 0?i:[],elementsToDeactivate:(o=t.elementsToDeactivate)!==null&&o!==void 0?o:[]}}n.create=e})($2||(_s.SwitchEditModeAction=$2={}));let U_=class extends dfe.Command{constructor(e){super(),this.action=e,this.elementsToActivate=[],this.elementsToDeactivate=[],this.handlesToRemove=[]}execute(e){const t=e.root.index;return this.action.elementsToActivate.forEach(i=>{const o=t.getById(i);o!==void 0&&this.elementsToActivate.push(o)}),this.action.elementsToDeactivate.forEach(i=>{const o=t.getById(i);if(o!==void 0&&this.elementsToDeactivate.push(o),o instanceof qr.SRoutingHandleImpl&&o.parent instanceof qr.SRoutableElementImpl){const r=o.parent;this.shouldRemoveHandle(o,r)&&(this.handlesToRemove.push({handle:o,parent:r}),this.elementsToDeactivate.push(r),this.elementsToActivate.push(r))}}),this.doExecute(e)}doExecute(e){return this.handlesToRemove.forEach(t=>{t.point=t.parent.routingPoints.splice(t.handle.pointIndex,1)[0]}),this.elementsToDeactivate.forEach(t=>{t instanceof qr.SRoutableElementImpl?t.removeAll(i=>i instanceof qr.SRoutingHandleImpl):t instanceof qr.SRoutingHandleImpl&&(t.editMode=!1,t.danglingAnchor&&t.parent instanceof qr.SRoutableElementImpl&&t.danglingAnchor.original&&(t.parent.source===t.danglingAnchor?t.parent.sourceId=t.danglingAnchor.original.id:t.parent.target===t.danglingAnchor&&(t.parent.targetId=t.danglingAnchor.original.id),t.danglingAnchor.parent.remove(t.danglingAnchor),t.danglingAnchor=void 0))}),this.elementsToActivate.forEach(t=>{(0,P$.canEditRouting)(t)&&t instanceof ufe.SParentElementImpl?this.edgeRouterRegistry.get(t.routerKind).createRoutingHandles(t):t instanceof qr.SRoutingHandleImpl&&(t.editMode=!0)}),e.root}shouldRemoveHandle(e,t){return e.kind==="junction"?this.edgeRouterRegistry.route(t).find(o=>o.pointIndex===e.pointIndex)===void 0:!1}undo(e){return this.handlesToRemove.forEach(t=>{t.point!==void 0&&t.parent.routingPoints.splice(t.handle.pointIndex,0,t.point)}),this.elementsToActivate.forEach(t=>{t instanceof qr.SRoutableElementImpl?t.removeAll(i=>i instanceof qr.SRoutingHandleImpl):t instanceof qr.SRoutingHandleImpl&&(t.editMode=!1)}),this.elementsToDeactivate.forEach(t=>{(0,P$.canEditRouting)(t)?this.edgeRouterRegistry.get(t.routerKind).createRoutingHandles(t):t instanceof qr.SRoutingHandleImpl&&(t.editMode=!0)}),e.root}redo(e){return this.doExecute(e)}};_s.SwitchEditModeCommand=U_;U_.KIND=$2.KIND;eU([(0,B2.inject)(C$.EdgeRouterRegistry),tU("design:type",C$.EdgeRouterRegistry)],U_.prototype,"edgeRouterRegistry",void 0);_s.SwitchEditModeCommand=U_=eU([(0,B2.injectable)(),cfe(0,(0,B2.inject)(lfe.TYPES.Action)),tU("design:paramtypes",[Object])],U_);var Hf={},nU=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},iU=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},ffe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Hf,"__esModule",{value:!0});Hf.ReconnectCommand=void 0;const k2=k,hfe=se,pfe=ze,mfe=me,gfe=an,w$=vi;let Y_=class extends pfe.Command{constructor(e){super(),this.action=e}execute(e){return this.doExecute(e),e.root}doExecute(e){const i=e.root.index.getById(this.action.routableId);if(i instanceof gfe.SRoutableElementImpl){const o=this.edgeRouterRegistry.get(i.routerKind),r=o.takeSnapshot(i);o.applyReconnect(i,this.action.newSourceId,this.action.newTargetId);const s=o.takeSnapshot(i);this.memento={edge:i,before:r,after:s}}}undo(e){return this.memento&&this.edgeRouterRegistry.get(this.memento.edge.routerKind).applySnapshot(this.memento.edge,this.memento.before),e.root}redo(e){return this.memento&&this.edgeRouterRegistry.get(this.memento.edge.routerKind).applySnapshot(this.memento.edge,this.memento.after),e.root}};Hf.ReconnectCommand=Y_;Y_.KIND=hfe.ReconnectAction.KIND;nU([(0,k2.inject)(w$.EdgeRouterRegistry),iU("design:type",w$.EdgeRouterRegistry)],Y_.prototype,"edgeRouterRegistry",void 0);Hf.ReconnectCommand=Y_=nU([(0,k2.injectable)(),ffe(0,(0,k2.inject)(mfe.TYPES.Action)),iU("design:paramtypes",[Object])],Y_);Object.defineProperty(ta,"__esModule",{value:!0});ta.labelEditUiModule=ta.labelEditModule=ta.edgeEditModule=void 0;const i7=k,F2=me,t3=wn,vfe=Wo,_fe=rn,yfe=an,bfe=zn,Sfe=jf,op=_n,nT=ca,Efe=_s,Cfe=Hf;ta.edgeEditModule=new i7.ContainerModule((n,e,t)=>{const i={bind:n,isBound:t};(0,t3.configureCommand)(i,Efe.SwitchEditModeCommand),(0,t3.configureCommand)(i,Cfe.ReconnectCommand),(0,t3.configureCommand)(i,Sfe.DeleteElementCommand),(0,_fe.configureModelElement)(i,"dangling-anchor",yfe.SDanglingAnchorImpl,bfe.EmptyGroupView)});ta.labelEditModule=new i7.ContainerModule((n,e,t)=>{n(op.EditLabelMouseListener).toSelf().inSingletonScope(),n(F2.TYPES.MouseListener).toService(op.EditLabelMouseListener),n(op.EditLabelKeyListener).toSelf().inSingletonScope(),n(F2.TYPES.KeyListener).toService(op.EditLabelKeyListener),(0,t3.configureCommand)({bind:n,isBound:t},op.ApplyLabelEditCommand)});ta.labelEditUiModule=new i7.ContainerModule((n,e,t)=>{const i={bind:n,isBound:t};(0,vfe.configureActionHandler)(i,op.EditLabelAction.KIND,nT.EditLabelActionHandler),n(nT.EditLabelUI).toSelf().inSingletonScope(),n(F2.TYPES.IUIExtension).toService(nT.EditLabelUI)});var Kf={},R0={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isExpandable=n.expandFeature=void 0,n.expandFeature=Symbol("expandFeature");function e(t){return t.hasFeature(n.expandFeature)&&"expanded"in t}n.isExpandable=e})(R0);var Pfe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Kf,"__esModule",{value:!0});Kf.ExpandButtonHandler=void 0;const wfe=k,Afe=se,Rfe=yt,Mfe=R0;let pC=class{buttonPressed(e){const t=(0,Rfe.findParentByFeature)(e,Mfe.isExpandable);return t!==void 0?[Afe.CollapseExpandAction.create({expandIds:t.expanded?[]:[t.id],collapseIds:t.expanded?[t.id]:[]})]:[]}};Kf.ExpandButtonHandler=pC;pC.TYPE="button:expand";Kf.ExpandButtonHandler=pC=Pfe([(0,wfe.injectable)()],pC);var cg={},Ife=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(cg,"__esModule",{value:!0});cg.ExpandButtonView=void 0;const iT=ti,Tfe=R0,Dfe=yt,Ofe=k;let x2=class{render(e,t){const i=(0,Dfe.findParentByFeature)(e,Tfe.isExpandable),o=i!==void 0&&i.expanded?"M 1,5 L 8,12 L 15,5 Z":"M 1,8 L 8,15 L 8,1 Z";return(0,iT.svg)("g",{"class-sprotty-button":"{true}","class-enabled":"{button.enabled}"},(0,iT.svg)("rect",{x:0,y:0,width:16,height:16,opacity:0}),(0,iT.svg)("path",{d:o}))}};cg.ExpandButtonView=x2;cg.ExpandButtonView=x2=Ife([(0,Ofe.injectable)()],x2);var Wi={},_A=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},oU=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Lfe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Wi,"__esModule",{value:!0});Wi.ExportSvgPostprocessor=Wi.ExportSvgCommand=Wi.RequestExportSvgAction=Wi.ExportSvgKeyListener=void 0;const yA=k,jfe=se,Nfe=ze,Bfe=no,$fe=ke,kfe=gi,Ffe=qt,A$=y0,xfe=sr,Hfe=Rs,Kfe=$u,rU=me;let H2=class extends kfe.KeyListener{keyDown(e,t){return(0,Ffe.matchesKeystroke)(t,"KeyE","ctrlCmd","shift")?[q_.create()]:[]}};Wi.ExportSvgKeyListener=H2;Wi.ExportSvgKeyListener=H2=_A([(0,yA.injectable)()],H2);var q_;(function(n){n.KIND="requestExportSvg";function e(){return{kind:n.KIND,requestId:(0,jfe.generateRequestId)()}}n.create=e})(q_||(Wi.RequestExportSvgAction=q_={}));let mC=class extends Nfe.HiddenCommand{constructor(e){super(),this.action=e}execute(e){if((0,A$.isExportable)(e.root)){const t=e.modelFactory.createRoot(e.root);if((0,A$.isExportable)(t))return(0,Hfe.isViewport)(t)&&(t.zoom=1,t.scroll={x:0,y:0}),t.index.all().forEach(i=>{(0,Bfe.isSelectable)(i)&&i.selected&&(i.selected=!1),(0,Kfe.isHoverable)(i)&&i.hoverFeedback&&(i.hoverFeedback=!1)}),{model:t,modelChanged:!0,cause:this.action}}return{model:e.root,modelChanged:!1}}};Wi.ExportSvgCommand=mC;mC.KIND=q_.KIND;Wi.ExportSvgCommand=mC=_A([Lfe(0,(0,yA.inject)(rU.TYPES.Action)),oU("design:paramtypes",[Object])],mC);let gC=class{decorate(e,t){return t instanceof $fe.SModelRootImpl&&(this.root=t),e}postUpdate(e){this.root&&e!==void 0&&e.kind===q_.KIND&&this.svgExporter.export(this.root,e)}};Wi.ExportSvgPostprocessor=gC;_A([(0,yA.inject)(rU.TYPES.SvgExporter),oU("design:type",xfe.SvgExporter)],gC.prototype,"svgExporter",void 0);Wi.ExportSvgPostprocessor=gC=_A([(0,yA.injectable)()],gC);var ua={},Vfe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(ua,"__esModule",{value:!0});ua.ElementFader=ua.FadeAnimation=void 0;const zfe=k,Gfe=Lr,Ufe=ke,Yfe=ft,qfe=Lf;class Wfe extends Gfe.Animation{constructor(e,t,i,o=!1){super(i),this.model=e,this.elementFades=t,this.removeAfterFadeOut=o}tween(e,t){for(const i of this.elementFades){const o=i.element;i.type==="in"?o.opacity=e:i.type==="out"&&(o.opacity=1-e,e===1&&this.removeAfterFadeOut&&o instanceof Ufe.SChildElementImpl&&o.parent.remove(o))}return this.model}}ua.FadeAnimation=Wfe;let K2=class{decorate(e,t){return(0,qfe.isFadeable)(t)&&t.opacity!==1&&(0,Yfe.setAttr)(e,"opacity",t.opacity),e}postUpdate(){}};ua.ElementFader=K2;ua.ElementFader=K2=Vfe([(0,zfe.injectable)()],K2);var fn={},ku=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},M0=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},sU=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(fn,"__esModule",{value:!0});fn.ClosePopupActionHandler=fn.HoverKeyListener=fn.PopupHoverMouseListener=fn.HoverMouseListener=fn.AbstractHoverMouseListener=fn.SetPopupModelCommand=fn.HoverFeedbackCommand=void 0;const la=k,Ks=se,Zfe=Te,Qfe=qt,I0=me,R$=ke,Xfe=Ut,aU=ze,Bl=$n,Jfe=gi,cv=yt,ehe=$t,rp=$u;let vC=class extends aU.SystemCommand{constructor(e){super(),this.action=e}execute(e){const i=e.root.index.getById(this.action.mouseoverElement);return i&&(0,rp.isHoverable)(i)&&(i.hoverFeedback=this.action.mouseIsOver),this.redo(e)}undo(e){return e.root}redo(e){return e.root}};fn.HoverFeedbackCommand=vC;vC.KIND=Ks.HoverFeedbackAction.KIND;fn.HoverFeedbackCommand=vC=ku([(0,la.injectable)(),sU(0,(0,la.inject)(I0.TYPES.Action)),M0("design:paramtypes",[Object])],vC);let W_=class extends aU.PopupCommand{constructor(e){super(),this.action=e}execute(e){return this.oldRoot=e.root,this.newRoot=e.modelFactory.createRoot(this.action.newRoot),this.newRoot}undo(e){return this.oldRoot}redo(e){return this.newRoot}};fn.SetPopupModelCommand=W_;W_.KIND=Ks.SetPopupModelAction.KIND;fn.SetPopupModelCommand=W_=ku([(0,la.injectable)(),sU(0,(0,la.inject)(I0.TYPES.Action)),M0("design:paramtypes",[Object])],W_);class T0 extends Xfe.MouseListener{mouseDown(e,t){return this.mouseIsDown=!0,[]}mouseUp(e,t){return this.mouseIsDown=!1,[]}stopMouseOutTimer(){this.state.mouseOutTimer!==void 0&&(window.clearTimeout(this.state.mouseOutTimer),this.state.mouseOutTimer=void 0)}startMouseOutTimer(){return this.stopMouseOutTimer(),new Promise(e=>{this.state.mouseOutTimer=window.setTimeout(()=>{this.state.popupOpen=!1,this.state.previousPopupElement=void 0,e(Ks.SetPopupModelAction.create({type:Bl.EMPTY_ROOT.type,id:Bl.EMPTY_ROOT.id}))},this.options.popupCloseDelay)})}stopMouseOverTimer(){this.state.mouseOverTimer!==void 0&&(window.clearTimeout(this.state.mouseOverTimer),this.state.mouseOverTimer=void 0)}}fn.AbstractHoverMouseListener=T0;ku([(0,la.inject)(I0.TYPES.ViewerOptions),M0("design:type",Object)],T0.prototype,"options",void 0);ku([(0,la.inject)(I0.TYPES.HoverState),M0("design:type",Object)],T0.prototype,"state",void 0);let _C=class extends T0{computePopupBounds(e,t){let i={x:-5,y:20};const o=(0,ehe.getAbsoluteBounds)(e),r=e.root.canvasBounds,s=Zfe.Bounds.translate(o,r),a=s.x+s.width-t.x,u=s.y+s.height-t.y;u<=a&&this.allowSidePosition(e,"below",u)?i={x:-5,y:Math.round(u+5)}:a<=u&&this.allowSidePosition(e,"right",a)&&(i={x:Math.round(a+5),y:-5});let h=t.x+i.x;const g=r.x+r.width;h>g&&(h=g);let y=t.y+i.y;const S=r.y+r.height;return y>S&&(y=S),{x:h,y,width:-1,height:-1}}allowSidePosition(e,t,i){return!(e instanceof R$.SModelRootImpl)&&i<=150}startMouseOverTimer(e,t){return this.stopMouseOverTimer(),new Promise(i=>{this.state.mouseOverTimer=window.setTimeout(()=>{const o=this.computePopupBounds(e,{x:t.pageX,y:t.pageY});i(Ks.RequestPopupModelAction.create({elementId:e.id,bounds:o})),this.state.popupOpen=!0,this.state.previousPopupElement=e},this.options.popupOpenDelay)})}mouseOver(e,t){const i=[];if(!this.mouseIsDown){const o=(0,cv.findParent)(e,rp.hasPopupFeature);this.state.popupOpen&&(o===void 0||this.state.previousPopupElement!==void 0&&this.state.previousPopupElement.id!==o.id)?i.push(this.startMouseOutTimer()):(this.stopMouseOverTimer(),this.stopMouseOutTimer()),o!==void 0&&(this.state.previousPopupElement===void 0||this.state.previousPopupElement.id!==o.id)&&i.push(this.startMouseOverTimer(o,t)),this.lastHoverFeedbackElementId&&(i.push(Ks.HoverFeedbackAction.create({mouseoverElement:this.lastHoverFeedbackElementId,mouseIsOver:!1})),this.lastHoverFeedbackElementId=void 0);const r=(0,cv.findParentByFeature)(e,rp.isHoverable);r!==void 0&&(i.push(Ks.HoverFeedbackAction.create({mouseoverElement:r.id,mouseIsOver:!0})),this.lastHoverFeedbackElementId=r.id)}return i}mouseOut(e,t){const i=[];if(!this.mouseIsDown){const o=this.getElementFromEventPosition(t);if(!this.isSprottyPopup(o)){if(this.state.popupOpen){const s=(0,cv.findParent)(e,rp.hasPopupFeature);this.state.previousPopupElement!==void 0&&s!==void 0&&this.state.previousPopupElement.id===s.id&&i.push(this.startMouseOutTimer())}this.stopMouseOverTimer();const r=(0,cv.findParentByFeature)(e,rp.isHoverable);r!==void 0&&(i.push(Ks.HoverFeedbackAction.create({mouseoverElement:r.id,mouseIsOver:!1})),this.lastHoverFeedbackElementId&&this.lastHoverFeedbackElementId!==r.id&&i.push(Ks.HoverFeedbackAction.create({mouseoverElement:this.lastHoverFeedbackElementId,mouseIsOver:!1})),this.lastHoverFeedbackElementId=void 0)}}return i}getElementFromEventPosition(e){return document.elementFromPoint(e.x,e.y)}isSprottyPopup(e){return e?e.id===this.options.popupDiv||!!e.parentElement&&this.isSprottyPopup(e.parentElement):!1}mouseMove(e,t){const i=[];if(!this.mouseIsDown){this.state.previousPopupElement!==void 0&&this.closeOnMouseMove(this.state.previousPopupElement,t)&&i.push(this.startMouseOutTimer());const o=(0,cv.findParent)(e,rp.hasPopupFeature);o!==void 0&&(this.state.previousPopupElement===void 0||this.state.previousPopupElement.id!==o.id)&&i.push(this.startMouseOverTimer(o,t))}return i}closeOnMouseMove(e,t){return e instanceof R$.SModelRootImpl}};fn.HoverMouseListener=_C;ku([(0,la.inject)(I0.TYPES.ViewerOptions),M0("design:type",Object)],_C.prototype,"options",void 0);fn.HoverMouseListener=_C=ku([(0,la.injectable)()],_C);let V2=class extends T0{mouseOut(e,t){return[this.startMouseOutTimer()]}mouseOver(e,t){return this.stopMouseOutTimer(),this.stopMouseOverTimer(),[]}};fn.PopupHoverMouseListener=V2;fn.PopupHoverMouseListener=V2=ku([(0,la.injectable)()],V2);class the extends Jfe.KeyListener{keyDown(e,t){return(0,Qfe.matchesKeystroke)(t,"Escape")?[Ks.SetPopupModelAction.create({type:Bl.EMPTY_ROOT.type,id:Bl.EMPTY_ROOT.id})]:[]}}fn.HoverKeyListener=the;let z2=class{constructor(){this.popupOpen=!1}handle(e){if(e.kind===W_.KIND)this.popupOpen=e.newRoot.type!==Bl.EMPTY_ROOT.type;else if(this.popupOpen)return Ks.SetPopupModelAction.create({id:Bl.EMPTY_ROOT.id,type:Bl.EMPTY_ROOT.type})}};fn.ClosePopupActionHandler=z2;fn.ClosePopupActionHandler=z2=ku([(0,la.injectable)()],z2);var D0={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SIssue=n.SIssueMarker=n.SIssueMarkerImpl=n.SDecoration=n.isDecoration=n.decorationFeature=void 0;const e=$t,t=$u;n.decorationFeature=Symbol("decorationFeature");function i(a){return a.hasFeature(n.decorationFeature)}n.isDecoration=i;class o extends e.SShapeElementImpl{}n.SDecoration=o,o.DEFAULT_FEATURES=[n.decorationFeature,e.boundsFeature,t.hoverFeedbackFeature,t.popupFeature];class r extends o{}n.SIssueMarkerImpl=r,n.SIssueMarker=r;class s{}n.SIssue=s})(D0);var Vf={},nhe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Vf,"__esModule",{value:!0});Vf.IssueMarkerView=void 0;const oT=ti,ihe=ft,ohe=k;let G2=class{render(e,t){const i=.008928571428571428,o=`scale(${i}, ${i})`,r=this.getMaxSeverity(e),s=(0,oT.svg)("g",{"class-sprotty-issue":!0},(0,oT.svg)("g",{transform:o},(0,oT.svg)("path",{d:this.getPath(r)})));return(0,ihe.setClass)(s,"sprotty-"+r,!0),s}getMaxSeverity(e){let t="info";for(const i of e.issues.map(o=>o.severity))(i==="error"||i==="warning"&&t==="info")&&(t=i);return t}getPath(e){switch(e){case"error":case"warning":return"M768 128q209 0 385.5 103t279.5 279.5 103 385.5-103 385.5-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103zm128 1247v-190q0-14-9-23.5t-22-9.5h-192q-13 0-23 10t-10 23v190q0 13 10 23t23 10h192q13 0 22-9.5t9-23.5zm-2-344l18-621q0-12-10-18-10-8-24-8h-220q-14 0-24 8-10 6-10 18l17 621q0 10 10 17.5t24 7.5h185q14 0 23.5-7.5t10.5-17.5z";case"info":return"M1024 1376v-160q0-14-9-23t-23-9h-96v-512q0-14-9-23t-23-9h-320q-14 0-23 9t-9 23v160q0 14 9 23t23 9h96v320h-96q-14 0-23 9t-9 23v160q0 14 9 23t23 9h448q14 0 23-9t9-23zm-128-896v-160q0-14-9-23t-23-9h-192q-14 0-23 9t-9 23v160q0 14 9 23t23 9h192q14 0 23-9t9-23zm640 416q0 209-103 385.5t-279.5 279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5 385.5-103 385.5 103 279.5 279.5 103 385.5z"}}};Vf.IssueMarkerView=G2;Vf.IssueMarkerView=G2=nhe([(0,ohe.injectable)()],G2);var zf={},cU=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},rhe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(zf,"__esModule",{value:!0});zf.DecorationPlacer=void 0;const dU=k,she=ke,ahe=D0,che=ft,M$=$t,dhe=an,I$=vi,T$=Fr;let yC=class{decorate(e,t){if((0,ahe.isDecoration)(t)){const i=this.getPosition(t),o="translate("+i.x+", "+i.y+")";(0,che.setAttr)(e,"transform",o)}return e}getPosition(e){if(e instanceof she.SChildElementImpl&&e.parent instanceof dhe.SRoutableElementImpl){const t=this.edgeRouterRegistry.route(e.parent);if(t.length>1){const i=Math.floor(.5*(t.length-1)),o=(0,M$.isSizeable)(e)?{x:-.5*e.bounds.width,y:-.5*e.bounds.width}:T$.Point.ORIGIN;return{x:.5*(t[i].x+t[i+1].x)+o.x,y:.5*(t[i].y+t[i+1].y)+o.y}}}return(0,M$.isSizeable)(e)?{x:-.666*e.bounds.width,y:-.666*e.bounds.height}:T$.Point.ORIGIN}postUpdate(){}};zf.DecorationPlacer=yC;cU([(0,dU.inject)(I$.EdgeRouterRegistry),rhe("design:type",I$.EdgeRouterRegistry)],yC.prototype,"edgeRouterRegistry",void 0);zf.DecorationPlacer=yC=cU([(0,dU.injectable)()],yC);var Qn={};class uhe{constructor(e=[],t=lhe){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let i=(this.length>>1)-1;i>=0;i--)this._down(i)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:i}=this,o=t[e];for(;e>0;){const r=e-1>>1,s=t[r];if(i(o,s)>=0)break;t[e]=s,e=r}t[e]=o}_down(e){const{data:t,compare:i}=this,o=this.length>>1,r=t[e];for(;e<o;){let s=(e<<1)+1,a=t[s];const u=s+1;if(u<this.length&&i(t[u],a)<0&&(s=u,a=t[u]),i(a,r)>=0)break;t[e]=a,e=s}t[e]=r}}function lhe(n,e){return n<e?-1:n>e?1:0}const fhe=Object.freeze(Object.defineProperty({__proto__:null,default:uhe},Symbol.toStringTag,{value:"Module"})),uU=y6(fhe);var Ln={},hhe=f&&f.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ln,"__esModule",{value:!0});Ln.intersectionOfSegments=Ln.getSegmentIndex=Ln.checkWhichSegmentHasRightEndpointFirst=Ln.runSweep=Ln.Segment=Ln.SweepEvent=Ln.checkWhichEventIsLeft=Ln.addRoute=void 0;const phe=hhe(uU),D$=ei;function mhe(n,e,t){if(e.length<1)return;let i=e[0],o;for(let r=0;r<e.length-1;r++){o=e[r+1];const s=new U2(n,i,r),a=new U2(n,o,r+1);s.otherEvent=a,a.otherEvent=s,lU(s,a)>0?(a.isLeftEndpoint=!0,s.isLeftEndpoint=!1):(s.isLeftEndpoint=!0,a.isLeftEndpoint=!1),t.push(s),t.push(a),i=o}}Ln.addRoute=mhe;function lU(n,e){return n.point.x>e.point.x?1:n.point.x<e.point.x?-1:n.point.y!==e.point.y?n.point.y>e.point.y?1:-1:1}Ln.checkWhichEventIsLeft=lU;class U2{constructor(e,t,i){this.edgeId=e,this.point=t,this.segmentIndex=i}}Ln.SweepEvent=U2;class fU{constructor(e){this.leftSweepEvent=e,this.rightSweepEvent=e.otherEvent}}Ln.Segment=fU;function ghe(n){const e=[],t=new phe.default([],hU);for(;n.length;){const i=n.pop();if(i!=null&&i.isLeftEndpoint){const o=new fU(i);for(let r=0;r<t.data.length;r++){const s=t.data[r],a=pU(o,s);a&&e.push({routable1:i.edgeId,routable2:s.leftSweepEvent.edgeId,segmentIndex1:Y2(o),segmentIndex2:Y2(s),intersectionPoint:a})}t.push(o)}else(i==null?void 0:i.isLeftEndpoint)===!1&&t.pop()}return e}Ln.runSweep=ghe;function hU(n,e){return n.rightSweepEvent.point.x>e.rightSweepEvent.point.x?1:n.rightSweepEvent.point.x<e.rightSweepEvent.point.x?-1:n.rightSweepEvent.point.y!==e.rightSweepEvent.point.y?n.rightSweepEvent.point.y<e.rightSweepEvent.point.y?1:-1:1}Ln.checkWhichSegmentHasRightEndpointFirst=hU;function Y2(n){return Math.min(n.leftSweepEvent.segmentIndex,n.rightSweepEvent.segmentIndex)}Ln.getSegmentIndex=Y2;function pU(n,e){if(n.leftSweepEvent.edgeId===e.leftSweepEvent.edgeId)return;const t=new D$.PointToPointLine(n.leftSweepEvent.point,n.rightSweepEvent.point),i=new D$.PointToPointLine(e.leftSweepEvent.point,e.rightSweepEvent.point);return t.intersection(i)}Ln.intersectionOfSegments=pU;var vhe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},_he=f&&f.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Qn,"__esModule",{value:!0});Qn.IntersectionFinder=Qn.BY_DESCENDING_X_THEN_DESCENDING_Y=Qn.BY_X_THEN_DESCENDING_Y=Qn.BY_DESCENDING_X_THEN_Y=Qn.BY_X_THEN_Y=Qn.isIntersectingRoutedPoint=void 0;const yhe=k,bhe=_he(uU),rT=Ln;function mU(n){return n!==void 0&&"intersections"in n&&"kind"in n}Qn.isIntersectingRoutedPoint=mU;const She=(n,e)=>n.intersectionPoint.x===e.intersectionPoint.x?n.intersectionPoint.y-e.intersectionPoint.y:n.intersectionPoint.x-e.intersectionPoint.x;Qn.BY_X_THEN_Y=She;const Ehe=(n,e)=>n.intersectionPoint.x===e.intersectionPoint.x?n.intersectionPoint.y-e.intersectionPoint.y:e.intersectionPoint.x-n.intersectionPoint.x;Qn.BY_DESCENDING_X_THEN_Y=Ehe;const Che=(n,e)=>n.intersectionPoint.x===e.intersectionPoint.x?e.intersectionPoint.y-n.intersectionPoint.y:n.intersectionPoint.x-e.intersectionPoint.x;Qn.BY_X_THEN_DESCENDING_Y=Che;const Phe=(n,e)=>n.intersectionPoint.x===e.intersectionPoint.x?e.intersectionPoint.y-n.intersectionPoint.y:e.intersectionPoint.x-n.intersectionPoint.x;Qn.BY_DESCENDING_X_THEN_DESCENDING_Y=Phe;let q2=class{apply(e){const t=this.find(e);this.addToRouting(t,e)}find(e){const t=new bhe.default(void 0,rT.checkWhichEventIsLeft);return e.routes.forEach((i,o)=>{this.isSupportedRoute(i)&&(0,rT.addRoute)(o,i,t)}),(0,rT.runSweep)(t)}isSupportedRoute(e){return e.find(t=>t.kind!=="source"&&t.kind!=="target"&&t.kind!=="linear")===void 0}addToRouting(e,t){for(const i of e){const o=t.get(i.routable1),r=t.get(i.routable2);this.addIntersectionToRoutedPoint(i,o,i.segmentIndex1),this.addIntersectionToRoutedPoint(i,r,i.segmentIndex2)}}addIntersectionToRoutedPoint(e,t,i){if(t&&t.length>i){const o=t[i+1];if(mU(o))o.intersections.push(e);else{const r=Object.assign(Object.assign({},o),{intersections:[e]});t[i+1]=r}}}};Qn.IntersectionFinder=q2;Qn.IntersectionFinder=q2=vhe([(0,yhe.injectable)()],q2);var Gf={},whe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Gf,"__esModule",{value:!0});Gf.JunctionFinder=void 0;const Ahe=k,Rhe=Sn;let W2=class{constructor(){this.edgesMap=new Map,this.sourcesMap=new Map,this.targetsMap=new Map}apply(e,t){this.findJunctions(e,t)}findJunctions(e,t){Array.from(t.index.all().filter(o=>o instanceof Rhe.SEdgeImpl)).forEach(o=>{this.edgesMap.set(o.id,o);const r=this.sourcesMap.get(o.sourceId);r?r.add(o.id):this.sourcesMap.set(o.sourceId,new Set([o.id]));const s=this.targetsMap.get(o.targetId);s?s.add(o.id):this.targetsMap.set(o.targetId,new Set([o.id]))}),e.routes.forEach((o,r)=>{const s=this.edgesMap.get(r);s&&(this.findJunctionPointsWithSameSource(s,o,e),this.findJunctionPointsWithSameTarget(s,o,e))})}findJunctionPointsWithSameSource(e,t,i){const o=this.sourcesMap.get(e.sourceId);if(!o)return;const s=Array.from(o).filter(a=>a!==e.id).map(a=>i.get(a)).filter(a=>a!==void 0);for(const a of s){const u=this.getJunctionIndex(t,a);u===-1||u===0||this.setJunctionPoints(t,a,u)}}findJunctionPointsWithSameTarget(e,t,i){const o=this.targetsMap.get(e.targetId);if(!o)return;const s=Array.from(o).filter(a=>a!==e.id).map(a=>i.get(a)).filter(a=>a!==void 0);t.reverse();for(const a of s){a.reverse();const u=this.getJunctionIndex(t,a);u===-1||u===0||(this.setJunctionPoints(t,a,u),a.reverse())}t.reverse()}setJunctionPoints(e,t,i){const o=this.getSegmentDirection(e[i-1],e[i]),r=this.getSegmentDirection(t[i-1],t[i]);if(o!==r)this.setPreviousPointAsJunction(e,t,i);else if(o==="left"||o==="right"){if(e[i].y!==t[i].y){this.setPreviousPointAsJunction(e,t,i);return}e[i].isJunction=o==="left"?e[i].x>t[i].x:e[i].x<t[i].x,t[i].isJunction=o==="left"?t[i].x>e[i].x:t[i].x<e[i].x}else{if(e[i].x!==t[i].x){this.setPreviousPointAsJunction(e,t,i);return}e[i].isJunction=o==="up"?e[i].y>t[i].y:e[i].y<t[i].y,t[i].isJunction=o==="up"?t[i].y>e[i].y:t[i].y<e[i].y}}setPreviousPointAsJunction(e,t,i){e[i-1].isJunction=!0,t[i-1].isJunction=!0}getSegmentDirection(e,t){const i=t.x-e.x,o=t.y-e.y;let r="horizontal";return Math.abs(i)<Math.abs(o)&&(r="vertical"),r==="horizontal"?i>0?"right":"left":o>0?"down":"up"}getJunctionIndex(e,t){let i=0;for(;i<e.length&&i<t.length;){if(e[i].x!==t[i].x||e[i].y!==t[i].y)return i;i++}return-1}};Gf.JunctionFinder=W2;Gf.JunctionFinder=W2=whe([(0,Ahe.injectable)()],W2);var Jn={},O0=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},bA=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Mhe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}},n3;Object.defineProperty(Jn,"__esModule",{value:!0});Jn.LocationPostprocessor=Jn.MoveMouseListener=Jn.MorphEdgesAnimation=Jn.MoveAnimation=Jn.MoveCommand=void 0;const fc=k,wd=Te,_d=se,n_=Lr,Ihe=ze,$l=ke,i_=yt,gU=me,The=Ut,Dhe=ft,Ohe=Sn,Lhe=vs,vU=$t,O$=X6,dE=_s,jhe=Hf,Dn=an,bC=vi,Nhe=$f,_U=no,Bhe=Rs,pp=xc;let Z_=n3=class extends Ihe.MergeableCommand{constructor(e){super(),this.action=e,this.resolvedMoves=new Map,this.edgeMementi=[],this.stoppableCommandKey=n3.KIND}stopExecution(){this.animation&&(this.animation.stop(),this.animation=void 0)}execute(e){const t=e.root.index,i=new Map,o=new Map;return this.action.moves.forEach(r=>{const s=t.getById(r.elementId);if(s instanceof Dn.SRoutingHandleImpl&&this.edgeRouterRegistry){const a=s.parent;if(a instanceof Dn.SRoutableElementImpl){const u=this.resolveHandleMove(s,a,r);if(u){let h=i.get(a);h||(h=[],i.set(a,h)),h.push(u)}}}else if(s&&(0,pp.isLocateable)(s)){const a=this.resolveElementMove(s,r);if(a&&(this.resolvedMoves.set(a.element.id,a),this.edgeRouterRegistry)){const u=g=>{t.getAttachedElements(g).forEach(y=>{if(y instanceof Dn.SRoutableElementImpl&&!this.isChildOfMovedElements(y)){const S=o.get(y),w=wd.Point.subtract(a.toPosition,a.fromPosition),P=S?wd.Point.linear(S,w,.5):w;o.set(y,P)}})},h=g=>{(0,$l.isParent)(g)&&g.children.forEach(y=>{y instanceof $l.SModelElementImpl&&(y instanceof Dn.SConnectableElementImpl&&u(y),h(y))})};h(s),u(s)}}}),this.doMove(i,o),this.action.animate?(this.undoMove(),(this.animation=new n_.CompoundAnimation(e.root,e,[new i3(e.root,this.resolvedMoves,e,!1),new o3(e.root,this.edgeMementi,e,!1)])).start()):e.root}resolveHandleMove(e,t,i){let o=i.fromPosition;if(!o){const r=this.edgeRouterRegistry.get(t.routerKind);o=r.getHandlePosition(t,r.route(t),e)}if(o)return{handle:e,fromPosition:o,toPosition:i.toPosition}}resolveElementMove(e,t){const i=t.fromPosition||{x:e.position.x,y:e.position.y};return{element:e,fromPosition:i,toPosition:t.toPosition}}doMove(e,t){this.resolvedMoves.forEach(i=>{i.element.position=i.toPosition}),e.forEach((i,o)=>{const r=this.edgeRouterRegistry.get(o.routerKind),s=r.takeSnapshot(o);r.applyHandleMoves(o,i);const a=r.takeSnapshot(o);this.edgeMementi.push({edge:o,before:s,after:a})}),t.forEach((i,o)=>{if(!e.get(o)){const r=this.edgeRouterRegistry.get(o.routerKind),s=r.takeSnapshot(o);if(this.isAttachedEdge(o))o.routingPoints=o.routingPoints.map(u=>wd.Point.add(u,i));else{const u=(0,_U.isSelectable)(o)&&o.selected;r.cleanupRoutingPoints(o,o.routingPoints,u,this.action.finished)}const a=r.takeSnapshot(o);this.edgeMementi.push({edge:o,before:s,after:a})}})}isChildOfMovedElements(e){const t=e.parent;return Array.from(this.resolvedMoves.values()).map(i=>i.element.id).includes(t.id)?!0:t instanceof $l.SChildElementImpl?this.isChildOfMovedElements(t):!1}isAttachedEdge(e){const t=e.source,i=e.target,o=r=>!!this.resolvedMoves.get(r.id)||this.isChildOfMovedElements(r);return!!(t&&i&&o(t)&&o(i))}undoMove(){this.resolvedMoves.forEach(e=>{e.element.position=e.fromPosition}),this.edgeMementi.forEach(e=>{this.edgeRouterRegistry.get(e.edge.routerKind).applySnapshot(e.edge,e.before)})}undo(e){return new n_.CompoundAnimation(e.root,e,[new i3(e.root,this.resolvedMoves,e,!0),new o3(e.root,this.edgeMementi,e,!0)]).start()}redo(e){return new n_.CompoundAnimation(e.root,e,[new i3(e.root,this.resolvedMoves,e,!1),new o3(e.root,this.edgeMementi,e,!1)]).start()}merge(e,t){if(!this.action.animate&&e instanceof n3)return e.resolvedMoves.forEach((i,o)=>{const r=this.resolvedMoves.get(o);r?r.toPosition=i.toPosition:this.resolvedMoves.set(o,i)}),e.edgeMementi.forEach(i=>{const o=this.edgeMementi.find(r=>r.edge.id===i.edge.id);o?o.after=i.after:this.edgeMementi.push(i)}),!0;if(e instanceof jhe.ReconnectCommand){const i=e.memento;if(i){const o=this.edgeMementi.find(r=>r.edge.id===i.edge.id);o?o.after=i.after:this.edgeMementi.push(i)}return!0}return!1}};Jn.MoveCommand=Z_;Z_.KIND=_d.MoveAction.KIND;O0([(0,fc.inject)(bC.EdgeRouterRegistry),(0,fc.optional)(),bA("design:type",bC.EdgeRouterRegistry)],Z_.prototype,"edgeRouterRegistry",void 0);Jn.MoveCommand=Z_=n3=O0([(0,fc.injectable)(),Mhe(0,(0,fc.inject)(gU.TYPES.Action)),bA("design:paramtypes",[Object])],Z_);class i3 extends n_.Animation{constructor(e,t,i,o=!1){super(i),this.model=e,this.elementMoves=t,this.reverse=o}tween(e){return this.elementMoves.forEach(t=>{this.reverse?t.element.position={x:(1-e)*t.toPosition.x+e*t.fromPosition.x,y:(1-e)*t.toPosition.y+e*t.fromPosition.y}:t.element.position={x:(1-e)*t.fromPosition.x+e*t.toPosition.x,y:(1-e)*t.fromPosition.y+e*t.toPosition.y}}),this.model}}Jn.MoveAnimation=i3;class o3 extends n_.Animation{constructor(e,t,i,o=!1){super(i),this.model=e,this.reverse=o,this.expanded=[],t.forEach(r=>{const s=this.reverse?r.after:r.before,a=this.reverse?r.before:r.after,u=s.routedPoints,h=a.routedPoints,g=Math.max(u.length,h.length);this.expanded.push({startExpandedRoute:this.growToSize(u,g),endExpandedRoute:this.growToSize(h,g),memento:r})})}midPoint(e){const t=e.edge,i=e.edge.source,o=e.edge.target;return wd.Point.linear((0,i_.translatePoint)(wd.Bounds.center(i.bounds),i.parent,t.parent),(0,i_.translatePoint)(wd.Bounds.center(o.bounds),o.parent,t.parent),.5)}start(){return this.expanded.forEach(e=>{e.memento.edge.removeAll(t=>t instanceof Dn.SRoutingHandleImpl)}),super.start()}tween(e){return e===1?this.expanded.forEach(t=>{const i=t.memento;this.reverse?i.before.router.applySnapshot(i.edge,i.before):i.after.router.applySnapshot(i.edge,i.after)}):this.expanded.forEach(t=>{const i=[];for(let s=1;s<t.startExpandedRoute.length-1;++s)i.push(wd.Point.linear(t.startExpandedRoute[s],t.endExpandedRoute[s],e));const o=e<.5?t.memento.before:t.memento.after,r=Object.assign(Object.assign({},o),{routingPoints:i,routingHandles:[]});o.router.applySnapshot(t.memento.edge,r)}),this.model}growToSize(e,t){const i=t-e.length;if(i<=0)return e;const o=[];o.push(e[0]);const r=1/(i+1),s=1/(e.length-1);let a=1;for(let u=1;u<e.length;++u){const h=s*u;let g=0;for(;h>(a+g)*r;)++g;a+=g;for(let y=0;y<g;++y){const S=wd.Point.linear(e[u-1],e[u],(y+1)/(g+1));o.push(S)}o.push(e[u])}return o}}Jn.MorphEdgesAnimation=o3;class o7 extends The.MouseListener{constructor(){super(...arguments),this.hasDragged=!1,this.elementId2startPos=new Map}mouseDown(e,t){if(t.button===0){const i=(0,i_.findParentByFeature)(e,pp.isMoveable),o=e instanceof Dn.SRoutingHandleImpl;if(i!==void 0||o||(0,O$.isCreatingOnDrag)(e)?this.startDragPosition={x:t.pageX,y:t.pageY}:this.startDragPosition=void 0,this.hasDragged=!1,(0,O$.isCreatingOnDrag)(e))return this.startCreatingOnDrag(e,t);if(o)return this.activateRoutingHandle(e,t)}return[]}startCreatingOnDrag(e,t){const i=[];return i.push(_d.SelectAllAction.create({select:!1})),i.push(e.createAction(Dn.edgeInProgressID)),i.push(_d.SelectAction.create({selectedElementsIDs:[Dn.edgeInProgressID]})),i.push(dE.SwitchEditModeAction.create({elementsToActivate:[Dn.edgeInProgressID]})),i.push(_d.SelectAction.create({selectedElementsIDs:[Dn.edgeInProgressTargetHandleID]})),i.push(dE.SwitchEditModeAction.create({elementsToActivate:[Dn.edgeInProgressTargetHandleID]})),i}activateRoutingHandle(e,t){return[dE.SwitchEditModeAction.create({elementsToActivate:[e.id]})]}mouseMove(e,t){const i=[];if(t.buttons===0)this.mouseUp(e,t);else if(this.startDragPosition){this.elementId2startPos.size===0&&this.collectStartPositions(e.root),this.hasDragged=!0;const o=this.getElementMoves(e,t,!1);o&&i.push(o)}return i}collectStartPositions(e){const t=new Set(e.index.all().filter(i=>(0,_U.isSelectable)(i)&&i.selected));t.forEach(i=>{if(!this.isChildOfSelected(t,i)){if((0,pp.isMoveable)(i))this.elementId2startPos.set(i.id,i.position);else if(i instanceof Dn.SRoutingHandleImpl){const o=this.getHandlePosition(i);o&&this.elementId2startPos.set(i.id,o)}}})}isChildOfSelected(e,t){for(;t instanceof $l.SChildElementImpl;)if(t=t.parent,(0,pp.isMoveable)(t)&&e.has(t))return!0;return!1}getElementMoves(e,t,i){if(!this.startDragPosition)return;const o=[],r=(0,i_.findParentByFeature)(e,Bhe.isViewport),s=r?r.zoom:1,a={x:(t.pageX-this.startDragPosition.x)/s,y:(t.pageY-this.startDragPosition.y)/s};if(this.elementId2startPos.forEach((u,h)=>{const g=e.root.index.getById(h);if(g){const y=this.createElementMove(g,u,a,t);y&&o.push(y)}}),o.length>0)return _d.MoveAction.create(o,{animate:!1,finished:i})}createElementMove(e,t,i,o){const r=this.snap({x:t.x+i.x,y:t.y+i.y},e,!o.shiftKey);if((0,pp.isMoveable)(e))return{elementId:e.id,elementType:e.type,fromPosition:{x:e.position.x,y:e.position.y},toPosition:r};if(e instanceof Dn.SRoutingHandleImpl){const s=this.getHandlePosition(e);if(s!==void 0)return{elementId:e.id,elementType:e.type,fromPosition:s,toPosition:r}}}snap(e,t,i){return i&&this.snapper?this.snapper.snap(e,t):e}getHandlePosition(e){if(this.edgeRouterRegistry){const t=e.parent;if(!(t instanceof Dn.SRoutableElementImpl))return;const i=this.edgeRouterRegistry.get(t.routerKind),o=i.route(t);return i.getHandlePosition(t,o,e)}}mouseEnter(e,t){return e instanceof $l.SModelRootImpl&&t.buttons===0&&!this.startDragPosition&&this.mouseUp(e,t),[]}mouseUp(e,t){const i=[];if(this.startDragPosition){const o=this.getElementMoves(e,t,!0);o&&i.push(o),e.root.index.all().forEach(r=>{r instanceof Dn.SRoutingHandleImpl&&i.push(...this.deactivateRoutingHandle(r,e,t))})}if(!i.some(o=>o.kind===_d.ReconnectAction.KIND)){const o=e.root.index.getById(Dn.edgeInProgressID);o instanceof $l.SChildElementImpl&&i.push(this.deleteEdgeInProgress(o))}return this.hasDragged&&i.push(Lhe.CommitModelAction.create()),this.hasDragged=!1,this.startDragPosition=void 0,this.elementId2startPos.clear(),i}deactivateRoutingHandle(e,t,i){const o=[],r=e.parent;if(r instanceof Dn.SRoutableElementImpl&&e.danglingAnchor){const s=this.getHandlePosition(e);if(s){const a=(0,i_.translatePoint)(s,e.parent,e.root),u=(0,vU.findChildrenAtPosition)(t.root,a).find(h=>(0,Dn.isConnectable)(h)&&h.canConnect(r,e.kind));u&&this.hasDragged&&o.push(_d.ReconnectAction.create({routableId:e.parent.id,newSourceId:e.kind==="source"?u.id:r.sourceId,newTargetId:e.kind==="target"?u.id:r.targetId}))}}return e.editMode&&o.push(dE.SwitchEditModeAction.create({elementsToDeactivate:[e.id]})),o}deleteEdgeInProgress(e){const t=[];return t.push(Dn.edgeInProgressID),e.children.forEach(i=>{i instanceof Dn.SRoutingHandleImpl&&i.danglingAnchor&&t.push(i.danglingAnchor.id)}),_d.DeleteElementAction.create(t)}decorate(e,t){return e}}Jn.MoveMouseListener=o7;O0([(0,fc.inject)(bC.EdgeRouterRegistry),(0,fc.optional)(),bA("design:type",bC.EdgeRouterRegistry)],o7.prototype,"edgeRouterRegistry",void 0);O0([(0,fc.inject)(gU.TYPES.ISnapper),(0,fc.optional)(),bA("design:type",Object)],o7.prototype,"snapper",void 0);let Z2=class{decorate(e,t){if((0,Nhe.isEdgeLayoutable)(t)&&t.parent instanceof Ohe.SEdgeImpl)return e;let i="";if((0,pp.isLocateable)(t)&&t instanceof $l.SChildElementImpl&&t.parent!==void 0){const o=t.position;(o.x!==0||o.y!==0)&&(i="translate("+o.x+", "+o.y+")")}if((0,vU.isAlignable)(t)){const o=t.alignment;(o.x!==0||o.y!==0)&&(i.length>0&&(i+=" "),i+="translate("+o.x+", "+o.y+")")}return i.length>0&&(0,Dhe.setAttr)(e,"transform",i),e}postUpdate(){}};Jn.LocationPostprocessor=Z2;Jn.LocationPostprocessor=Z2=O0([(0,fc.injectable)()],Z2);var dg={},$he=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(dg,"__esModule",{value:!0});dg.CenterGridSnapper=void 0;const khe=k,Fhe=$t;let Q2=class{get gridX(){return 10}get gridY(){return 10}snap(e,t){return t&&(0,Fhe.isBoundsAware)(t)?{x:Math.round((e.x+.5*t.bounds.width)/this.gridX)*this.gridX-.5*t.bounds.width,y:Math.round((e.y+.5*t.bounds.height)/this.gridY)*this.gridY-.5*t.bounds.height}:{x:Math.round(e.x/this.gridX)*this.gridX,y:Math.round(e.y/this.gridY)*this.gridY}}};dg.CenterGridSnapper=Q2;dg.CenterGridSnapper=Q2=$he([(0,khe.injectable)()],Q2);var ug={},SA={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isOpenable=n.openFeature=void 0,n.openFeature=Symbol("openFeature");function e(t){return t.hasFeature(n.openFeature)}n.isOpenable=e})(SA);Object.defineProperty(ug,"__esModule",{value:!0});ug.OpenMouseListener=void 0;const xhe=se,Hhe=Ut,Khe=yt,Vhe=SA;class zhe extends Hhe.MouseListener{doubleClick(e,t){const i=(0,Khe.findParentByFeature)(e,Vhe.isOpenable);return i!==void 0?[xhe.OpenAction.create(i.id)]:[]}}ug.OpenMouseListener=zhe;var Yo={};Object.defineProperty(Yo,"__esModule",{value:!0});Yo.getModelBounds=Yo.getProjectedBounds=Yo.getProjections=Yo.isProjectable=void 0;const Ghe=Te,Uhe=Ji,L$=yt,SC=$t;function yU(n){return(0,Uhe.hasOwnProperty)(n,"projectionCssClasses")}Yo.isProjectable=yU;function bU(n){let e;for(const t of n.children){if(yU(t)&&t.projectionCssClasses.length>0){const i=SU(t);if(i){const o={elementId:t.id,projectedBounds:i,cssClasses:t.projectionCssClasses};e?e.push(o):e=[o]}}if(t.children.length>0){const i=bU(t);i&&(e?e.push(...i):e=i)}}return e}Yo.getProjections=bU;function SU(n){const e=n.parent;if(n.projectedBounds){let t=n.projectedBounds;return(0,SC.isBoundsAware)(e)&&(t=(0,L$.transformToRootBounds)(e,t)),t}else if((0,SC.isBoundsAware)(n)){let t=n.bounds;return t=(0,L$.transformToRootBounds)(e,t),t}}Yo.getProjectedBounds=SU;const uE=1e9;function Yhe(n){let e=uE,t=uE,i=-uE,o=-uE;const r=(0,SC.isBoundsAware)(n)?n.bounds:void 0;if(r&&Ghe.Dimension.isValid(r))e=r.x,t=r.y,i=e+r.width,o=t+r.height;else for(const s of n.children)if((0,SC.isBoundsAware)(s)){const a=s.bounds;e=Math.min(e,a.x),t=Math.min(t,a.y),i=Math.max(i,a.x+a.width),o=Math.max(o,a.y+a.height)}if(e=Math.min(e,n.scroll.x),t=Math.min(t,n.scroll.y),i=Math.max(i,n.scroll.x+n.canvasBounds.width/n.zoom),o=Math.max(o,n.scroll.y+n.canvasBounds.height/n.zoom),e<i&&t<o)return{x:e,y:t,width:i-e,height:o-t}}Yo.getModelBounds=Yhe;var lg={},qhe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(lg,"__esModule",{value:!0});lg.ProjectedViewportView=void 0;const lE=ti,Whe=k,j$=ig,N$=ft,B$=Yo;let X2=class{render(e,t,i){const o=(0,lE.html)("div",{"class-sprotty-root":!0},this.renderSvg(e,t,i),this.renderProjections(e,t,i));return(0,N$.setAttr)(o,"tabindex",0),o}renderSvg(e,t,i){const o=`scale(${e.zoom}) translate(${-e.scroll.x},${-e.scroll.y})`,r="http://www.w3.org/2000/svg";return(0,j$.h)("svg",{ns:r},(0,j$.h)("g",{ns:r,attrs:{transform:o}},t.renderChildren(e)))}renderProjections(e,t,i){var o;if(e.zoom<=0)return[];const r=(0,B$.getModelBounds)(e);if(!r)return[];const s=(o=(0,B$.getProjections)(e))!==null&&o!==void 0?o:[];return[this.renderProjectionBar(s,e,r,"vertical"),this.renderProjectionBar(s,e,r,"horizontal")]}renderProjectionBar(e,t,i,o){const r={modelBounds:i,orientation:o};return r.factor=o==="horizontal"?t.canvasBounds.width/i.width:t.canvasBounds.height/i.height,r.zoomedFactor=r.factor/t.zoom,(0,lE.html)("div",{"class-sprotty-projection-bar":!0,"class-horizontal":o==="horizontal","class-vertical":o==="vertical"},this.renderViewport(t,r),e.map(s=>this.renderProjection(s,t,r)))}renderViewport(e,t){let i,o;t.orientation==="horizontal"?(i=e.canvasBounds.width,o=(e.scroll.x-t.modelBounds.x)*t.factor):(i=e.canvasBounds.height,o=(e.scroll.y-t.modelBounds.y)*t.factor);let r=i*t.zoomedFactor;o<0?(r+=o,o=0):o>i&&(o=i),r<0?r=0:o+r>i&&(r=i-o);const s=t.orientation==="horizontal"?{left:`${o}px`,width:`${r}px`}:{top:`${o}px`,height:`${r}px`};return(0,lE.html)("div",{"class-sprotty-viewport":!0,style:s})}renderProjection(e,t,i){let o,r,s;i.orientation==="horizontal"?(o=t.canvasBounds.width,r=(e.projectedBounds.x-i.modelBounds.x)*i.factor,s=e.projectedBounds.width*i.factor):(o=t.canvasBounds.height,r=(e.projectedBounds.y-i.modelBounds.y)*i.factor,s=e.projectedBounds.height*i.factor),r<0?(s+=r,r=0):r>o&&(r=o),s<0?s=0:r+s>o&&(s=o-r);const a=i.orientation==="horizontal"?{left:`${r}px`,width:`${s}px`}:{top:`${r}px`,height:`${s}px`},u=(0,lE.html)("div",{id:`${i.orientation}-projection:${e.elementId}`,"class-sprotty-projection":!0,style:a});return e.cssClasses.forEach(h=>(0,N$.setClass)(u,h,!0)),u}};lg.ProjectedViewportView=X2;lg.ProjectedViewportView=X2=qhe([(0,Whe.injectable)()],X2);var Jo={},wo={},r7=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(wo,"__esModule",{value:!0});wo.DiamondAnchor=wo.RectangleAnchor=wo.EllipseAnchor=void 0;const s7=Ra,sT=ei,a7=k,c7=Hc,Ep=Te;let J2=class{get kind(){return c7.PolylineEdgeRouter.KIND+":"+s7.ELLIPTIC_ANCHOR_KIND}getAnchor(e,t,i=0){const o=e.bounds,r=Ep.Bounds.center(o),s=r.x-t.x,a=r.y-t.y,u=Math.sqrt(s*s+a*a),h=s/u||0,g=a/u||0;return{x:r.x-h*(.5*o.width+i),y:r.y-g*(.5*o.height+i)}}};wo.EllipseAnchor=J2;wo.EllipseAnchor=J2=r7([(0,a7.injectable)()],J2);let e8=class{get kind(){return c7.PolylineEdgeRouter.KIND+":"+s7.RECTANGULAR_ANCHOR_KIND}getAnchor(e,t,i=0){const o=e.bounds,r=Ep.Bounds.center(o),s=new Zhe(r,t);if(!(0,Ep.almostEquals)(r.y,t.y)){const a=this.getXIntersection(o.y,r,t);a>=o.x&&a<=o.x+o.width&&s.addCandidate(a,o.y-i);const u=this.getXIntersection(o.y+o.height,r,t);u>=o.x&&u<=o.x+o.width&&s.addCandidate(u,o.y+o.height+i)}if(!(0,Ep.almostEquals)(r.x,t.x)){const a=this.getYIntersection(o.x,r,t);a>=o.y&&a<=o.y+o.height&&s.addCandidate(o.x-i,a);const u=this.getYIntersection(o.x+o.width,r,t);u>=o.y&&u<=o.y+o.height&&s.addCandidate(o.x+o.width+i,u)}return s.best}getXIntersection(e,t,i){const o=(e-t.y)/(i.y-t.y);return(i.x-t.x)*o+t.x}getYIntersection(e,t,i){const o=(e-t.x)/(i.x-t.x);return(i.y-t.y)*o+t.y}};wo.RectangleAnchor=e8;wo.RectangleAnchor=e8=r7([(0,a7.injectable)()],e8);class Zhe{constructor(e,t){this.centerPoint=e,this.refPoint=t,this.currentDist=-1}addCandidate(e,t){const i=this.refPoint.x-e,o=this.refPoint.y-t,r=i*i+o*o;(this.currentDist<0||r<this.currentDist)&&(this.currentBest={x:e,y:t},this.currentDist=r)}get best(){return this.currentBest===void 0?this.centerPoint:this.currentBest}}let t8=class{get kind(){return c7.PolylineEdgeRouter.KIND+":"+s7.DIAMOND_ANCHOR_KIND}getAnchor(e,t,i){const o=e.bounds,r=new sT.PointToPointLine(Ep.Bounds.center(o),t),s=new sT.Diamond(o).closestSideLine(t),a=(0,sT.intersection)(s,r);return Ep.Point.shiftTowards(a,t,i)}};wo.DiamondAnchor=t8;wo.DiamondAnchor=t8=r7([(0,a7.injectable)()],t8);var Zi={},EU=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Qhe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},$$=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}},$v;Object.defineProperty(Zi,"__esModule",{value:!0});Zi.AddRemoveBezierSegmentCommand=Zi.AddRemoveBezierSegmentAction=Zi.BezierMouseListener=Zi.BezierEdgeRouter=void 0;const r3=k,k$=Te,Sd=an,F$=vi,Xhe=Xo,Jhe=Ut,epe=ze,tpe=me;let zp=$v=class extends Xhe.AbstractEdgeRouter{get kind(){return $v.KIND}route(e){if(!e.source||!e.target)return[];const t=e.routingPoints.length,i=e.source,o=e.target,r=[];if(r.push({kind:"source",x:0,y:0}),t===0){const[g,y]=this.createDefaultBezierHandles(i.position,o.position);r.push({kind:"bezier-control-after",x:g.x,y:g.y,pointIndex:0}),r.push({kind:"bezier-control-before",x:y.x,y:y.y,pointIndex:1}),e.routingPoints.push(g),e.routingPoints.push(y)}else if(t>=2)for(let g=0;g<t;g++){const y=e.routingPoints[g];g%3===0&&r.push({kind:"bezier-control-after",x:y.x,y:y.y,pointIndex:g}),(g+1)%3===0?r.push({kind:"bezier-junction",x:y.x,y:y.y,pointIndex:g}):(g+2)%3===0&&r.push({kind:"bezier-control-before",x:y.x,y:y.y,pointIndex:g})}r.push({kind:"target",x:0,y:0});const s=t>2?e.routingPoints[2]:o.position,a=t>2?e.routingPoints[e.routingPoints.length-3]:i.position,u=this.getTranslatedAnchor(i,s,o.parent,e,e.sourceAnchorCorrection),h=this.getTranslatedAnchor(o,a,i.parent,e,e.targetAnchorCorrection);return r[0]={kind:"source",x:u.x,y:u.y},r[r.length-1]={kind:"target",x:h.x,y:h.y},r}createDefaultBezierHandles(e,t){const i={x:e.x-$v.DEFAULT_BEZIER_HANDLE_OFFSET,y:e.y},o={x:t.x+$v.DEFAULT_BEZIER_HANDLE_OFFSET,y:t.y};return[i,o]}createRoutingHandles(e){this.route(e),this.rebuildHandles(e)}rebuildHandles(e){this.addHandle(e,"source","routing-point",-2),this.addHandle(e,"bezier-control-after","bezier-routing-point",0),this.addHandle(e,"bezier-add","bezier-create-routing-point",0);const t=e.routingPoints.length;if(t>2)for(let i=1;i<t-1;i+=3)this.addHandle(e,"bezier-control-before","bezier-routing-point",i),this.addHandle(e,"bezier-add","bezier-create-routing-point",i+1),this.addHandle(e,"bezier-junction","routing-point",i+1),this.addHandle(e,"bezier-remove","bezier-remove-routing-point",i+1),this.addHandle(e,"bezier-control-after","bezier-routing-point",i+2),this.moveBezierControlPair(e.routingPoints[i],i,e);this.addHandle(e,"bezier-control-before","bezier-routing-point",t-1),this.addHandle(e,"target","routing-point",-1)}getInnerHandlePosition(e,t,i){if(i.kind==="bezier-control-before"||i.kind==="bezier-junction"||i.kind==="bezier-control-after")for(let o=0;o<t.length;o++){const r=t[o];if(r.pointIndex===i.pointIndex&&r.kind===i.kind)return r}else if(i.kind==="bezier-add"){const o=this.findBezierControl(e,t,i.pointIndex);return{x:o.x,y:o.y+12.5}}else if(i.kind==="bezier-remove"){const o=this.findBezierControl(e,t,i.pointIndex);return{x:o.x,y:o.y-12.5}}}findBezierControl(e,t,i){let o={x:t[0].x,y:t[0].y};if(i>0){for(const r of t)if(r.pointIndex!==void 0&&r.pointIndex===i&&r.kind==="bezier-junction"){o={x:r.x,y:r.y};break}}return o}applyHandleMoves(e,t){t.forEach(i=>{const o=i.handle;let r={x:0,y:0},s,a,u;const h=i.toPosition;switch(o.kind){case"bezier-control-before":case"bezier-control-after":this.moveBezierControlPair(h,i.handle.pointIndex,e);break;case"bezier-junction":const g=o.pointIndex;g>=0&&g<e.routingPoints.length&&(u=g-1,r=e.routingPoints[g],s=e.routingPoints[u],a=this.calcRelativeMove(r,h,s),e.routingPoints[g]=h,this.moveBezierControlPair(a,u,e));break;case"source":if(u=0,s=e.routingPoints[u],e.source instanceof Sd.SDanglingAnchorImpl)o.danglingAnchor&&(r=o.danglingAnchor.position,o.danglingAnchor.position=h);else{const y=new Sd.SDanglingAnchorImpl;y.id=e.id+"_dangling-source",y.original=e.source,y.position=i.toPosition,o.root.add(y),o.danglingAnchor=y,e.sourceId=y.id,e.source&&(r=e.source.position)}a=this.calcRelativeMove(r,h,s),this.moveBezierControlPair(a,u,e);break;case"target":if(u=e.routingPoints.length-1,s=e.routingPoints[u],e.target instanceof Sd.SDanglingAnchorImpl)o.danglingAnchor&&(r=o.danglingAnchor.position,o.danglingAnchor.position=h);else{const y=new Sd.SDanglingAnchorImpl;y.id=e.id+"_dangling-target",y.original=e.target,y.position=h,o.root.add(y),o.danglingAnchor=y,e.targetId=y.id,e.target&&(r=e.target.position)}a=this.calcRelativeMove(r,h,s),this.moveBezierControlPair(a,u,e);break}})}applyInnerHandleMoves(e,t){}getOptions(e){return{minimalPointDistance:2,standardDistance:.1,selfEdgeOffset:20}}calcRelativeMove(e,t,i){return{x:i.x-(e.x-t.x),y:i.y-(e.y-t.y)}}createNewBezierSegment(e,t){const i=t.routingPoints;let o,r,s;i.length===2?(r=i[e<0?0:e],s=i[i.length-1],o=(0,k$.centerOfLine)(r,s)):(r=i[e],s=i[e+2],o=(0,k$.centerOfLine)(r,s));const[a,u]=this.createDefaultBezierHandles(o,o);i.splice(e+1,0,a),i.splice(e+2,0,o),i.splice(e+3,0,u),this.moveBezierControlPair(a,e+1,t),t.removeAll(h=>h instanceof Sd.SRoutingHandleImpl),this.rebuildHandles(t)}removeBezierSegment(e,t){t.routingPoints.splice(e-1,3),t.removeAll(o=>o instanceof Sd.SRoutingHandleImpl),this.rebuildHandles(t)}moveBezierControlPair(e,t,i){if(t>=0&&t<i.routingPoints.length){const o=t-1,r=t+1;o<0||r===i.routingPoints.length?i.routingPoints[t]=e:t%3===0?this.setBezierMirror(i,e,t,!1):(t+2)%3===0&&this.setBezierMirror(i,e,t,!0)}}setBezierMirror(e,t,i,o){e.routingPoints[i]=t;const r=e.routingPoints[o?i+1:i-1];e.routingPoints[o?i+2:i-2]={x:r.x-(t.x-r.x),y:r.y-(t.y-r.y)}}};Zi.BezierEdgeRouter=zp;zp.KIND="bezier";zp.DEFAULT_BEZIER_HANDLE_OFFSET=25;Zi.BezierEdgeRouter=zp=$v=EU([(0,r3.injectable)()],zp);class npe extends Jhe.MouseListener{mouseDown(e,t){const i=[];return e instanceof Sd.SRoutingHandleImpl&&(e.kind==="bezier-add"||e.kind==="bezier-remove")&&(e.type==="bezier-create-routing-point"?i.push(Q_.create("add",e.id)):e.type==="bezier-remove-routing-point"&&i.push(Q_.create("remove",e.id))),i}}Zi.BezierMouseListener=npe;var Q_;(function(n){n.KIND="addRemoveBezierSegment";function e(t,i){return{kind:n.KIND,actionTask:t,targetId:i}}n.create=e})(Q_||(Zi.AddRemoveBezierSegmentAction=Q_={}));let EC=class extends epe.Command{constructor(e,t){super(),this.action=e,this.edgeRouterRegistry=t}execute(e){const i=e.root.index.getById(this.action.targetId);if(this.edgeRouterRegistry&&i instanceof Sd.SRoutingHandleImpl){const o=this.edgeRouterRegistry.get(i.parent.routerKind);if(o instanceof zp){const r=o;for(const s of e.root.children)if(s.id===i.parent.id){this.action.actionTask==="add"?r.createNewBezierSegment(i.pointIndex,s):this.action.actionTask==="remove"&&r.removeBezierSegment(i.pointIndex,s);break}}}return e.root}undo(e){throw new Error("Method not implemented.")}redo(e){throw new Error("Method not implemented.")}};Zi.AddRemoveBezierSegmentCommand=EC;EC.KIND=Q_.KIND;Zi.AddRemoveBezierSegmentCommand=EC=EU([(0,r3.injectable)(),$$(0,(0,r3.inject)(tpe.TYPES.Action)),$$(1,(0,r3.inject)(F$.EdgeRouterRegistry)),Qhe("design:paramtypes",[Object,F$.EdgeRouterRegistry])],EC);var d7=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Jo,"__esModule",{value:!0});Jo.BezierDiamondAnchor=Jo.BezierRectangleAnchor=Jo.BezierEllipseAnchor=void 0;const u7=Ra,l7=k,f7=wo,h7=Zi;let n8=class extends f7.EllipseAnchor{get kind(){return h7.BezierEdgeRouter.KIND+":"+u7.ELLIPTIC_ANCHOR_KIND}};Jo.BezierEllipseAnchor=n8;Jo.BezierEllipseAnchor=n8=d7([(0,l7.injectable)()],n8);let i8=class extends f7.RectangleAnchor{get kind(){return h7.BezierEdgeRouter.KIND+":"+u7.RECTANGULAR_ANCHOR_KIND}};Jo.BezierRectangleAnchor=i8;Jo.BezierRectangleAnchor=i8=d7([(0,l7.injectable)()],i8);let o8=class extends f7.DiamondAnchor{get kind(){return h7.BezierEdgeRouter.KIND+":"+u7.DIAMOND_ANCHOR_KIND}};Jo.BezierDiamondAnchor=o8;Jo.BezierDiamondAnchor=o8=d7([(0,l7.injectable)()],o8);var er={},Uf={};Object.defineProperty(Uf,"__esModule",{value:!0});Uf.ManhattanEdgeRouter=void 0;const un=Te,x$=yt,de=Xo,aT=an;class EA extends de.AbstractEdgeRouter{get kind(){return EA.KIND}getOptions(e){return{standardDistance:20,minimalPointDistance:3,selfEdgeOffset:.25}}route(e){if(!e.source||!e.target)return[];const t=this.createRoutedCorners(e),i=t[0]||(0,x$.translatePoint)(un.Bounds.center(e.target.bounds),e.target.parent,e.parent),o=this.getTranslatedAnchor(e.source,i,e.parent,e,e.sourceAnchorCorrection),r=t[t.length-1]||(0,x$.translatePoint)(un.Bounds.center(e.source.bounds),e.source.parent,e.parent),s=this.getTranslatedAnchor(e.target,r,e.parent,e,e.targetAnchorCorrection);if(!o||!s)return[];const a=[];return a.push(Object.assign({kind:"source"},o)),t.forEach(u=>a.push(u)),a.push(Object.assign({kind:"target"},s)),a}createRoutedCorners(e){const t=new de.DefaultAnchors(e.source,e.parent,"source"),i=new de.DefaultAnchors(e.target,e.parent,"target");if(e.routingPoints.length>0){const s=e.routingPoints.slice();if(this.cleanupRoutingPoints(e,s,!1,!0),s.length>0)return s.map((a,u)=>Object.assign({kind:"linear",pointIndex:u},a))}const o=this.getOptions(e);return this.calculateDefaultCorners(e,t,i,o).map(s=>Object.assign({kind:"linear"},s))}createRoutingHandles(e){const t=this.route(e);if(this.commitRoute(e,t),t.length>0){this.addHandle(e,"source","routing-point",-2);for(let i=0;i<t.length-1;++i)this.addHandle(e,"manhattan-50%","volatile-routing-point",i-1);this.addHandle(e,"target","routing-point",t.length-2)}}getInnerHandlePosition(e,t,i){const o=this.getFraction(i.kind);if(o!==void 0){const{start:r,end:s}=this.findRouteSegment(e,t,i.pointIndex);if(r!==void 0&&s!==void 0)return un.Point.linear(r,s,o)}}getFraction(e){switch(e){case"manhattan-50%":return .5;default:return}}applyInnerHandleMoves(e,t){const i=this.route(e),o=e.routingPoints,r=this.getOptions(e).minimalPointDistance;t.forEach(s=>{const a=s.handle,u=a.pointIndex,h=this.correctX(o,u,s.toPosition.x,r),g=this.correctY(o,u,s.toPosition.y,r);switch(a.kind){case"manhattan-50%":u<0?o.length===0?(o.push({x:h,y:g}),a.pointIndex=0):(0,un.almostEquals)(i[0].x,i[1].x)?this.alignX(o,0,h):this.alignY(o,0,g):u<o.length-1?(0,un.almostEquals)(o[u].x,o[u+1].x)?(this.alignX(o,u,h),this.alignX(o,u+1,h)):(this.alignY(o,u,g),this.alignY(o,u+1,g)):(0,un.almostEquals)(i[i.length-2].x,i[i.length-1].x)?this.alignX(o,o.length-1,h):this.alignY(o,o.length-1,g);break}})}correctX(e,t,i,o){return t>0&&Math.abs(i-e[t-1].x)<o?e[t-1].x:t<e.length-2&&Math.abs(i-e[t+2].x)<o?e[t+2].x:i}alignX(e,t,i){t>=0&&t<e.length&&(e[t]={x:i,y:e[t].y})}correctY(e,t,i,o){return t>0&&Math.abs(i-e[t-1].y)<o?e[t-1].y:t<e.length-2&&Math.abs(i-e[t+2].y)<o?e[t+2].y:i}alignY(e,t,i){t>=0&&t<e.length&&(e[t]={x:e[t].x,y:i})}cleanupRoutingPoints(e,t,i,o){const r=new de.DefaultAnchors(e.source,e.parent,"source"),s=new de.DefaultAnchors(e.target,e.parent,"target");if(!this.resetRoutingPointsOnReconnect(e,t,i,r,s)){for(let a=0;a<t.length&&un.Bounds.includes(r.bounds,t[a]);++a)t.splice(0,1),i&&this.removeHandle(e,-1);for(let a=t.length-1;a>=0&&un.Bounds.includes(s.bounds,t[a]);--a)t.splice(a,1),i&&this.removeHandle(e,a);if(t.length>=2){const a=this.getOptions(e);for(let u=t.length-2;u>=0;--u)un.Point.manhattanDistance(t[u],t[u+1])<a.minimalPointDistance&&(t.splice(u,2),--u,i&&(this.removeHandle(e,u-1),this.removeHandle(e,u)))}o&&(this.addAdditionalCorner(e,t,r,s,i),this.addAdditionalCorner(e,t,s,r,i),this.manhattanify(e,t))}}removeHandle(e,t){const i=[];e.children.forEach(o=>{o instanceof aT.SRoutingHandleImpl&&(o.pointIndex>t?--o.pointIndex:o.pointIndex===t&&i.push(o))}),i.forEach(o=>e.remove(o))}addAdditionalCorner(e,t,i,o,r){if(t.length===0)return;const s=i.kind==="source"?t[0]:t[t.length-1],a=i.kind==="source"?0:t.length,u=a-(i.kind==="source"?1:0);let h;if(t.length>1)h=a===0?(0,un.almostEquals)(t[0].x,t[1].x):(0,un.almostEquals)(t[t.length-1].x,t[t.length-2].x);else{const g=o.getNearestSide(s);h=g===de.Side.TOP||g===de.Side.BOTTOM}if(h){if(s.y<i.get(de.Side.TOP).y||s.y>i.get(de.Side.BOTTOM).y){const g={x:i.get(de.Side.TOP).x,y:s.y};t.splice(a,0,g),r&&(e.children.forEach(y=>{y instanceof aT.SRoutingHandleImpl&&y.pointIndex>=u&&++y.pointIndex}),this.addHandle(e,"manhattan-50%","volatile-routing-point",u))}}else if(s.x<i.get(de.Side.LEFT).x||s.x>i.get(de.Side.RIGHT).x){const g={x:s.x,y:i.get(de.Side.LEFT).y};t.splice(a,0,g),r&&(e.children.forEach(y=>{y instanceof aT.SRoutingHandleImpl&&y.pointIndex>=u&&++y.pointIndex}),this.addHandle(e,"manhattan-50%","volatile-routing-point",u))}}manhattanify(e,t){for(let i=1;i<t.length;++i){const o=Math.abs(t[i-1].x-t[i].x)<1,r=Math.abs(t[i-1].y-t[i].y)<1;!o&&!r&&(t.splice(i,0,{x:t[i-1].x,y:t[i].y}),++i)}}calculateDefaultCorners(e,t,i,o){const r=super.calculateDefaultCorners(e,t,i,o);if(r.length>0)return r;const s=this.getBestConnectionAnchors(e,t,i,o),a=s.source,u=s.target,h=[],g=t.get(a);let y=i.get(u);switch(a){case de.Side.RIGHT:switch(u){case de.Side.BOTTOM:h.push({x:y.x,y:g.y});break;case de.Side.TOP:h.push({x:y.x,y:g.y});break;case de.Side.RIGHT:h.push({x:Math.max(g.x,y.x)+1.5*o.standardDistance,y:g.y}),h.push({x:Math.max(g.x,y.x)+1.5*o.standardDistance,y:y.y});break;case de.Side.LEFT:y.y!==g.y&&(h.push({x:(g.x+y.x)/2,y:g.y}),h.push({x:(g.x+y.x)/2,y:y.y}));break}break;case de.Side.LEFT:switch(u){case de.Side.BOTTOM:h.push({x:y.x,y:g.y});break;case de.Side.TOP:h.push({x:y.x,y:g.y});break;default:y=i.get(de.Side.RIGHT),y.y!==g.y&&(h.push({x:(g.x+y.x)/2,y:g.y}),h.push({x:(g.x+y.x)/2,y:y.y}));break}break;case de.Side.TOP:switch(u){case de.Side.RIGHT:y.x-g.x>0?(h.push({x:g.x,y:g.y-o.standardDistance}),h.push({x:y.x+1.5*o.standardDistance,y:g.y-o.standardDistance}),h.push({x:y.x+1.5*o.standardDistance,y:y.y})):h.push({x:g.x,y:y.y});break;case de.Side.LEFT:y.x-g.x<0?(h.push({x:g.x,y:g.y-o.standardDistance}),h.push({x:y.x-1.5*o.standardDistance,y:g.y-o.standardDistance}),h.push({x:y.x-1.5*o.standardDistance,y:y.y})):h.push({x:g.x,y:y.y});break;case de.Side.TOP:h.push({x:g.x,y:Math.min(g.y,y.y)-1.5*o.standardDistance}),h.push({x:y.x,y:Math.min(g.y,y.y)-1.5*o.standardDistance});break;case de.Side.BOTTOM:y.x!==g.x&&(h.push({x:g.x,y:(g.y+y.y)/2}),h.push({x:y.x,y:(g.y+y.y)/2}));break}break;case de.Side.BOTTOM:switch(u){case de.Side.RIGHT:y.x-g.x>0?(h.push({x:g.x,y:g.y+o.standardDistance}),h.push({x:y.x+1.5*o.standardDistance,y:g.y+o.standardDistance}),h.push({x:y.x+1.5*o.standardDistance,y:y.y})):h.push({x:g.x,y:y.y});break;case de.Side.LEFT:y.x-g.x<0?(h.push({x:g.x,y:g.y+o.standardDistance}),h.push({x:y.x-1.5*o.standardDistance,y:g.y+o.standardDistance}),h.push({x:y.x-1.5*o.standardDistance,y:y.y})):h.push({x:g.x,y:y.y});break;default:y=i.get(de.Side.TOP),y.x!==g.x&&(h.push({x:g.x,y:(g.y+y.y)/2}),h.push({x:y.x,y:(g.y+y.y)/2}));break}break}return h}getBestConnectionAnchors(e,t,i,o){let r=t.get(de.Side.RIGHT),s=i.get(de.Side.LEFT);if(s.x-r.x>o.standardDistance)return{source:de.Side.RIGHT,target:de.Side.LEFT};if(r=t.get(de.Side.LEFT),s=i.get(de.Side.RIGHT),r.x-s.x>o.standardDistance)return{source:de.Side.LEFT,target:de.Side.RIGHT};if(r=t.get(de.Side.TOP),s=i.get(de.Side.BOTTOM),r.y-s.y>o.standardDistance)return{source:de.Side.TOP,target:de.Side.BOTTOM};if(r=t.get(de.Side.BOTTOM),s=i.get(de.Side.TOP),s.y-r.y>o.standardDistance)return{source:de.Side.BOTTOM,target:de.Side.TOP};if(r=t.get(de.Side.RIGHT),s=i.get(de.Side.TOP),s.x-r.x>.5*o.standardDistance&&s.y-r.y>o.standardDistance)return{source:de.Side.RIGHT,target:de.Side.TOP};if(s=i.get(de.Side.BOTTOM),s.x-r.x>.5*o.standardDistance&&r.y-s.y>o.standardDistance)return{source:de.Side.RIGHT,target:de.Side.BOTTOM};if(r=t.get(de.Side.LEFT),s=i.get(de.Side.BOTTOM),r.x-s.x>.5*o.standardDistance&&r.y-s.y>o.standardDistance)return{source:de.Side.LEFT,target:de.Side.BOTTOM};if(s=i.get(de.Side.TOP),r.x-s.x>.5*o.standardDistance&&s.y-r.y>o.standardDistance)return{source:de.Side.LEFT,target:de.Side.TOP};if(r=t.get(de.Side.TOP),s=i.get(de.Side.RIGHT),r.y-s.y>.5*o.standardDistance&&r.x-s.x>o.standardDistance)return{source:de.Side.TOP,target:de.Side.RIGHT};if(s=i.get(de.Side.LEFT),r.y-s.y>.5*o.standardDistance&&s.x-r.x>o.standardDistance)return{source:de.Side.TOP,target:de.Side.LEFT};if(r=t.get(de.Side.BOTTOM),s=i.get(de.Side.RIGHT),s.y-r.y>.5*o.standardDistance&&r.x-s.x>o.standardDistance)return{source:de.Side.BOTTOM,target:de.Side.RIGHT};if(s=i.get(de.Side.LEFT),s.y-r.y>.5*o.standardDistance&&s.x-r.x>o.standardDistance)return{source:de.Side.BOTTOM,target:de.Side.LEFT};if(r=t.get(de.Side.TOP),s=i.get(de.Side.TOP),!un.Bounds.includes(i.bounds,r)&&!un.Bounds.includes(t.bounds,s)){if(r.y-s.y<0){if(Math.abs(r.x-s.x)>(t.bounds.width+o.standardDistance)/2)return{source:de.Side.TOP,target:de.Side.TOP}}else if(Math.abs(r.x-s.x)>i.bounds.width/2)return{source:de.Side.TOP,target:de.Side.TOP}}if(r=t.get(de.Side.RIGHT),s=i.get(de.Side.RIGHT),!un.Bounds.includes(i.bounds,r)&&!un.Bounds.includes(t.bounds,s)){if(r.x-s.x>0){if(Math.abs(r.y-s.y)>(t.bounds.height+o.standardDistance)/2)return{source:de.Side.RIGHT,target:de.Side.RIGHT}}else if(Math.abs(r.y-s.y)>i.bounds.height/2)return{source:de.Side.RIGHT,target:de.Side.RIGHT}}return r=t.get(de.Side.TOP),s=i.get(de.Side.RIGHT),!un.Bounds.includes(i.bounds,r)&&!un.Bounds.includes(t.bounds,s)?{source:de.Side.TOP,target:de.Side.RIGHT}:(s=i.get(de.Side.LEFT),!un.Bounds.includes(i.bounds,r)&&!un.Bounds.includes(t.bounds,s)?{source:de.Side.TOP,target:de.Side.LEFT}:(r=t.get(de.Side.BOTTOM),s=i.get(de.Side.RIGHT),!un.Bounds.includes(i.bounds,r)&&!un.Bounds.includes(t.bounds,s)?{source:de.Side.BOTTOM,target:de.Side.RIGHT}:(s=i.get(de.Side.LEFT),!un.Bounds.includes(i.bounds,r)&&!un.Bounds.includes(t.bounds,s)?{source:de.Side.BOTTOM,target:de.Side.LEFT}:{source:de.Side.RIGHT,target:de.Side.BOTTOM})))}}Uf.ManhattanEdgeRouter=EA;EA.KIND="manhattan";var p7=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},r8,s8,a8;Object.defineProperty(er,"__esModule",{value:!0});er.ManhattanEllipticAnchor=er.ManhattanDiamondAnchor=er.ManhattanRectangularAnchor=void 0;const CC=Te,ko=ei,m7=Ra,g7=Uf,v7=k;let PC=r8=class{get kind(){return r8.KIND}getAnchor(e,t,i){const o=e.bounds;if(o.width<=0||o.height<=0)return o;const r={x:o.x-i,y:o.y-i,width:o.width+2*i,height:o.height+2*i};return t.x>=r.x&&r.x+r.width>=t.x?t.y<r.y+.5*r.height?{x:t.x,y:r.y}:{x:t.x,y:r.y+r.height}:t.y>=r.y&&r.y+r.height>=t.y?t.x<r.x+.5*r.width?{x:r.x,y:t.y}:{x:r.x+r.width,y:t.y}:CC.Bounds.center(r)}};er.ManhattanRectangularAnchor=PC;PC.KIND=g7.ManhattanEdgeRouter.KIND+":"+m7.RECTANGULAR_ANCHOR_KIND;er.ManhattanRectangularAnchor=PC=r8=p7([(0,v7.injectable)()],PC);let wC=s8=class{get kind(){return s8.KIND}getAnchor(e,t,i=0){const o=e.bounds;if(o.width<=0||o.height<=0)return o;const r={x:o.x-i,y:o.y-i,width:o.width+2*i,height:o.height+2*i},s=CC.Bounds.center(r);let a,u;return t.x>=r.x&&t.x<=r.x+r.width?r.x+.5*r.width>=t.x?(u=new ko.PointToPointLine(t,{x:t.x,y:s.y}),t.y<s.y?a=new ko.PointToPointLine({x:r.x,y:s.y},{x:s.x,y:r.y}):a=new ko.PointToPointLine({x:r.x,y:s.y},{x:s.x,y:r.y+r.height})):(u=new ko.PointToPointLine(t,{x:t.x,y:s.y}),t.y<s.y?a=new ko.PointToPointLine({x:r.x+r.width,y:s.y},{x:s.x,y:r.y}):a=new ko.PointToPointLine({x:r.x+r.width,y:s.y},{x:s.x,y:r.y+r.height})):t.y>=r.y&&t.y<=r.y+r.height&&(r.y+.5*r.height>=t.y?(u=new ko.PointToPointLine(t,{x:s.x,y:t.y}),t.x<s.x?a=new ko.PointToPointLine({x:r.x,y:s.y},{x:s.x,y:r.y}):a=new ko.PointToPointLine({x:r.x+r.width,y:s.y},{x:s.x,y:r.y})):(u=new ko.PointToPointLine(t,{x:s.x,y:t.y}),t.x<s.x?a=new ko.PointToPointLine({x:r.x,y:s.y},{x:s.x,y:r.y+r.height}):a=new ko.PointToPointLine({x:r.x+r.width,y:s.y},{x:s.x,y:r.y+r.height}))),u&&a?(0,ko.intersection)(a,u):s}};er.ManhattanDiamondAnchor=wC;wC.KIND=g7.ManhattanEdgeRouter.KIND+":"+m7.DIAMOND_ANCHOR_KIND;er.ManhattanDiamondAnchor=wC=s8=p7([(0,v7.injectable)()],wC);let AC=a8=class{get kind(){return a8.KIND}getAnchor(e,t,i=0){const o=e.bounds;if(o.width<=0||o.height<=0)return o;const r={x:o.x-i,y:o.y-i,width:o.width+2*i,height:o.height+2*i},s=CC.Bounds.center(r),a=CC.Point.subtract(t,s);let u=s.x,h=s.y;if(t.x>=r.x&&r.x+r.width>=t.x){u+=a.x;const g=.5*r.height*Math.sqrt(1-a.x*a.x/(.25*r.width*r.width));a.y<0?h-=g:h+=g}else if(t.y>=r.y&&r.y+r.height>=t.y){h+=a.y;const g=.5*r.width*Math.sqrt(1-a.y*a.y/(.25*r.height*r.height));a.x<0?u-=g:u+=g}return{x:u,y:h}}};er.ManhattanEllipticAnchor=AC;AC.KIND=g7.ManhattanEdgeRouter.KIND+":"+m7.ELLIPTIC_ANCHOR_KIND;er.ManhattanEllipticAnchor=AC=a8=p7([(0,v7.injectable)()],AC);var Yf={},ipe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Yf,"__esModule",{value:!0});Yf.RoutableView=void 0;const ope=k,rpe=an;let c8=class{isVisible(e,t,i){if(i.targetKind==="hidden"||t.length===0)return!0;const o=(0,rpe.getAbsoluteRouteBounds)(e,t),r=e.root.canvasBounds;return o.x<=r.width&&o.x+o.width>=0&&o.y<=r.height&&o.y+o.height>=0}};Yf.RoutableView=c8;Yf.RoutableView=c8=ipe([(0,ope.injectable)()],c8);var fi={},fg={},CU=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},spe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(fg,"__esModule",{value:!0});fg.ModelRequestCommand=void 0;const PU=k,ape=me,cpe=ze;let RC=class extends cpe.SystemCommand{execute(e){const t=this.retrieveResult(e);return this.actionDispatcher.dispatch(t),{model:e.root,modelChanged:!1}}undo(e){return{model:e.root,modelChanged:!1}}redo(e){return{model:e.root,modelChanged:!1}}};fg.ModelRequestCommand=RC;CU([(0,PU.inject)(ape.TYPES.IActionDispatcher),spe("design:type",Object)],RC.prototype,"actionDispatcher",void 0);fg.ModelRequestCommand=RC=CU([(0,PU.injectable)()],RC);var hc={},dpe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},upe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(hc,"__esModule",{value:!0});hc.findViewportScrollbar=hc.ScrollMouseListener=void 0;const lpe=k,cT=se,Bh=Te,fpe=ke,hpe=Ut,dv=yt,fE=Rs,ppe=xc,mpe=an,gpe=Yo,vpe=sn,_pe=me;class wU extends hpe.MouseListener{constructor(){super(...arguments),this.scrollbarMouseDownDelay=200}mouseDown(e,t){if((0,dv.findParentByFeature)(e,ppe.isMoveable)===void 0&&!(e instanceof mpe.SRoutingHandleImpl)){const o=(0,dv.findParentByFeature)(e,fE.isViewport);if(o){if(this.lastScrollPosition={x:t.pageX,y:t.pageY},this.scrollbar=this.getScrollbar(t),this.scrollbar)return window.clearTimeout(this.scrollbarMouseDownTimeout),this.moveScrollBar(o,t,this.scrollbar,!0).map(r=>new Promise(s=>{this.scrollbarMouseDownTimeout=window.setTimeout(()=>s(r),this.scrollbarMouseDownDelay)}))}else this.lastScrollPosition=void 0,this.scrollbar=void 0}return[]}mouseMove(e,t){if(t.buttons===0)return this.mouseUp(e,t);if(this.scrollbar){window.clearTimeout(this.scrollbarMouseDownTimeout);const i=(0,dv.findParentByFeature)(e,fE.isViewport);if(i)return this.moveScrollBar(i,t,this.scrollbar)}if(this.lastScrollPosition){const i=(0,dv.findParentByFeature)(e,fE.isViewport);if(i)return this.dragCanvas(i,t,this.lastScrollPosition)}return[]}mouseEnter(e,t){return e instanceof fpe.SModelRootImpl&&t.buttons===0&&this.mouseUp(e,t),[]}mouseUp(e,t){return this.lastScrollPosition=void 0,this.scrollbar=void 0,[]}doubleClick(e,t){if((0,dv.findParentByFeature)(e,fE.isViewport)){const o=this.getScrollbar(t);if(o){window.clearTimeout(this.scrollbarMouseDownTimeout);const r=this.findClickTarget(o,t);let s;if(r&&r.id.startsWith("horizontal-projection:")?s=r.id.substring(22):r&&r.id.startsWith("vertical-projection:")&&(s=r.id.substring(20)),s)return[cT.CenterAction.create([s],{animate:!0,retainZoom:!0})]}}return[]}dragCanvas(e,t,i){let o=(t.pageX-i.x)/e.zoom;(o>0&&(0,Bh.almostEquals)(e.scroll.x,this.viewerOptions.horizontalScrollLimits.min)||o<0&&(0,Bh.almostEquals)(e.scroll.x,this.viewerOptions.horizontalScrollLimits.max-e.canvasBounds.width/e.zoom))&&(o=0);let r=(t.pageY-i.y)/e.zoom;if((r>0&&(0,Bh.almostEquals)(e.scroll.y,this.viewerOptions.verticalScrollLimits.min)||r<0&&(0,Bh.almostEquals)(e.scroll.y,this.viewerOptions.verticalScrollLimits.max-e.canvasBounds.height/e.zoom))&&(r=0),o===0&&r===0)return[];const s={scroll:{x:e.scroll.x-o,y:e.scroll.y-r},zoom:e.zoom};return this.lastScrollPosition={x:t.pageX,y:t.pageY},[cT.SetViewportAction.create(e.id,s,{animate:!1})]}moveScrollBar(e,t,i,o=!1){const r=(0,gpe.getModelBounds)(e);if(!r||e.zoom<=0)return[];const s=i.getBoundingClientRect();let a;if(this.getScrollbarOrientation(i)==="horizontal"){if(s.width<=0)return[];const u=e.canvasBounds.width/(e.zoom*r.width)*s.width;let h=t.clientX-s.x-u/2;if(h<0?h=0:h>s.width-u&&(h=s.width-u),a={x:r.x+h/s.width*r.width,y:e.scroll.y},a.x<this.viewerOptions.horizontalScrollLimits.min?a.x=this.viewerOptions.horizontalScrollLimits.min:a.x>this.viewerOptions.horizontalScrollLimits.max-e.canvasBounds.width/e.zoom&&(a.x=this.viewerOptions.horizontalScrollLimits.max-e.canvasBounds.width/e.zoom),(0,Bh.almostEquals)(a.x,e.scroll.x))return[]}else{if(s.height<=0)return[];const u=e.canvasBounds.height/(e.zoom*r.height)*s.height;let h=t.clientY-s.y-u/2;if(h<0?h=0:h>s.height-u&&(h=s.height-u),a={x:e.scroll.x,y:r.y+h/s.height*r.height},a.y<this.viewerOptions.verticalScrollLimits.min?a.y=this.viewerOptions.verticalScrollLimits.min:a.y>this.viewerOptions.verticalScrollLimits.max-e.canvasBounds.height/e.zoom&&(a.y=this.viewerOptions.verticalScrollLimits.max-e.canvasBounds.height/e.zoom),(0,Bh.almostEquals)(a.y,e.scroll.y))return[]}return[cT.SetViewportAction.create(e.id,{scroll:a,zoom:e.zoom},{animate:o})]}getScrollbar(e){return AU(e)}getScrollbarOrientation(e){return e.classList.contains("horizontal")?"horizontal":"vertical"}findClickTarget(e,t){const i=Array.from(e.children).filter(o=>o.id&&o.classList.contains("sprotty-projection")&&(0,vpe.hitsMouseEvent)(o,t));if(i.length>0)return i[i.length-1]}}hc.ScrollMouseListener=wU;dpe([(0,lpe.inject)(_pe.TYPES.ViewerOptions),upe("design:type",Object)],wU.prototype,"viewerOptions",void 0);function AU(n){let e=n.target;for(;e;){if(e.classList&&e.classList.contains("sprotty-projection-bar"))return e;e=e.parentElement}}hc.findViewportScrollbar=AU;var CA=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},PA=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},_7=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(fi,"__esModule",{value:!0});fi.SelectKeyboardListener=fi.GetSelectionCommand=fi.SelectMouseListener=fi.SelectAllCommand=fi.SelectCommand=void 0;const iu=k,Vs=se,RU=ze,ype=fg,o_=ke,dT=yt,y7=me,bpe=gi,Spe=Ut,Epe=ft,H$=sn,MU=Io,Cpe=qt,K$=ps,Ppe=rg,hE=_s,wpe=an,pE=an,Ape=hc,Ja=no;let MC=class extends RU.Command{constructor(e){super(),this.action=e,this.selected=[],this.deselected=[]}execute(e){const t=e.root;return this.action.selectedElementsIDs.forEach(i=>{const o=t.index.getById(i);o instanceof o_.SChildElementImpl&&(0,Ja.isSelectable)(o)&&this.selected.push(o)}),this.action.deselectedElementsIDs.forEach(i=>{const o=t.index.getById(i);o instanceof o_.SChildElementImpl&&(0,Ja.isSelectable)(o)&&this.deselected.push(o)}),this.redo(e)}undo(e){for(const t of this.selected)t.selected=!1;for(const t of this.deselected)t.selected=!0;return e.root}redo(e){for(const t of this.deselected)t.selected=!1;for(const t of this.selected)t.selected=!0;return e.root}};fi.SelectCommand=MC;MC.KIND=Vs.SelectAction.KIND;fi.SelectCommand=MC=CA([(0,iu.injectable)(),_7(0,(0,iu.inject)(y7.TYPES.Action)),PA("design:paramtypes",[Object])],MC);let IC=class extends RU.Command{constructor(e){super(),this.action=e,this.previousSelection={}}execute(e){return this.selectAll(e.root,this.action.select),e.root}selectAll(e,t){(0,Ja.isSelectable)(e)&&(this.previousSelection[e.id]=e.selected,e.selected=t);for(const i of e.children)this.selectAll(i,t)}undo(e){const t=e.root.index;return Object.keys(this.previousSelection).forEach(i=>{const o=t.getById(i);o!==void 0&&(0,Ja.isSelectable)(o)&&(o.selected=this.previousSelection[i])}),e.root}redo(e){return this.selectAll(e.root,this.action.select),e.root}};fi.SelectAllCommand=IC;IC.KIND=Vs.SelectAllAction.KIND;fi.SelectAllCommand=IC=CA([(0,iu.injectable)(),_7(0,(0,iu.inject)(y7.TYPES.Action)),PA("design:paramtypes",[Object])],IC);class IU extends Spe.MouseListener{constructor(){super(...arguments),this.wasSelected=!1,this.hasDragged=!1,this.isMouseDown=!1}mouseDown(e,t){if(t.button!==0)return[];this.isMouseDown=!0;const i=this.handleButton(e,t);if(i)return i;const o=(0,dT.findParentByFeature)(e,Ja.isSelectable);if((o!==void 0||e instanceof o_.SModelRootImpl)&&(this.hasDragged=!1),o!==void 0){let r=[];if((0,H$.isCtrlOrCmd)(t)||(r=this.collectElementsToDeselect(e,o)),o.selected){if((0,H$.isCtrlOrCmd)(t))return this.wasSelected=!1,this.handleDeselectTarget(o,t);this.wasSelected=!0}else return this.wasSelected=!1,this.handleSelectTarget(o,r,t)}return[]}collectElementsToDeselect(e,t){return(0,MU.toArray)(e.root.index.all().filter(i=>(0,Ja.isSelectable)(i)&&i.selected&&!(t instanceof wpe.SRoutingHandleImpl&&i===t.parent)))}handleButton(e,t){if(this.buttonHandlerRegistry!==void 0&&e instanceof Ppe.SButtonImpl&&e.enabled){const i=this.buttonHandlerRegistry.get(e.type);if(i!==void 0)return i.buttonPressed(e)}}handleSelectTarget(e,t,i){const o=[];o.push(Vs.SelectAction.create({selectedElementsIDs:[e.id],deselectedElementsIDs:t.map(s=>s.id)})),o.push(Vs.BringToFrontAction.create([e.id]));const r=t.filter(s=>s instanceof pE.SRoutableElementImpl).map(s=>s.id);return e instanceof pE.SRoutableElementImpl?o.push(hE.SwitchEditModeAction.create({elementsToActivate:[e.id],elementsToDeactivate:r})):r.length>0&&o.push(hE.SwitchEditModeAction.create({elementsToDeactivate:r})),o}handleDeselectTarget(e,t){const i=[];return i.push(Vs.SelectAction.create({selectedElementsIDs:[],deselectedElementsIDs:[e.id]})),e instanceof pE.SRoutableElementImpl&&i.push(hE.SwitchEditModeAction.create({elementsToDeactivate:[e.id]})),i}handleDeselectAll(e,t){const i=[];i.push(Vs.SelectAction.create({selectedElementsIDs:[],deselectedElementsIDs:e.map(r=>r.id)}));const o=e.filter(r=>r instanceof pE.SRoutableElementImpl).map(r=>r.id);return o.length>0&&i.push(hE.SwitchEditModeAction.create({elementsToDeactivate:o})),i}mouseMove(e,t){return this.hasDragged=this.isMouseDown,[]}mouseUp(e,t){if(t.button===0&&!this.hasDragged){const i=(0,dT.findParentByFeature)(e,Ja.isSelectable);if(i!==void 0){if(this.wasSelected)return[Vs.SelectAction.create({selectedElementsIDs:[i.id],deselectedElementsIDs:[]})]}else if(e instanceof o_.SModelRootImpl&&!(0,Ape.findViewportScrollbar)(t)||!(e instanceof o_.SModelRootImpl))return this.handleDeselectAll(this.collectElementsToDeselect(e,void 0),t)}return this.isMouseDown=!1,this.hasDragged=!1,[]}decorate(e,t){const i=(0,dT.findParentByFeature)(t,Ja.isSelectable);return i!==void 0&&(0,Epe.setClass)(e,"selected",i.selected),e}}fi.SelectMouseListener=IU;CA([(0,iu.inject)(K$.ButtonHandlerRegistry),(0,iu.optional)(),PA("design:type",K$.ButtonHandlerRegistry)],IU.prototype,"buttonHandlerRegistry",void 0);let TC=class extends ype.ModelRequestCommand{constructor(e){super(),this.action=e,this.previousSelection={}}retrieveResult(e){const t=e.root.index.all().filter(i=>(0,Ja.isSelectable)(i)&&i.selected).map(i=>i.id);return Vs.SelectionResult.create((0,MU.toArray)(t),this.action.requestId)}};fi.GetSelectionCommand=TC;TC.KIND=Vs.GetSelectionAction.KIND;fi.GetSelectionCommand=TC=CA([(0,iu.injectable)(),_7(0,(0,iu.inject)(y7.TYPES.Action)),PA("design:paramtypes",[Object])],TC);class Rpe extends bpe.KeyListener{keyDown(e,t){return(0,Cpe.matchesKeystroke)(t,"KeyA","ctrlCmd")?[Vs.SelectAllAction.create()]:[]}}fi.SelectKeyboardListener=Rpe;var L0={};Object.defineProperty(L0,"__esModule",{value:!0});L0.UndoRedoKeyListener=void 0;const V$=se,uT=qt,Mpe=gi,Ipe=sn;class Tpe extends Mpe.KeyListener{keyDown(e,t){return(0,uT.matchesKeystroke)(t,"KeyZ","ctrlCmd")?[V$.UndoAction.create()]:(0,uT.matchesKeystroke)(t,"KeyZ","ctrlCmd","shift")||!(0,Ipe.isMac)()&&(0,uT.matchesKeystroke)(t,"KeyY","ctrlCmd")?[V$.RedoAction.create()]:[]}}L0.UndoRedoKeyListener=Tpe;var ss={};Object.defineProperty(ss,"__esModule",{value:!0});ss.applyMatches=ss.ModelMatcher=ss.forEachMatch=void 0;const d8=ke,Dpe=Fr;function Ope(n,e){Object.keys(n).forEach(t=>e(t,n[t]))}ss.forEachMatch=Ope;class Lpe{match(e,t){const i={};return this.matchLeft(e,i),this.matchRight(t,i),i}matchLeft(e,t,i){let o=t[e.id];if(o!==void 0?(o.left=e,o.leftParentId=i):(o={left:e,leftParentId:i},t[e.id]=o),(0,d8.isParent)(e))for(const r of e.children)this.matchLeft(r,t,e.id)}matchRight(e,t,i){let o=t[e.id];if(o!==void 0?(o.right=e,o.rightParentId=i):(o={right:e,rightParentId:i},t[e.id]=o),(0,d8.isParent)(e))for(const r of e.children)this.matchRight(r,t,e.id)}}ss.ModelMatcher=Lpe;function jpe(n,e,t){n instanceof d8.SModelRootImpl?t=n.index:t===void 0&&(t=new Dpe.SModelIndex,t.add(n));for(const i of e){let o=!1;if(i.left!==void 0&&i.leftParentId!==void 0){const r=t.getById(i.leftParentId);if(r!==void 0&&r.children!==void 0){const s=r.children.indexOf(i.left);s>=0&&(i.right!==void 0&&i.leftParentId===i.rightParentId?(r.children.splice(s,1,i.right),o=!0):r.children.splice(s,1)),t.remove(i.left)}}if(!o&&i.right!==void 0&&i.rightParentId!==void 0){const r=t.getById(i.rightParentId);r!==void 0&&(r.children===void 0&&(r.children=[]),r.children.push(i.right))}}}ss.applyMatches=jpe;var Fu={},wA={};Object.defineProperty(wA,"__esModule",{value:!0});wA.ResizeAnimation=void 0;const Npe=Lr;class Bpe extends Npe.Animation{constructor(e,t,i,o=!1){super(i),this.model=e,this.elementResizes=t,this.reverse=o}tween(e){return this.elementResizes.forEach(t=>{const i=t.element,o=this.reverse?{width:(1-e)*t.toDimension.width+e*t.fromDimension.width,height:(1-e)*t.toDimension.height+e*t.fromDimension.height}:{width:(1-e)*t.fromDimension.width+e*t.toDimension.width,height:(1-e)*t.fromDimension.height+e*t.toDimension.height};i.bounds={x:i.bounds.x,y:i.bounds.y,width:o.width,height:o.height}}),this.model}}wA.ResizeAnimation=Bpe;var TU=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},DU=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},$pe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Fu,"__esModule",{value:!0});Fu.UpdateModelCommand=void 0;const DC=k,kpe=se,$h=Te,z$=Lr,Fpe=ze,xpe=ua,kh=ke,G$=Jn,U$=Lf,Y$=xc,q$=$t,W$=Ff,Z$=no,Q$=ss,Hpe=wA,Kpe=me,X$=Rs,J$=vi,ek=an,Vpe=yt;let X_=class extends Fpe.Command{constructor(e){super(),this.action=e}execute(e){let t;return this.action.newRoot!==void 0?t=e.modelFactory.createRoot(this.action.newRoot):(t=e.modelFactory.createRoot(e.root),this.action.matches!==void 0&&this.applyMatches(t,this.action.matches,e)),this.oldRoot=e.root,this.newRoot=t,this.performUpdate(this.oldRoot,this.newRoot,e)}performUpdate(e,t,i){if((this.action.animate===void 0||this.action.animate)&&e.id===t.id){let o;this.action.matches===void 0?o=new Q$.ModelMatcher().match(e,t):o=this.convertToMatchResult(this.action.matches,e,t);const r=this.computeAnimation(t,o,i);return r instanceof z$.Animation?r.start():r}else return e.type===t.type&&$h.Dimension.isValid(e.canvasBounds)&&(t.canvasBounds=e.canvasBounds),(0,X$.isViewport)(e)&&(0,X$.isViewport)(t)&&(t.zoom=e.zoom,t.scroll=e.scroll),t}applyMatches(e,t,i){const o=e.index;for(const r of t)if(r.left!==void 0){const s=o.getById(r.left.id);s instanceof kh.SChildElementImpl&&s.parent.remove(s)}for(const r of t)if(r.right!==void 0){const s=i.modelFactory.createElement(r.right);let a;r.rightParentId!==void 0&&(a=o.getById(r.rightParentId)),a instanceof kh.SParentElementImpl?a.add(s):e.add(s)}}convertToMatchResult(e,t,i){const o={};for(const r of e){const s={};let a;r.left!==void 0&&(a=r.left.id,s.left=t.index.getById(a),s.leftParentId=r.leftParentId),r.right!==void 0&&(a=r.right.id,s.right=i.index.getById(a),s.rightParentId=r.rightParentId),a!==void 0&&(o[a]=s)}return o}computeAnimation(e,t,i){const o={fades:[]};(0,Q$.forEachMatch)(t,(s,a)=>{if(a.left!==void 0&&a.right!==void 0)this.updateElement(a.left,a.right,o);else if(a.right!==void 0){const u=a.right;(0,U$.isFadeable)(u)&&(u.opacity=0,o.fades.push({element:u,type:"in"}))}else if(a.left instanceof kh.SChildElementImpl){const u=a.left;if((0,U$.isFadeable)(u)&&a.leftParentId!==void 0&&!(0,Vpe.containsSome)(e,u)){const h=e.index.getById(a.leftParentId);if(h instanceof kh.SParentElementImpl){const g=i.modelFactory.createElement(u);h.add(g),o.fades.push({element:g,type:"out"})}}}});const r=this.createAnimations(o,e,i);return r.length>=2?new z$.CompoundAnimation(e,i,r):r.length===1?r[0]:e}updateElement(e,t,i){if((0,Y$.isLocateable)(e)&&(0,Y$.isLocateable)(t)){const o=e.position,r=t.position;(!(0,$h.almostEquals)(o.x,r.x)||!(0,$h.almostEquals)(o.y,r.y))&&(i.moves===void 0&&(i.moves=[]),i.moves.push({element:t,fromPosition:o,toPosition:r}),t.position=o)}(0,q$.isSizeable)(e)&&(0,q$.isSizeable)(t)&&($h.Dimension.isValid(t.bounds)?(!(0,$h.almostEquals)(e.bounds.width,t.bounds.width)||!(0,$h.almostEquals)(e.bounds.height,t.bounds.height))&&(i.resizes===void 0&&(i.resizes=[]),i.resizes.push({element:t,fromDimension:{width:e.bounds.width,height:e.bounds.height},toDimension:{width:t.bounds.width,height:t.bounds.height}})):t.bounds={x:t.bounds.x,y:t.bounds.y,width:e.bounds.width,height:e.bounds.height}),e instanceof ek.SRoutableElementImpl&&t instanceof ek.SRoutableElementImpl&&this.edgeRouterRegistry&&(i.edgeMementi===void 0&&(i.edgeMementi=[]),i.edgeMementi.push({edge:t,before:this.takeSnapshot(e),after:this.takeSnapshot(t)})),(0,Z$.isSelectable)(e)&&(0,Z$.isSelectable)(t)&&(t.selected=e.selected),e instanceof kh.SModelRootImpl&&t instanceof kh.SModelRootImpl&&(t.canvasBounds=e.canvasBounds),e instanceof W$.ViewportRootElementImpl&&t instanceof W$.ViewportRootElementImpl&&(t.scroll=e.scroll,t.zoom=e.zoom)}takeSnapshot(e){return this.edgeRouterRegistry.get(e.routerKind).takeSnapshot(e)}createAnimations(e,t,i){const o=[];if(e.fades.length>0&&o.push(new xpe.FadeAnimation(t,e.fades,i,!0)),e.moves!==void 0&&e.moves.length>0){const r=new Map;for(const s of e.moves)r.set(s.element.id,s);o.push(new G$.MoveAnimation(t,r,i,!1))}if(e.resizes!==void 0&&e.resizes.length>0){const r=new Map;for(const s of e.resizes)r.set(s.element.id,s);o.push(new Hpe.ResizeAnimation(t,r,i,!1))}return e.edgeMementi!==void 0&&e.edgeMementi.length>0&&o.push(new G$.MorphEdgesAnimation(t,e.edgeMementi,i,!1)),o}undo(e){return this.performUpdate(this.newRoot,this.oldRoot,e)}redo(e){return this.performUpdate(this.oldRoot,this.newRoot,e)}};Fu.UpdateModelCommand=X_;X_.KIND=kpe.UpdateModelAction.KIND;TU([(0,DC.inject)(J$.EdgeRouterRegistry),(0,DC.optional)(),DU("design:type",J$.EdgeRouterRegistry)],X_.prototype,"edgeRouterRegistry",void 0);Fu.UpdateModelCommand=X_=TU([(0,DC.injectable)(),$pe(0,(0,DC.inject)(Kpe.TYPES.Action)),DU("design:paramtypes",[Object])],X_);var Bi={},Ao={},b7=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},S7=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},OU=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}},u8;Object.defineProperty(Ao,"__esModule",{value:!0});Ao.ViewportAnimation=Ao.GetViewportCommand=Ao.SetViewportCommand=void 0;const OC=k,E7=se,zpe=Te,Gpe=ze,Upe=Lr,s3=Rs,C7=me,Ype=fg;let J_=u8=class extends Gpe.MergeableCommand{constructor(e){super(),this.action=e,this.newViewport=e.newViewport}execute(e){const t=e.root,i=t.index.getById(this.action.elementId);if(i&&(0,s3.isViewport)(i)){this.element=i,this.oldViewport={scroll:this.element.scroll,zoom:this.element.zoom};const{zoomLimits:o,horizontalScrollLimits:r,verticalScrollLimits:s}=this.viewerOptions;return this.newViewport=(0,s3.limitViewport)(this.newViewport,t.canvasBounds,r,s,o),this.setViewport(i,this.oldViewport,this.newViewport,e)}return e.root}setViewport(e,t,i,o){if(e&&(0,s3.isViewport)(e)){if(this.action.animate)return new LU(e,t,i,o).start();e.scroll=i.scroll,e.zoom=i.zoom}return o.root}undo(e){return this.setViewport(this.element,this.newViewport,this.oldViewport,e)}redo(e){return this.setViewport(this.element,this.oldViewport,this.newViewport,e)}merge(e,t){return!this.action.animate&&e instanceof u8&&this.element===e.element?(this.newViewport=e.newViewport,!0):!1}};Ao.SetViewportCommand=J_;J_.KIND=E7.SetViewportAction.KIND;b7([(0,OC.inject)(C7.TYPES.ViewerOptions),S7("design:type",Object)],J_.prototype,"viewerOptions",void 0);Ao.SetViewportCommand=J_=u8=b7([(0,OC.injectable)(),OU(0,(0,OC.inject)(C7.TYPES.Action)),S7("design:paramtypes",[Object])],J_);let LC=class extends Ype.ModelRequestCommand{constructor(e){super(),this.action=e}retrieveResult(e){const t=e.root;let i;return(0,s3.isViewport)(t)?i={scroll:t.scroll,zoom:t.zoom}:i={scroll:zpe.Point.ORIGIN,zoom:1},E7.ViewportResult.create(i,t.canvasBounds,this.action.requestId)}};Ao.GetViewportCommand=LC;LC.KIND=E7.GetViewportAction.KIND;Ao.GetViewportCommand=LC=b7([OU(0,(0,OC.inject)(C7.TYPES.Action)),S7("design:paramtypes",[Object])],LC);class LU extends Upe.Animation{constructor(e,t,i,o){super(o),this.element=e,this.oldViewport=t,this.newViewport=i,this.context=o,this.zoomFactor=Math.log(i.zoom/t.zoom)}tween(e,t){return this.element.scroll={x:(1-e)*this.oldViewport.scroll.x+e*this.newViewport.scroll.x,y:(1-e)*this.oldViewport.scroll.y+e*this.newViewport.scroll.y},this.element.zoom=this.oldViewport.zoom*Math.exp(e*this.zoomFactor),t.root}}Ao.ViewportAnimation=LU;var AA=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},RA=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},jU=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Bi,"__esModule",{value:!0});Bi.CenterKeyboardListener=Bi.FitToScreenCommand=Bi.CenterCommand=Bi.BoundsAwareViewportCommand=void 0;const jC=se,Qa=Te,tk=qt,qpe=ke,Wpe=ze,Zpe=gi,lT=$t,Qpe=no,nk=Ao,kv=Rs,MA=k,P7=me;let Gp=class extends Wpe.Command{constructor(e){super(),this.animate=e}initialize(e){if(!(0,kv.isViewport)(e))return;this.oldViewport={scroll:e.scroll,zoom:e.zoom};const t=[];if(this.getElementIds().forEach(i=>{const o=e.index.getById(i);o&&(0,lT.isBoundsAware)(o)&&t.push(this.boundsInViewport(o,o.bounds,e))}),t.length===0&&e.index.all().forEach(i=>{(0,Qpe.isSelectable)(i)&&i.selected&&(0,lT.isBoundsAware)(i)&&t.push(this.boundsInViewport(i,i.bounds,e))}),t.length===0&&e.index.all().forEach(i=>{(0,lT.isBoundsAware)(i)&&t.push(this.boundsInViewport(i,i.bounds,e))}),t.length!==0){const i=t.reduce((o,r)=>Qa.Bounds.combine(o,r));if(Qa.Dimension.isValid(i)){const o=this.getNewViewport(i,e);if(o){const{zoomLimits:r,horizontalScrollLimits:s,verticalScrollLimits:a}=this.viewerOptions;this.newViewport=(0,kv.limitViewport)(o,e.canvasBounds,s,a,r)}}}}boundsInViewport(e,t,i){return e instanceof qpe.SChildElementImpl&&e.parent!==i?this.boundsInViewport(e.parent,e.parent.localToParent(t),i):t}execute(e){return this.initialize(e.root),this.redo(e)}undo(e){const t=e.root;if((0,kv.isViewport)(t)&&this.newViewport!==void 0&&!this.equal(this.newViewport,this.oldViewport)){if(this.animate)return new nk.ViewportAnimation(t,this.newViewport,this.oldViewport,e).start();t.scroll=this.oldViewport.scroll,t.zoom=this.oldViewport.zoom}return t}redo(e){const t=e.root;if((0,kv.isViewport)(t)&&this.newViewport!==void 0&&!this.equal(this.newViewport,this.oldViewport)){if(this.animate)return new nk.ViewportAnimation(t,this.oldViewport,this.newViewport,e).start();t.scroll=this.newViewport.scroll,t.zoom=this.newViewport.zoom}return t}equal(e,t){return(0,Qa.almostEquals)(e.zoom,t.zoom)&&(0,Qa.almostEquals)(e.scroll.x,t.scroll.x)&&(0,Qa.almostEquals)(e.scroll.y,t.scroll.y)}};Bi.BoundsAwareViewportCommand=Gp;AA([(0,MA.inject)(P7.TYPES.ViewerOptions),RA("design:type",Object)],Gp.prototype,"viewerOptions",void 0);Bi.BoundsAwareViewportCommand=Gp=AA([(0,MA.injectable)(),RA("design:paramtypes",[Boolean])],Gp);let NC=class extends Gp{constructor(e){super(e.animate),this.action=e}getElementIds(){return this.action.elementIds}getNewViewport(e,t){if(!Qa.Dimension.isValid(t.canvasBounds))return;let i=1;this.action.retainZoom&&(0,kv.isViewport)(t)?i=t.zoom:this.action.zoomScale&&(i=this.action.zoomScale);const o=Qa.Bounds.center(e);return{scroll:{x:o.x-.5*t.canvasBounds.width/i,y:o.y-.5*t.canvasBounds.height/i},zoom:i}}};Bi.CenterCommand=NC;NC.KIND=jC.CenterAction.KIND;Bi.CenterCommand=NC=AA([jU(0,(0,MA.inject)(P7.TYPES.Action)),RA("design:paramtypes",[Object])],NC);let BC=class extends Gp{constructor(e){super(e.animate),this.action=e}getElementIds(){return this.action.elementIds}getNewViewport(e,t){if(!Qa.Dimension.isValid(t.canvasBounds))return;const i=Qa.Bounds.center(e),o=this.action.padding===void 0?0:2*this.action.padding;let r=Math.min(t.canvasBounds.width/(e.width+o),t.canvasBounds.height/(e.height+o));return this.action.maxZoom!==void 0&&(r=Math.min(r,this.action.maxZoom)),r===1/0&&(r=1),{scroll:{x:i.x-.5*t.canvasBounds.width/r,y:i.y-.5*t.canvasBounds.height/r},zoom:r}}};Bi.FitToScreenCommand=BC;BC.KIND=jC.FitToScreenAction.KIND;Bi.FitToScreenCommand=BC=AA([jU(0,(0,MA.inject)(P7.TYPES.Action)),RA("design:paramtypes",[Object])],BC);class Xpe extends Zpe.KeyListener{keyDown(e,t){return(0,tk.matchesKeystroke)(t,"KeyC","ctrlCmd","shift")?[jC.CenterAction.create([])]:(0,tk.matchesKeystroke)(t,"KeyF","ctrlCmd","shift")?[jC.FitToScreenAction.create([])]:[]}}Bi.CenterKeyboardListener=Xpe;var qf={},Jpe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},eme=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},tme=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(qf,"__esModule",{value:!0});qf.BringToFrontCommand=void 0;const ik=k,nme=se,ime=me,ok=ke,ome=ze,rk=an;let $C=class extends ome.Command{constructor(e){super(),this.action=e,this.selected=[]}execute(e){const t=e.root;return this.action.elementIDs.forEach(i=>{const o=t.index.getById(i);o instanceof rk.SRoutableElementImpl&&(o.source&&this.addToSelection(o.source),o.target&&this.addToSelection(o.target)),o instanceof ok.SChildElementImpl&&this.addToSelection(o),this.includeConnectedEdges(o)}),this.redo(e)}includeConnectedEdges(e){if(e instanceof rk.SConnectableElementImpl&&(e.incomingEdges.forEach(t=>this.addToSelection(t)),e.outgoingEdges.forEach(t=>this.addToSelection(t))),e instanceof ok.SParentElementImpl)for(const t of e.children)this.includeConnectedEdges(t)}addToSelection(e){this.selected.push({element:e,index:e.parent.children.indexOf(e)})}undo(e){for(let t=this.selected.length-1;t>=0;t--){const i=this.selected[t],o=i.element;o.parent.move(o,i.index)}return e.root}redo(e){for(let t=0;t<this.selected.length;t++)this.bringToFront(this.selected[t]);return e.root}bringToFront(e){const t=e.element,i=t.parent.children.length;t.parent.move(t,i-1)}};qf.BringToFrontCommand=$C;$C.KIND=nme.BringToFrontAction.KIND;qf.BringToFrontCommand=$C=Jpe([(0,ik.injectable)(),tme(0,(0,ik.inject)(ime.TYPES.Action)),eme("design:paramtypes",[Object])],$C);var IA={};Object.defineProperty(IA,"__esModule",{value:!0});const rme=k,fT=me,sk=hs,ak=cA,uv=qi,ck=wn,dk=Of,uk=Df,lk=og,sme=new rme.ContainerModule((n,e,t)=>{(0,ck.configureCommand)({bind:n,isBound:t},sk.SetBoundsCommand),(0,ck.configureCommand)({bind:n,isBound:t},sk.RequestBoundsCommand),n(ak.HiddenBoundsUpdater).toSelf().inSingletonScope(),n(fT.TYPES.HiddenVNodePostprocessor).toService(ak.HiddenBoundsUpdater),n(fT.TYPES.Layouter).to(uv.Layouter).inSingletonScope(),n(fT.TYPES.LayoutRegistry).to(uv.LayoutRegistry).inSingletonScope(),(0,uv.configureLayout)({bind:n,isBound:t},uk.VBoxLayouter.KIND,uk.VBoxLayouter),(0,uv.configureLayout)({bind:n,isBound:t},dk.HBoxLayouter.KIND,dk.HBoxLayouter),(0,uv.configureLayout)({bind:n,isBound:t},lk.StackLayouter.KIND,lk.StackLayouter)});IA.default=sme;var j0={};Object.defineProperty(j0,"__esModule",{value:!0});const ame=k,cme=ps,dme=new ame.ContainerModule(n=>{n(cme.ButtonHandlerRegistry).toSelf().inSingletonScope()});j0.default=dme;var TA={};Object.defineProperty(TA,"__esModule",{value:!0});const ume=k,hT=me,fk=ms,mE=cc,lme=new ume.ContainerModule(n=>{n(mE.CommandPalette).toSelf().inSingletonScope(),n(hT.TYPES.IUIExtension).toService(mE.CommandPalette),n(mE.CommandPaletteKeyListener).toSelf().inSingletonScope(),n(hT.TYPES.KeyListener).toService(mE.CommandPaletteKeyListener),n(fk.CommandPaletteActionProviderRegistry).toSelf().inSingletonScope(),n(hT.TYPES.ICommandPaletteActionProviderRegistry).toService(fk.CommandPaletteActionProviderRegistry)});TA.default=lme;var DA={};Object.defineProperty(DA,"__esModule",{value:!0});const fme=k,hme=gs,hk=Nf,lv=me,pme=new fme.ContainerModule(n=>{n(lv.TYPES.IContextMenuServiceProvider).toProvider(e=>()=>new Promise((t,i)=>{e.container.isBound(lv.TYPES.IContextMenuService)?t(e.container.get(lv.TYPES.IContextMenuService)):i()})),n(hk.ContextMenuMouseListener).toSelf().inSingletonScope(),n(lv.TYPES.MouseListener).toService(hk.ContextMenuMouseListener),n(lv.TYPES.IContextMenuProviderRegistry).to(hme.ContextMenuProviderRegistry)});DA.default=pme;var OA={};Object.defineProperty(OA,"__esModule",{value:!0});const mme=rn,gme=k,vme=D0,_me=Vf,yme=me,pk=zf,bme=new gme.ContainerModule((n,e,t)=>{(0,mme.configureModelElement)({bind:n,isBound:t},"marker",vme.SIssueMarkerImpl,_me.IssueMarkerView),n(pk.DecorationPlacer).toSelf().inSingletonScope(),n(yme.TYPES.IVNodePostprocessor).toService(pk.DecorationPlacer)});OA.default=bme;var LA={};Object.defineProperty(LA,"__esModule",{value:!0});const Sme=k,Eme=me,mk=Qn,Cme=new Sme.ContainerModule(n=>{n(mk.IntersectionFinder).toSelf().inSingletonScope(),n(Eme.TYPES.IEdgeRoutePostprocessor).toService(mk.IntersectionFinder)});LA.default=Cme;var jA={},N0={},NU=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Pme=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(N0,"__esModule",{value:!0});N0.JunctionPostProcessor=void 0;const BU=k,wme=me;let kC=class{decorate(e,t){return e}postUpdate(e){const t=this.viewerOptions.baseDiv,i=document.querySelector(`#${t} > svg > g`);if(i){const o=Array.from(document.querySelectorAll("g.sprotty-junction"));o.forEach(r=>{r.remove()}),i.append(...o)}}};N0.JunctionPostProcessor=kC;NU([(0,BU.inject)(wme.TYPES.ViewerOptions),Pme("design:type",Object)],kC.prototype,"viewerOptions",void 0);N0.JunctionPostProcessor=kC=NU([(0,BU.injectable)()],kC);Object.defineProperty(jA,"__esModule",{value:!0});const Ame=k,gk=me,vk=Gf,_k=N0,Rme=new Ame.ContainerModule(n=>{n(vk.JunctionFinder).toSelf().inSingletonScope(),n(gk.TYPES.IEdgeRoutePostprocessor).toService(vk.JunctionFinder),n(_k.JunctionPostProcessor).toSelf().inSingletonScope(),n(gk.TYPES.IVNodePostprocessor).toService(_k.JunctionPostProcessor)});jA.default=Rme;var B0={};Object.defineProperty(B0,"__esModule",{value:!0});const Mme=k,Ime=ps,yk=Kf,Tme=new Mme.ContainerModule((n,e,t)=>{(0,Ime.configureButtonHandler)({bind:n,isBound:t},yk.ExpandButtonHandler.TYPE,yk.ExpandButtonHandler)});B0.default=Tme;var NA={};Object.defineProperty(NA,"__esModule",{value:!0});const Dme=k,pT=me,fv=Wi,Ome=sr,Lme=wn,jme=new Dme.ContainerModule((n,e,t)=>{n(fv.ExportSvgKeyListener).toSelf().inSingletonScope(),n(pT.TYPES.KeyListener).toService(fv.ExportSvgKeyListener),n(fv.ExportSvgPostprocessor).toSelf().inSingletonScope(),n(pT.TYPES.HiddenVNodePostprocessor).toService(fv.ExportSvgPostprocessor),(0,Lme.configureCommand)({bind:n,isBound:t},fv.ExportSvgCommand),n(pT.TYPES.SvgExporter).to(Ome.SvgExporter).inSingletonScope()});NA.default=jme;var $0={};Object.defineProperty($0,"__esModule",{value:!0});const Nme=k,Bme=me,bk=ua,$me=new Nme.ContainerModule(n=>{n(bk.ElementFader).toSelf().inSingletonScope(),n(Bme.TYPES.IVNodePostprocessor).toService(bk.ElementFader)});$0.default=$me;var BA={},hg={},$U=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},kme=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(hg,"__esModule",{value:!0});hg.PopupPositionUpdater=void 0;const kU=k,Fme=me;let FC=class{decorate(e,t){return e}postUpdate(){const e=document.getElementById(this.options.popupDiv);if(e!==null&&typeof window<"u"){const t=e.getBoundingClientRect();window.innerHeight<t.height+t.top&&(e.style.top=window.pageYOffset+window.innerHeight-t.height-5+"px"),window.innerWidth<t.left+t.width&&(e.style.left=window.pageXOffset+window.innerWidth-t.width-5+"px"),t.left<0&&(e.style.left="0px"),t.top<0&&(e.style.top="0px")}}};hg.PopupPositionUpdater=FC;$U([(0,kU.inject)(Fme.TYPES.ViewerOptions),kme("design:type",Object)],FC.prototype,"options",void 0);hg.PopupPositionUpdater=FC=$U([(0,kU.injectable)()],FC);Object.defineProperty(BA,"__esModule",{value:!0});const xme=k,hv=me,Vi=fn,Sk=hg,Ek=wn,pv=Wo,Ck=Bi,Hme=Ao,Kme=Jn,Vme=new xme.ContainerModule((n,e,t)=>{n(Sk.PopupPositionUpdater).toSelf().inSingletonScope(),n(hv.TYPES.PopupVNodePostprocessor).toService(Sk.PopupPositionUpdater),n(Vi.HoverMouseListener).toSelf().inSingletonScope(),n(hv.TYPES.MouseListener).toService(Vi.HoverMouseListener),n(Vi.PopupHoverMouseListener).toSelf().inSingletonScope(),n(hv.TYPES.PopupMouseListener).toService(Vi.PopupHoverMouseListener),n(Vi.HoverKeyListener).toSelf().inSingletonScope(),n(hv.TYPES.KeyListener).toService(Vi.HoverKeyListener),n(hv.TYPES.HoverState).toConstantValue({mouseOverTimer:void 0,mouseOutTimer:void 0,popupOpen:!1,previousPopupElement:void 0}),n(Vi.ClosePopupActionHandler).toSelf().inSingletonScope();const i={bind:n,isBound:t};(0,Ek.configureCommand)(i,Vi.HoverFeedbackCommand),(0,Ek.configureCommand)(i,Vi.SetPopupModelCommand),(0,pv.configureActionHandler)(i,Vi.SetPopupModelCommand.KIND,Vi.ClosePopupActionHandler),(0,pv.configureActionHandler)(i,Ck.FitToScreenCommand.KIND,Vi.ClosePopupActionHandler),(0,pv.configureActionHandler)(i,Ck.CenterCommand.KIND,Vi.ClosePopupActionHandler),(0,pv.configureActionHandler)(i,Hme.SetViewportCommand.KIND,Vi.ClosePopupActionHandler),(0,pv.configureActionHandler)(i,Kme.MoveCommand.KIND,Vi.ClosePopupActionHandler)});BA.default=Vme;var k0={};Object.defineProperty(k0,"__esModule",{value:!0});const zme=k,mT=me,Fh=Jn,Gme=wn,Ume=new zme.ContainerModule((n,e,t)=>{n(Fh.MoveMouseListener).toSelf().inSingletonScope(),n(mT.TYPES.MouseListener).toService(Fh.MoveMouseListener),(0,Gme.configureCommand)({bind:n,isBound:t},Fh.MoveCommand),n(Fh.LocationPostprocessor).toSelf().inSingletonScope(),n(mT.TYPES.IVNodePostprocessor).toService(Fh.LocationPostprocessor),n(mT.TYPES.HiddenVNodePostprocessor).toService(Fh.LocationPostprocessor)});k0.default=Ume;var F0={};Object.defineProperty(F0,"__esModule",{value:!0});const Yme=k,qme=me,Pk=ug,Wme=new Yme.ContainerModule(n=>{n(Pk.OpenMouseListener).toSelf().inSingletonScope(),n(qme.TYPES.MouseListener).toService(Pk.OpenMouseListener)});F0.default=Wme;var $A={};Object.defineProperty($A,"__esModule",{value:!0});const Zme=k,yr=me,wk=Uf,Ak=Hc,xh=er,Hh=wo,Qme=Ra,Xme=vi,gT=Zi,Kh=Jo,Jme=wn,ege=new Zme.ContainerModule((n,e,t)=>{n(Xme.EdgeRouterRegistry).toSelf().inSingletonScope(),n(Qme.AnchorComputerRegistry).toSelf().inSingletonScope(),n(wk.ManhattanEdgeRouter).toSelf().inSingletonScope(),n(yr.TYPES.IEdgeRouter).toService(wk.ManhattanEdgeRouter),n(xh.ManhattanEllipticAnchor).toSelf().inSingletonScope(),n(yr.TYPES.IAnchorComputer).toService(xh.ManhattanEllipticAnchor),n(xh.ManhattanRectangularAnchor).toSelf().inSingletonScope(),n(yr.TYPES.IAnchorComputer).toService(xh.ManhattanRectangularAnchor),n(xh.ManhattanDiamondAnchor).toSelf().inSingletonScope(),n(yr.TYPES.IAnchorComputer).toService(xh.ManhattanDiamondAnchor),n(Ak.PolylineEdgeRouter).toSelf().inSingletonScope(),n(yr.TYPES.IEdgeRouter).toService(Ak.PolylineEdgeRouter),n(Hh.EllipseAnchor).toSelf().inSingletonScope(),n(yr.TYPES.IAnchorComputer).toService(Hh.EllipseAnchor),n(Hh.RectangleAnchor).toSelf().inSingletonScope(),n(yr.TYPES.IAnchorComputer).toService(Hh.RectangleAnchor),n(Hh.DiamondAnchor).toSelf().inSingletonScope(),n(yr.TYPES.IAnchorComputer).toService(Hh.DiamondAnchor),n(gT.BezierEdgeRouter).toSelf().inSingletonScope(),n(yr.TYPES.IEdgeRouter).toService(gT.BezierEdgeRouter),n(Kh.BezierEllipseAnchor).toSelf().inSingletonScope(),n(yr.TYPES.IAnchorComputer).toService(Kh.BezierEllipseAnchor),n(Kh.BezierRectangleAnchor).toSelf().inSingletonScope(),n(yr.TYPES.IAnchorComputer).toService(Kh.BezierRectangleAnchor),n(Kh.BezierDiamondAnchor).toSelf().inSingletonScope(),n(yr.TYPES.IAnchorComputer).toService(Kh.BezierDiamondAnchor),(0,Jme.configureCommand)({bind:n,isBound:t},gT.AddRemoveBezierSegmentCommand)});$A.default=ege;var kA={};Object.defineProperty(kA,"__esModule",{value:!0});const tge=k,Rk=me,el=fi,vT=wn,nge=new tge.ContainerModule((n,e,t)=>{(0,vT.configureCommand)({bind:n,isBound:t},el.SelectCommand),(0,vT.configureCommand)({bind:n,isBound:t},el.SelectAllCommand),(0,vT.configureCommand)({bind:n,isBound:t},el.GetSelectionCommand),n(el.SelectKeyboardListener).toSelf().inSingletonScope(),n(Rk.TYPES.KeyListener).toService(el.SelectKeyboardListener),n(el.SelectMouseListener).toSelf().inSingletonScope(),n(Rk.TYPES.MouseListener).toService(el.SelectMouseListener)});kA.default=nge;var FA={};Object.defineProperty(FA,"__esModule",{value:!0});const ige=k,oge=me,Mk=L0,rge=new ige.ContainerModule(n=>{n(Mk.UndoRedoKeyListener).toSelf().inSingletonScope(),n(oge.TYPES.KeyListener).toService(Mk.UndoRedoKeyListener)});FA.default=rge;var x0={};Object.defineProperty(x0,"__esModule",{value:!0});const sge=k,age=wn,cge=Fu,dge=new sge.ContainerModule((n,e,t)=>{(0,age.configureCommand)({bind:n,isBound:t},cge.UpdateModelCommand)});x0.default=dge;var xA={};Object.defineProperty(xA,"__esModule",{value:!0});const uge=k,_T=me,gE=Bi,Ik=Ao,Tk=hc,Dk=uc,vE=wn,lge=new uge.ContainerModule((n,e,t)=>{(0,vE.configureCommand)({bind:n,isBound:t},gE.CenterCommand),(0,vE.configureCommand)({bind:n,isBound:t},gE.FitToScreenCommand),(0,vE.configureCommand)({bind:n,isBound:t},Ik.SetViewportCommand),(0,vE.configureCommand)({bind:n,isBound:t},Ik.GetViewportCommand),n(gE.CenterKeyboardListener).toSelf().inSingletonScope(),n(_T.TYPES.KeyListener).toService(gE.CenterKeyboardListener),n(Tk.ScrollMouseListener).toSelf().inSingletonScope(),n(Dk.ZoomMouseListener).toSelf().inSingletonScope(),n(_T.TYPES.MouseListener).toService(Tk.ScrollMouseListener),n(_T.TYPES.MouseListener).toService(Dk.ZoomMouseListener)});xA.default=lge;var H0={};Object.defineProperty(H0,"__esModule",{value:!0});const fge=k,hge=wn,pge=qf,mge=new fge.ContainerModule((n,e,t)=>{(0,hge.configureCommand)({bind:n,isBound:t},pge.BringToFrontCommand)});H0.default=mge;var gt={},To=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},HA=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(gt,"__esModule",{value:!0});gt.SBezierControlHandleView=gt.SBezierCreateHandleView=gt.SCompartmentView=gt.SLabelView=gt.SRoutingHandleView=gt.BezierCurveEdgeView=gt.PolylineEdgeViewWithGapsOnIntersections=gt.JumpingPolylineEdgeView=gt.PolylineEdgeView=gt.SGraphView=void 0;const Do=k,mp=Te,FU=Nn,K0=ft,gge=Fc,mv=Qn,vge=$f,KA=an,ou=vi,xU=Yf,Gt=ti,_ge=ei;let xC=class{render(e,t){const i=this.edgeRouterRegistry.routeAllChildren(e),o=`scale(${e.zoom}) translate(${-e.scroll.x},${-e.scroll.y})`;return(0,Gt.svg)("svg",{"class-sprotty-graph":!0},(0,Gt.svg)("g",{transform:o},t.renderChildren(e,{edgeRouting:i})))}};gt.SGraphView=xC;To([(0,Do.inject)(ou.EdgeRouterRegistry),HA("design:type",ou.EdgeRouterRegistry)],xC.prototype,"edgeRouterRegistry",void 0);gt.SGraphView=xC=To([(0,Do.injectable)()],xC);let ey=class extends xU.RoutableView{render(e,t,i){const o=this.edgeRouterRegistry.route(e,i);return o.length===0?this.renderDanglingEdge("Cannot compute route",e,t):this.isVisible(e,o,t)?(0,Gt.svg)("g",{"class-sprotty-edge":!0,"class-mouseover":e.hoverFeedback},this.renderLine(e,o,t,i),this.renderAdditionals(e,o,t),this.renderJunctionPoints(e,o,t,i),t.renderChildren(e,{route:o})):e.children.length===0?void 0:(0,Gt.svg)("g",null,t.renderChildren(e,{route:o}))}renderJunctionPoints(e,t,i,o){const s=[];for(let a=1;a<t.length;a++)t[a].isJunction&&s.push((0,Gt.svg)("circle",{cx:t[a].x,cy:t[a].y,r:5}));if(s.length>0)return(0,Gt.svg)("g",{"class-sprotty-junction":!0},s)}renderLine(e,t,i,o){const r=t[0];let s=`M ${r.x},${r.y}`;for(let a=1;a<t.length;a++){const u=t[a];s+=` L ${u.x},${u.y}`}return(0,Gt.svg)("path",{d:s})}renderAdditionals(e,t,i){return[]}renderDanglingEdge(e,t,i){return(0,Gt.svg)("text",{"class-sprotty-edge-dangling":!0,title:e},"?")}};gt.PolylineEdgeView=ey;To([(0,Do.inject)(ou.EdgeRouterRegistry),HA("design:type",ou.EdgeRouterRegistry)],ey.prototype,"edgeRouterRegistry",void 0);gt.PolylineEdgeView=ey=To([(0,Do.injectable)()],ey);let HC=class extends ey{constructor(){super(...arguments),this.jumpOffsetBefore=5,this.jumpOffsetAfter=5,this.skipOffsetBefore=3,this.skipOffsetAfter=2}renderLine(e,t,i,o){let r="";for(let s=0;s<t.length;s++){const a=t[s];s===0&&(r=`M ${a.x},${a.y}`),(0,mv.isIntersectingRoutedPoint)(a)&&(r+=this.intersectionPath(e,t,a,o)),s!==0&&(r+=` L ${a.x},${a.y}`)}return(0,Gt.svg)("path",{d:r})}intersectionPath(e,t,i,o){if(i.intersections.length<1)return"";const r=this.getLineSegment(e,i.intersections[0],o,t),s=this.getIntersectionsSortedBySegmentDirection(r,i);let a="";for(const u of s){const h=this.getOtherLineSegment(e,u,o);if(h===void 0)continue;const g=this.getLineSegment(e,u,o,t),y=u.intersectionPoint;this.shouldDrawLineJumpOnIntersection(g,h)?a+=this.createJumpPath(y,g):this.shouldDrawLineGapOnIntersection(g,h)&&(a+=this.createGapPath(y,g))}return a}getIntersectionsSortedBySegmentDirection(e,t){switch(e.direction){case"north":case"north-east":return t.intersections.sort(mv.BY_X_THEN_DESCENDING_Y);case"south":case"south-east":case"east":return t.intersections.sort(mv.BY_X_THEN_Y);case"south-west":case"west":return t.intersections.sort(mv.BY_DESCENDING_X_THEN_Y);case"north-west":return t.intersections.sort(mv.BY_DESCENDING_X_THEN_DESCENDING_Y)}}shouldDrawLineJumpOnIntersection(e,t){return Math.abs(e.slopeOrMax)<Math.abs(t.slopeOrMax)}shouldDrawLineGapOnIntersection(e,t){return!this.shouldDrawLineJumpOnIntersection(e,t)}getLineSegment(e,t,i,o){const r=o||this.edgeRouterRegistry.route(e,i),s=t.routable1===e.id?t.segmentIndex1:t.segmentIndex2;return new _ge.PointToPointLine(r[s],r[s+1])}getOtherLineSegment(e,t,i){const o=t.routable1===e.id?t.routable2:t.routable1,r=e.index.getById(o);if(r instanceof KA.SRoutableElementImpl)return this.getLineSegment(r,t,i)}createJumpPath(e,t){const i=mp.Point.shiftTowards(e,t.p1,this.jumpOffsetBefore),o=mp.Point.shiftTowards(e,t.p2,this.jumpOffsetAfter),r=t.p1.x<t.p2.x?1:0;return` L ${i.x},${i.y} A 1,1 0,0 ${r} ${o.x},${o.y}`}createGapPath(e,t){let i,o;e.y<t.p1.y?(i=-this.skipOffsetBefore,o=this.jumpOffsetAfter+this.skipOffsetAfter):(i=this.jumpOffsetBefore+this.skipOffsetAfter,o=-this.skipOffsetBefore);const r=mp.Point.shiftTowards(e,t.p1,i),s=mp.Point.shiftTowards(e,t.p2,o);return` L ${r.x},${r.y} M ${s.x},${s.y}`}};gt.JumpingPolylineEdgeView=HC;gt.JumpingPolylineEdgeView=HC=To([(0,Do.injectable)()],HC);let l8=class extends HC{constructor(){super(...arguments),this.skipOffsetBefore=3,this.skipOffsetAfter=3}shouldDrawLineJumpOnIntersection(e,t){return!1}shouldDrawLineGapOnIntersection(e,t){return Math.abs(e.slopeOrMax)>=Math.abs(t.slopeOrMax)}createGapPath(e,t){const i=mp.Point.shiftTowards(e,t.p1,this.skipOffsetBefore),o=mp.Point.shiftTowards(e,t.p2,this.skipOffsetAfter);return` L ${i.x},${i.y} M ${o.x},${o.y}`}};gt.PolylineEdgeViewWithGapsOnIntersections=l8;gt.PolylineEdgeViewWithGapsOnIntersections=l8=To([(0,Do.injectable)()],l8);let KC=class extends xU.RoutableView{render(e,t,i){const o=this.edgeRouterRegistry.route(e,i);return o.length===0?this.renderDanglingEdge("Cannot compute route",e,t):this.isVisible(e,o,t)?(0,Gt.svg)("g",{"class-sprotty-edge":!0,"class-mouseover":e.hoverFeedback},this.renderLine(e,o,t,i),this.renderAdditionals(e,o,t),t.renderChildren(e,{route:o})):e.children.length===0?void 0:(0,Gt.svg)("g",null,t.renderChildren(e,{route:o}))}renderLine(e,t,i,o){let r="";if(t.length>=4){r+=this.buildMainSegment(t);const s=t.length-4;if(s>0&&s%3===0)for(let a=4;a<t.length;a+=3)r+=this.addSpline(t,a)}return(0,Gt.svg)("path",{d:r})}buildMainSegment(e){const t=e[0],i=e[1],o=e[2],r=e[3];return`M${t.x},${t.y} C${i.x},${i.y} ${o.x},${o.y} ${r.x},${r.y}`}addSpline(e,t){const i=e[t+1],o=e[t+2];return` S${i.x},${i.y} ${o.x},${o.y}`}renderAdditionals(e,t,i){return[]}renderDanglingEdge(e,t,i){return(0,Gt.svg)("text",{"class-sprotty-edge-dangling":!0,title:e},"?")}};gt.BezierCurveEdgeView=KC;To([(0,Do.inject)(ou.EdgeRouterRegistry),HA("design:type",ou.EdgeRouterRegistry)],KC.prototype,"edgeRouterRegistry",void 0);gt.BezierCurveEdgeView=KC=To([(0,Do.injectable)()],KC);let Up=class{constructor(){this.minimalPointDistance=10}render(e,t,i){if(i&&i.route&&e.parent instanceof KA.SRoutableElementImpl){const o=this.edgeRouterRegistry.get(e.parent.routerKind),r=i.route===void 0?this.edgeRouterRegistry.route(e.parent,i):i.route,s=o.getHandlePosition(e.parent,r,e);if(s!==void 0){const a=(0,Gt.svg)("circle",{"class-sprotty-routing-handle":!0,"class-selected":e.selected,"class-mouseover":e.hoverFeedback,cx:s.x,cy:s.y,r:this.getRadius()});return(0,K0.setAttr)(a,"data-kind",e.kind),a}}return(0,Gt.svg)("g",null)}getRadius(){return 7}};gt.SRoutingHandleView=Up;To([(0,Do.inject)(ou.EdgeRouterRegistry),HA("design:type",ou.EdgeRouterRegistry)],Up.prototype,"edgeRouterRegistry",void 0);gt.SRoutingHandleView=Up=To([(0,Do.injectable)()],Up);let f8=class extends gge.ShapeView{render(e,t){if(!(0,vge.isEdgeLayoutable)(e)&&!this.isVisible(e,t))return;const i=(0,Gt.svg)("text",{"class-sprotty-label":!0},e.text),o=(0,FU.getSubType)(e);return o&&(0,K0.setAttr)(i,"class",o),i}};gt.SLabelView=f8;gt.SLabelView=f8=To([(0,Do.injectable)()],f8);let h8=class{render(e,t,i){const o=`translate(${e.bounds.x}, ${e.bounds.y})`,r=(0,Gt.svg)("g",{transform:o,"class-sprotty-comp":"{true}"},t.renderChildren(e)),s=(0,FU.getSubType)(e);return s&&(0,K0.setAttr)(r,"class",s),r}};gt.SCompartmentView=h8;gt.SCompartmentView=h8=To([(0,Do.injectable)()],h8);let p8=class extends Up{render(e,t,i){if(i){const o=i.route;if(o&&e.parent instanceof KA.SRoutableElementImpl){const s=this.edgeRouterRegistry.get(e.parent.routerKind).getHandlePosition(e.parent,o,e);if(s!==void 0){const a="translate("+s.x+", "+s.y+")",u=-5.5,h=5.5,g=e.kind==="bezier-add"?"+":"-",y=(0,Gt.svg)("g",{transform:a,"class-sprotty-routing-handle":!0,"class-selected":e.selected,"class-mouseover":e.hoverFeedback},(0,Gt.svg)("circle",{r:this.getRadius()}),(0,Gt.svg)("text",{x:u,y:h,"attrs-text-align":"middle","style-font-family":"monospace","style-pointer-events":"none","style-fill":"white"},g));return(0,K0.setAttr)(y,"data-kind",e.kind),y}}}return(0,Gt.svg)("g",null)}};gt.SBezierCreateHandleView=p8;gt.SBezierCreateHandleView=p8=To([(0,Do.injectable)()],p8);let m8=class extends Up{render(e,t,i){if(i){const o=i.route;if(o&&e.parent instanceof KA.SRoutableElementImpl){const s=this.edgeRouterRegistry.get(e.parent.routerKind).getHandlePosition(e.parent,o,e);if(s!==void 0){let a;for(let h=0;h<o.length;h++){const g=o[h];if(g.kind===s.kind&&g.pointIndex===s.pointIndex){e.kind==="bezier-control-before"?a=o[h+1]:a=o[h-1];break}}let u;if(a){const h=`M ${s.x}, ${s.y} L ${a.x}, ${a.y}`;u=(0,Gt.svg)("g",{"class-sprotty-routing-handle":!0,"class-selected":e.selected,"class-mouseover":e.hoverFeedback},(0,Gt.svg)("path",{d:h,stroke:"grey","style-stroke-width":"2px"}),(0,Gt.svg)("circle",{cx:s.x,cy:s.y,r:this.getRadius()}))}else u=(0,Gt.svg)("circle",{"class-sprotty-routing-handle":!0,"class-selected":e.selected,"class-mouseover":e.hoverFeedback,cx:s.x,cy:s.y,r:this.getRadius()});return(0,K0.setAttr)(u,"data-kind",e.kind),u}}}return(0,Gt.svg)("g",null)}};gt.SBezierControlHandleView=m8;gt.SBezierControlHandleView=m8=To([(0,Do.injectable)()],m8);var V0={},z0={};Object.defineProperty(z0,"__esModule",{value:!0});const yge=k,bge=wn,_E=me,Sge=vs,Ege=rr,Cge=new yge.ContainerModule((n,e,t)=>{n(_E.TYPES.ModelSourceProvider).toProvider(i=>()=>new Promise(o=>{o(i.container.get(_E.TYPES.ModelSource))})),(0,bge.configureCommand)({bind:n,isBound:t},Sge.CommitModelCommand),n(_E.TYPES.IActionHandlerInitializer).toService(_E.TYPES.ModelSource),n(Ege.ComputedBoundsApplicator).toSelf().inSingletonScope()});z0.default=Cge;var kn=f&&f.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(V0,"__esModule",{value:!0});V0.loadDefaultModules=void 0;const Pge=kn(h0),wge=kn(z0),Age=kn(IA),Rge=kn(j0),Mge=kn(TA),Ige=kn(DA),Tge=kn(OA),Dge=kn(Vl),yT=ta,Oge=kn(B0),Lge=kn(NA),jge=kn($0),Nge=kn(BA),Bge=kn(k0),$ge=kn(F0),kge=kn($A),Fge=kn(kA),xge=kn(FA),Hge=kn(x0),Kge=kn(xA),Vge=kn(H0);function zge(n,e){const t=[Pge.default,wge.default,Age.default,Rge.default,Mge.default,Ige.default,Tge.default,yT.edgeEditModule,Dge.default,Oge.default,Lge.default,jge.default,Nge.default,yT.labelEditModule,yT.labelEditUiModule,Bge.default,$ge.default,kge.default,Fge.default,xge.default,Hge.default,Kge.default,Vge.default];if(e&&e.exclude)for(const i of e.exclude){const o=t.indexOf(i);o>=0&&t.splice(o,1)}n.load(...t)}V0.loadDefaultModules=zge;var pc={},w7={};Object.defineProperty(w7,"__esModule",{value:!0});const a3=ig;function Gge(n){const e={},t=(s,a)=>{if(a!=="style"&&a!=="class"){const u=Zge(n[a]);s?s[a]=u:s={[a]:u}}return s},i=Object.keys(n).reduce(t,null);i&&(e.attrs=i);const o=Uge(n);o&&(e.style=o);const r=Yge(n);return r&&(e.class=r),e}function Uge(n){const e=(t,i)=>{const o=i.split(":"),r=qge(o[0].trim());if(r){const s=o[1].replace("!important","").trim();t?t[r]=s:t={[r]:s}}return t};try{return n.style.split(";").reduce(e,null)}catch{return null}}function Yge(n){const e=(t,i)=>(i=i.trim(),i&&(t?t[i]=!0:t={[i]:!0}),t);try{return n.class.split(" ").reduce(e,null)}catch{return null}}function qge(n){return n=n.replace(/-(\w)/g,function(i,o){return o.toUpperCase()}),`${n.charAt(0).toLowerCase()}${n.substring(1)}`}const Wge=new RegExp("&[a-z0-9#]+;","gi");let Vh=null;function Zge(n){return Vh||(Vh=document.createElement("div")),n.replace(Wge,e=>Vh===null?"":(Vh.innerHTML=e,Vh.textContent===null?"":Vh.textContent))}function Qge(n,e){let t=n,i=null;const o=[],r=s=>{const a=s.firstChild;a!==null&&(i=s),t=a};for(e(t,i),r(t);;){for(;t;)o.push(t),e(t,i),r(t);const s=o.pop();if(t=s||null,!o.length)break;if(i=o[o.length-1],t){const a=t.nextSibling;a==null&&(i=o[o.length-1]),t=a}}}let r_=null;const bT=new Map;let c3=!1;function Xge(n,e){let t;switch(e!==null&&(t=bT.get(e)),n==null?void 0:n.nodeType){case 1:{if(t===void 0)return;t.children=t.children?t.children:[];const i=t.children,o=n.attributes,r={};for(let a=0;a<o.length;a++){const u=o.item(a);u&&(r[u.name]=u.value)}const s=(0,a3.h)(n.nodeName,Gge(r));i.push(s),bT.set(n,s);break}case 3:{const i=n.textContent;if(i!==null&&t!==void 0){t.children=t.children?t.children:[];const o=t.children,r=o.length>0?o[o.length-1]:null;!c3&&typeof r!="string"&&r!==null&&r.sel===void 0?r.text=r.text+i:o.push((0,a3.vnode)(void 0,void 0,void 0,i,void 0)),c3=!1}break}case 8:{c3=!0;break}case 9:{r_=(0,a3.vnode)(void 0,void 0,[],void 0,void 0),bT.set(n,r_);break}}}function Jge(n){const e=n==null?void 0:n.children;return typeof e>"u"?null:e.length===1&&typeof e[0]!="string"?e[0]:null}function e1e(n){var e,t;const i=new window.DOMParser;if(i===void 0||n===void 0||n==="")return null;const o=i.parseFromString(n,"application/xml");if(((e=o==null?void 0:o.firstChild)===null||e===void 0?void 0:e.nodeName)==="parsererror"){const r=`${(t=o==null?void 0:o.firstChild)===null||t===void 0?void 0:t.textContent}`;return(0,a3.h)("parsererror",[r])}return c3=!1,r_=null,Qge(o,Xge),r_===null?null:Jge(r_)}var HU=w7.default=e1e,Mt={};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.ForeignObjectElement=Mt.ForeignObjectElementImpl=Mt.ShapedPreRenderedElement=Mt.ShapedPreRenderedElementImpl=Mt.PreRenderedElement=Mt.PreRenderedElementImpl=Mt.HtmlRoot=Mt.HtmlRootImpl=Mt.RectangularPort=Mt.CircularPort=Mt.DiamondNode=Mt.RectangularNode=Mt.CircularNode=void 0;const s_=Te,KU=ke,g8=$t,t1e=xc,n1e=no,G0=Sn,U0=Ra;class i1e extends G0.SNodeImpl{get anchorKind(){return U0.ELLIPTIC_ANCHOR_KIND}}Mt.CircularNode=i1e;class o1e extends G0.SNodeImpl{get anchorKind(){return U0.RECTANGULAR_ANCHOR_KIND}}Mt.RectangularNode=o1e;class r1e extends G0.SNodeImpl{get anchorKind(){return U0.DIAMOND_ANCHOR_KIND}}Mt.DiamondNode=r1e;class s1e extends G0.SPortImpl{get anchorKind(){return U0.ELLIPTIC_ANCHOR_KIND}}Mt.CircularPort=s1e;class a1e extends G0.SPortImpl{get anchorKind(){return U0.RECTANGULAR_ANCHOR_KIND}}Mt.RectangularPort=a1e;class VU extends KU.SModelRootImpl{constructor(){super(...arguments),this.classes=[]}}Mt.HtmlRootImpl=VU;Mt.HtmlRoot=VU;class A7 extends KU.SChildElementImpl{}Mt.PreRenderedElementImpl=A7;Mt.PreRenderedElement=A7;class VA extends A7{constructor(){super(...arguments),this.position=s_.Point.ORIGIN,this.size=s_.Dimension.EMPTY,this.selected=!1,this.alignment=s_.Point.ORIGIN}get bounds(){return{x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height}}set bounds(e){this.position={x:e.x,y:e.y},this.size={width:e.width,height:e.height}}}Mt.ShapedPreRenderedElementImpl=VA;VA.DEFAULT_FEATURES=[t1e.moveFeature,g8.boundsFeature,n1e.selectFeature,g8.alignFeature];Mt.ShapedPreRenderedElement=VA;class zU extends VA{get bounds(){return s_.Dimension.isValid(this.size)?{x:this.position.x,y:this.position.y,width:this.size.width,height:this.size.height}:(0,g8.isBoundsAware)(this.parent)?{x:this.position.x,y:this.position.y,width:this.parent.bounds.width,height:this.parent.bounds.height}:s_.Bounds.EMPTY}}Mt.ForeignObjectElementImpl=zU;Mt.ForeignObjectElement=zU;var GU=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},c1e=f&&f.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(pc,"__esModule",{value:!0});pc.ForeignObjectView=pc.PreRenderedView=void 0;const Ok=ti,UU=k,YU=c1e(w7),v8=ft,d1e=Fc,u1e=Mt;let _8=class extends d1e.ShapeView{render(e,t){if(e instanceof u1e.ShapedPreRenderedElementImpl&&!this.isVisible(e,t))return;const i=(0,YU.default)(e.code);if(i!==null)return this.correctNamespace(i),i}correctNamespace(e){(e.sel==="svg"||e.sel==="g")&&(0,v8.setNamespace)(e,"http://www.w3.org/2000/svg")}};pc.PreRenderedView=_8;pc.PreRenderedView=_8=GU([(0,UU.injectable)()],_8);let y8=class{render(e,t){const i=(0,YU.default)(e.code);if(i===null)return;const o=(0,Ok.svg)("g",null,(0,Ok.svg)("foreignObject",{requiredFeatures:"http://www.w3.org/TR/SVG11/feature#Extensibility",height:e.bounds.height,width:e.bounds.width,x:0,y:0},i),t.renderChildren(e));return(0,v8.setAttr)(o,"class",e.type),(0,v8.setNamespace)(i,e.namespace),o}};pc.ForeignObjectView=y8;pc.ForeignObjectView=y8=GU([(0,UU.injectable)()],y8);var pg={},l1e=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(pg,"__esModule",{value:!0});pg.HtmlRootView=void 0;const f1e=ti,h1e=k,p1e=ft;let b8=class{render(e,t){const i=(0,f1e.html)("div",null,t.renderChildren(e));for(const o of e.classes)(0,p1e.setClass)(i,o,!0);return i}};pg.HtmlRootView=b8;pg.HtmlRootView=b8=l1e([(0,h1e.injectable)()],b8);var ru={},qU={exports:{}};(function(n,e){(function(t,i){i()})(f,function(){function t(h,g){return typeof g>"u"?g={autoBom:!1}:typeof g!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),g={autoBom:!g}),g.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(h.type)?new Blob(["\uFEFF",h],{type:h.type}):h}function i(h,g,y){var S=new XMLHttpRequest;S.open("GET",h),S.responseType="blob",S.onload=function(){u(S.response,g,y)},S.onerror=function(){console.error("could not download file")},S.send()}function o(h){var g=new XMLHttpRequest;g.open("HEAD",h,!1);try{g.send()}catch{}return 200<=g.status&&299>=g.status}function r(h){try{h.dispatchEvent(new MouseEvent("click"))}catch{var g=document.createEvent("MouseEvents");g.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),h.dispatchEvent(g)}}var s=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof f=="object"&&f.global===f?f:void 0,a=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=s.saveAs||(typeof window!="object"||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(h,g,y){var S=s.URL||s.webkitURL,w=document.createElement("a");g=g||h.name||"download",w.download=g,w.rel="noopener",typeof h=="string"?(w.href=h,w.origin===location.origin?r(w):o(w.href)?i(h,g,y):r(w,w.target="_blank")):(w.href=S.createObjectURL(h),setTimeout(function(){S.revokeObjectURL(w.href)},4e4),setTimeout(function(){r(w)},0))}:"msSaveOrOpenBlob"in navigator?function(h,g,y){if(g=g||h.name||"download",typeof h!="string")navigator.msSaveOrOpenBlob(t(h,y),g);else if(o(h))i(h,g,y);else{var S=document.createElement("a");S.href=h,S.target="_blank",setTimeout(function(){r(S)})}}:function(h,g,y,S){if(S=S||open("","_blank"),S&&(S.document.title=S.document.body.innerText="downloading..."),typeof h=="string")return i(h,g,y);var w=h.type==="application/octet-stream",P=/constructor/i.test(s.HTMLElement)||s.safari,E=/CriOS\/[\d]+/.test(navigator.userAgent);if((E||w&&P||a)&&typeof FileReader<"u"){var A=new FileReader;A.onloadend=function(){var U=A.result;U=E?U:U.replace(/^data:[^;]*;/,"data:attachment/file;"),S?S.location.href=U:location=U,S=null},A.readAsDataURL(h)}else{var L=s.URL||s.webkitURL,B=L.createObjectURL(h);S?S.location=B:location.href=B,S=null,setTimeout(function(){L.revokeObjectURL(B)},4e4)}});s.saveAs=u.saveAs=u,n.exports=u})})(qU);var R7=qU.exports,M7=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},WU=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(ru,"__esModule",{value:!0});ru.DiagramServerProxy=ru.ServerStatusAction=void 0;const m1e=R7,I7=k,Ns=se,Lk=Nu,g1e=me,ST=hs,v1e=sr,jk=Fu,S8=rr;class Yp{constructor(){this.kind=Yp.KIND}}ru.ServerStatusAction=Yp;Yp.KIND="serverStatus";const Nk="__receivedFromServer";let ty=class extends S8.ModelSource{constructor(){super(...arguments),this.currentRoot={type:"NONE",id:"ROOT"}}get model(){return this.currentRoot}initialize(e){super.initialize(e),e.register(Ns.ComputedBoundsAction.KIND,this),e.register(ST.RequestBoundsCommand.KIND,this),e.register(Ns.RequestPopupModelAction.KIND,this),e.register(Ns.CollapseExpandAction.KIND,this),e.register(Ns.CollapseExpandAllAction.KIND,this),e.register(Ns.OpenAction.KIND,this),e.register(Yp.KIND,this),this.clientId||(this.clientId=this.viewerOptions.baseDiv)}handle(e){this.handleLocally(e)&&this.forwardToServer(e)}forwardToServer(e){const t={clientId:this.clientId,action:e};this.logger.log(this,"sending",t),this.sendMessage(t)}messageReceived(e){const t=typeof e=="string"?JSON.parse(e):e;(0,Ns.isActionMessage)(t)&&t.action?(!t.clientId||t.clientId===this.clientId)&&(t.action[Nk]=!0,this.logger.log(this,"receiving",t),this.actionDispatcher.dispatch(t.action).then(()=>{this.storeNewModel(t.action)})):this.logger.error(this,"received data is not an action message",t)}handleLocally(e){switch(this.storeNewModel(e),e.kind){case Ns.ComputedBoundsAction.KIND:return this.handleComputedBounds(e);case Ns.RequestModelAction.KIND:return this.handleRequestModel(e);case ST.RequestBoundsCommand.KIND:return!1;case v1e.ExportSvgAction.KIND:return this.handleExportSvgAction(e);case Yp.KIND:return this.handleServerStateAction(e)}return!e[Nk]}storeNewModel(e){if(e.kind===Lk.SetModelCommand.KIND||e.kind===jk.UpdateModelCommand.KIND||e.kind===ST.RequestBoundsCommand.KIND){const t=e.newRoot;t&&(this.currentRoot=t,(e.kind===Lk.SetModelCommand.KIND||e.kind===jk.UpdateModelCommand.KIND)&&(this.lastSubmittedModelType=t.type))}}handleRequestModel(e){const t=Object.assign({needsClientLayout:this.viewerOptions.needsClientLayout,needsServerLayout:this.viewerOptions.needsServerLayout},e.options),i=Object.assign(Object.assign({},e),{options:t});return this.forwardToServer(i),!1}handleComputedBounds(e){if(this.viewerOptions.needsServerLayout)return!0;{const t=this.currentRoot;return this.computedBoundsApplicator.apply(t,e),t.type===this.lastSubmittedModelType?this.actionDispatcher.dispatch(Ns.UpdateModelAction.create(t)):this.actionDispatcher.dispatch(Ns.SetModelAction.create(t)),this.lastSubmittedModelType=t.type,!1}}handleExportSvgAction(e){const t=new Blob([e.svg],{type:"text/plain;charset=utf-8"});return(0,m1e.saveAs)(t,"diagram.svg"),!1}handleServerStateAction(e){return!1}commitModel(e){const t=this.currentRoot;return this.currentRoot=e,t}};ru.DiagramServerProxy=ty;M7([(0,I7.inject)(g1e.TYPES.ILogger),WU("design:type",Object)],ty.prototype,"logger",void 0);M7([(0,I7.inject)(S8.ComputedBoundsApplicator),WU("design:type",S8.ComputedBoundsApplicator)],ty.prototype,"computedBoundsApplicator",void 0);ru.DiagramServerProxy=ty=M7([(0,I7.injectable)()],ty);var Y0={},q0=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},zA=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Y0,"__esModule",{value:!0});Y0.LocalModelSource=void 0;const _1e=R7,zl=k,Wr=se,Bk=Fr,$k=Nn,T7=me,y1e=$n,b1e=sr,S1e=ss,E8=rr;let Gl=class extends E8.ModelSource{constructor(){super(...arguments),this.currentRoot=y1e.EMPTY_ROOT}get model(){return this.currentRoot}set model(e){this.setModel(e)}initialize(e){super.initialize(e),e.register(Wr.ComputedBoundsAction.KIND,this),e.register(Wr.RequestPopupModelAction.KIND,this)}setModel(e){return this.currentRoot=e,this.submitModel(e,!1)}commitModel(e){const t=this.currentRoot;return this.currentRoot=e,t}updateModel(e){return e===void 0?this.submitModel(this.currentRoot,!0):(this.currentRoot=e,this.submitModel(e,!0))}async getSelection(){const e=await this.actionDispatcher.request(Bk.GetSelectionAction.create()),t=[];return this.gatherSelectedElements(this.currentRoot,new Set(e.selectedElementsIDs),t),t}gatherSelectedElements(e,t,i){if(t.has(e.id)&&i.push(e),e.children)for(const o of e.children)this.gatherSelectedElements(o,t,i)}async getViewport(){const e=await this.actionDispatcher.request(Bk.GetViewportAction.create());return{scroll:e.viewport.scroll,zoom:e.viewport.zoom,canvasBounds:e.canvasBounds}}async submitModel(e,t,i){if(this.viewerOptions.needsClientLayout){const o=await this.actionDispatcher.request(Wr.RequestBoundsAction.create(e)),r=this.computedBoundsApplicator.apply(this.currentRoot,o);await this.doSubmitModel(e,!0,i,r)}else await this.doSubmitModel(e,t,i)}async doSubmitModel(e,t,i,o){if(this.layoutEngine!==void 0)try{const s=this.layoutEngine.layout(e,o);s instanceof Promise?e=await s:s!==void 0&&(e=s)}catch(s){this.logger.error(this,s.toString(),s.stack)}const r=this.lastSubmittedModelType;if(this.lastSubmittedModelType=e.type,i&&i.kind===Wr.RequestModelAction.KIND&&i.requestId){const s=i;await this.actionDispatcher.dispatch(Wr.SetModelAction.create(e,s.requestId))}else if(t&&e.type===r){const s=Array.isArray(t)?t:e;await this.actionDispatcher.dispatch(Wr.UpdateModelAction.create(s,{animate:!0,cause:i}))}else await this.actionDispatcher.dispatch(Wr.SetModelAction.create(e))}applyMatches(e){const t=this.currentRoot;return(0,S1e.applyMatches)(t,e),this.submitModel(t,e)}addElements(e){const t=[];for(const i of e){const o=i;typeof o.element=="object"&&typeof o.parentId=="string"?t.push({right:o.element,rightParentId:o.parentId}):typeof o.id=="string"&&t.push({right:o,rightParentId:this.currentRoot.id})}return this.applyMatches(t)}removeElements(e){const t=[],i=new $k.SModelIndex;i.add(this.currentRoot);for(const o of e){const r=o;if(r.elementId!==void 0&&r.parentId!==void 0){const s=i.getById(r.elementId);s!==void 0&&t.push({left:s,leftParentId:r.parentId})}else{const s=i.getById(r);s!==void 0&&t.push({left:s,leftParentId:this.currentRoot.id})}}return this.applyMatches(t)}handle(e){switch(e.kind){case Wr.RequestModelAction.KIND:this.handleRequestModel(e);break;case Wr.ComputedBoundsAction.KIND:this.computedBoundsApplicator.apply(this.currentRoot,e);break;case Wr.RequestPopupModelAction.KIND:this.handleRequestPopupModel(e);break;case b1e.ExportSvgAction.KIND:this.handleExportSvgAction(e);break}}handleRequestModel(e){this.submitModel(this.currentRoot,!1,e)}handleRequestPopupModel(e){if(this.popupModelProvider!==void 0){const t=(0,$k.findElement)(this.currentRoot,e.elementId),i=this.popupModelProvider.getPopupModel(e,t);i!==void 0&&(i.canvasBounds=e.bounds,this.actionDispatcher.dispatch(Wr.SetPopupModelAction.create(i,e.requestId)))}}handleExportSvgAction(e){const t=new Blob([e.svg],{type:"text/plain;charset=utf-8"});(0,_1e.saveAs)(t,"diagram.svg")}};Y0.LocalModelSource=Gl;q0([(0,zl.inject)(T7.TYPES.ILogger),zA("design:type",Object)],Gl.prototype,"logger",void 0);q0([(0,zl.inject)(E8.ComputedBoundsApplicator),zA("design:type",E8.ComputedBoundsApplicator)],Gl.prototype,"computedBoundsApplicator",void 0);q0([(0,zl.inject)(T7.TYPES.IPopupModelProvider),(0,zl.optional)(),zA("design:type",Object)],Gl.prototype,"popupModelProvider",void 0);q0([(0,zl.inject)(T7.TYPES.IModelLayoutEngine),(0,zl.optional)(),zA("design:type",Object)],Gl.prototype,"layoutEngine",void 0);Y0.LocalModelSource=Gl=q0([(0,zl.injectable)()],Gl);var mg={},D7=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},ZU=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(mg,"__esModule",{value:!0});mg.ForwardingLogger=void 0;const O7=k,E1e=se,ud=Zo,QU=me;let ny=class{error(e,t,...i){this.logLevel>=ud.LogLevel.error&&this.forward(e,t,ud.LogLevel.error,i)}warn(e,t,...i){this.logLevel>=ud.LogLevel.warn&&this.forward(e,t,ud.LogLevel.warn,i)}info(e,t,...i){this.logLevel>=ud.LogLevel.info&&this.forward(e,t,ud.LogLevel.info,i)}log(e,t,...i){if(this.logLevel>=ud.LogLevel.log)try{const o=typeof e=="object"?e.constructor.name:String(e);console.log.apply(e,[o+": "+t,...i])}catch{}}forward(e,t,i,o){const r=new Date,s=E1e.LoggingAction.create({message:t,severity:ud.LogLevel[i],time:r.toLocaleTimeString(),caller:typeof e=="object"?e.constructor.name:String(e),params:o.map(a=>JSON.stringify(a))});this.modelSourceProvider().then(a=>{try{a.handle(s)}catch(u){try{console.log.apply(e,[t,s,u])}catch{}}})}};mg.ForwardingLogger=ny;D7([(0,O7.inject)(QU.TYPES.ModelSourceProvider),ZU("design:type",Function)],ny.prototype,"modelSourceProvider",void 0);D7([(0,O7.inject)(QU.TYPES.LogLevel),ZU("design:type",Number)],ny.prototype,"logLevel",void 0);mg.ForwardingLogger=ny=D7([(0,O7.injectable)()],ny);var W0={},C1e=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(W0,"__esModule",{value:!0});W0.WebSocketDiagramServerProxy=void 0;const P1e=k,w1e=ru;let C8=class extends w1e.DiagramServerProxy{listen(e){e.addEventListener("message",t=>{this.messageReceived(t.data)}),e.addEventListener("error",t=>{this.logger.error(this,"error event received",t)}),this.webSocket=e}disconnect(){this.webSocket&&(this.webSocket.close(),this.webSocket=void 0)}sendMessage(e){if(this.webSocket)this.webSocket.send(JSON.stringify(e));else throw new Error("WebSocket is not connected")}};W0.WebSocketDiagramServerProxy=C8;W0.WebSocketDiagramServerProxy=C8=C1e([(0,P1e.injectable)()],C8);var ic={};Object.defineProperty(ic,"__esModule",{value:!0});ic.ColorMap=ic.toSVG=ic.rgb=void 0;function A1e(n,e,t){return{red:n,green:e,blue:t}}ic.rgb=A1e;function R1e(n){return"rgb("+n.red+","+n.green+","+n.blue+")"}ic.toSVG=R1e;class M1e{constructor(e){this.stops=e}getColor(e){e=Math.max(0,Math.min(.99999999,e));const t=Math.floor(e*this.stops.length);return this.stops[t]}}ic.ColorMap=M1e;(function(n){var e=f&&f.__createBinding||(Object.create?function(T,$,Q,K){K===void 0&&(K=Q);var Z=Object.getOwnPropertyDescriptor($,Q);(!Z||("get"in Z?!$.__esModule:Z.writable||Z.configurable))&&(Z={enumerable:!0,get:function(){return $[Q]}}),Object.defineProperty(T,K,Z)}:function(T,$,Q,K){K===void 0&&(K=Q),T[K]=$[Q]}),t=f&&f.__exportStar||function(T,$){for(var Q in T)Q!=="default"&&!Object.prototype.hasOwnProperty.call($,Q)&&e($,T,Q)},i=f&&f.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(n,"__esModule",{value:!0}),n.modelSourceModule=n.zorderModule=n.viewportModule=n.updateModule=n.undoRedoModule=n.selectModule=n.routingModule=n.openModule=n.moveModule=n.hoverModule=n.fadeModule=n.exportModule=n.expandModule=n.edgeLayoutModule=n.edgeJunctionModule=n.edgeIntersectionModule=n.decorationModule=n.contextMenuModule=n.commandPaletteModule=n.buttonModule=n.boundsModule=n.defaultModule=void 0,t(Jd,n),t(ju,n),t(Wo,n),t(wf,n),t(Pa,n),t(Lr,n),t(Jm,n),t(ze,n),t(wn,n),t(eA,n),t(Af,n),t(Co,n),t(Nu,n),t($n,n),t(yt,n),t(ke,n),t(Po,n),t(aa,n),t(gi,n),t(Ut,n),t(ac,n),t(rn,n),t(If,n),t(rA,n),t(Xn,n),t(Tf,n),t(ft,n),t(me,n);const o=i(h0);n.defaultModule=o.default,t(hs,n),t(cA,n),t(qi,n),t($t,n),t(Df,n),t(Of,n),t(og,n),t(Fc,n),t(ps,n),t(rg,n),t(ms,n),t(cc,n),t(hA,n),t(gs,n),t(Nf,n),t(Vl,n),t(Bf,n),t($f,n),t(E0,n),t(X6,n),t(ta,n),t(jf,n),t(_n,n),t(ca,n),t(_s,n),t(kf,n),t(Hf,n),t(Kf,n),t(R0,n),t(cg,n),t(Wi,n),t(y0,n),t(sr,n),t(ua,n),t(Lf,n),t(fn,n),t($u,n),t(D0,n),t(Vf,n),t(zf,n),t(Qn,n),t(Ln,n),t(Gf,n),t(xc,n),t(Jn,n),t(dg,n),t(uA,n),t(ug,n),t(SA,n),t(Yo,n),t(lg,n),t(Ra,n),t(Xo,n),t(Jo,n),t(Zi,n),t(er,n),t(Uf,n),t(an,n),t(wo,n),t(Hc,n),t(vi,n),t(Yf,n),t(no,n),t(fi,n),t(L0,n),t(ss,n),t(Fu,n),t(Bi,n),t(Rs,n),t(hc,n),t(Ff,n),t(Ao,n),t(uc,n),t(qf,n);const r=i(IA);n.boundsModule=r.default;const s=i(j0);n.buttonModule=s.default;const a=i(TA);n.commandPaletteModule=a.default;const u=i(DA);n.contextMenuModule=u.default;const h=i(OA);n.decorationModule=h.default;const g=i(LA);n.edgeIntersectionModule=g.default;const y=i(jA);n.edgeJunctionModule=y.default;const S=i(Vl);n.edgeLayoutModule=S.default;const w=i(B0);n.expandModule=w.default;const P=i(NA);n.exportModule=P.default;const E=i($0);n.fadeModule=E.default;const A=i(BA);n.hoverModule=A.default;const L=i(k0);n.moveModule=L.default;const B=i(F0);n.openModule=B.default;const U=i($A);n.routingModule=U.default;const p=i(kA);n.selectModule=p.default;const b=i(FA);n.undoRedoModule=b.default;const v=i(x0);n.updateModule=v.default;const R=i(xA);n.viewportModule=R.default;const D=i(H0);n.zorderModule=D.default,t(Sn,n),t(gt,n),t(V0,n),t(pc,n),t(pg,n),t(ti,n),t(Mt,n),t(zn,n),t(vs,n),t(ru,n),t(Y0,n),t(mg,n),t(rr,n),t(W0,n);const j=i(z0);n.modelSourceModule=j.default,t(sn,n),t(lA,n),t(ic,n),t(ei,n),t(wa,n),t(Zo,n),t(pn,n)})(d0);var XU=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Xd,"__esModule",{value:!0});Xd.MouseListener=Xd.KeyListener=void 0;const JU=k,eY=d0;let P8=class extends eY.KeyListener{keyDown(e,t){return[]}keyUp(e,t){return[]}};Xd.KeyListener=P8;Xd.KeyListener=P8=XU([(0,JU.injectable)()],P8);let w8=class extends eY.MouseListener{mouseOver(e,t){return[]}mouseOut(e,t){return[]}mouseEnter(e,t){return[]}mouseLeave(e,t){return[]}mouseDown(e,t){return[]}mouseMove(e,t){return[]}mouseUp(e,t){return[]}wheel(e,t){return[]}doubleClick(e,t){return[]}contextMenu(e,t){return[]}dragOver(e,t){return[]}drop(e,t){return[]}decorate(e,t){return e}};Xd.MouseListener=w8;Xd.MouseListener=w8=XU([(0,JU.injectable)()],w8);var Nt={},L7={},qp={},lt={};Object.defineProperty(lt,"__esModule",{value:!0});lt.arrayOf=lt.partition=lt.isArrayMatching=lt.isStringArray=lt.isArrayOfPrimitive=lt.isArrayOfClass=lt.isArrayOfType=lt.distinctAdd=lt.asArray=lt.flatPush=lt.remove=lt.pluck=lt.last=lt.first=void 0;function I1e(n,e){return e?n.filter((t,i)=>i<e):n[0]}lt.first=I1e;function T1e(n,e){return e?n.filter((t,i)=>n.length-i<=e):n[n.length-1]}lt.last=T1e;function D1e(n,e){return n.map(t=>t[e])}lt.pluck=D1e;function O1e(n,...e){e.forEach(t=>{const i=n.indexOf(t);i>=0&&n.splice(i,1)})}lt.remove=O1e;function L1e(n,e){e.forEach(t=>Array.isArray(t)?n.push(...t):n.push(t))}lt.flatPush=L1e;function j1e(n){return Array.isArray(n)?n:[n]}lt.asArray=j1e;function N1e(n,...e){e.forEach(t=>{n.includes(t)||n.push(t)})}lt.distinctAdd=N1e;function B1e(n,e,t=!1){return GA(n,i=>e(i),t)}lt.isArrayOfType=B1e;function $1e(n,e,t=!1){return GA(n,i=>i instanceof e,t)}lt.isArrayOfClass=$1e;function tY(n,e,t=!1){return GA(n,i=>typeof i===e,t)}lt.isArrayOfPrimitive=tY;function k1e(n,e=!1){return tY(n,"string",e)}lt.isStringArray=k1e;function GA(n,e,t=!1){return Array.isArray(n)&&n.every(e)&&(t||n.length>0)}lt.isArrayMatching=GA;function F1e(n,e){const t=[],i=[];return n.forEach(o=>{e(o)?t.push(o):i.push(o)}),{match:t,rest:i}}lt.partition=F1e;function x1e(...n){return n.filter(e=>e!==void 0)}lt.arrayOf=x1e;var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.hasArrayProp=Oe.hasFunctionProp=Oe.hasObjectProp=Oe.hasNumberProp=Oe.hasBooleanProp=Oe.hasStringProp=Oe.call=Oe.toTypeGuard=Oe.typeGuardOr=Oe.typeGuard=Oe.AnyObject=void 0;var A8;(function(n){function e(t){return t!==null&&typeof t=="object"}n.is=e})(A8||(Oe.AnyObject=A8={}));function H1e(n,e){return t=>n(t)&&e(t)}Oe.typeGuard=H1e;function K1e(n,e){return t=>n(t)||e(t)}Oe.typeGuardOr=K1e;function V1e(n){return e=>e instanceof n}Oe.toTypeGuard=V1e;function z1e(n,...e){return typeof n=="function"?n(...e):n}Oe.call=z1e;function G1e(n,e,t=!1){const i=n[e];return i!==void 0?typeof i=="string":t}Oe.hasStringProp=G1e;function U1e(n,e,t=!1){const i=n[e];return i!==void 0?typeof i=="boolean":t}Oe.hasBooleanProp=U1e;function Y1e(n,e,t=!1){const i=n[e];return i!==void 0?typeof i=="number":t}Oe.hasNumberProp=Y1e;function q1e(n,e,t=!1){const i=n[e];return i!==void 0?A8.is(i):t}Oe.hasObjectProp=q1e;function W1e(n,e,t=!1){const i=n[e];return i!==void 0?typeof i=="function":t}Oe.hasFunctionProp=W1e;function Z1e(n,e,t=!1){const i=n[e];return i!==void 0?Array.isArray(i):t}Oe.hasArrayProp=Z1e;var Z0={};Object.defineProperty(Z0,"__esModule",{value:!0});Z0.FeatureModule=void 0;const Q1e=k,X1e=lt;class UA extends Q1e.ContainerModule{constructor(e,t={}){var i;super((o,r,s,...a)=>{this.configure(o,s)&&(e(o,r,s,...a),this.debugLog(`Loading of feature module with id '${this.featureId.toString()}' completed`))}),this.featureId=(i=t.featureId)!==null&&i!==void 0?i:this.createFeatureId(),this.requires=t.requires}createFeatureId(){return Symbol(this.id)}configure(e,t){if(this.debugLog(`Trying to load feature module with id '${this.featureId.toString()}'`),this.isLoaded({isBound:t})){const i=`Could not load feature module. Another module with id '${this.featureId.toString()}' is already loaded`;throw this.debugLog(i),new Error(i)}return this.checkRequirements(t)?(this.debugLog(`Requirements are met, continue loading of feature module with id '${this.featureId.toString()}'`),e(this.featureId).toConstantValue(this.featureId),!0):!1}debugLog(e,...t){UA.DEBUG_LOG_ENABLED&&console.log(e,...t)}checkRequirements(e){var t;const i=(0,X1e.asArray)((t=this.requires)!==null&&t!==void 0?t:[]);if(i.length===0)return!0;const o=i.filter(r=>!r.isLoaded({isBound:e}));return o.length>0?(this.debugLog(`Could not load feature module. Required modules are not loaded. Feature ids: ${o.map(r=>r.featureId.toString()).join(", ")}`),!1):!0}isLoaded(e){return e.isBound(this.featureId)}}Z0.FeatureModule=UA;UA.DEBUG_LOG_ENABLED=!1;Object.defineProperty(qp,"__esModule",{value:!0});qp.resolveContainerConfiguration=qp.initializeContainer=void 0;const tl=lt,kk=Oe,Fk=Z0;function J1e(n,...e){const t=nY(...e);return n.load(...t),n}qp.initializeContainer=J1e;function nY(...n){const e=[];n.forEach(o=>{eve(o)?(0,tl.distinctAdd)(e,o):(o.remove&&(0,tl.remove)(e,...(0,tl.asArray)(o.remove)),o.add&&(0,tl.distinctAdd)(e,...(0,tl.asArray)(o.add)),o.replace&&(0,tl.asArray)(o.replace).forEach(r=>{const s=e.findIndex(a=>a instanceof Fk.FeatureModule&&a.featureId===r.featureId);s>=0?e[s]=r:(console.warn(`Could not find module to replace with feature id ${r.featureId.toString()}.Adding replacement module to the end of the resolved configurations.`),(0,tl.distinctAdd)(e,r))}))});const t=new Set,i=[];if(e.forEach(o=>{o instanceof Fk.FeatureModule&&(t.has(o.featureId)?i.push(o):t.add(o.featureId))}),i.length>0){const o=i.map(r=>r.featureId.toString()).join(", ");throw new Error(`Could not resolve container configuration. Non-unique feature ids found in container configuration: ${o}`)}return e}qp.resolveContainerConfiguration=nY;function eve(n){return(0,kk.hasNumberProp)(n,"id")&&(0,kk.hasFunctionProp)(n,"registry")}var Fd={};Object.defineProperty(Fd,"__esModule",{value:!0});Fd.bindAsService=Fd.lazyBind=Fd.bindOrRebind=void 0;function tve(n,e){return n.isBound(e)?n.rebind(e):n.bind(e)}Fd.bindOrRebind=tve;function nve(n,e){if(!n.isBound(e))return n.bind(e)}Fd.lazyBind=nve;function ive(n,e,t){const i=typeof n=="object"?n.bind.bind(n):n;i(t).toSelf().inSingletonScope(),i(e).toService(t)}Fd.bindAsService=ive;var iY={},Ee={};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.STACK_OVERFLOW=Ee.CIRCULAR_DEPENDENCY_IN_FACTORY=Ee.ON_DEACTIVATION_ERROR=Ee.PRE_DESTROY_ERROR=Ee.POST_CONSTRUCT_ERROR=Ee.ASYNC_UNBIND_REQUIRED=Ee.MULTIPLE_POST_CONSTRUCT_METHODS=Ee.MULTIPLE_PRE_DESTROY_METHODS=Ee.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK=Ee.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE=Ee.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE=Ee.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT=Ee.ARGUMENTS_LENGTH_MISMATCH=Ee.INVALID_DECORATOR_OPERATION=Ee.INVALID_TO_SELF_VALUE=Ee.LAZY_IN_SYNC=Ee.INVALID_FUNCTION_BINDING=Ee.INVALID_MIDDLEWARE_RETURN=Ee.NO_MORE_SNAPSHOTS_AVAILABLE=Ee.INVALID_BINDING_TYPE=Ee.NOT_IMPLEMENTED=Ee.CIRCULAR_DEPENDENCY=Ee.UNDEFINED_INJECT_ANNOTATION=Ee.MISSING_INJECT_ANNOTATION=Ee.MISSING_INJECTABLE_ANNOTATION=Ee.NOT_REGISTERED=Ee.CANNOT_UNBIND=Ee.AMBIGUOUS_MATCH=Ee.KEY_NOT_FOUND=Ee.NULL_ARGUMENT=Ee.DUPLICATED_METADATA=Ee.DUPLICATED_INJECTABLE_DECORATOR=void 0;Ee.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.";Ee.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:";Ee.NULL_ARGUMENT="NULL argument";Ee.KEY_NOT_FOUND="Key Not Found";Ee.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:";Ee.CANNOT_UNBIND="Could not unbind serviceIdentifier:";Ee.NOT_REGISTERED="No matching bindings found for serviceIdentifier:";Ee.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:";Ee.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:";var ove=function(n){return"@inject called with undefined this could mean that the class ".concat(n," has ")+"a circular dependency problem. You can use a LazyServiceIdentifer to overcome this limitation."};Ee.UNDEFINED_INJECT_ANNOTATION=ove;Ee.CIRCULAR_DEPENDENCY="Circular dependency found:";Ee.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.";Ee.INVALID_BINDING_TYPE="Invalid binding type:";Ee.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.";Ee.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!";Ee.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!";var rve=function(n){return"You are attempting to construct ".concat(lve(n)," in a synchronous way ")+"but it has asynchronous dependencies."};Ee.LAZY_IN_SYNC=rve;Ee.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier";Ee.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.";var sve=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return"The number of constructor arguments in the derived class "+"".concat(n[0]," must be >= than the number of constructor arguments of its base class.")};Ee.ARGUMENTS_LENGTH_MISMATCH=sve;Ee.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.";Ee.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE='Invalid Container option. Default scope must be a string ("singleton" or "transient").';Ee.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean";Ee.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean";Ee.MULTIPLE_PRE_DESTROY_METHODS="Cannot apply @preDestroy decorator multiple times in the same class";Ee.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class";Ee.ASYNC_UNBIND_REQUIRED="Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)";var ave=function(n,e){return"@postConstruct error in class ".concat(n,": ").concat(e)};Ee.POST_CONSTRUCT_ERROR=ave;var cve=function(n,e){return"@preDestroy error in class ".concat(n,": ").concat(e)};Ee.PRE_DESTROY_ERROR=cve;var dve=function(n,e){return"onDeactivation() error in class ".concat(n,": ").concat(e)};Ee.ON_DEACTIVATION_ERROR=dve;var uve=function(n,e){return"It looks like there is a circular dependency in one of the '".concat(n,"' bindings. Please investigate bindings with ")+"service identifier '".concat(e,"'.")};Ee.CIRCULAR_DEPENDENCY_IN_FACTORY=uve;Ee.STACK_OVERFLOW="Maximum call stack size exceeded";function lve(n){return typeof n=="function"?"[function/class ".concat(n.name||"<anonymous>","]"):typeof n=="symbol"?n.toString():"'".concat(n,"'")}(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.bindLazyInjector=n.DefaultLazyInjector=n.LazyInjector=void 0;const e=k,t=Ee;n.LazyInjector=Symbol("LazyInjector");class i{constructor(s){this.container=s,this.cache=new Map}get(s){const a=this.getOptional(s);if(a===void 0)throw new Error(t.NOT_REGISTERED+(0,e.getServiceIdentifierAsString)(s));return a}getOptional(s){if(this.cache.has(s))return this.cache.get(s);const a=this.container.isBound(s)?this.container.get(s):void 0;return this.cache.set(s,a),a}getAll(s){if(this.cache.has(s))return this.cache.get(s);const a=this.container.isBound(s)?this.container.getAll(s):[];return this.cache.set(s,a),a}}n.DefaultLazyInjector=i;function o(r){(typeof r=="object"?r.bind.bind(r):r)(n.LazyInjector).toDynamicValue(a=>new i(a.container))}n.bindLazyInjector=o})(iY);var oY={},Ul={},gg={},vg={},j7={},VC={},Ie={},jn={};Object.defineProperty(jn,"__esModule",{value:!0});jn.stringArray=jn.array=jn.func=jn.error=jn.number=jn.string=jn.boolean=void 0;function fve(n){return n===!0||n===!1}jn.boolean=fve;function rY(n){return typeof n=="string"||n instanceof String}jn.string=rY;function hve(n){return typeof n=="number"||n instanceof Number}jn.number=hve;function pve(n){return n instanceof Error}jn.error=pve;function mve(n){return typeof n=="function"}jn.func=mve;function sY(n){return Array.isArray(n)}jn.array=sY;function gve(n){return sY(n)&&n.every(e=>rY(e))}jn.stringArray=gve;Object.defineProperty(Ie,"__esModule",{value:!0});Ie.Message=Ie.NotificationType9=Ie.NotificationType8=Ie.NotificationType7=Ie.NotificationType6=Ie.NotificationType5=Ie.NotificationType4=Ie.NotificationType3=Ie.NotificationType2=Ie.NotificationType1=Ie.NotificationType0=Ie.NotificationType=Ie.RequestType9=Ie.RequestType8=Ie.RequestType7=Ie.RequestType6=Ie.RequestType5=Ie.RequestType4=Ie.RequestType3=Ie.RequestType2=Ie.RequestType1=Ie.RequestType=Ie.RequestType0=Ie.AbstractMessageSignature=Ie.ParameterStructures=Ie.ResponseError=Ie.ErrorCodes=void 0;const _l=jn;var R8;(function(n){n.ParseError=-32700,n.InvalidRequest=-32600,n.MethodNotFound=-32601,n.InvalidParams=-32602,n.InternalError=-32603,n.jsonrpcReservedErrorRangeStart=-32099,n.serverErrorStart=-32099,n.MessageWriteError=-32099,n.MessageReadError=-32098,n.PendingResponseRejected=-32097,n.ConnectionInactive=-32096,n.ServerNotInitialized=-32002,n.UnknownErrorCode=-32001,n.jsonrpcReservedErrorRangeEnd=-32e3,n.serverErrorEnd=-32e3})(R8||(Ie.ErrorCodes=R8={}));class N7 extends Error{constructor(e,t,i){super(t),this.code=_l.number(e)?e:R8.UnknownErrorCode,this.data=i,Object.setPrototypeOf(this,N7.prototype)}toJson(){const e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}}Ie.ResponseError=N7;class ki{constructor(e){this.kind=e}static is(e){return e===ki.auto||e===ki.byName||e===ki.byPosition}toString(){return this.kind}}Ie.ParameterStructures=ki;ki.auto=new ki("auto");ki.byPosition=new ki("byPosition");ki.byName=new ki("byName");class mn{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return ki.auto}}Ie.AbstractMessageSignature=mn;class vve extends mn{constructor(e){super(e,0)}}Ie.RequestType0=vve;class _ve extends mn{constructor(e,t=ki.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}Ie.RequestType=_ve;class yve extends mn{constructor(e,t=ki.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}Ie.RequestType1=yve;class bve extends mn{constructor(e){super(e,2)}}Ie.RequestType2=bve;class Sve extends mn{constructor(e){super(e,3)}}Ie.RequestType3=Sve;class Eve extends mn{constructor(e){super(e,4)}}Ie.RequestType4=Eve;class Cve extends mn{constructor(e){super(e,5)}}Ie.RequestType5=Cve;class Pve extends mn{constructor(e){super(e,6)}}Ie.RequestType6=Pve;class wve extends mn{constructor(e){super(e,7)}}Ie.RequestType7=wve;class Ave extends mn{constructor(e){super(e,8)}}Ie.RequestType8=Ave;class Rve extends mn{constructor(e){super(e,9)}}Ie.RequestType9=Rve;class Mve extends mn{constructor(e,t=ki.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}Ie.NotificationType=Mve;class Ive extends mn{constructor(e){super(e,0)}}Ie.NotificationType0=Ive;class Tve extends mn{constructor(e,t=ki.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}}Ie.NotificationType1=Tve;class Dve extends mn{constructor(e){super(e,2)}}Ie.NotificationType2=Dve;class Ove extends mn{constructor(e){super(e,3)}}Ie.NotificationType3=Ove;class Lve extends mn{constructor(e){super(e,4)}}Ie.NotificationType4=Lve;class jve extends mn{constructor(e){super(e,5)}}Ie.NotificationType5=jve;class Nve extends mn{constructor(e){super(e,6)}}Ie.NotificationType6=Nve;class Bve extends mn{constructor(e){super(e,7)}}Ie.NotificationType7=Bve;class $ve extends mn{constructor(e){super(e,8)}}Ie.NotificationType8=$ve;class kve extends mn{constructor(e){super(e,9)}}Ie.NotificationType9=kve;var xk;(function(n){function e(o){const r=o;return r&&_l.string(r.method)&&(_l.string(r.id)||_l.number(r.id))}n.isRequest=e;function t(o){const r=o;return r&&_l.string(r.method)&&o.id===void 0}n.isNotification=t;function i(o){const r=o;return r&&(r.result!==void 0||!!r.error)&&(_l.string(r.id)||_l.number(r.id)||r.id===null)}n.isResponse=i})(xk||(Ie.Message=xk={}));var oc={},Hk;Object.defineProperty(oc,"__esModule",{value:!0});oc.LRUCache=oc.LinkedMap=oc.Touch=void 0;var Ii;(function(n){n.None=0,n.First=1,n.AsOld=n.First,n.Last=2,n.AsNew=n.Last})(Ii||(oc.Touch=Ii={}));class aY{constructor(){this[Hk]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){var e;return(e=this._head)==null?void 0:e.value}get last(){var e;return(e=this._tail)==null?void 0:e.value}has(e){return this._map.has(e)}get(e,t=Ii.None){const i=this._map.get(e);if(i)return t!==Ii.None&&this.touch(i,t),i.value}set(e,t,i=Ii.None){let o=this._map.get(e);if(o)o.value=t,i!==Ii.None&&this.touch(o,i);else{switch(o={key:e,value:t,next:void 0,previous:void 0},i){case Ii.None:this.addItemLast(o);break;case Ii.First:this.addItemFirst(o);break;case Ii.Last:this.addItemLast(o);break;default:this.addItemLast(o);break}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){const t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");const e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){const i=this._state;let o=this._head;for(;o;){if(t?e.bind(t)(o.value,o.key,this):e(o.value,o.key,this),this._state!==i)throw new Error("LinkedMap got modified during iteration.");o=o.next}}keys(){const e=this._state;let t=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const o={value:t.key,done:!1};return t=t.next,o}else return{value:void 0,done:!0}}};return i}values(){const e=this._state;let t=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const o={value:t.value,done:!1};return t=t.next,o}else return{value:void 0,done:!0}}};return i}entries(){const e=this._state;let t=this._head;const i={[Symbol.iterator]:()=>i,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){const o={value:[t.key,t.value],done:!1};return t=t.next,o}else return{value:void 0,done:!0}}};return i}[(Hk=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,i=this.size;for(;t&&i>e;)this._map.delete(t.key),t=t.next,i--;this._head=t,this._size=i,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{const t=e.next,i=e.previous;if(!t||!i)throw new Error("Invalid list");t.previous=i,i.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==Ii.First&&t!==Ii.Last)){if(t===Ii.First){if(e===this._head)return;const i=e.next,o=e.previous;e===this._tail?(o.next=void 0,this._tail=o):(i.previous=o,o.next=i),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Ii.Last){if(e===this._tail)return;const i=e.next,o=e.previous;e===this._head?(i.previous=void 0,this._head=i):(i.previous=o,o.next=i),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){const e=[];return this.forEach((t,i)=>{e.push([i,t])}),e}fromJSON(e){this.clear();for(const[t,i]of e)this.set(t,i)}}oc.LinkedMap=aY;class Fve extends aY{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Ii.AsNew){return super.get(e,t)}peek(e){return super.get(e,Ii.None)}set(e,t){return super.set(e,t,Ii.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}}oc.LRUCache=Fve;var YA={};Object.defineProperty(YA,"__esModule",{value:!0});YA.Disposable=void 0;var Kk;(function(n){function e(t){return{dispose:t}}n.create=e})(Kk||(YA.Disposable=Kk={}));var fa={},Kc={};Object.defineProperty(Kc,"__esModule",{value:!0});let M8;function I8(){if(M8===void 0)throw new Error("No runtime abstraction layer installed");return M8}(function(n){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");M8=t}n.install=e})(I8||(I8={}));Kc.default=I8;Object.defineProperty(fa,"__esModule",{value:!0});fa.Emitter=fa.Event=void 0;const xve=Kc;var Vk;(function(n){const e={dispose(){}};n.None=function(){return e}})(Vk||(fa.Event=Vk={}));class Hve{add(e,t=null,i){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(i)&&i.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let i=!1;for(let o=0,r=this._callbacks.length;o<r;o++)if(this._callbacks[o]===e)if(this._contexts[o]===t){this._callbacks.splice(o,1),this._contexts.splice(o,1);return}else i=!0;if(i)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];const t=[],i=this._callbacks.slice(0),o=this._contexts.slice(0);for(let r=0,s=i.length;r<s;r++)try{t.push(i[r].apply(o[r],e))}catch(a){(0,xve.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}}let cY=class dY{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,i)=>{this._callbacks||(this._callbacks=new Hve),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);const o={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),o.dispose=dY._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(i)&&i.push(o),o}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};fa.Emitter=cY;cY._noop=function(){};var su={};Object.defineProperty(su,"__esModule",{value:!0});su.CancellationTokenSource=su.CancellationToken=void 0;const Kve=Kc,Vve=jn,T8=fa;var zC;(function(n){n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:T8.Event.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:T8.Event.None});function e(t){const i=t;return i&&(i===n.None||i===n.Cancelled||Vve.boolean(i.isCancellationRequested)&&!!i.onCancellationRequested)}n.is=e})(zC||(su.CancellationToken=zC={}));const zve=Object.freeze(function(n,e){const t=(0,Kve.default)().timer.setTimeout(n.bind(e),0);return{dispose(){t.dispose()}}});class zk{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?zve:(this._emitter||(this._emitter=new T8.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}}class Gve{get token(){return this._token||(this._token=new zk),this._token}cancel(){this._token?this._token.cancel():this._token=zC.Cancelled}dispose(){this._token?this._token instanceof zk&&this._token.dispose():this._token=zC.None}}su.CancellationTokenSource=Gve;var Wp={};Object.defineProperty(Wp,"__esModule",{value:!0});Wp.SharedArrayReceiverStrategy=Wp.SharedArraySenderStrategy=void 0;const Uve=su;var iy;(function(n){n.Continue=0,n.Cancelled=1})(iy||(iy={}));class Yve{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;const t=new SharedArrayBuffer(4),i=new Int32Array(t,0,1);i[0]=iy.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){const i=this.buffers.get(t);if(i===void 0)return;const o=new Int32Array(i,0,1);Atomics.store(o,0,iy.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}}Wp.SharedArraySenderStrategy=Yve;class qve{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===iy.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}}class Wve{constructor(e){this.token=new qve(e)}cancel(){}dispose(){}}class Zve{constructor(){this.kind="request"}createCancellationTokenSource(e){const t=e.$cancellationData;return t===void 0?new Uve.CancellationTokenSource:new Wve(t)}}Wp.SharedArrayReceiverStrategy=Zve;var xd={},Q0={};Object.defineProperty(Q0,"__esModule",{value:!0});Q0.Semaphore=void 0;const Qve=Kc;class Xve{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,i)=>{this._waiting.push({thunk:e,resolve:t,reject:i}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Qve.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;const e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{const t=e.thunk();t instanceof Promise?t.then(i=>{this._active--,e.resolve(i),this.runNext()},i=>{this._active--,e.reject(i),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}}Q0.Semaphore=Xve;Object.defineProperty(xd,"__esModule",{value:!0});xd.ReadableStreamMessageReader=xd.AbstractMessageReader=xd.MessageReader=void 0;const D8=Kc,sp=jn,ET=fa,Jve=Q0;var Gk;(function(n){function e(t){let i=t;return i&&sp.func(i.listen)&&sp.func(i.dispose)&&sp.func(i.onError)&&sp.func(i.onClose)&&sp.func(i.onPartialMessage)}n.is=e})(Gk||(xd.MessageReader=Gk={}));class uY{constructor(){this.errorEmitter=new ET.Emitter,this.closeEmitter=new ET.Emitter,this.partialMessageEmitter=new ET.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${sp.string(e.message)?e.message:"unknown"}`)}}xd.AbstractMessageReader=uY;var O8;(function(n){function e(t){let i,o;const r=new Map;let s;const a=new Map;if(t===void 0||typeof t=="string")i=t??"utf-8";else{if(i=t.charset??"utf-8",t.contentDecoder!==void 0&&(o=t.contentDecoder,r.set(o.name,o)),t.contentDecoders!==void 0)for(const u of t.contentDecoders)r.set(u.name,u);if(t.contentTypeDecoder!==void 0&&(s=t.contentTypeDecoder,a.set(s.name,s)),t.contentTypeDecoders!==void 0)for(const u of t.contentTypeDecoders)a.set(u.name,u)}return s===void 0&&(s=(0,D8.default)().applicationJson.decoder,a.set(s.name,s)),{charset:i,contentDecoder:o,contentDecoders:r,contentTypeDecoder:s,contentTypeDecoders:a}}n.fromOptions=e})(O8||(O8={}));class e_e extends uY{constructor(e,t){super(),this.readable=e,this.options=O8.fromOptions(t),this.buffer=(0,D8.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new Jve.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;const t=this.readable.onData(i=>{this.onData(i)});return this.readable.onError(i=>this.fireError(i)),this.readable.onClose(()=>this.fireClose()),t}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){const i=this.buffer.tryReadHeaders(!0);if(!i)return;const o=i.get("content-length");if(!o){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(i))}`));return}const r=parseInt(o);if(isNaN(r)){this.fireError(new Error(`Content-Length value must be a number. Got ${o}`));return}this.nextMessageLength=r}const t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{const i=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,o=await this.options.contentTypeDecoder.decode(i,this.options);this.callback(o)}).catch(i=>{this.fireError(i)})}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,D8.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}}xd.ReadableStreamMessageReader=e_e;var Hd={};Object.defineProperty(Hd,"__esModule",{value:!0});Hd.WriteableStreamMessageWriter=Hd.AbstractMessageWriter=Hd.MessageWriter=void 0;const Uk=Kc,Fv=jn,t_e=Q0,Yk=fa,n_e="Content-Length: ",qk=`\r
`;var Wk;(function(n){function e(t){let i=t;return i&&Fv.func(i.dispose)&&Fv.func(i.onClose)&&Fv.func(i.onError)&&Fv.func(i.write)}n.is=e})(Wk||(Hd.MessageWriter=Wk={}));class lY{constructor(){this.errorEmitter=new Yk.Emitter,this.closeEmitter=new Yk.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,i){this.errorEmitter.fire([this.asError(e),t,i])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${Fv.string(e.message)?e.message:"unknown"}`)}}Hd.AbstractMessageWriter=lY;var L8;(function(n){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,Uk.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,Uk.default)().applicationJson.encoder}}n.fromOptions=e})(L8||(L8={}));class i_e extends lY{constructor(e,t){super(),this.writable=e,this.options=L8.fromOptions(t),this.errorCount=0,this.writeSemaphore=new t_e.Semaphore(1),this.writable.onError(i=>this.fireError(i)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(i=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(i):i).then(i=>{const o=[];return o.push(n_e,i.byteLength.toString(),qk),o.push(qk),this.doWrite(e,o,i)},i=>{throw this.fireError(i),i}))}async doWrite(e,t,i){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(i)}catch(o){return this.handleError(o,e),Promise.reject(o)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}}Hd.WriteableStreamMessageWriter=i_e;var qA={};Object.defineProperty(qA,"__esModule",{value:!0});qA.AbstractMessageBuffer=void 0;const o_e=13,r_e=10,s_e=`\r
`;class a_e{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){const t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,i=0,o=0,r=0;e:for(;i<this._chunks.length;){const h=this._chunks[i];for(o=0;o<h.length;){switch(h[o]){case o_e:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case r_e:switch(t){case 1:t=2;break;case 3:t=4,o++;break e;default:t=0}break;default:t=0}o++}r+=h.byteLength,i++}if(t!==4)return;const s=this._read(r+o),a=new Map,u=this.toString(s,"ascii").split(s_e);if(u.length<2)return a;for(let h=0;h<u.length-2;h++){const g=u[h],y=g.indexOf(":");if(y===-1)throw new Error(`Message header must separate key and value using ':'
${g}`);const S=g.substr(0,y),w=g.substr(y+1).trim();a.set(e?S.toLowerCase():S,w)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){const r=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(r)}if(this._chunks[0].byteLength>e){const r=this._chunks[0],s=this.asNative(r,e);return this._chunks[0]=r.slice(e),this._totalLength-=e,s}const t=this.allocNative(e);let i=0,o=0;for(;e>0;){const r=this._chunks[o];if(r.byteLength>e){const s=r.slice(0,e);t.set(s,i),i+=e,this._chunks[o]=r.slice(e),this._totalLength-=e,e-=e}else t.set(r,i),i+=r.byteLength,this._chunks.shift(),this._totalLength-=r.byteLength,e-=r.byteLength}return t}}qA.AbstractMessageBuffer=a_e;var fY={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.createMessageConnection=n.ConnectionOptions=n.MessageStrategy=n.CancellationStrategy=n.CancellationSenderStrategy=n.CancellationReceiverStrategy=n.RequestCancellationReceiverStrategy=n.IdCancellationReceiverStrategy=n.ConnectionStrategy=n.ConnectionError=n.ConnectionErrors=n.LogTraceNotification=n.SetTraceNotification=n.TraceFormat=n.TraceValues=n.Trace=n.NullLogger=n.ProgressType=n.ProgressToken=void 0;const e=Kc,t=jn,i=Ie,o=oc,r=fa,s=su;var a;(function(K){K.type=new i.NotificationType("$/cancelRequest")})(a||(a={}));var u;(function(K){function Z(H){return typeof H=="string"||typeof H=="number"}K.is=Z})(u||(n.ProgressToken=u={}));var h;(function(K){K.type=new i.NotificationType("$/progress")})(h||(h={}));class g{constructor(){}}n.ProgressType=g;var y;(function(K){function Z(H){return t.func(H)}K.is=Z})(y||(y={})),n.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var S;(function(K){K[K.Off=0]="Off",K[K.Messages=1]="Messages",K[K.Compact=2]="Compact",K[K.Verbose=3]="Verbose"})(S||(n.Trace=S={}));var w;(function(K){K.Off="off",K.Messages="messages",K.Compact="compact",K.Verbose="verbose"})(w||(n.TraceValues=w={})),function(K){function Z(M){if(!t.string(M))return K.Off;switch(M=M.toLowerCase(),M){case"off":return K.Off;case"messages":return K.Messages;case"compact":return K.Compact;case"verbose":return K.Verbose;default:return K.Off}}K.fromString=Z;function H(M){switch(M){case K.Off:return"off";case K.Messages:return"messages";case K.Compact:return"compact";case K.Verbose:return"verbose";default:return"off"}}K.toString=H}(S||(n.Trace=S={}));var P;(function(K){K.Text="text",K.JSON="json"})(P||(n.TraceFormat=P={})),function(K){function Z(H){return t.string(H)?(H=H.toLowerCase(),H==="json"?K.JSON:K.Text):K.Text}K.fromString=Z}(P||(n.TraceFormat=P={}));var E;(function(K){K.type=new i.NotificationType("$/setTrace")})(E||(n.SetTraceNotification=E={}));var A;(function(K){K.type=new i.NotificationType("$/logTrace")})(A||(n.LogTraceNotification=A={}));var L;(function(K){K[K.Closed=1]="Closed",K[K.Disposed=2]="Disposed",K[K.AlreadyListening=3]="AlreadyListening"})(L||(n.ConnectionErrors=L={}));class B extends Error{constructor(Z,H){super(H),this.code=Z,Object.setPrototypeOf(this,B.prototype)}}n.ConnectionError=B;var U;(function(K){function Z(H){const M=H;return M&&t.func(M.cancelUndispatched)}K.is=Z})(U||(n.ConnectionStrategy=U={}));var p;(function(K){function Z(H){const M=H;return M&&(M.kind===void 0||M.kind==="id")&&t.func(M.createCancellationTokenSource)&&(M.dispose===void 0||t.func(M.dispose))}K.is=Z})(p||(n.IdCancellationReceiverStrategy=p={}));var b;(function(K){function Z(H){const M=H;return M&&M.kind==="request"&&t.func(M.createCancellationTokenSource)&&(M.dispose===void 0||t.func(M.dispose))}K.is=Z})(b||(n.RequestCancellationReceiverStrategy=b={}));var v;(function(K){K.Message=Object.freeze({createCancellationTokenSource(H){return new s.CancellationTokenSource}});function Z(H){return p.is(H)||b.is(H)}K.is=Z})(v||(n.CancellationReceiverStrategy=v={}));var R;(function(K){K.Message=Object.freeze({sendCancellation(H,M){return H.sendNotification(a.type,{id:M})},cleanup(H){}});function Z(H){const M=H;return M&&t.func(M.sendCancellation)&&t.func(M.cleanup)}K.is=Z})(R||(n.CancellationSenderStrategy=R={}));var D;(function(K){K.Message=Object.freeze({receiver:v.Message,sender:R.Message});function Z(H){const M=H;return M&&v.is(M.receiver)&&R.is(M.sender)}K.is=Z})(D||(n.CancellationStrategy=D={}));var j;(function(K){function Z(H){const M=H;return M&&t.func(M.handleMessage)}K.is=Z})(j||(n.MessageStrategy=j={}));var T;(function(K){function Z(H){const M=H;return M&&(D.is(M.cancellationStrategy)||U.is(M.connectionStrategy)||j.is(M.messageStrategy))}K.is=Z})(T||(n.ConnectionOptions=T={}));var $;(function(K){K[K.New=1]="New",K[K.Listening=2]="Listening",K[K.Closed=3]="Closed",K[K.Disposed=4]="Disposed"})($||($={}));function Q(K,Z,H,M){const Y=H!==void 0?H:n.NullLogger;let te=0,ue=0,Re=0;const ae="2.0";let ot;const Ft=new Map;let et;const ht=new Map,wt=new Map;let Ot,vt=new o.LinkedMap,At=new Map,bi=new Set,Wt=new Map,Ze=S.Off,ii=P.Text,he,je=$.New;const en=new r.Emitter,xt=new r.Emitter,Rn=new r.Emitter,gn=new r.Emitter,oi=new r.Emitter,_t=M&&M.cancellationStrategy?M.cancellationStrategy:D.Message;function Zt(V){if(V===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+V.toString()}function Si(V){return V===null?"res-unknown-"+(++Re).toString():"res-"+V.toString()}function X(){return"not-"+(++ue).toString()}function ne(V,oe){i.Message.isRequest(oe)?V.set(Zt(oe.id),oe):i.Message.isResponse(oe)?V.set(Si(oe.id),oe):V.set(X(),oe)}function fe(V){}function ve(){return je===$.Listening}function we(){return je===$.Closed}function Qt(){return je===$.Disposed}function Fe(){(je===$.New||je===$.Listening)&&(je=$.Closed,xt.fire(void 0))}function xe(V){en.fire([V,void 0,void 0])}function De(V){en.fire(V)}K.onClose(Fe),K.onError(xe),Z.onClose(Fe),Z.onError(De);function Qe(){Ot||vt.size===0||(Ot=(0,e.default)().timer.setImmediate(()=>{Ot=void 0,oo()}))}function Xe(V){i.Message.isRequest(V)?k1(V):i.Message.isNotification(V)?wM(V):i.Message.isResponse(V)?PM(V):AM(V)}function oo(){if(vt.size===0)return;const V=vt.shift();try{const oe=M==null?void 0:M.messageStrategy;j.is(oe)?oe.handleMessage(V,Xe):Xe(V)}finally{Qe()}}const Zc=V=>{try{if(i.Message.isNotification(V)&&V.method===a.type.method){const oe=V.params.id,pe=Zt(oe),Pe=vt.get(pe);if(i.Message.isRequest(Pe)){const Tt=M==null?void 0:M.connectionStrategy,jt=Tt&&Tt.cancelUndispatched?Tt.cancelUndispatched(Pe,fe):void 0;if(jt&&(jt.error!==void 0||jt.result!==void 0)){vt.delete(pe),Wt.delete(oe),jt.id=Pe.id,gh(jt,V.method,Date.now()),Z.write(jt).catch(()=>Y.error("Sending response for canceled message failed."));return}}const Lt=Wt.get(oe);if(Lt!==void 0){Lt.cancel(),F1(V);return}else bi.add(oe)}ne(vt,V)}finally{Qe()}};function k1(V){if(Qt())return;function oe(dt,Xt,bt){const tn={jsonrpc:ae,id:V.id};dt instanceof i.ResponseError?tn.error=dt.toJson():tn.result=dt===void 0?null:dt,gh(tn,Xt,bt),Z.write(tn).catch(()=>Y.error("Sending response failed."))}function pe(dt,Xt,bt){const tn={jsonrpc:ae,id:V.id,error:dt.toJson()};gh(tn,Xt,bt),Z.write(tn).catch(()=>Y.error("Sending response failed."))}function Pe(dt,Xt,bt){dt===void 0&&(dt=null);const tn={jsonrpc:ae,id:V.id,result:dt};gh(tn,Xt,bt),Z.write(tn).catch(()=>Y.error("Sending response failed."))}MM(V);const Lt=Ft.get(V.method);let Tt,jt;Lt&&(Tt=Lt.type,jt=Lt.handler);const cn=Date.now();if(jt||ot){const dt=V.id??String(Date.now()),Xt=p.is(_t.receiver)?_t.receiver.createCancellationTokenSource(dt):_t.receiver.createCancellationTokenSource(V);V.id!==null&&bi.has(V.id)&&Xt.cancel(),V.id!==null&&Wt.set(dt,Xt);try{let bt;if(jt)if(V.params===void 0){if(Tt!==void 0&&Tt.numberOfParams!==0){pe(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${V.method} defines ${Tt.numberOfParams} params but received none.`),V.method,cn);return}bt=jt(Xt.token)}else if(Array.isArray(V.params)){if(Tt!==void 0&&Tt.parameterStructures===i.ParameterStructures.byName){pe(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${V.method} defines parameters by name but received parameters by position`),V.method,cn);return}bt=jt(...V.params,Xt.token)}else{if(Tt!==void 0&&Tt.parameterStructures===i.ParameterStructures.byPosition){pe(new i.ResponseError(i.ErrorCodes.InvalidParams,`Request ${V.method} defines parameters by position but received parameters by name`),V.method,cn);return}bt=jt(V.params,Xt.token)}else ot&&(bt=ot(V.method,V.params,Xt.token));const tn=bt;bt?tn.then?tn.then(ri=>{Wt.delete(dt),oe(ri,V.method,cn)},ri=>{Wt.delete(dt),ri instanceof i.ResponseError?pe(ri,V.method,cn):ri&&t.string(ri.message)?pe(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${V.method} failed with message: ${ri.message}`),V.method,cn):pe(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${V.method} failed unexpectedly without providing any details.`),V.method,cn)}):(Wt.delete(dt),oe(bt,V.method,cn)):(Wt.delete(dt),Pe(bt,V.method,cn))}catch(bt){Wt.delete(dt),bt instanceof i.ResponseError?oe(bt,V.method,cn):bt&&t.string(bt.message)?pe(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${V.method} failed with message: ${bt.message}`),V.method,cn):pe(new i.ResponseError(i.ErrorCodes.InternalError,`Request ${V.method} failed unexpectedly without providing any details.`),V.method,cn)}}else pe(new i.ResponseError(i.ErrorCodes.MethodNotFound,`Unhandled method ${V.method}`),V.method,cn)}function PM(V){if(!Qt())if(V.id===null)V.error?Y.error(`Received response message without id: Error is: 
${JSON.stringify(V.error,void 0,4)}`):Y.error("Received response message without id. No further error information provided.");else{const oe=V.id,pe=At.get(oe);if(hS(V,pe),pe!==void 0){At.delete(oe);try{if(V.error){const Pe=V.error;pe.reject(new i.ResponseError(Pe.code,Pe.message,Pe.data))}else if(V.result!==void 0)pe.resolve(V.result);else throw new Error("Should never happen.")}catch(Pe){Pe.message?Y.error(`Response handler '${pe.method}' failed with message: ${Pe.message}`):Y.error(`Response handler '${pe.method}' failed unexpectedly.`)}}}}function wM(V){if(Qt())return;let oe,pe;if(V.method===a.type.method){const Pe=V.params.id;bi.delete(Pe),F1(V);return}else{const Pe=ht.get(V.method);Pe&&(pe=Pe.handler,oe=Pe.type)}if(pe||et)try{if(F1(V),pe)if(V.params===void 0)oe!==void 0&&oe.numberOfParams!==0&&oe.parameterStructures!==i.ParameterStructures.byName&&Y.error(`Notification ${V.method} defines ${oe.numberOfParams} params but received none.`),pe();else if(Array.isArray(V.params)){const Pe=V.params;V.method===h.type.method&&Pe.length===2&&u.is(Pe[0])?pe({token:Pe[0],value:Pe[1]}):(oe!==void 0&&(oe.parameterStructures===i.ParameterStructures.byName&&Y.error(`Notification ${V.method} defines parameters by name but received parameters by position`),oe.numberOfParams!==V.params.length&&Y.error(`Notification ${V.method} defines ${oe.numberOfParams} params but received ${Pe.length} arguments`)),pe(...Pe))}else oe!==void 0&&oe.parameterStructures===i.ParameterStructures.byPosition&&Y.error(`Notification ${V.method} defines parameters by position but received parameters by name`),pe(V.params);else et&&et(V.method,V.params)}catch(Pe){Pe.message?Y.error(`Notification handler '${V.method}' failed with message: ${Pe.message}`):Y.error(`Notification handler '${V.method}' failed unexpectedly.`)}else Rn.fire(V)}function AM(V){if(!V){Y.error("Received empty message.");return}Y.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(V,null,4)}`);const oe=V;if(t.string(oe.id)||t.number(oe.id)){const pe=oe.id,Pe=At.get(pe);Pe&&Pe.reject(new Error("The received response has neither a result nor an error property."))}}function Vr(V){if(V!=null)switch(Ze){case S.Verbose:return JSON.stringify(V,null,4);case S.Compact:return JSON.stringify(V);default:return}}function fS(V){if(!(Ze===S.Off||!he))if(ii===P.Text){let oe;(Ze===S.Verbose||Ze===S.Compact)&&V.params&&(oe=`Params: ${Vr(V.params)}

`),he.log(`Sending request '${V.method} - (${V.id})'.`,oe)}else Qc("send-request",V)}function RM(V){if(!(Ze===S.Off||!he))if(ii===P.Text){let oe;(Ze===S.Verbose||Ze===S.Compact)&&(V.params?oe=`Params: ${Vr(V.params)}

`:oe=`No parameters provided.

`),he.log(`Sending notification '${V.method}'.`,oe)}else Qc("send-notification",V)}function gh(V,oe,pe){if(!(Ze===S.Off||!he))if(ii===P.Text){let Pe;(Ze===S.Verbose||Ze===S.Compact)&&(V.error&&V.error.data?Pe=`Error data: ${Vr(V.error.data)}

`:V.result?Pe=`Result: ${Vr(V.result)}

`:V.error===void 0&&(Pe=`No result returned.

`)),he.log(`Sending response '${oe} - (${V.id})'. Processing request took ${Date.now()-pe}ms`,Pe)}else Qc("send-response",V)}function MM(V){if(!(Ze===S.Off||!he))if(ii===P.Text){let oe;(Ze===S.Verbose||Ze===S.Compact)&&V.params&&(oe=`Params: ${Vr(V.params)}

`),he.log(`Received request '${V.method} - (${V.id})'.`,oe)}else Qc("receive-request",V)}function F1(V){if(!(Ze===S.Off||!he||V.method===A.type.method))if(ii===P.Text){let oe;(Ze===S.Verbose||Ze===S.Compact)&&(V.params?oe=`Params: ${Vr(V.params)}

`:oe=`No parameters provided.

`),he.log(`Received notification '${V.method}'.`,oe)}else Qc("receive-notification",V)}function hS(V,oe){if(!(Ze===S.Off||!he))if(ii===P.Text){let pe;if((Ze===S.Verbose||Ze===S.Compact)&&(V.error&&V.error.data?pe=`Error data: ${Vr(V.error.data)}

`:V.result?pe=`Result: ${Vr(V.result)}

`:V.error===void 0&&(pe=`No result returned.

`)),oe){const Pe=V.error?` Request failed: ${V.error.message} (${V.error.code}).`:"";he.log(`Received response '${oe.method} - (${V.id})' in ${Date.now()-oe.timerStart}ms.${Pe}`,pe)}else he.log(`Received response ${V.id} without active response promise.`,pe)}else Qc("receive-response",V)}function Qc(V,oe){if(!he||Ze===S.Off)return;const pe={isLSPMessage:!0,type:V,message:oe,timestamp:Date.now()};he.log(pe)}function Vu(){if(we())throw new B(L.Closed,"Connection is closed.");if(Qt())throw new B(L.Disposed,"Connection is disposed.")}function IM(){if(ve())throw new B(L.AlreadyListening,"Connection is already listening")}function x1(){if(!ve())throw new Error("Call listen() first.")}function zu(V){return V===void 0?null:V}function vh(V){if(V!==null)return V}function pS(V){return V!=null&&!Array.isArray(V)&&typeof V=="object"}function H1(V,oe){switch(V){case i.ParameterStructures.auto:return pS(oe)?vh(oe):[zu(oe)];case i.ParameterStructures.byName:if(!pS(oe))throw new Error("Received parameters by name but param is not an object literal.");return vh(oe);case i.ParameterStructures.byPosition:return[zu(oe)];default:throw new Error(`Unknown parameter structure ${V.toString()}`)}}function mS(V,oe){let pe;const Pe=V.numberOfParams;switch(Pe){case 0:pe=void 0;break;case 1:pe=H1(V.parameterStructures,oe[0]);break;default:pe=[];for(let Lt=0;Lt<oe.length&&Lt<Pe;Lt++)pe.push(zu(oe[Lt]));if(oe.length<Pe)for(let Lt=oe.length;Lt<Pe;Lt++)pe.push(null);break}return pe}const Xc={sendNotification:(V,...oe)=>{Vu();let pe,Pe;if(t.string(V)){pe=V;const Tt=oe[0];let jt=0,cn=i.ParameterStructures.auto;i.ParameterStructures.is(Tt)&&(jt=1,cn=Tt);let dt=oe.length;const Xt=dt-jt;switch(Xt){case 0:Pe=void 0;break;case 1:Pe=H1(cn,oe[jt]);break;default:if(cn===i.ParameterStructures.byName)throw new Error(`Received ${Xt} parameters for 'by Name' notification parameter structure.`);Pe=oe.slice(jt,dt).map(bt=>zu(bt));break}}else{const Tt=oe;pe=V.method,Pe=mS(V,Tt)}const Lt={jsonrpc:ae,method:pe,params:Pe};return RM(Lt),Z.write(Lt).catch(Tt=>{throw Y.error("Sending notification failed."),Tt})},onNotification:(V,oe)=>{Vu();let pe;return t.func(V)?et=V:oe&&(t.string(V)?(pe=V,ht.set(V,{type:void 0,handler:oe})):(pe=V.method,ht.set(V.method,{type:V,handler:oe}))),{dispose:()=>{pe!==void 0?ht.delete(pe):et=void 0}}},onProgress:(V,oe,pe)=>{if(wt.has(oe))throw new Error(`Progress handler for token ${oe} already registered`);return wt.set(oe,pe),{dispose:()=>{wt.delete(oe)}}},sendProgress:(V,oe,pe)=>Xc.sendNotification(h.type,{token:oe,value:pe}),onUnhandledProgress:gn.event,sendRequest:(V,...oe)=>{Vu(),x1();let pe,Pe,Lt;if(t.string(V)){pe=V;const dt=oe[0],Xt=oe[oe.length-1];let bt=0,tn=i.ParameterStructures.auto;i.ParameterStructures.is(dt)&&(bt=1,tn=dt);let ri=oe.length;s.CancellationToken.is(Xt)&&(ri=ri-1,Lt=Xt);const Fi=ri-bt;switch(Fi){case 0:Pe=void 0;break;case 1:Pe=H1(tn,oe[bt]);break;default:if(tn===i.ParameterStructures.byName)throw new Error(`Received ${Fi} parameters for 'by Name' request parameter structure.`);Pe=oe.slice(bt,ri).map(TM=>zu(TM));break}}else{const dt=oe;pe=V.method,Pe=mS(V,dt);const Xt=V.numberOfParams;Lt=s.CancellationToken.is(dt[Xt])?dt[Xt]:void 0}const Tt=te++;let jt;Lt&&(jt=Lt.onCancellationRequested(()=>{const dt=_t.sender.sendCancellation(Xc,Tt);return dt===void 0?(Y.log(`Received no promise from cancellation strategy when cancelling id ${Tt}`),Promise.resolve()):dt.catch(()=>{Y.log(`Sending cancellation messages for id ${Tt} failed`)})}));const cn={jsonrpc:ae,id:Tt,method:pe,params:Pe};return fS(cn),typeof _t.sender.enableCancellation=="function"&&_t.sender.enableCancellation(cn),new Promise(async(dt,Xt)=>{const bt=Fi=>{dt(Fi),_t.sender.cleanup(Tt),jt==null||jt.dispose()},tn=Fi=>{Xt(Fi),_t.sender.cleanup(Tt),jt==null||jt.dispose()},ri={method:pe,timerStart:Date.now(),resolve:bt,reject:tn};try{await Z.write(cn),At.set(Tt,ri)}catch(Fi){throw Y.error("Sending request failed."),ri.reject(new i.ResponseError(i.ErrorCodes.MessageWriteError,Fi.message?Fi.message:"Unknown reason")),Fi}})},onRequest:(V,oe)=>{Vu();let pe=null;return y.is(V)?(pe=void 0,ot=V):t.string(V)?(pe=null,oe!==void 0&&(pe=V,Ft.set(V,{handler:oe,type:void 0}))):oe!==void 0&&(pe=V.method,Ft.set(V.method,{type:V,handler:oe})),{dispose:()=>{pe!==null&&(pe!==void 0?Ft.delete(pe):ot=void 0)}}},hasPendingResponse:()=>At.size>0,trace:async(V,oe,pe)=>{let Pe=!1,Lt=P.Text;pe!==void 0&&(t.boolean(pe)?Pe=pe:(Pe=pe.sendNotification||!1,Lt=pe.traceFormat||P.Text)),Ze=V,ii=Lt,Ze===S.Off?he=void 0:he=oe,Pe&&!we()&&!Qt()&&await Xc.sendNotification(E.type,{value:S.toString(V)})},onError:en.event,onClose:xt.event,onUnhandledNotification:Rn.event,onDispose:oi.event,end:()=>{Z.end()},dispose:()=>{if(Qt())return;je=$.Disposed,oi.fire(void 0);const V=new i.ResponseError(i.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(const oe of At.values())oe.reject(V);At=new Map,Wt=new Map,bi=new Set,vt=new o.LinkedMap,t.func(Z.dispose)&&Z.dispose(),t.func(K.dispose)&&K.dispose()},listen:()=>{Vu(),IM(),je=$.Listening,K.listen(Zc)},inspect:()=>{(0,e.default)().console.log("inspect")}};return Xc.onNotification(A.type,V=>{if(Ze===S.Off||!he)return;const oe=Ze===S.Verbose||Ze===S.Compact;he.log(V.message,oe?V.verbose:void 0)}),Xc.onNotification(h.type,V=>{const oe=wt.get(V.token);oe?oe(V.value):gn.fire(V)}),Xc}n.createMessageConnection=Q})(fY);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ProgressType=n.ProgressToken=n.createMessageConnection=n.NullLogger=n.ConnectionOptions=n.ConnectionStrategy=n.AbstractMessageBuffer=n.WriteableStreamMessageWriter=n.AbstractMessageWriter=n.MessageWriter=n.ReadableStreamMessageReader=n.AbstractMessageReader=n.MessageReader=n.SharedArrayReceiverStrategy=n.SharedArraySenderStrategy=n.CancellationToken=n.CancellationTokenSource=n.Emitter=n.Event=n.Disposable=n.LRUCache=n.Touch=n.LinkedMap=n.ParameterStructures=n.NotificationType9=n.NotificationType8=n.NotificationType7=n.NotificationType6=n.NotificationType5=n.NotificationType4=n.NotificationType3=n.NotificationType2=n.NotificationType1=n.NotificationType0=n.NotificationType=n.ErrorCodes=n.ResponseError=n.RequestType9=n.RequestType8=n.RequestType7=n.RequestType6=n.RequestType5=n.RequestType4=n.RequestType3=n.RequestType2=n.RequestType1=n.RequestType0=n.RequestType=n.Message=n.RAL=void 0,n.MessageStrategy=n.CancellationStrategy=n.CancellationSenderStrategy=n.CancellationReceiverStrategy=n.ConnectionError=n.ConnectionErrors=n.LogTraceNotification=n.SetTraceNotification=n.TraceFormat=n.TraceValues=n.Trace=void 0;const e=Ie;Object.defineProperty(n,"Message",{enumerable:!0,get:function(){return e.Message}}),Object.defineProperty(n,"RequestType",{enumerable:!0,get:function(){return e.RequestType}}),Object.defineProperty(n,"RequestType0",{enumerable:!0,get:function(){return e.RequestType0}}),Object.defineProperty(n,"RequestType1",{enumerable:!0,get:function(){return e.RequestType1}}),Object.defineProperty(n,"RequestType2",{enumerable:!0,get:function(){return e.RequestType2}}),Object.defineProperty(n,"RequestType3",{enumerable:!0,get:function(){return e.RequestType3}}),Object.defineProperty(n,"RequestType4",{enumerable:!0,get:function(){return e.RequestType4}}),Object.defineProperty(n,"RequestType5",{enumerable:!0,get:function(){return e.RequestType5}}),Object.defineProperty(n,"RequestType6",{enumerable:!0,get:function(){return e.RequestType6}}),Object.defineProperty(n,"RequestType7",{enumerable:!0,get:function(){return e.RequestType7}}),Object.defineProperty(n,"RequestType8",{enumerable:!0,get:function(){return e.RequestType8}}),Object.defineProperty(n,"RequestType9",{enumerable:!0,get:function(){return e.RequestType9}}),Object.defineProperty(n,"ResponseError",{enumerable:!0,get:function(){return e.ResponseError}}),Object.defineProperty(n,"ErrorCodes",{enumerable:!0,get:function(){return e.ErrorCodes}}),Object.defineProperty(n,"NotificationType",{enumerable:!0,get:function(){return e.NotificationType}}),Object.defineProperty(n,"NotificationType0",{enumerable:!0,get:function(){return e.NotificationType0}}),Object.defineProperty(n,"NotificationType1",{enumerable:!0,get:function(){return e.NotificationType1}}),Object.defineProperty(n,"NotificationType2",{enumerable:!0,get:function(){return e.NotificationType2}}),Object.defineProperty(n,"NotificationType3",{enumerable:!0,get:function(){return e.NotificationType3}}),Object.defineProperty(n,"NotificationType4",{enumerable:!0,get:function(){return e.NotificationType4}}),Object.defineProperty(n,"NotificationType5",{enumerable:!0,get:function(){return e.NotificationType5}}),Object.defineProperty(n,"NotificationType6",{enumerable:!0,get:function(){return e.NotificationType6}}),Object.defineProperty(n,"NotificationType7",{enumerable:!0,get:function(){return e.NotificationType7}}),Object.defineProperty(n,"NotificationType8",{enumerable:!0,get:function(){return e.NotificationType8}}),Object.defineProperty(n,"NotificationType9",{enumerable:!0,get:function(){return e.NotificationType9}}),Object.defineProperty(n,"ParameterStructures",{enumerable:!0,get:function(){return e.ParameterStructures}});const t=oc;Object.defineProperty(n,"LinkedMap",{enumerable:!0,get:function(){return t.LinkedMap}}),Object.defineProperty(n,"LRUCache",{enumerable:!0,get:function(){return t.LRUCache}}),Object.defineProperty(n,"Touch",{enumerable:!0,get:function(){return t.Touch}});const i=YA;Object.defineProperty(n,"Disposable",{enumerable:!0,get:function(){return i.Disposable}});const o=fa;Object.defineProperty(n,"Event",{enumerable:!0,get:function(){return o.Event}}),Object.defineProperty(n,"Emitter",{enumerable:!0,get:function(){return o.Emitter}});const r=su;Object.defineProperty(n,"CancellationTokenSource",{enumerable:!0,get:function(){return r.CancellationTokenSource}}),Object.defineProperty(n,"CancellationToken",{enumerable:!0,get:function(){return r.CancellationToken}});const s=Wp;Object.defineProperty(n,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return s.SharedArraySenderStrategy}}),Object.defineProperty(n,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return s.SharedArrayReceiverStrategy}});const a=xd;Object.defineProperty(n,"MessageReader",{enumerable:!0,get:function(){return a.MessageReader}}),Object.defineProperty(n,"AbstractMessageReader",{enumerable:!0,get:function(){return a.AbstractMessageReader}}),Object.defineProperty(n,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return a.ReadableStreamMessageReader}});const u=Hd;Object.defineProperty(n,"MessageWriter",{enumerable:!0,get:function(){return u.MessageWriter}}),Object.defineProperty(n,"AbstractMessageWriter",{enumerable:!0,get:function(){return u.AbstractMessageWriter}}),Object.defineProperty(n,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return u.WriteableStreamMessageWriter}});const h=qA;Object.defineProperty(n,"AbstractMessageBuffer",{enumerable:!0,get:function(){return h.AbstractMessageBuffer}});const g=fY;Object.defineProperty(n,"ConnectionStrategy",{enumerable:!0,get:function(){return g.ConnectionStrategy}}),Object.defineProperty(n,"ConnectionOptions",{enumerable:!0,get:function(){return g.ConnectionOptions}}),Object.defineProperty(n,"NullLogger",{enumerable:!0,get:function(){return g.NullLogger}}),Object.defineProperty(n,"createMessageConnection",{enumerable:!0,get:function(){return g.createMessageConnection}}),Object.defineProperty(n,"ProgressToken",{enumerable:!0,get:function(){return g.ProgressToken}}),Object.defineProperty(n,"ProgressType",{enumerable:!0,get:function(){return g.ProgressType}}),Object.defineProperty(n,"Trace",{enumerable:!0,get:function(){return g.Trace}}),Object.defineProperty(n,"TraceValues",{enumerable:!0,get:function(){return g.TraceValues}}),Object.defineProperty(n,"TraceFormat",{enumerable:!0,get:function(){return g.TraceFormat}}),Object.defineProperty(n,"SetTraceNotification",{enumerable:!0,get:function(){return g.SetTraceNotification}}),Object.defineProperty(n,"LogTraceNotification",{enumerable:!0,get:function(){return g.LogTraceNotification}}),Object.defineProperty(n,"ConnectionErrors",{enumerable:!0,get:function(){return g.ConnectionErrors}}),Object.defineProperty(n,"ConnectionError",{enumerable:!0,get:function(){return g.ConnectionError}}),Object.defineProperty(n,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return g.CancellationReceiverStrategy}}),Object.defineProperty(n,"CancellationSenderStrategy",{enumerable:!0,get:function(){return g.CancellationSenderStrategy}}),Object.defineProperty(n,"CancellationStrategy",{enumerable:!0,get:function(){return g.CancellationStrategy}}),Object.defineProperty(n,"MessageStrategy",{enumerable:!0,get:function(){return g.MessageStrategy}});const y=Kc;n.RAL=y.default})(VC);Object.defineProperty(j7,"__esModule",{value:!0});const zs=VC;class WA extends zs.AbstractMessageBuffer{constructor(e="utf-8"){super(e),this.asciiDecoder=new TextDecoder("ascii")}emptyBuffer(){return WA.emptyBuffer}fromString(e,t){return new TextEncoder().encode(e)}toString(e,t){return t==="ascii"?this.asciiDecoder.decode(e):new TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e:e.slice(0,t)}allocNative(e){return new Uint8Array(e)}}WA.emptyBuffer=new Uint8Array(0);class c_e{constructor(e){this.socket=e,this._onData=new zs.Emitter,this._messageListener=t=>{t.data.arrayBuffer().then(o=>{this._onData.fire(new Uint8Array(o))},()=>{(0,zs.RAL)().console.error("Converting blob to array buffer failed.")})},this.socket.addEventListener("message",this._messageListener)}onClose(e){return this.socket.addEventListener("close",e),zs.Disposable.create(()=>this.socket.removeEventListener("close",e))}onError(e){return this.socket.addEventListener("error",e),zs.Disposable.create(()=>this.socket.removeEventListener("error",e))}onEnd(e){return this.socket.addEventListener("end",e),zs.Disposable.create(()=>this.socket.removeEventListener("end",e))}onData(e){return this._onData.event(e)}}class d_e{constructor(e){this.socket=e}onClose(e){return this.socket.addEventListener("close",e),zs.Disposable.create(()=>this.socket.removeEventListener("close",e))}onError(e){return this.socket.addEventListener("error",e),zs.Disposable.create(()=>this.socket.removeEventListener("error",e))}onEnd(e){return this.socket.addEventListener("end",e),zs.Disposable.create(()=>this.socket.removeEventListener("end",e))}write(e,t){if(typeof e=="string"){if(t!==void 0&&t!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${t}`);this.socket.send(e)}else this.socket.send(e);return Promise.resolve()}end(){this.socket.close()}}const u_e=new TextEncoder,hY=Object.freeze({messageBuffer:Object.freeze({create:n=>new WA(n)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(n,e)=>{if(e.charset!=="utf-8")throw new Error(`In a Browser environments only utf-8 text encoding is supported. But got encoding: ${e.charset}`);return Promise.resolve(u_e.encode(JSON.stringify(n,void 0,0)))}}),decoder:Object.freeze({name:"application/json",decode:(n,e)=>{if(!(n instanceof Uint8Array))throw new Error("In a Browser environments only Uint8Arrays are supported.");return Promise.resolve(JSON.parse(new TextDecoder(e.charset).decode(n)))}})}),stream:Object.freeze({asReadableStream:n=>new c_e(n),asWritableStream:n=>new d_e(n)}),console,timer:Object.freeze({setTimeout(n,e,...t){const i=setTimeout(n,e,...t);return{dispose:()=>clearTimeout(i)}},setImmediate(n,...e){const t=setTimeout(n,0,...e);return{dispose:()=>clearTimeout(t)}},setInterval(n,e,...t){const i=setInterval(n,e,...t);return{dispose:()=>clearInterval(i)}}})});function j8(){return hY}(function(n){function e(){zs.RAL.install(hY)}n.install=e})(j8||(j8={}));j7.default=j8;(function(n){var e=f&&f.__createBinding||(Object.create?function(u,h,g,y){y===void 0&&(y=g);var S=Object.getOwnPropertyDescriptor(h,g);(!S||("get"in S?!h.__esModule:S.writable||S.configurable))&&(S={enumerable:!0,get:function(){return h[g]}}),Object.defineProperty(u,y,S)}:function(u,h,g,y){y===void 0&&(y=g),u[y]=h[g]}),t=f&&f.__exportStar||function(u,h){for(var g in u)g!=="default"&&!Object.prototype.hasOwnProperty.call(h,g)&&e(h,u,g)};Object.defineProperty(n,"__esModule",{value:!0}),n.createMessageConnection=n.BrowserMessageWriter=n.BrowserMessageReader=void 0,j7.default.install();const o=VC;t(VC,n);class r extends o.AbstractMessageReader{constructor(h){super(),this._onData=new o.Emitter,this._messageListener=g=>{this._onData.fire(g.data)},h.addEventListener("error",g=>this.fireError(g)),h.onmessage=this._messageListener}listen(h){return this._onData.event(h)}}n.BrowserMessageReader=r;class s extends o.AbstractMessageWriter{constructor(h){super(),this.port=h,this.errorCount=0,h.addEventListener("error",g=>this.fireError(g))}write(h){try{return this.port.postMessage(h),Promise.resolve()}catch(g){return this.handleError(g,h),Promise.reject(g)}}handleError(h,g){this.errorCount++,this.fireError(h,g,this.errorCount)}end(){}}n.BrowserMessageWriter=s;function a(u,h,g,y){return g===void 0&&(g=o.NullLogger),o.ConnectionStrategy.is(y)&&(y={connectionStrategy:y}),(0,o.createMessageConnection)(u,h,g,y)}n.createMessageConnection=a})(vg);Object.defineProperty(gg,"__esModule",{value:!0});gg.Emitter=void 0;const l_e=vg;class f_e extends l_e.Emitter{constructor(e={}){super(e)}get event(){return super.event}fire(e){super.fire(e)}}gg.Emitter=f_e;var as={},_g={},ZA={};Object.defineProperty(ZA,"__esModule",{value:!0});ZA.default=void 0;ZA.default="ffffffff-ffff-ffff-ffff-ffffffffffff";var QA={};Object.defineProperty(QA,"__esModule",{value:!0});QA.default=void 0;QA.default="00000000-0000-0000-0000-000000000000";var Wf={},Zf={},XA={};Object.defineProperty(XA,"__esModule",{value:!0});XA.default=void 0;XA.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;Object.defineProperty(Zf,"__esModule",{value:!0});Zf.default=void 0;var h_e=p_e(XA);function p_e(n){return n&&n.__esModule?n:{default:n}}function m_e(n){return typeof n=="string"&&h_e.default.test(n)}Zf.default=m_e;Object.defineProperty(Wf,"__esModule",{value:!0});Wf.default=void 0;var g_e=v_e(Zf);function v_e(n){return n&&n.__esModule?n:{default:n}}function __e(n){if(!(0,g_e.default)(n))throw TypeError("Invalid UUID");var e,t=new Uint8Array(16);return t[0]=(e=parseInt(n.slice(0,8),16))>>>24,t[1]=e>>>16&255,t[2]=e>>>8&255,t[3]=e&255,t[4]=(e=parseInt(n.slice(9,13),16))>>>8,t[5]=e&255,t[6]=(e=parseInt(n.slice(14,18),16))>>>8,t[7]=e&255,t[8]=(e=parseInt(n.slice(19,23),16))>>>8,t[9]=e&255,t[10]=(e=parseInt(n.slice(24,36),16))/1099511627776&255,t[11]=e/4294967296&255,t[12]=e>>>24&255,t[13]=e>>>16&255,t[14]=e>>>8&255,t[15]=e&255,t}Wf.default=__e;var xr={};Object.defineProperty(xr,"__esModule",{value:!0});xr.default=void 0;xr.unsafeStringify=pY;var y_e=b_e(Zf);function b_e(n){return n&&n.__esModule?n:{default:n}}var ui=[];for(var CT=0;CT<256;++CT)ui.push((CT+256).toString(16).slice(1));function pY(n,e=0){return(ui[n[e+0]]+ui[n[e+1]]+ui[n[e+2]]+ui[n[e+3]]+"-"+ui[n[e+4]]+ui[n[e+5]]+"-"+ui[n[e+6]]+ui[n[e+7]]+"-"+ui[n[e+8]]+ui[n[e+9]]+"-"+ui[n[e+10]]+ui[n[e+11]]+ui[n[e+12]]+ui[n[e+13]]+ui[n[e+14]]+ui[n[e+15]]).toLowerCase()}function S_e(n,e=0){var t=pY(n,e);if(!(0,y_e.default)(t))throw TypeError("Stringified UUID is invalid");return t}xr.default=S_e;var X0={},J0={};Object.defineProperty(J0,"__esModule",{value:!0});J0.default=C_e;var yE,E_e=new Uint8Array(16);function C_e(){if(!yE&&(yE=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!yE))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return yE(E_e)}Object.defineProperty(X0,"__esModule",{value:!0});X0.default=void 0;var P_e=A_e(J0),w_e=xr;function A_e(n){return n&&n.__esModule?n:{default:n}}var PT,bE,wT=0,AT=0;function R_e(n,e,t){var i=e&&t||0,o=e||new Array(16);n=n||{};var r=n.node,s=n.clockseq;if(n._v6||(r||(r=PT),s==null&&(s=bE)),r==null||s==null){var a=n.random||(n.rng||P_e.default)();r==null&&(r=[a[0],a[1],a[2],a[3],a[4],a[5]],!PT&&!n._v6&&(r[0]|=1,PT=r)),s==null&&(s=(a[6]<<8|a[7])&16383,bE===void 0&&!n._v6&&(bE=s))}var u=n.msecs!==void 0?n.msecs:Date.now(),h=n.nsecs!==void 0?n.nsecs:AT+1,g=u-wT+(h-AT)/1e4;if(g<0&&n.clockseq===void 0&&(s=s+1&16383),(g<0||u>wT)&&n.nsecs===void 0&&(h=0),h>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");wT=u,AT=h,bE=s,u+=122192928e5;var y=((u&268435455)*1e4+h)%4294967296;o[i++]=y>>>24&255,o[i++]=y>>>16&255,o[i++]=y>>>8&255,o[i++]=y&255;var S=u/4294967296*1e4&268435455;o[i++]=S>>>8&255,o[i++]=S&255,o[i++]=S>>>24&15|16,o[i++]=S>>>16&255,o[i++]=s>>>8|128,o[i++]=s&255;for(var w=0;w<6;++w)o[i+w]=r[w];return e||(0,w_e.unsafeStringify)(o)}X0.default=R_e;var JA={};Object.defineProperty(JA,"__esModule",{value:!0});JA.default=D_e;var M_e=T_e(Wf),I_e=xr;function T_e(n){return n&&n.__esModule?n:{default:n}}function D_e(n){var e=typeof n=="string"?(0,M_e.default)(n):n,t=O_e(e);return typeof n=="string"?(0,I_e.unsafeStringify)(t):t}function O_e(n,e=!1){return Uint8Array.of((n[6]&15)<<4|n[7]>>4&15,(n[7]&15)<<4|(n[4]&240)>>4,(n[4]&15)<<4|(n[5]&240)>>4,(n[5]&15)<<4|(n[0]&240)>>4,(n[0]&15)<<4|(n[1]&240)>>4,(n[1]&15)<<4|(n[2]&240)>>4,96|n[2]&15,n[3],n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}var eR={},au={};Object.defineProperty(au,"__esModule",{value:!0});au.URL=au.DNS=void 0;au.default=F_e;var L_e=xr,j_e=N_e(Wf);function N_e(n){return n&&n.__esModule?n:{default:n}}function B_e(n){n=unescape(encodeURIComponent(n));for(var e=[],t=0;t<n.length;++t)e.push(n.charCodeAt(t));return e}var $_e=au.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",k_e=au.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function F_e(n,e,t){function i(o,r,s,a){var u;if(typeof o=="string"&&(o=B_e(o)),typeof r=="string"&&(r=(0,j_e.default)(r)),((u=r)===null||u===void 0?void 0:u.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var h=new Uint8Array(16+o.length);if(h.set(r),h.set(o,r.length),h=t(h),h[6]=h[6]&15|e,h[8]=h[8]&63|128,s){a=a||0;for(var g=0;g<16;++g)s[a+g]=h[g];return s}return(0,L_e.unsafeStringify)(h)}try{i.name=n}catch{}return i.DNS=$_e,i.URL=k_e,i}var tR={};Object.defineProperty(tR,"__esModule",{value:!0});tR.default=void 0;function x_e(n){if(typeof n=="string"){var e=unescape(encodeURIComponent(n));n=new Uint8Array(e.length);for(var t=0;t<e.length;++t)n[t]=e.charCodeAt(t)}return H_e(K_e(V_e(n),n.length*8))}function H_e(n){for(var e=[],t=n.length*32,i="0123456789abcdef",o=0;o<t;o+=8){var r=n[o>>5]>>>o%32&255,s=parseInt(i.charAt(r>>>4&15)+i.charAt(r&15),16);e.push(s)}return e}function mY(n){return(n+64>>>9<<4)+14+1}function K_e(n,e){n[e>>5]|=128<<e%32,n[mY(e)-1]=e;for(var t=1732584193,i=-271733879,o=-1732584194,r=271733878,s=0;s<n.length;s+=16){var a=t,u=i,h=o,g=r;t=Pi(t,i,o,r,n[s],7,-680876936),r=Pi(r,t,i,o,n[s+1],12,-389564586),o=Pi(o,r,t,i,n[s+2],17,606105819),i=Pi(i,o,r,t,n[s+3],22,-1044525330),t=Pi(t,i,o,r,n[s+4],7,-176418897),r=Pi(r,t,i,o,n[s+5],12,1200080426),o=Pi(o,r,t,i,n[s+6],17,-1473231341),i=Pi(i,o,r,t,n[s+7],22,-45705983),t=Pi(t,i,o,r,n[s+8],7,1770035416),r=Pi(r,t,i,o,n[s+9],12,-1958414417),o=Pi(o,r,t,i,n[s+10],17,-42063),i=Pi(i,o,r,t,n[s+11],22,-1990404162),t=Pi(t,i,o,r,n[s+12],7,1804603682),r=Pi(r,t,i,o,n[s+13],12,-40341101),o=Pi(o,r,t,i,n[s+14],17,-1502002290),i=Pi(i,o,r,t,n[s+15],22,1236535329),t=wi(t,i,o,r,n[s+1],5,-165796510),r=wi(r,t,i,o,n[s+6],9,-1069501632),o=wi(o,r,t,i,n[s+11],14,643717713),i=wi(i,o,r,t,n[s],20,-373897302),t=wi(t,i,o,r,n[s+5],5,-701558691),r=wi(r,t,i,o,n[s+10],9,38016083),o=wi(o,r,t,i,n[s+15],14,-660478335),i=wi(i,o,r,t,n[s+4],20,-405537848),t=wi(t,i,o,r,n[s+9],5,568446438),r=wi(r,t,i,o,n[s+14],9,-1019803690),o=wi(o,r,t,i,n[s+3],14,-187363961),i=wi(i,o,r,t,n[s+8],20,1163531501),t=wi(t,i,o,r,n[s+13],5,-1444681467),r=wi(r,t,i,o,n[s+2],9,-51403784),o=wi(o,r,t,i,n[s+7],14,1735328473),i=wi(i,o,r,t,n[s+12],20,-1926607734),t=Ai(t,i,o,r,n[s+5],4,-378558),r=Ai(r,t,i,o,n[s+8],11,-2022574463),o=Ai(o,r,t,i,n[s+11],16,1839030562),i=Ai(i,o,r,t,n[s+14],23,-35309556),t=Ai(t,i,o,r,n[s+1],4,-1530992060),r=Ai(r,t,i,o,n[s+4],11,1272893353),o=Ai(o,r,t,i,n[s+7],16,-155497632),i=Ai(i,o,r,t,n[s+10],23,-1094730640),t=Ai(t,i,o,r,n[s+13],4,681279174),r=Ai(r,t,i,o,n[s],11,-358537222),o=Ai(o,r,t,i,n[s+3],16,-722521979),i=Ai(i,o,r,t,n[s+6],23,76029189),t=Ai(t,i,o,r,n[s+9],4,-640364487),r=Ai(r,t,i,o,n[s+12],11,-421815835),o=Ai(o,r,t,i,n[s+15],16,530742520),i=Ai(i,o,r,t,n[s+2],23,-995338651),t=Ri(t,i,o,r,n[s],6,-198630844),r=Ri(r,t,i,o,n[s+7],10,1126891415),o=Ri(o,r,t,i,n[s+14],15,-1416354905),i=Ri(i,o,r,t,n[s+5],21,-57434055),t=Ri(t,i,o,r,n[s+12],6,1700485571),r=Ri(r,t,i,o,n[s+3],10,-1894986606),o=Ri(o,r,t,i,n[s+10],15,-1051523),i=Ri(i,o,r,t,n[s+1],21,-2054922799),t=Ri(t,i,o,r,n[s+8],6,1873313359),r=Ri(r,t,i,o,n[s+15],10,-30611744),o=Ri(o,r,t,i,n[s+6],15,-1560198380),i=Ri(i,o,r,t,n[s+13],21,1309151649),t=Ri(t,i,o,r,n[s+4],6,-145523070),r=Ri(r,t,i,o,n[s+11],10,-1120210379),o=Ri(o,r,t,i,n[s+2],15,718787259),i=Ri(i,o,r,t,n[s+9],21,-343485551),t=jd(t,a),i=jd(i,u),o=jd(o,h),r=jd(r,g)}return[t,i,o,r]}function V_e(n){if(n.length===0)return[];for(var e=n.length*8,t=new Uint32Array(mY(e)),i=0;i<e;i+=8)t[i>>5]|=(n[i/8]&255)<<i%32;return t}function jd(n,e){var t=(n&65535)+(e&65535),i=(n>>16)+(e>>16)+(t>>16);return i<<16|t&65535}function z_e(n,e){return n<<e|n>>>32-e}function nR(n,e,t,i,o,r){return jd(z_e(jd(jd(e,n),jd(i,r)),o),t)}function Pi(n,e,t,i,o,r,s){return nR(e&t|~e&i,n,e,o,r,s)}function wi(n,e,t,i,o,r,s){return nR(e&i|t&~i,n,e,o,r,s)}function Ai(n,e,t,i,o,r,s){return nR(e^t^i,n,e,o,r,s)}function Ri(n,e,t,i,o,r,s){return nR(t^(e|~i),n,e,o,r,s)}tR.default=x_e;Object.defineProperty(eR,"__esModule",{value:!0});eR.default=void 0;var G_e=gY(au),U_e=gY(tR);function gY(n){return n&&n.__esModule?n:{default:n}}var Y_e=(0,G_e.default)("v3",48,U_e.default);eR.default=Y_e;var iR={},oR={};Object.defineProperty(oR,"__esModule",{value:!0});oR.default=void 0;var q_e=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);oR.default={randomUUID:q_e};Object.defineProperty(iR,"__esModule",{value:!0});iR.default=void 0;var Zk=vY(oR),W_e=vY(J0),Z_e=xr;function vY(n){return n&&n.__esModule?n:{default:n}}function Q_e(n,e,t){if(Zk.default.randomUUID&&!e&&!n)return Zk.default.randomUUID();n=n||{};var i=n.random||(n.rng||W_e.default)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){t=t||0;for(var o=0;o<16;++o)e[t+o]=i[o];return e}return(0,Z_e.unsafeStringify)(i)}iR.default=Q_e;var rR={},sR={};Object.defineProperty(sR,"__esModule",{value:!0});sR.default=void 0;function X_e(n,e,t,i){switch(n){case 0:return e&t^~e&i;case 1:return e^t^i;case 2:return e&t^e&i^t&i;case 3:return e^t^i}}function RT(n,e){return n<<e|n>>>32-e}function J_e(n){var e=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof n=="string"){var i=unescape(encodeURIComponent(n));n=[];for(var o=0;o<i.length;++o)n.push(i.charCodeAt(o))}else Array.isArray(n)||(n=Array.prototype.slice.call(n));n.push(128);for(var r=n.length/4+2,s=Math.ceil(r/16),a=new Array(s),u=0;u<s;++u){for(var h=new Uint32Array(16),g=0;g<16;++g)h[g]=n[u*64+g*4]<<24|n[u*64+g*4+1]<<16|n[u*64+g*4+2]<<8|n[u*64+g*4+3];a[u]=h}a[s-1][14]=(n.length-1)*8/Math.pow(2,32),a[s-1][14]=Math.floor(a[s-1][14]),a[s-1][15]=(n.length-1)*8&4294967295;for(var y=0;y<s;++y){for(var S=new Uint32Array(80),w=0;w<16;++w)S[w]=a[y][w];for(var P=16;P<80;++P)S[P]=RT(S[P-3]^S[P-8]^S[P-14]^S[P-16],1);for(var E=t[0],A=t[1],L=t[2],B=t[3],U=t[4],p=0;p<80;++p){var b=Math.floor(p/20),v=RT(E,5)+X_e(b,A,L,B)+U+e[b]+S[p]>>>0;U=B,B=L,L=RT(A,30)>>>0,A=E,E=v}t[0]=t[0]+E>>>0,t[1]=t[1]+A>>>0,t[2]=t[2]+L>>>0,t[3]=t[3]+B>>>0,t[4]=t[4]+U>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}sR.default=J_e;Object.defineProperty(rR,"__esModule",{value:!0});rR.default=void 0;var eye=_Y(au),tye=_Y(sR);function _Y(n){return n&&n.__esModule?n:{default:n}}var nye=(0,eye.default)("v5",80,tye.default);rR.default=nye;var B7={};Object.defineProperty(B7,"__esModule",{value:!0});B7.default=dye;var iye=xr,oye=yY(X0),rye=yY(JA);function yY(n){return n&&n.__esModule?n:{default:n}}function Qk(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);e&&(i=i.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,i)}return t}function Xk(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Qk(Object(t),!0).forEach(function(i){sye(n,i,t[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Qk(Object(t)).forEach(function(i){Object.defineProperty(n,i,Object.getOwnPropertyDescriptor(t,i))})}return n}function sye(n,e,t){return(e=aye(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aye(n){var e=cye(n,"string");return typeof e=="symbol"?e:e+""}function cye(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var i=t.call(n,e||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function dye(n={},e,t=0){var i=(0,oye.default)(Xk(Xk({},n),{},{_v6:!0}),new Uint8Array(16));if(i=(0,rye.default)(i),e){for(var o=0;o<16;o++)e[t+o]=i[o];return e}return(0,iye.unsafeStringify)(i)}var $7={};Object.defineProperty($7,"__esModule",{value:!0});$7.default=hye;var uye=fye(Wf),lye=xr;function fye(n){return n&&n.__esModule?n:{default:n}}function hye(n){var e=typeof n=="string"?(0,uye.default)(n):n,t=pye(e);return typeof n=="string"?(0,lye.unsafeStringify)(t):t}function pye(n){return Uint8Array.of((n[3]&15)<<4|n[4]>>4&15,(n[4]&15)<<4|(n[5]&240)>>4,(n[5]&15)<<4|n[6]&15,n[7],(n[1]&15)<<4|(n[2]&240)>>4,(n[2]&15)<<4|(n[3]&240)>>4,16|(n[0]&240)>>4,(n[0]&15)<<4|(n[1]&240)>>4,n[8],n[9],n[10],n[11],n[12],n[13],n[14],n[15])}var aR={};Object.defineProperty(aR,"__esModule",{value:!0});aR.default=void 0;var mye=vye(J0),gye=xr;function vye(n){return n&&n.__esModule?n:{default:n}}var Jk=null,eF=null,Zr=0;function _ye(n,e,t){n=n||{};var i=e&&t||0,o=e||new Uint8Array(16),r=n.random||(n.rng||mye.default)(),s=n.msecs!==void 0?n.msecs:Date.now(),a=n.seq!==void 0?n.seq:null,u=eF,h=Jk;return s>Zr&&n.msecs===void 0&&(Zr=s,a!==null&&(u=null,h=null)),a!==null&&(a>2147483647&&(a=2147483647),u=a>>>19&4095,h=a&524287),(u===null||h===null)&&(u=r[6]&127,u=u<<8|r[7],h=r[8]&63,h=h<<8|r[9],h=h<<5|r[10]>>>3),s+1e4>Zr&&a===null?++h>524287&&(h=0,++u>4095&&(u=0,Zr++)):Zr=s,eF=u,Jk=h,o[i++]=Zr/1099511627776&255,o[i++]=Zr/4294967296&255,o[i++]=Zr/16777216&255,o[i++]=Zr/65536&255,o[i++]=Zr/256&255,o[i++]=Zr&255,o[i++]=u>>>4&15|112,o[i++]=u&255,o[i++]=h>>>13&63|128,o[i++]=h>>>5&255,o[i++]=h<<3&255|r[10]&7,o[i++]=r[11],o[i++]=r[12],o[i++]=r[13],o[i++]=r[14],o[i++]=r[15],e||(0,gye.unsafeStringify)(o)}aR.default=_ye;var cR={};Object.defineProperty(cR,"__esModule",{value:!0});cR.default=void 0;var yye=bye(Zf);function bye(n){return n&&n.__esModule?n:{default:n}}function Sye(n){if(!(0,yye.default)(n))throw TypeError("Invalid UUID");return parseInt(n.slice(14,15),16)}cR.default=Sye;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"MAX",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"NIL",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"parse",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(n,"stringify",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(n,"v1",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"v1ToV6",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"v3",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(n,"v4",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(n,"v5",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(n,"v6",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(n,"v6ToV1",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(n,"v7",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(n,"validate",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(n,"version",{enumerable:!0,get:function(){return P.default}});var e=E(ZA),t=E(QA),i=E(Wf),o=E(xr),r=E(X0),s=E(JA),a=E(eR),u=E(iR),h=E(rR),g=E(B7),y=E($7),S=E(aR),w=E(Zf),P=E(cR);function E(A){return A&&A.__esModule?A:{default:A}}})(_g);Object.defineProperty(as,"__esModule",{value:!0});as.GLSPClient=as.ClientState=as.ApplicationIdProvider=void 0;const Eye=_g,tF=Oe;class a_{static get(){return a_._applicationId||(a_._applicationId=Eye.v4()),a_._applicationId}}as.ApplicationIdProvider=a_;var nF;(function(n){n[n.Initial=0]="Initial",n[n.Starting=1]="Starting",n[n.StartFailed=2]="StartFailed",n[n.Running=3]="Running",n[n.Stopping=4]="Stopping",n[n.Stopped=5]="Stopped",n[n.ServerError=6]="ServerError"})(nF||(as.ClientState=nF={}));var iF;(function(n){function e(t){return tF.AnyObject.is(t)&&(0,tF.hasStringProp)(t,"id")}n.isOptions=e,n.protocolVersion="1.0.0"})(iF||(as.GLSPClient=iF={}));var yg={};Object.defineProperty(yg,"__esModule",{value:!0});yg.JsonrpcGLSPClient=void 0;const gv=vg,Cye=as;var oF;(function(n){function e(i){return Cye.GLSPClient.isOptions(i)&&"connectionProvider"in i}n.isOptions=e,n.ActionMessageNotification=new gv.NotificationType("process"),n.InitializeRequest=new gv.RequestType("initialize"),n.InitializeClientSessionRequest=new gv.RequestType("initializeClientSession"),n.DisposeClientSessionRequest=new gv.RequestType("disposeClientSession"),n.ShutdownNotification=new gv.NotificationType0("shutdown"),n.ClientNotReadyMsg="JsonrpcGLSPClient is not ready yet";function t(i,...o){console.error(`[JsonrpcGLSPClient] ${i}`,o)}n.error=t})(oF||(yg.JsonrpcGLSPClient=oF={}));Object.defineProperty(Ul,"__esModule",{value:!0});Ul.JsonrpcClientProxy=Ul.BaseJsonrpcGLSPClient=void 0;const rF=gg,fo=as,Qr=yg;class Pye{get onServerInitialized(){return this.onServerInitializedEmitter.event}get onActionMessageNotification(){return this.onActionMessageNotificationEmitter.event}constructor(e){this.onServerInitializedEmitter=new rF.Emitter,this.onActionMessageNotificationEmitter=new rF.Emitter,Object.assign(this,e),this.state=fo.ClientState.Initial}shutdownServer(){this.checkedConnection.sendNotification(Qr.JsonrpcGLSPClient.ShutdownNotification)}async initializeServer(e){return this._initializeResult||(this._initializeResult=await this.checkedConnection.sendRequest(Qr.JsonrpcGLSPClient.InitializeRequest,e),this.onServerInitializedEmitter.fire(this._initializeResult)),this._initializeResult}get initializeResult(){return this._initializeResult}initializeClientSession(e){return this.checkedConnection.sendRequest(Qr.JsonrpcGLSPClient.InitializeClientSessionRequest,e)}disposeClientSession(e){return this.checkedConnection.sendRequest(Qr.JsonrpcGLSPClient.DisposeClientSessionRequest,e)}onActionMessage(e,t){return this.onActionMessageNotification(i=>{(!t||i.clientId===t)&&e(i)})}sendActionMessage(e){this.checkedConnection.sendNotification(Qr.JsonrpcGLSPClient.ActionMessageNotification,e)}get checkedConnection(){if(!this.isConnectionActive())throw new Error(Qr.JsonrpcGLSPClient.ClientNotReadyMsg);return this.resolvedConnection}async start(){if(this.state!==fo.ClientState.Running)try{this.state=fo.ClientState.Starting;const e=await this.resolveConnection();e.listen(),this.resolvedConnection=e,this.state=fo.ClientState.Running}catch(e){Qr.JsonrpcGLSPClient.error("Failed to start connection to server",e),this.state=fo.ClientState.StartFailed}}stop(){return this.connectionPromise?this.state===fo.ClientState.Stopping&&this.onStop?this.onStop:(this.state=fo.ClientState.Stopping,this.onStop=this.resolveConnection().then(e=>{e.dispose(),this.state=fo.ClientState.Stopped,this.onStop=void 0,this.onActionMessageNotificationEmitter.dispose(),this.connectionPromise=void 0,this.resolvedConnection=void 0})):(this.state=fo.ClientState.Stopped,Promise.resolve())}resolveConnection(){return this.connectionPromise||(this.connectionPromise=this.doCreateConnection()),this.connectionPromise}async doCreateConnection(){const e=typeof this.connectionProvider=="function"?await this.connectionProvider():this.connectionProvider;return e.onError(t=>this.handleConnectionError(t[0],t[1],t[2])),e.onClose(()=>this.handleConnectionClosed()),e.onNotification(Qr.JsonrpcGLSPClient.ActionMessageNotification,t=>this.onActionMessageNotificationEmitter.fire(t)),e}handleConnectionError(e,t,i){Qr.JsonrpcGLSPClient.error("Connection to server is erroring. Shutting down server.",e),this.stop(),this.state=fo.ClientState.ServerError}handleConnectionClosed(){if(!(this.state===fo.ClientState.Stopping||this.state===fo.ClientState.Stopped)){try{this.resolvedConnection&&(this.resolvedConnection.dispose(),this.connectionPromise=void 0,this.resolvedConnection=void 0)}catch{}Qr.JsonrpcGLSPClient.error("Connection to server got closed. Server will not be restarted."),this.state=fo.ClientState.ServerError}}isConnectionActive(){return this.state===fo.ClientState.Running&&!!this.resolvedConnection}get currentState(){return this.state}}Ul.BaseJsonrpcGLSPClient=Pye;class wye{initialize(e,t=!1){this.clientConnection=e,this.enableLogging=t}process(e){var t;this.enableLogging&&console.log(`Send action '${e.action.kind}' to client '${e.clientId}'`),(t=this.clientConnection)===null||t===void 0||t.sendNotification(Qr.JsonrpcGLSPClient.ActionMessageNotification,e)}}Ul.JsonrpcClientProxy=wye;Object.defineProperty(oY,"__esModule",{value:!0});const sF=k,Aye=Ul;(0,sF.decorate)((0,sF.injectable)(),Aye.JsonrpcClientProxy);(function(n){var e=f&&f.__createBinding||(Object.create?function(i,o,r,s){s===void 0&&(s=r);var a=Object.getOwnPropertyDescriptor(o,r);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,s,a)}:function(i,o,r,s){s===void 0&&(s=r),i[s]=o[r]}),t=f&&f.__exportStar||function(i,o){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(o,r)&&e(o,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),t(qp,n),t(Z0,n),t(Fd,n),t(iY,n),t(oY,n)})(L7);Object.defineProperty(Nt,"__esModule",{value:!0});Nt.sprottyDefaultModule=Nt.edgeJunctionModule=Nt.zorderModule=Nt.updateModule=Nt.openModule=Nt.moveModule=Nt.modelSourceModule=Nt.fadeModule=Nt.expandModule=Nt.edgeLayoutModule=Nt.edgeIntersectionModule=Nt.edgeEditModule=Nt.buttonModule=void 0;const Hr=L7,Rye=h0;Nt.sprottyDefaultModule=Rye.default;const Mye=j0,Iye=LA,Tye=jA,Dye=Vl,Oye=ta,Lye=B0,jye=$0,Nye=k0,Bye=F0,$ye=x0,kye=H0,Fye=z0;Nt.buttonModule=new Hr.FeatureModule(Mye.default.registry,{featureId:Symbol("button")});Nt.edgeEditModule=new Hr.FeatureModule(Oye.edgeEditModule.registry,{featureId:Symbol("edgeEdit")});Nt.edgeIntersectionModule=new Hr.FeatureModule(Iye.default.registry,{featureId:Symbol("edgeIntersection")});Nt.edgeLayoutModule=new Hr.FeatureModule(Dye.default.registry,{featureId:Symbol("edgeLayout")});Nt.expandModule=new Hr.FeatureModule(Lye.default.registry,{featureId:Symbol("expand")});Nt.fadeModule=new Hr.FeatureModule(jye.default.registry,{featureId:Symbol("fade")});Nt.modelSourceModule=new Hr.FeatureModule(Fye.default.registry,{featureId:Symbol("modelSource")});Nt.moveModule=new Hr.FeatureModule(Nye.default.registry,{featureId:Symbol("move")});Nt.openModule=new Hr.FeatureModule(Bye.default.registry,{featureId:Symbol("open")});Nt.updateModule=new Hr.FeatureModule($ye.default.registry,{featureId:Symbol("update")});Nt.zorderModule=new Hr.FeatureModule(kye.default.registry,{featureId:Symbol("zorder")});Nt.edgeJunctionModule=new Hr.FeatureModule(Tye.default.registry,{featureId:Symbol("edgeJunction")});var bY={},ct={},at={};Object.defineProperty(at,"__esModule",{value:!0});at.CompoundOperation=at.Operation=at.RejectAction=at.ResponseAction=at.RequestAction=at.ActionMessage=at.Action=void 0;const xye=se,cu=Oe;var Yl;(function(n){function e(i){return cu.AnyObject.is(i)&&(0,cu.hasStringProp)(i,"kind")}n.is=e;function t(i,o){return n.is(i)&&i.kind===o}n.hasKind=t})(Yl||(at.Action=Yl={}));var aF;(function(n){function e(t,i){const o=i??Yl.is;return cu.AnyObject.is(t)&&(0,cu.hasStringProp)(t,"clientId")&&"action"in t&&o(t.action)}n.is=e})(aF||(at.ActionMessage=aF={}));var cF;(function(n){function e(o){return Yl.is(o)&&(0,cu.hasStringProp)(o,"requestId")}n.is=e;function t(o,r){return n.is(o)&&o.kind===r}n.hasKind=t;function i(){return xye.generateRequestId()}n.generateRequestId=i})(cF||(at.RequestAction=cF={}));var dF;(function(n){function e(i){return Yl.is(i)&&(0,cu.hasStringProp)(i,"responseId")}n.is=e;function t(i){return n.is(i)&&i.responseId!==""}n.hasValidResponseId=t})(dF||(at.ResponseAction=dF={}));var uF;(function(n){n.KIND="rejectRequest";function e(i){return Yl.hasKind(i,n.KIND)&&(0,cu.hasStringProp)(i,"message")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",message:i,...o}}n.create=t})(uF||(at.RejectAction=uF={}));var N8;(function(n){function e(i){return Yl.is(i)&&"isOperation"in i&&i.isOperation===!0}n.is=e;function t(i,o){return n.is(i)&&i.kind===o}n.hasKind=t})(N8||(at.Operation=N8={}));var lF;(function(n){n.KIND="compound";function e(i){return N8.hasKind(i,n.KIND)&&(0,cu.hasArrayProp)(i,"operationList")}n.is=e;function t(i,o={}){return{kind:n.KIND,isOperation:!0,operationList:i,...o}}n.create=t})(lF||(at.CompoundOperation=lF={}));var Er={};Object.defineProperty(Er,"__esModule",{value:!0});Er.EndProgressAction=Er.UpdateProgressAction=Er.StartProgressAction=Er.MessageAction=Er.StatusAction=void 0;const du=Oe,eb=at;var fF;(function(n){n.KIND="status";function e(i){return eb.Action.hasKind(i,n.KIND)&&(0,du.hasStringProp)(i,"severity")&&(0,du.hasStringProp)(i,"message")}n.is=e;function t(i,o={}){return{kind:n.KIND,severity:"INFO",message:i,...o}}n.create=t})(fF||(Er.StatusAction=fF={}));var hF;(function(n){n.KIND="message";function e(i){return eb.Action.hasKind(i,n.KIND)&&(0,du.hasStringProp)(i,"message")&&(0,du.hasStringProp)(i,"severity")}n.is=e;function t(i,o={}){return{kind:n.KIND,message:i,severity:"INFO",...o}}n.create=t})(hF||(Er.MessageAction=hF={}));var pF;(function(n){n.KIND="startProgress";function e(i){return eb.Action.hasKind(i,n.KIND)&&(0,du.hasStringProp)(i,"progressId")&&(0,du.hasStringProp)(i,"title")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(pF||(Er.StartProgressAction=pF={}));var mF;(function(n){n.KIND="updateProgress";function e(i){return eb.Action.hasKind(i,n.KIND)&&(0,du.hasStringProp)(i,"progressId")}n.is=e;function t(i,o={}){return{kind:n.KIND,progressId:i,...o}}n.create=t})(mF||(Er.UpdateProgressAction=mF={}));var gF;(function(n){n.KIND="endProgress";function e(i){return eb.Action.hasKind(i,n.KIND)&&(0,du.hasStringProp)(i,"progressId")}n.is=e;function t(i,o){return{kind:n.KIND,progressId:i,message:o}}n.create=t})(gF||(Er.EndProgressAction=gF={}));var Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.PasteOperation=Gs.CutOperation=Gs.SetClipboardDataAction=Gs.RequestClipboardDataAction=void 0;const oy=Oe,dR=at;var vF;(function(n){n.KIND="requestClipboardData";function e(i){return dR.RequestAction.hasKind(i,n.KIND)&&(0,oy.hasObjectProp)(i,"editorContext")}n.is=e;function t(i,o={}){return{kind:n.KIND,requestId:"",editorContext:i,...o}}n.create=t})(vF||(Gs.RequestClipboardDataAction=vF={}));var _F;(function(n){n.KIND="setClipboardData";function e(i){return dR.Action.hasKind(i,n.KIND)&&(0,oy.hasObjectProp)(i,"clipboardData")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",clipboardData:i,...o}}n.create=t})(_F||(Gs.SetClipboardDataAction=_F={}));var yF;(function(n){n.KIND="cut";function e(i){return dR.Operation.hasKind(i,n.KIND)&&(0,oy.hasObjectProp)(i,"editorContext")}n.is=e;function t(i,o={}){return{kind:n.KIND,isOperation:!0,editorContext:i,...o}}n.create=t})(yF||(Gs.CutOperation=yF={}));var bF;(function(n){n.KIND="paste";function e(i){return dR.Operation.hasKind(i,n.KIND)&&(0,oy.hasObjectProp)(i,"clipboardData")&&(0,oy.hasObjectProp)(i,"editorContext")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,...i}}n.create=t})(bF||(Gs.PasteOperation=bF={}));var Zp={};Object.defineProperty(Zp,"__esModule",{value:!0});Zp.SetContextActions=Zp.RequestContextActions=void 0;const B8=Oe,SY=at;var SF;(function(n){n.KIND="requestContextActions";function e(i){return SY.RequestAction.hasKind(i,n.KIND)&&(0,B8.hasStringProp)(i,"contextId")&&(0,B8.hasObjectProp)(i,"editorContext")}n.is=e;function t(i){return{kind:n.KIND,requestId:"",...i}}n.create=t})(SF||(Zp.RequestContextActions=SF={}));var EF;(function(n){n.KIND="setContextActions";function e(i){return SY.Action.hasKind(i,n.KIND)&&(0,B8.hasArrayProp)(i,"actions")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",actions:i,...o}}n.create=t})(EF||(Zp.SetContextActions=EF={}));var Qp={};Object.defineProperty(Qp,"__esModule",{value:!0});Qp.ChangeRoutingPointsOperation=Qp.ReconnectEdgeOperation=void 0;const d3=Oe,EY=at;var CF;(function(n){n.KIND="reconnectEdge";function e(i){return EY.Operation.hasKind(i,n.KIND)&&(0,d3.hasStringProp)(i,"edgeElementId")&&(0,d3.hasStringProp)(i,"sourceElementId")&&(0,d3.hasStringProp)(i,"targetElementId")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,...i}}n.create=t})(CF||(Qp.ReconnectEdgeOperation=CF={}));var PF;(function(n){n.KIND="changeRoutingPoints";function e(i){return EY.Operation.hasKind(i,n.KIND)&&(0,d3.hasArrayProp)(i,"newRoutingPoints")}n.is=e;function t(i,o={}){return{kind:n.KIND,isOperation:!0,newRoutingPoints:i,...o}}n.create=t})(PF||(Qp.ChangeRoutingPointsOperation=PF={}));var Us={};Object.defineProperty(Us,"__esModule",{value:!0});Us.DeleteElementOperation=Us.CreateEdgeOperation=Us.CreateNodeOperation=Us.CreateOperation=void 0;const GC=Oe,CY=at;var UC;(function(n){function e(i){return CY.Operation.is(i)&&(0,GC.hasStringProp)(i,"elementTypeId")}n.is=e;function t(i,o){return n.is(i)&&i.kind===o}n.hasKind=t})(UC||(Us.CreateOperation=UC={}));var wF;(function(n){n.KIND="createNode";function e(i){return UC.hasKind(i,n.KIND)}n.is=e;function t(i,o={}){return{kind:n.KIND,isOperation:!0,elementTypeId:i,...o}}n.create=t})(wF||(Us.CreateNodeOperation=wF={}));var AF;(function(n){n.KIND="createEdge";function e(i){return UC.hasKind(i,n.KIND)&&(0,GC.hasStringProp)(i,"sourceElementId")&&(0,GC.hasStringProp)(i,"targetElementId")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,...i}}n.create=t})(AF||(Us.CreateEdgeOperation=AF={}));var RF;(function(n){n.KIND="deleteElement";function e(i){return CY.Operation.hasKind(i,n.KIND)&&(0,GC.hasArrayProp)(i,"elementIds")}n.is=e;function t(i,o={}){return{kind:n.KIND,isOperation:!0,elementIds:i,...o}}n.create=t})(RF||(Us.DeleteElementOperation=RF={}));var Xp={};Object.defineProperty(Xp,"__esModule",{value:!0});Xp.SetPopupModelAction=Xp.RequestPopupModelAction=void 0;const $8=Oe,PY=at;var MF;(function(n){n.KIND="requestPopupModel";function e(i){return PY.RequestAction.hasKind(i,n.KIND)&&(0,$8.hasStringProp)(i,"elementId")&&(0,$8.hasObjectProp)(i,"bounds")}n.is=e;function t(i){return{kind:n.KIND,requestId:"",...i}}n.create=t})(MF||(Xp.RequestPopupModelAction=MF={}));var IF;(function(n){n.KIND="setPopupModel";function e(i){return PY.Action.hasKind(i,n.KIND)&&(0,$8.hasObjectProp)(i,"newRoot")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",newRoot:i,...o}}n.create=t})(IF||(Xp.SetPopupModelAction=IF={}));var Li={};Object.defineProperty(Li,"__esModule",{value:!0});Li.NavigateToExternalTargetAction=Li.SetResolvedNavigationTargetAction=Li.ResolveNavigationTargetAction=Li.NavigateToTargetAction=Li.SetNavigationTargetsAction=Li.RequestNavigationTargetsAction=Li.NavigationTarget=void 0;const mc=Oe,bg=at;var TF;(function(n){function e(u){return mc.AnyObject.is(u)&&(0,mc.hasStringProp)(u,"uri")}n.is=e,n.ELEMENT_IDS="elementIds",n.ELEMENT_IDS_SEPARATOR="&",n.TEXT_LINE="line",n.TEXT_COLUMN="column";function t(u){return u.args!==void 0&&Object.keys(u.args).length>0}n.hasArguments=t;function i(u,h,g){u.args||(u.args={}),u.args[h]=g}n.addArgument=i;function o(u){var h;return!((h=u==null?void 0:u.args)===null||h===void 0)&&h[n.ELEMENT_IDS]?u.args[n.ELEMENT_IDS].toString().split(n.ELEMENT_IDS_SEPARATOR):[]}n.getElementIds=o;function r(u,...h){return u.args===void 0&&(u.args={}),u.args[n.ELEMENT_IDS]=h.join(n.ELEMENT_IDS_SEPARATOR)}n.setElementIds=r;function s(u,h){h&&(u.args===void 0&&(u.args={}),u.args[n.TEXT_LINE]=h.line,u.args[n.TEXT_COLUMN]=h.character)}n.setTextPosition=s;function a(u){if(!(!u.args||!u.args[n.TEXT_LINE]||!u.args[n.TEXT_COLUMN]))return{line:Number(u.args[n.TEXT_LINE]),character:Number(u.args[n.TEXT_COLUMN])}}n.getTextPosition=a})(TF||(Li.NavigationTarget=TF={}));var DF;(function(n){n.KIND="requestNavigationTargets";function e(i){return bg.RequestAction.hasKind(i,n.KIND)&&(0,mc.hasStringProp)(i,"targetTypeId")&&(0,mc.hasObjectProp)(i,"editorContext")}n.is=e;function t(i){return{kind:n.KIND,requestId:"",...i}}n.create=t})(DF||(Li.RequestNavigationTargetsAction=DF={}));var OF;(function(n){n.KIND="setNavigationTargets";function e(i){return bg.Action.hasKind(i,n.KIND)&&(0,mc.hasArrayProp)(i,"targets")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",targets:i,...o}}n.create=t})(OF||(Li.SetNavigationTargetsAction=OF={}));var LF;(function(n){n.KIND="navigateToTarget";function e(i){return bg.Action.hasKind(i,n.KIND)&&(0,mc.hasObjectProp)(i,"target")}n.is=e;function t(i){return{kind:n.KIND,target:i}}n.create=t})(LF||(Li.NavigateToTargetAction=LF={}));var jF;(function(n){n.KIND="resolveNavigationTarget";function e(i){return bg.RequestAction.hasKind(i,n.KIND)&&(0,mc.hasObjectProp)(i,"navigationTarget")}n.is=e;function t(i,o={}){return{kind:n.KIND,requestId:"",navigationTarget:i,...o}}n.create=t})(jF||(Li.ResolveNavigationTargetAction=jF={}));var NF;(function(n){n.KIND="setResolvedNavigationTarget";function e(i){return bg.Action.hasKind(i,n.KIND)&&(0,mc.hasArrayProp)(i,"elementIds")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",elementIds:i,...o}}n.create=t})(NF||(Li.SetResolvedNavigationTargetAction=NF={}));var BF;(function(n){n.KIND="navigateToExternalTarget";function e(i){return bg.Action.hasKind(i,n.KIND)&&(0,mc.hasObjectProp)(i,"target")}n.is=e;function t(i){return{kind:n.KIND,target:i}}n.create=t})(BF||(Li.NavigateToExternalTargetAction=BF={}));var Jp={};Object.defineProperty(Jp,"__esModule",{value:!0});Jp.SelectAllAction=Jp.SelectAction=void 0;const Hye=lt,k8=Oe,wY=at;var $F;(function(n){n.KIND="elementSelected";function e(s){return wY.Action.hasKind(s,n.KIND)&&(0,k8.hasArrayProp)(s,"selectedElementsIDs")&&(0,k8.hasArrayProp)(s,"deselectedElementsIDs")}n.is=e;function t(s={}){var a,u;const h=(a=s.deselectedElementsIDs)!==null&&a!==void 0?a:[];return{kind:n.KIND,selectedElementsIDs:(u=s.selectedElementsIDs)!==null&&u!==void 0?u:[],deselectedElementsIDs:(0,Hye.isStringArray)(h,!0)?h:[],deselectAll:typeof h=="boolean"?h:!1}}n.create=t;function i(s){return t({selectedElementsIDs:s})}n.addSelection=i;function o(s){return t({deselectedElementsIDs:s})}n.removeSelection=o;function r(s){return t({selectedElementsIDs:s,deselectedElementsIDs:!0})}n.setSelection=r})($F||(Jp.SelectAction=$F={}));var kF;(function(n){n.KIND="allSelected";function e(i){return wY.Action.hasKind(i,n.KIND)&&(0,k8.hasBooleanProp)(i,"select")}n.is=e;function t(i=!0){return{kind:n.KIND,select:i}}n.create=t})(kF||(Jp.SelectAllAction=kF={}));var Ys={};Object.defineProperty(Ys,"__esModule",{value:!0});Ys.ValidationStatus=Ys.ApplyLabelEditOperation=Ys.SetEditValidationResultAction=Ys.RequestEditValidationAction=void 0;const Cp=Oe,k7=at;var FF;(function(n){n.KIND="requestEditValidation";function e(i){return k7.RequestAction.hasKind(i,n.KIND)&&(0,Cp.hasStringProp)(i,"contextId")&&(0,Cp.hasStringProp)(i,"modelElementId")&&(0,Cp.hasStringProp)(i,"text")}n.is=e;function t(i){return{kind:n.KIND,requestId:"",...i}}n.create=t})(FF||(Ys.RequestEditValidationAction=FF={}));var xF;(function(n){n.KIND="setEditValidationResult";function e(i){return k7.Action.hasKind(i,n.KIND)&&(0,Cp.hasObjectProp)(i,"status")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",status:i,...o}}n.create=t})(xF||(Ys.SetEditValidationResultAction=xF={}));var HF;(function(n){n.KIND="applyLabelEdit";function e(i){return k7.Operation.hasKind(i,n.KIND)&&(0,Cp.hasStringProp)(i,"labelId")&&(0,Cp.hasStringProp)(i,"text")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,...i}}n.create=t})(HF||(Ys.ApplyLabelEditOperation=HF={}));var KF;(function(n){let e;(function(r){r[r.FATAL=0]="FATAL",r[r.ERROR=1]="ERROR",r[r.WARNING=2]="WARNING",r[r.INFO=3]="INFO",r[r.OK=4]="OK",r[r.NONE=5]="NONE"})(e=n.Severity||(n.Severity={})),n.NONE={severity:e.NONE,message:"",error:{code:-1,message:"",data:{}}};function t(r){return r.severity===e.OK||r.severity===e.INFO||r.severity===e.NONE}n.isOk=t;function i(r){return r.severity===e.WARNING}n.isWarning=i;function o(r){return r.severity===e.ERROR||r.severity===e.FATAL}n.isError=o})(KF||(Ys.ValidationStatus=KF={}));var qs={};Object.defineProperty(qs,"__esModule",{value:!0});qs.CheckEdgeResultAction=qs.RequestCheckEdgeAction=qs.SetTypeHintsAction=qs.RequestTypeHintsAction=void 0;const ec=Oe,uR=at;var VF;(function(n){n.KIND="requestTypeHints";function e(i){return uR.RequestAction.hasKind(i,n.KIND)}n.is=e;function t(i={}){return{kind:n.KIND,requestId:"",...i}}n.create=t})(VF||(qs.RequestTypeHintsAction=VF={}));var zF;(function(n){n.KIND="setTypeHints";function e(i){return uR.Action.hasKind(i,n.KIND)&&(0,ec.hasArrayProp)(i,"shapeHints")&&(0,ec.hasArrayProp)(i,"edgeHints")}n.is=e;function t(i){return{kind:n.KIND,responseId:"",...i}}n.create=t})(zF||(qs.SetTypeHintsAction=zF={}));var GF;(function(n){n.KIND="requestCheckEdge";function e(i){return uR.Action.hasKind(i,n.KIND)&&(0,ec.hasStringProp)(i,"edgeType")&&(0,ec.hasStringProp)(i,"sourceElementId")&&(0,ec.hasStringProp)(i,"targetElementId",!0)}n.is=e;function t(i){var o;return{kind:n.KIND,edgeType:i.edgeType,sourceElementId:UF(i.sourceElement),targetElementId:i.targetElement?UF(i.targetElement):void 0,requestId:(o=i.requestId)!==null&&o!==void 0?o:""}}n.create=t})(GF||(qs.RequestCheckEdgeAction=GF={}));function UF(n){return typeof n=="string"?n:n.id}var YF;(function(n){n.KIND="checkEdgeTargetResult";function e(i){return uR.Action.hasKind(i,n.KIND)&&(0,ec.hasBooleanProp)(i,"isValid")&&(0,ec.hasStringProp)(i,"edgeType")&&(0,ec.hasStringProp)(i,"sourceElementId")&&(0,ec.hasStringProp)(i,"targetElementId",!0)}n.is=e;function t(i){return{kind:n.KIND,responseId:"",...i}}n.create=t})(YF||(qs.CheckEdgeResultAction=YF={}));var Cr={};Object.defineProperty(Cr,"__esModule",{value:!0});Cr.DeleteMarkersAction=Cr.SetMarkersAction=Cr.RequestMarkersAction=Cr.MarkersReason=Cr.MarkerKind=void 0;const F7=Oe,x7=at;var qF;(function(n){n.INFO="info",n.WARNING="warning",n.ERROR="error"})(qF||(Cr.MarkerKind=qF={}));var YC;(function(n){n.BATCH="batch",n.LIVE="live"})(YC||(Cr.MarkersReason=YC={}));var WF;(function(n){n.KIND="requestMarkers";function e(i){return x7.RequestAction.hasKind(i,n.KIND)&&(0,F7.hasArrayProp)(i,"elementsIDs")}n.is=e;function t(i,o={}){return{kind:n.KIND,requestId:"",elementsIDs:i,reason:YC.BATCH,...o}}n.create=t})(WF||(Cr.RequestMarkersAction=WF={}));var ZF;(function(n){n.KIND="setMarkers";function e(i){return x7.Action.hasKind(i,n.KIND)&&(0,F7.hasArrayProp)(i,"markers")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",markers:i,reason:YC.BATCH,...o}}n.create=t})(ZF||(Cr.SetMarkersAction=ZF={}));var QF;(function(n){n.KIND="deleteMarkers";function e(i){return x7.Action.hasKind(i,n.KIND)&&(0,F7.hasArrayProp)(i,"markers")}n.is=e;function t(i){return{kind:n.KIND,markers:i}}n.create=t})(QF||(Cr.DeleteMarkersAction=QF={}));var Ws={};Object.defineProperty(Ws,"__esModule",{value:!0});Ws.SourceModelChangedAction=Ws.UpdateModelAction=Ws.SetModelAction=Ws.RequestModelAction=void 0;const H7=Oe,lR=at;var XF;(function(n){n.KIND="requestModel";function e(i){return lR.RequestAction.hasKind(i,n.KIND)}n.is=e;function t(i={}){return{kind:n.KIND,requestId:"",...i}}n.create=t})(XF||(Ws.RequestModelAction=XF={}));var JF;(function(n){n.KIND="setModel";function e(i){return lR.Action.hasKind(i,n.KIND)&&(0,H7.hasObjectProp)(i,"newRoot")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",newRoot:i,...o}}n.create=t})(JF||(Ws.SetModelAction=JF={}));var ex;(function(n){n.KIND="updateModel";function e(i){return lR.Action.hasKind(i,n.KIND)&&(0,H7.hasObjectProp)(i,"newRoot")}n.is=e;function t(i,o={}){return{kind:n.KIND,newRoot:i,animate:!0,...o}}n.create=t})(ex||(Ws.UpdateModelAction=ex={}));var tx;(function(n){n.KIND="sourceModelChanged";function e(i){return lR.Action.hasKind(i,n.KIND)&&(0,H7.hasStringProp)(i,"sourceModelName")}n.is=e;function t(i){return{kind:n.KIND,sourceModelName:i}}n.create=t})(tx||(Ws.SourceModelChangedAction=tx={}));var em={};Object.defineProperty(em,"__esModule",{value:!0});em.EditMode=em.SetEditModeAction=void 0;const Kye=Oe,Vye=at;var nx;(function(n){n.KIND="setEditMode";function e(i){return Vye.Action.hasKind(i,n.KIND)&&(0,Kye.hasStringProp)(i,"editMode")}n.is=e;function t(i){return{kind:n.KIND,editMode:i}}n.create=t})(nx||(em.SetEditModeAction=nx={}));var ix;(function(n){n.READONLY="readonly",n.EDITABLE="editable"})(ix||(em.EditMode=ix={}));var Kd={};Object.defineProperty(Kd,"__esModule",{value:!0});Kd.LayoutOperation=Kd.ComputedBoundsAction=Kd.RequestBoundsAction=void 0;const K7=Oe,V7=at;var ox;(function(n){n.KIND="requestBounds";function e(i){return V7.RequestAction.hasKind(i,n.KIND)&&(0,K7.hasObjectProp)(i,"newRoot")}n.is=e;function t(i,o={}){return{kind:n.KIND,requestId:"",newRoot:i,...o}}n.create=t})(ox||(Kd.RequestBoundsAction=ox={}));var rx;(function(n){n.KIND="computedBounds";function e(i){return V7.Action.hasKind(i,n.KIND)&&(0,K7.hasArrayProp)(i,"bounds")}n.is=e;function t(i,o={}){return{kind:n.KIND,responseId:"",bounds:i,...o}}n.create=t})(rx||(Kd.ComputedBoundsAction=rx={}));var sx;(function(n){n.KIND="layout";function e(i){return V7.Action.hasKind(i,n.KIND)&&(0,K7.hasArrayProp)(i,"elementIds")}n.is=e;function t(i,o={}){return{kind:n.KIND,isOperation:!0,elementIds:i,...o}}n.create=t})(sx||(Kd.LayoutOperation=sx={}));var Zs={};Object.defineProperty(Zs,"__esModule",{value:!0});Zs.ExportSvgAction=Zs.RequestExportSvgAction=Zs.SetDirtyStateAction=Zs.SaveModelAction=void 0;const AY=Oe,fR=at;var ax;(function(n){n.KIND="saveModel";function e(i){return fR.Action.hasKind(i,n.KIND)}n.is=e;function t(i={}){return{kind:n.KIND,...i}}n.create=t})(ax||(Zs.SaveModelAction=ax={}));var cx;(function(n){n.KIND="setDirtyState";function e(i){return fR.Action.hasKind(i,n.KIND)&&(0,AY.hasBooleanProp)(i,"isDirty")}n.is=e;function t(i,o={}){return{kind:n.KIND,isDirty:i,...o}}n.create=t})(cx||(Zs.SetDirtyStateAction=cx={}));var dx;(function(n){n.KIND="requestExportSvg";function e(i){return fR.RequestAction.hasKind(i,n.KIND)}n.is=e;function t(i={}){return{kind:n.KIND,requestId:"",...i}}n.create=t})(dx||(Zs.RequestExportSvgAction=dx={}));var ux;(function(n){n.KIND="exportSvg";function e(i){return fR.Action.hasKind(i,n.KIND)&&(0,AY.hasStringProp)(i,"svg")}n.is=e;function t(i,o={}){return{kind:n.KIND,svg:i,responseId:"",...o}}n.create=t})(ux||(Zs.ExportSvgAction=ux={}));var tm={};Object.defineProperty(tm,"__esModule",{value:!0});tm.ChangeContainerOperation=tm.ChangeBoundsOperation=void 0;const F8=Oe,RY=at;var lx;(function(n){n.KIND="changeBounds";function e(i){return RY.Operation.hasKind(i,n.KIND)&&(0,F8.hasArrayProp)(i,"newBounds")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,newBounds:i}}n.create=t})(lx||(tm.ChangeBoundsOperation=lx={}));var fx;(function(n){n.KIND="changeContainer";function e(i){return RY.Operation.hasKind(i,n.KIND)&&(0,F8.hasStringProp)(i,"elementId")&&(0,F8.hasStringProp)(i,"targetContainerId")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,...i}}n.create=t})(fx||(tm.ChangeContainerOperation=fx={}));var ql={};Object.defineProperty(ql,"__esModule",{value:!0});ql.TriggerEdgeCreationAction=ql.TriggerNodeCreationAction=void 0;const MY=Oe,IY=at;var hx;(function(n){n.KIND="triggerNodeCreation";function e(i){return IY.Action.hasKind(i,n.KIND)&&(0,MY.hasStringProp)(i,"elementTypeId")}n.is=e;function t(i,o){return{kind:n.KIND,elementTypeId:i,...o}}n.create=t})(hx||(ql.TriggerNodeCreationAction=hx={}));var px;(function(n){n.KIND="triggerEdgeCreation";function e(i){return IY.Action.hasKind(i,n.KIND)&&(0,MY.hasStringProp)(i,"elementTypeId")}n.is=e;function t(i,o={}){return{kind:n.KIND,elementTypeId:i,...o}}n.create=t})(px||(ql.TriggerEdgeCreationAction=px={}));var Qs={};Object.defineProperty(Qs,"__esModule",{value:!0});Qs.MenuItem=Qs.PaletteItem=Qs.LabeledAction=Qs.EditorContext=void 0;const Vd=Oe,mx=ql;var gx;(function(n){function e(t){return Vd.AnyObject.is(t)&&(0,Vd.hasArrayProp)(t,"selectedElementIds")}n.is=e})(gx||(Qs.EditorContext=gx={}));var qC;(function(n){function e(i){return Vd.AnyObject.is(i)&&(0,Vd.hasStringProp)(i,"label")&&(0,Vd.hasArrayProp)(i,"actions")}n.is=e;function t(i){return Array.isArray(i)?i:n.is(i)?i.actions:[i]}n.toActionArray=t})(qC||(Qs.LabeledAction=qC={}));var vx;(function(n){function e(o){return qC.is(o)&&(0,Vd.hasStringProp)(o,"id")&&(0,Vd.hasStringProp)(o,"sortString")}n.is=e;function t(o){if(o){const r=o.actions.filter(s=>i(s)).map(s=>s);return r.length>0?r[0]:void 0}}n.getTriggerAction=t;function i(o){return mx.TriggerNodeCreationAction.is(o)||mx.TriggerEdgeCreationAction.is(o)}n.isTriggerElementCreationAction=i})(vx||(Qs.PaletteItem=vx={}));var _x;(function(n){function e(t){return qC.is(t)&&(0,Vd.hasStringProp)(t,"id")}n.is=e})(_x||(Qs.MenuItem=_x={}));var nm={};Object.defineProperty(nm,"__esModule",{value:!0});nm.RedoAction=nm.UndoAction=void 0;const TY=at;var yx;(function(n){n.KIND="glspUndo";function e(i){return TY.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(yx||(nm.UndoAction=yx={}));var bx;(function(n){n.KIND="glspRedo";function e(i){return TY.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(bx||(nm.RedoAction=bx={}));var im={};Object.defineProperty(im,"__esModule",{value:!0});im.FitToScreenAction=im.CenterAction=void 0;const WC=Oe,DY=at;var Sx;(function(n){n.KIND="center";function e(i){return DY.Action.hasKind(i,n.KIND)&&(0,WC.hasBooleanProp)(i,"animate")&&(0,WC.hasBooleanProp)(i,"retainZoom")}n.is=e;function t(i,o={}){return{kind:n.KIND,animate:!0,retainZoom:!1,elementIds:i,...o}}n.create=t})(Sx||(im.CenterAction=Sx={}));var Ex;(function(n){n.KIND="fit";function e(i){return DY.Action.hasKind(i,n.KIND)&&(0,WC.hasArrayProp)(i,"elementIds")&&(0,WC.hasBooleanProp)(i,"animate")}n.is=e;function t(i,o={}){return{kind:n.KIND,animate:!0,elementIds:i,...o}}n.create=t})(Ex||(im.FitToScreenAction=Ex={}));var OY={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.BaseGLSPClient=n.GLOBAL_HANDLER_ID=void 0;const e=Fr,t=vg,i=lt,o=gg,r=as;n.GLOBAL_HANDLER_ID="*";class s{get onServerInitialized(){return this.onServerInitializedEmitter.event}constructor(u){this.options=u,this.serverDeferred=new e.Deferred,this.onStartDeferred=new e.Deferred,this.onStopDeferred=new e.Deferred,this.startupTimeout=1500,this.actionMessageHandlers=new Map([[n.GLOBAL_HANDLER_ID,[]]]),this.onServerInitializedEmitter=new o.Emitter,this.state=r.ClientState.Initial,this.proxy=this.createProxy()}createProxy(){return{process:u=>{var h;const g=(h=this.actionMessageHandlers.get(u.clientId))!==null&&h!==void 0?h:this.actionMessageHandlers.get(n.GLOBAL_HANDLER_ID);if(!g){console.warn("No ActionMessageHandler is configured- Cannot process server message",u);return}g.forEach(y=>y(u))}}}configureServer(u){if(this.state===r.ClientState.Running)throw new Error("Could not configure new server. The GLSPClient is already running");this.serverDeferred.resolve(u)}start(){if(this.state===r.ClientState.Running)return this.onStartDeferred.promise;this.state=r.ClientState.Starting;const u=new Promise((h,g)=>setTimeout(()=>{g(new Error("Could not start client. No server is configured"))},this.startupTimeout));return Promise.race([this.serverDeferred.promise,u]).then(h=>{this._server=h,this.state=r.ClientState.Running,this.onStartDeferred.resolve()}).catch(h=>{this.state=r.ClientState.StartFailed,this.onStartDeferred.reject(h)}),this.onStartDeferred.promise}async initializeServer(u){return this._initializeResult||(this._initializeResult=await this.checkedServer.initialize(u),this.onServerInitializedEmitter.fire(this._initializeResult)),this._initializeResult}get initializeResult(){return this._initializeResult}initializeClientSession(u){return this.checkedServer.initializeClientSession(u)}disposeClientSession(u){return this.checkedServer.disposeClientSession(u)}shutdownServer(){this.checkedServer.shutdown()}async stop(){if(this.state===r.ClientState.Stopped||this.state===r.ClientState.Stopping)return this.onStop();this.state=r.ClientState.Stopping;try{this._server&&this._server.shutdown()}finally{this.state=r.ClientState.Stopped,this.onStopDeferred.resolve()}}sendActionMessage(u){this.checkedServer.process(u)}onActionMessage(u,h){return h?(this.actionMessageHandlers.has(h)?(0,i.distinctAdd)(this.actionMessageHandlers.get(h),u):this.actionMessageHandlers.set(h,[u]),t.Disposable.create(()=>(0,i.remove)(this.actionMessageHandlers.get(h),u))):((0,i.distinctAdd)(this.actionMessageHandlers.get(n.GLOBAL_HANDLER_ID),u),t.Disposable.create(()=>(0,i.remove)(this.actionMessageHandlers.get(n.GLOBAL_HANDLER_ID),u)))}get currentState(){return this.state}onStart(){return this.onStartDeferred.promise}onStop(){return this.onStopDeferred.promise}get id(){return this.options.id}checkState(){if(this.state!==r.ClientState.Running)throw new Error(`Client with id '${this.id}' is not in 'Running' state`)}get checkedServer(){if(this.checkState(),!this._server)throw new Error(`No server is configured for GLSPClient with id '${this.id}'`);return this._server}setStartupTimeout(u){this.startupTimeout=u}}n.BaseGLSPClient=s})(OY);var zd={};Object.defineProperty(zd,"__esModule",{value:!0});zd.GLSPClientProxy=zd.GLSPServerListener=zd.GLSPServer=void 0;zd.GLSPServer=Symbol("GLSPServer");zd.GLSPServerListener=Symbol("GLSPServerListener");zd.GLSPClientProxy=Symbol("GLSPClientProxy");var hR={};Object.defineProperty(hR,"__esModule",{value:!0});hR.configureClientConnection=void 0;const SE=yg;function zye(n,e){n.onRequest(SE.JsonrpcGLSPClient.InitializeRequest.method,t=>e.initialize(t)),n.onRequest(SE.JsonrpcGLSPClient.InitializeClientSessionRequest,t=>e.initializeClientSession(t)),n.onRequest(SE.JsonrpcGLSPClient.DisposeClientSessionRequest,t=>e.disposeClientSession(t)),n.onNotification(SE.JsonrpcGLSPClient.ActionMessageNotification,t=>e.process(t)),n.listen()}hR.configureClientConnection=zye;var Uo={};Object.defineProperty(Uo,"__esModule",{value:!0});Uo.listen=Uo.createWebSocketConnection=Uo.WebSocketMessageWriter=Uo.WebSocketMessageReader=Uo.wrap=void 0;const ZC=vg;function LY(n){return{send:e=>n.send(e),onMessage:e=>n.onmessage=t=>e(t.data),onClose:e=>n.onclose=t=>e(t.code,t.reason),onError:e=>n.onerror=t=>{"error"in t&&e(t.error)},dispose:()=>n.close()}}Uo.wrap=LY;class jY extends ZC.AbstractMessageReader{constructor(e){super(),this.socket=e,this.state="initial",this.eventQueue=[],this.socket.onMessage(t=>this.handleMessage(t)),this.socket.onError(t=>this.fireError(t)),this.socket.onClose(()=>this.fireClose())}listen(e){return this.state==="initial"&&(this.state="listening",this.callback=e,this.eventQueue.forEach(t=>{t.message?this.handleMessage(t.message):t.error?this.fireError(t.error):this.fireClose()}),this.eventQueue=[]),ZC.Disposable.create(()=>{this.callback=void 0,this.eventQueue=[]})}handleMessage(e){if(this.state==="initial")this.eventQueue.push({message:e});else if(this.state==="listening"){const t=JSON.parse(e);this.callback(t)}}fireError(e){this.state==="initial"?this.eventQueue.push({error:e}):this.state==="listening"&&super.fireError(e)}fireClose(){this.state==="initial"?this.eventQueue.push({}):this.state==="listening"&&super.fireClose(),this.state="closed"}}Uo.WebSocketMessageReader=jY;class NY extends ZC.AbstractMessageWriter{constructor(e){super(),this.socket=e,this.errorCount=0}end(){}async write(e){try{const t=JSON.stringify(e);this.socket.send(t)}catch(t){this.errorCount++,this.fireError(t,e,this.errorCount)}}}Uo.WebSocketMessageWriter=NY;function BY(n,e){const t=new jY(n),i=new NY(n);return(0,ZC.createMessageConnection)(t,i,e)}Uo.createWebSocketConnection=BY;function Gye(n,e,t){return new Promise(i=>{n.onopen=()=>{const o=LY(n),r=BY(o,t);e==null||e(r),i(r)}})}Uo.listen=Gye;var pR={},Uye=vg;Object.defineProperty(pR,"__esModule",{value:!0});pR.GLSPWebWorkerProvider=void 0;const MT=Uye;class Yye{constructor(e){this.url=e}createWebWorker(e){return new Worker(e)}listen(e){var t,i;this.worker=this.createWebWorker(this.url);const o=(0,MT.createMessageConnection)(new MT.BrowserMessageReader(this.worker),new MT.BrowserMessageWriter(this.worker));return(t=e.logger)===null||t===void 0||t.warn("GLSPWebWorkerProvider Initializing!"),(i=e.onConnection)===null||i===void 0||i.call(e,o),o}}pR.GLSPWebWorkerProvider=Yye;var om={};Object.defineProperty(om,"__esModule",{value:!0});om.GLSPWebSocketProvider=om.GLSPConnectionHandler=void 0;const Cx=Uo;om.GLSPConnectionHandler=Symbol("GLSPConnectionHandler");class qye{constructor(e,t){this.url=e,this.reconnectAttempts=0,this.options={reconnecting:!0,reconnectAttempts:1/0,reconnectDelay:1e3},this.options=Object.assign(this.options,t)}createWebSocket(e){return new WebSocket(e)}listen(e,t=!1){return this.webSocket=this.createWebSocket(this.url),this.webSocket.onerror=()=>{var i;(i=e.logger)===null||i===void 0||i.error("GLSPWebSocketProvider Connection to server errored. Please make sure that the server is running!"),clearInterval(this.reconnectTimer),this.webSocket.close()},new Promise(i=>{this.webSocket.onopen=()=>{var o,r,s,a;clearInterval(this.reconnectTimer);const u=(0,Cx.wrap)(this.webSocket),h=(0,Cx.createWebSocketConnection)(u,e.logger);this.webSocket.onclose=()=>{var g,y;const{reconnecting:S,reconnectAttempts:w,reconnectDelay:P}=this.options;S?this.reconnectAttempts>=w?(g=e.logger)===null||g===void 0||g.error(`GLSPWebSocketProvider WebSocket reconnect failed - maximum number reconnect attempts (${w}) was exceeded!`):this.reconnectTimer=setInterval(()=>{var E;(E=e.logger)===null||E===void 0||E.warn("GLSPWebSocketProvider reconnecting..."),this.listen(e,!0),this.reconnectAttempts++},P):(y=e.logger)===null||y===void 0||y.error("GLSPWebSocketProvider WebSocket will not reconnect - closing the connection now!")},t?((o=e.logger)===null||o===void 0||o.warn("GLSPWebSocketProvider Reconnecting!"),(r=e.onReconnect)===null||r===void 0||r.call(e,h)):((s=e.logger)===null||s===void 0||s.warn("GLSPWebSocketProvider Initializing!"),(a=e.onConnection)===null||a===void 0||a.call(e,h)),i(h)}})}}om.GLSPWebSocketProvider=qye;var $Y={};Object.defineProperty($Y,"__esModule",{value:!0});var mR={};Object.defineProperty(mR,"__esModule",{value:!0});mR.DefaultTypes=void 0;var Px;(function(n){n.HTML="html",n.FOREIGN_OBJECT="foreign-object",n.PRE_RENDERED="pre-rendered",n.SHAPE_PRE_RENDERED="shape-pre-rendered",n.SVG="svg",n.GRAPH="graph",n.NODE="node",n.COMPARTMENT="comp",n.COMPARTMENT_HEADER="comp:header",n.EDGE="edge",n.PORT="port",n.ROUTING_POINT="routing-point",n.VOLATILE_ROUTING_POINT=`volatile-${n.ROUTING_POINT}`,n.LABEL="label",n.BUTTON="button",n.BUTTON_EXPAND="button:expand",n.ISSUE_MARKER="marker",n.NODE_CIRCLE="node:circle",n.NODE_RECTANGLE="node:rectangle",n.NODE_DIAMOND="node:diamond"})(Px||(mR.DefaultTypes=Px={}));var gR={};Object.defineProperty(gR,"__esModule",{value:!0});gR.isGModelElementSchema=void 0;const wx=Oe;function Wye(n){return typeof n=="object"&&(0,wx.hasStringProp)(n,"type")&&(0,wx.hasStringProp)(n,"id")}gR.isGModelElementSchema=Wye;var kY={};(function(n){var e=f&&f.__createBinding||(Object.create?function(r,s,a,u){u===void 0&&(u=a);var h=Object.getOwnPropertyDescriptor(s,a);(!h||("get"in h?!s.__esModule:h.writable||h.configurable))&&(h={enumerable:!0,get:function(){return s[a]}}),Object.defineProperty(r,u,h)}:function(r,s,a,u){u===void 0&&(u=a),r[u]=s[a]}),t=f&&f.__exportStar||function(r,s){for(var a in r)a!=="default"&&!Object.prototype.hasOwnProperty.call(s,a)&&e(s,r,a)};Object.defineProperty(n,"__esModule",{value:!0}),n.getSubType=n.getBasicType=n.findElement=n.cloneModel=n.applyBounds=n.isZoomable=n.isScrollable=void 0;var i=Kl;Object.defineProperty(n,"isScrollable",{enumerable:!0,get:function(){return i.isScrollable}}),Object.defineProperty(n,"isZoomable",{enumerable:!0,get:function(){return i.isZoomable}}),t(Pf,n),t(Te,n),t(R6,n);var o=Nn;Object.defineProperty(n,"applyBounds",{enumerable:!0,get:function(){return o.applyBounds}}),Object.defineProperty(n,"cloneModel",{enumerable:!0,get:function(){return o.cloneModel}}),Object.defineProperty(n,"findElement",{enumerable:!0,get:function(){return o.findElement}}),Object.defineProperty(n,"getBasicType",{enumerable:!0,get:function(){return o.getBasicType}}),Object.defineProperty(n,"getSubType",{enumerable:!0,get:function(){return o.getSubType}})})(kY);var FY={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ViewportResult=n.SetViewportAction=n.SetBoundsAction=n.SelectionResult=n.OpenAction=n.MoveAction=n.HoverFeedbackAction=n.GetViewportAction=n.GetSelectionAction=n.CollapseExpandAllAction=n.CollapseExpandAction=n.BringToFrontAction=void 0;const e=se;Object.defineProperty(n,"BringToFrontAction",{enumerable:!0,get:function(){return e.BringToFrontAction}}),Object.defineProperty(n,"CollapseExpandAction",{enumerable:!0,get:function(){return e.CollapseExpandAction}}),Object.defineProperty(n,"CollapseExpandAllAction",{enumerable:!0,get:function(){return e.CollapseExpandAllAction}}),Object.defineProperty(n,"GetSelectionAction",{enumerable:!0,get:function(){return e.GetSelectionAction}}),Object.defineProperty(n,"GetViewportAction",{enumerable:!0,get:function(){return e.GetViewportAction}}),Object.defineProperty(n,"HoverFeedbackAction",{enumerable:!0,get:function(){return e.HoverFeedbackAction}}),Object.defineProperty(n,"MoveAction",{enumerable:!0,get:function(){return e.MoveAction}}),Object.defineProperty(n,"OpenAction",{enumerable:!0,get:function(){return e.OpenAction}}),Object.defineProperty(n,"SelectionResult",{enumerable:!0,get:function(){return e.SelectionResult}}),Object.defineProperty(n,"SetBoundsAction",{enumerable:!0,get:function(){return e.SetBoundsAction}}),Object.defineProperty(n,"SetViewportAction",{enumerable:!0,get:function(){return e.SetViewportAction}}),Object.defineProperty(n,"ViewportResult",{enumerable:!0,get:function(){return e.ViewportResult}});const t=at,i=Oe;e.CollapseExpandAction.is=o=>t.Action.hasKind(o,e.CollapseExpandAction.KIND)&&(0,i.hasArrayProp)(o,"expandIds")&&(0,i.hasArrayProp)(o,"collapseIds"),e.CollapseExpandAllAction.is=o=>t.Action.hasKind(o,e.CollapseExpandAllAction.KIND)&&(0,i.hasBooleanProp)(o,"expand"),e.GetSelectionAction.is=o=>t.RequestAction.hasKind(o,e.GetSelectionAction.KIND),e.GetViewportAction.is=o=>t.RequestAction.hasKind(o,e.GetViewportAction.KIND),e.HoverFeedbackAction.is=o=>t.Action.hasKind(o,e.HoverFeedbackAction.KIND)&&(0,i.hasStringProp)(o,"mouseoverElement")&&(0,i.hasBooleanProp)(o,"mouseIsOver"),e.MoveAction.is=o=>t.Action.hasKind(o,e.MoveAction.KIND)&&(0,i.hasArrayProp)(o,"moves")&&(0,i.hasBooleanProp)(o,"animate")&&(0,i.hasBooleanProp)(o,"finished"),e.OpenAction.is=o=>t.Action.hasKind(o,e.OpenAction.KIND)&&(0,i.hasStringProp)(o,"elementId"),e.SelectionResult.is=o=>t.Action.hasKind(o,e.SelectionResult.KIND)&&(0,i.hasArrayProp)(o,"selectedElementsIDs"),e.SetBoundsAction.is=o=>t.Action.hasKind(o,e.SetBoundsAction.KIND)&&(0,i.hasObjectProp)(o,"bounds"),e.SetViewportAction.is=o=>t.Action.hasKind(o,e.SetViewportAction.KIND)&&(0,i.hasStringProp)(o,"elementId")&&(0,i.hasObjectProp)(o,"newViewport")&&(0,i.hasBooleanProp)(o,"animate"),e.ViewportResult.is=o=>t.Action.hasKind(o,e.ViewportResult.KIND)&&(0,i.hasObjectProp)(o,"viewport")&&(0,i.hasObjectProp)(o,"canvasBounds")})(FY);var xY={},z7={},Sg={};Object.defineProperty(Sg,"__esModule",{value:!0});Sg.equalUpTo=void 0;function Zye(n,e,t=Number.EPSILON){return Math.abs(n-e)<=t}Sg.equalUpTo=Zye;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Dimension=void 0;const e=Te;Object.defineProperty(n,"Dimension",{enumerable:!0,get:function(){return e.Dimension}});const t=Sg,i=Oe;e.Dimension.ZERO=Object.freeze({width:0,height:0}),e.Dimension.is=o=>i.AnyObject.is(o)&&(0,i.hasNumberProp)(o,"width")&&(0,i.hasNumberProp)(o,"height"),e.Dimension.center=o=>({x:o.width*.5,y:o.height*.5}),e.Dimension.add=(o,r)=>({width:o.width+r.width,height:o.height+r.height}),e.Dimension.subtract=(o,r)=>({width:o.width-r.width,height:o.height-r.height}),e.Dimension.multiplyMeasure=(o,r)=>({width:o.width*r,height:o.height*r}),e.Dimension.divideMeasure=(o,r)=>({width:o.width/r,height:o.height/r}),e.Dimension.map=(o,r)=>({...o,width:r(o.width,"width"),height:r(o.height,"height")}),e.Dimension.equals=(o,r,s)=>(0,t.equalUpTo)(o.width,r.width,s)&&(0,t.equalUpTo)(o.height,r.height,s),e.Dimension.fromPoint=o=>({width:o.x,height:o.y}),e.Dimension.area=o=>o.width*o.height})(z7);var vR={},Eg={},tb={};Object.defineProperty(tb,"__esModule",{value:!0});tb.Direction=void 0;tb.Direction={Left:"left",Right:"right",Up:"up",Down:"down"};Object.defineProperty(Eg,"__esModule",{value:!0});Eg.Vector=void 0;const EE=tb,IT=Oe;var Ax;(function(n){n.ZERO=Object.freeze({x:0,y:0});function e(B){return{x:Math.abs(B.x),y:Math.abs(B.y)}}n.abs=e;function t(B,U){return{x:B.x+U.x,y:B.y+U.y}}n.add=t;function i(B,U){return B.x===U.x&&B.y===U.y}n.equals=i;function o(B){return B!==void 0&&!isNaN(B.x)&&!isNaN(B.y)}n.isValid=o;function r(B){return Math.sqrt(Math.pow(B.x,2)+Math.pow(B.y,2))}n.magnitude=r;function s(B,U){return{...B,x:U(B.x,"x"),y:U(B.y,"y")}}n.map=s;function a(B){const U=r(B);return U===0||U===1?n.ZERO:{x:B.x/U,y:B.y/U}}n.normalize=a;function u(B){return n.equals(B,n.ZERO)}n.isZero=u;function h(B){return IT.AnyObject.is(B)&&(0,IT.hasNumberProp)(B,"x")&&(0,IT.hasNumberProp)(B,"y")}n.is=h;function g(B,U){return n.map(B,p=>p/U)}n.divide=g;function y(B,U){return n.map(B,p=>p*U)}n.multiply=y;function S(B,U){return{x:B.x-U.x,y:B.y-U.y}}n.subtract=S;function w(B){return{x:-B.x,y:-B.y}}n.reverse=w;function P(B){const U=[];return B.x<0?U.push(EE.Direction.Left):B.x>0&&U.push(EE.Direction.Right),B.y<0?U.push(EE.Direction.Up):B.y>0&&U.push(EE.Direction.Down),U}n.direction=P;function E(...B){return{x:Math.min(...B.map(U=>U.x)),y:Math.min(...B.map(U=>U.y))}}n.min=E;function A(...B){return{x:Math.max(...B.map(U=>U.x)),y:Math.max(...B.map(U=>U.y))}}n.max=A;function L(...B){return B.length===0?n.ZERO:{x:B.reduce((U,p)=>U+p.x,0)/B.length,y:B.reduce((U,p)=>U+p.y,0)/B.length}}n.avg=L})(Ax||(Eg.Vector=Ax={}));(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Point=void 0;const e=Te;Object.defineProperty(n,"Point",{enumerable:!0,get:function(){return e.Point}});const t=Eg,i=Sg,o=Oe;e.Point.is=r=>o.AnyObject.is(r)&&(0,o.hasNumberProp)(r,"x")&&(0,o.hasNumberProp)(r,"y"),e.Point.isOrigin=r=>e.Point.equals(r,e.Point.ORIGIN),e.Point.isValid=r=>r!==void 0&&!isNaN(r.x)&&!isNaN(r.y),e.Point.abs=r=>e.Point.map(r,Math.abs),e.Point.divideScalar=(r,s)=>e.Point.map(r,a=>a/s),e.Point.multiplyScalar=(r,s)=>e.Point.map(r,a=>a*s),e.Point.map=(r,s)=>({...r,x:s(r.x,"x"),y:s(r.y,"y")}),e.Point.snapToGrid=(r,s,a)=>{if(a){const u=e.Point.subtract(r,a),h=e.Point.snapToGrid(u,s);return e.Point.add(a,h)}else return{x:Math.round(r.x/s.x)*s.x,y:Math.round(r.y/s.y)*s.y}},e.Point.vector=(r,s)=>e.Point.subtract(s,r),e.Point.move=(r,s)=>{const a=e.Point.vector(r,s),u=t.Vector.direction(a);return{from:r,to:s,vector:a,direction:u}},e.Point.moveTowards=(r,s)=>{const a=e.Point.add(r,s),u=t.Vector.direction(s);return{from:r,to:a,vector:s,direction:u}},e.Point.equals=(r,s,a)=>(0,i.equalUpTo)(r.x,s.x,a)&&(0,i.equalUpTo)(r.y,s.y,a)})(vR);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Bounds=void 0;const e=Te;Object.defineProperty(n,"Bounds",{enumerable:!0,get:function(){return e.Bounds}});const t=z7,i=vR,o=Oe;e.Bounds.ZERO=Object.freeze({x:0,y:0,width:0,height:0}),e.Bounds.is=r=>o.AnyObject.is(r)&&(0,o.hasNumberProp)(r,"x")&&(0,o.hasNumberProp)(r,"y")&&(0,o.hasNumberProp)(r,"width")&&(0,o.hasNumberProp)(r,"height"),e.Bounds.isValid=r=>r!==void 0&&t.Dimension.isValid(r)&&i.Point.isValid(r),e.Bounds.encompasses=(r,s)=>e.Bounds.includes(r,e.Bounds.topLeft(s))&&e.Bounds.includes(r,e.Bounds.bottomRight(s)),e.Bounds.overlap=(r,s,a)=>{const u=e.Bounds.topLeft(r),h=e.Bounds.bottomRight(r),g=e.Bounds.topLeft(s),y=e.Bounds.bottomRight(s);return a?u.x<=y.x&&g.x<=h.x&&h.y>=g.y&&y.y>=u.y:u.x<y.x&&g.x<h.x&&h.y>g.y&&y.y>u.y},e.Bounds.equals=(r,s,a)=>i.Point.equals(r,s,a)&&t.Dimension.equals(r,s,a),e.Bounds.left=r=>r.x,e.Bounds.centerX=r=>r.x+(r.width>=0?r.width*.5:0),e.Bounds.right=r=>r.x+r.width,e.Bounds.top=r=>r.y,e.Bounds.middle=r=>r.y+(r.height>=0?r.height*.5:0),e.Bounds.centerY=e.Bounds.middle,e.Bounds.bottom=r=>r.y+r.height,e.Bounds.topLeft=r=>({x:e.Bounds.left(r),y:e.Bounds.top(r)}),e.Bounds.topCenter=r=>({x:e.Bounds.centerX(r),y:e.Bounds.top(r)}),e.Bounds.topRight=r=>({x:e.Bounds.right(r),y:e.Bounds.top(r)}),e.Bounds.middleLeft=r=>({x:e.Bounds.left(r),y:e.Bounds.middle(r)}),e.Bounds.middleCenter=r=>({x:e.Bounds.centerX(r),y:e.Bounds.middle(r)}),e.Bounds.middleRight=r=>({x:e.Bounds.right(r),y:e.Bounds.middle(r)}),e.Bounds.bottomLeft=r=>({x:e.Bounds.left(r),y:e.Bounds.bottom(r)}),e.Bounds.bottomCenter=r=>({x:e.Bounds.centerX(r),y:e.Bounds.bottom(r)}),e.Bounds.bottomRight=r=>({x:e.Bounds.right(r),y:e.Bounds.bottom(r)}),e.Bounds.isAbove=(r,s)=>e.Bounds.top(r)<=e.Bounds.top(s),e.Bounds.isBelow=(r,s)=>e.Bounds.top(r)>=e.Bounds.top(s),e.Bounds.isBefore=(r,s)=>e.Bounds.left(r)<e.Bounds.left(s),e.Bounds.isAfter=(r,s)=>e.Bounds.left(r)>=e.Bounds.left(s),e.Bounds.sortBy=(r,...s)=>s.sort((a,u)=>r(a)-r(u)),e.Bounds.from=(r,s)=>({...r,width:s.x-r.x,height:s.y-r.y}),e.Bounds.position=e.Bounds.topLeft,e.Bounds.dimension=r=>({width:r.width,height:r.height}),e.Bounds.move=e.Bounds.translate,e.Bounds.resize=(r,s)=>({...r,width:r.width+s.width,height:r.height+s.height})})(xY);var rm={};Object.defineProperty(rm,"__esModule",{value:!0});rm.DisposableCollection=rm.Disposable=void 0;const Rx=lt,Mx=Oe;var c_;(function(n){function e(o){return Mx.AnyObject.is(o)&&(0,Mx.hasFunctionProp)(o,"dispose")}n.is=e;function t(){return{dispose:()=>{}}}n.empty=t;function i(o){return{dispose:o}}n.create=i})(c_||(rm.Disposable=c_={}));class Qye{constructor(...e){this.disposables=[],e.forEach(t=>this.push(t)),this.errorHandler=t=>console.error(t)}dispose(){var e,t;if(!this.disposed)try{for(;!this.disposed;)(e=this.disposables.pop())===null||e===void 0||e.dispose()}catch(i){(t=this.errorHandler)===null||t===void 0||t.call(this,i)}}get disposed(){return this.disposables.length===0}push(...e){const t=(0,Rx.isArrayOfType)(e,c_.is)?e:e.map(c_.create);return this.disposables.push(...t),c_.create(()=>(0,Rx.remove)(this.disposables,...t))}get isDisposed(){return this.disposed}clear(){this.disposables.length=0}}rm.DisposableCollection=Qye;var _R={};Object.defineProperty(_R,"__esModule",{value:!0});_R.Movement=void 0;const zh=vR,CE=Eg,vv=Oe;var Ix;(function(n){n.ZERO=Object.freeze({from:zh.Point.ORIGIN,to:zh.Point.ORIGIN,vector:CE.Vector.ZERO,direction:[]});function e(r){return vv.AnyObject.is(r)&&(0,vv.hasObjectProp)(r,"from")&&zh.Point.is(r.from)&&(0,vv.hasObjectProp)(r,"to")&&zh.Point.is(r.to)&&(0,vv.hasObjectProp)(r,"vector")&&CE.Vector.is(r.to)&&(0,vv.hasObjectProp)(r,"direction")}n.is=e;function t(r){return CE.Vector.isZero(r.vector)}n.isStationary=t;function i(r){return n.equals(r,n.ZERO)}n.isZero=i;function o(r,s){return zh.Point.equals(r.from,s.from)&&zh.Point.equals(r.to,s.to)&&CE.Vector.equals(r.vector,s.vector)}n.equals=o})(Ix||(_R.Movement=Ix={}));(function(n){var e=f&&f.__createBinding||(Object.create?function(i,o,r,s){s===void 0&&(s=r);var a=Object.getOwnPropertyDescriptor(o,r);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,s,a)}:function(i,o,r,s){s===void 0&&(s=r),i[s]=o[r]}),t=f&&f.__exportStar||function(i,o){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(o,r)&&e(o,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),t(at,n),t(Er,n),t(Gs,n),t(Zp,n),t(Qp,n),t(Us,n),t(Xp,n),t(Li,n),t(Jp,n),t(Ys,n),t(qs,n),t(Cr,n),t(Ws,n),t(em,n),t(Kd,n),t(Zs,n),t(tm,n),t(ql,n),t(Qs,n),t(nm,n),t(im,n),t(OY,n),t(as,n),t(zd,n),t(Ul,n),t(yg,n),t(hR,n),t(Uo,n),t(pR,n),t(om,n),t($Y,n),t(mR,n),t(gR,n),t(kY,n),t(FY,n),t(xY,n),t(z7,n),t(vR,n),t(lt,n),t(rm,n),t(gg,n),t(_R,n),t(tb,n),t(Eg,n),t(Sg,n),t(Oe,n)})(ct);(function(n){var e=f&&f.__createBinding||(Object.create?function(Z,H,M,Y){Y===void 0&&(Y=M);var te=Object.getOwnPropertyDescriptor(H,M);(!te||("get"in te?!H.__esModule:te.writable||te.configurable))&&(te={enumerable:!0,get:function(){return H[M]}}),Object.defineProperty(Z,Y,te)}:function(Z,H,M,Y){Y===void 0&&(Y=M),Z[Y]=H[M]}),t=f&&f.__exportStar||function(Z,H){for(var M in Z)M!=="default"&&!Object.prototype.hasOwnProperty.call(H,M)&&e(H,Z,M)};Object.defineProperty(n,"__esModule",{value:!0}),n.isFadeable=n.fadeFeature=n.SvgExporter=n.ExportSvgPostprocessor=n.ExportSvgKeyListener=n.ExportSvgCommand=n.isExpandable=n.expandFeature=n.isEdgeLayoutable=n.edgeLayoutFeature=n.DEFAULT_EDGE_PLACEMENT=n.checkEdgePlacement=n.DeleteContextMenuItemProvider=n.ContextMenuProviderRegistry=n.RevealNamedElementActionProvider=n.CommandPaletteActionProviderRegistry=n.GButton=n.configureButtonHandler=n.ButtonHandlerRegistry=n.layoutContainerFeature=n.layoutableChildFeature=n.isSizeable=n.isLayoutContainer=n.isLayoutableChild=n.isBoundsAware=n.isAlignable=n.GShapeElement=n.getAbsoluteClientBounds=n.getAbsoluteBounds=n.findChildrenAtPosition=n.boundsFeature=n.alignFeature=n.PopupMouseTool=n.MouseTool=n.MousePositionTracker=n.KeyTool=n.SModelRegistry=n.GModelFactory=n.EMPTY_ROOT=n.createFeatureSet=n.ModelIndexImpl=n.isParent=n.GParentElement=n.GModelRoot=n.GModelElement=n.GChildElement=n.createRandomId=n.onAction=n.configureActionHandler=n.ActionHandlerRegistry=void 0,n.PolylineEdgeViewWithGapsOnIntersections=n.PolylineEdgeView=n.JumpingPolylineEdgeView=n.GRoutingHandleView=n.GLabelView=n.GCompartmentView=n.GBezierCreateHandleView=n.GBezierControlHandleView=n.BezierCurveEdgeView=n.SGraphImpl=n.SEdgeImpl=n.GPort=n.GNode=n.GLabel=n.GGraphIndex=n.GCompartment=n.GViewportRootElement=n.SprottySelectCommand=n.SprottySelectAllCommand=n.SelectMouseListener=n.SelectKeyboardListener=n.GetSelectionCommand=n.selectFeature=n.isSelected=n.isSelectable=n.isConnectable=n.GRoutingHandle=n.GRoutableElement=n.getRouteBounds=n.getAbsoluteRouteBounds=n.GDanglingAnchor=n.GConnectableElement=n.edgeInProgressTargetHandleID=n.edgeInProgressID=n.connectableFeature=n.isProjectable=n.getProjections=n.getProjectedBounds=n.getModelBounds=n.moveFeature=n.isMoveable=n.isLocateable=n.SIssueMarkerImpl=n.isDecoration=n.GDecoration=n.decorationFeature=n.popupFeature=n.isHoverable=n.hoverFeedbackFeature=n.hasPopupFeature=void 0,n.SvgViewportView=n.RectangularNodeView=n.EmptyGroupView=n.RectangularPort=n.RectangularNode=n.GShapedPreRenderedElement=n.GPreRenderedElement=n.GHtmlRoot=n.GForeignObjectElement=n.DiamondNode=n.CircularPort=n.CircularNode=n.SGraphView=void 0,t(ct,n),t(L7,n),t(ju,n);var i=Wo;Object.defineProperty(n,"ActionHandlerRegistry",{enumerable:!0,get:function(){return i.ActionHandlerRegistry}}),Object.defineProperty(n,"configureActionHandler",{enumerable:!0,get:function(){return i.configureActionHandler}}),Object.defineProperty(n,"onAction",{enumerable:!0,get:function(){return i.onAction}}),t(wf,n),t(Lr,n),t(Pa,n),t(Jm,n),t(ze,n),t(wn,n),t(Af,n),t(eA,n),t(Co,n),t(Nu,n);var o=ke;Object.defineProperty(n,"createRandomId",{enumerable:!0,get:function(){return o.createRandomId}}),Object.defineProperty(n,"GChildElement",{enumerable:!0,get:function(){return o.SChildElementImpl}}),Object.defineProperty(n,"GModelElement",{enumerable:!0,get:function(){return o.SModelElementImpl}}),Object.defineProperty(n,"GModelRoot",{enumerable:!0,get:function(){return o.SModelRootImpl}}),Object.defineProperty(n,"GParentElement",{enumerable:!0,get:function(){return o.SParentElementImpl}}),Object.defineProperty(n,"isParent",{enumerable:!0,get:function(){return o.isParent}}),Object.defineProperty(n,"ModelIndexImpl",{enumerable:!0,get:function(){return o.ModelIndexImpl}});var r=$n;Object.defineProperty(n,"createFeatureSet",{enumerable:!0,get:function(){return r.createFeatureSet}}),Object.defineProperty(n,"EMPTY_ROOT",{enumerable:!0,get:function(){return r.EMPTY_ROOT}}),Object.defineProperty(n,"GModelFactory",{enumerable:!0,get:function(){return r.SModelFactory}}),Object.defineProperty(n,"SModelRegistry",{enumerable:!0,get:function(){return r.SModelRegistry}}),t(yt,n),t(aa,n),t(Po,n),t(Aa,n);var s=gi;Object.defineProperty(n,"KeyTool",{enumerable:!0,get:function(){return s.KeyTool}});var a=Ut;Object.defineProperty(n,"MousePositionTracker",{enumerable:!0,get:function(){return a.MousePositionTracker}}),Object.defineProperty(n,"MouseTool",{enumerable:!0,get:function(){return a.MouseTool}}),Object.defineProperty(n,"PopupMouseTool",{enumerable:!0,get:function(){return a.PopupMouseTool}}),t(ac,n),t(rn,n),t(Xn,n),t(If,n),t(rA,n),t(Tf,n),t(ft,n),t(Bu,n),t(hs,n),t(Of,n),t(cA,n),t(qi,n);var u=$t;Object.defineProperty(n,"alignFeature",{enumerable:!0,get:function(){return u.alignFeature}}),Object.defineProperty(n,"boundsFeature",{enumerable:!0,get:function(){return u.boundsFeature}}),Object.defineProperty(n,"findChildrenAtPosition",{enumerable:!0,get:function(){return u.findChildrenAtPosition}}),Object.defineProperty(n,"getAbsoluteBounds",{enumerable:!0,get:function(){return u.getAbsoluteBounds}}),Object.defineProperty(n,"getAbsoluteClientBounds",{enumerable:!0,get:function(){return u.getAbsoluteClientBounds}}),Object.defineProperty(n,"GShapeElement",{enumerable:!0,get:function(){return u.SShapeElementImpl}}),Object.defineProperty(n,"isAlignable",{enumerable:!0,get:function(){return u.isAlignable}}),Object.defineProperty(n,"isBoundsAware",{enumerable:!0,get:function(){return u.isBoundsAware}}),Object.defineProperty(n,"isLayoutableChild",{enumerable:!0,get:function(){return u.isLayoutableChild}}),Object.defineProperty(n,"isLayoutContainer",{enumerable:!0,get:function(){return u.isLayoutContainer}}),Object.defineProperty(n,"isSizeable",{enumerable:!0,get:function(){return u.isSizeable}}),Object.defineProperty(n,"layoutableChildFeature",{enumerable:!0,get:function(){return u.layoutableChildFeature}}),Object.defineProperty(n,"layoutContainerFeature",{enumerable:!0,get:function(){return u.layoutContainerFeature}}),t(Df,n),t(Fc,n);var h=ps;Object.defineProperty(n,"ButtonHandlerRegistry",{enumerable:!0,get:function(){return h.ButtonHandlerRegistry}}),Object.defineProperty(n,"configureButtonHandler",{enumerable:!0,get:function(){return h.configureButtonHandler}});var g=rg;Object.defineProperty(n,"GButton",{enumerable:!0,get:function(){return g.SButtonImpl}});var y=ms;Object.defineProperty(n,"CommandPaletteActionProviderRegistry",{enumerable:!0,get:function(){return y.CommandPaletteActionProviderRegistry}}),Object.defineProperty(n,"RevealNamedElementActionProvider",{enumerable:!0,get:function(){return y.RevealNamedElementActionProvider}}),t(cc,n);var S=gs;Object.defineProperty(n,"ContextMenuProviderRegistry",{enumerable:!0,get:function(){return S.ContextMenuProviderRegistry}}),Object.defineProperty(n,"DeleteContextMenuItemProvider",{enumerable:!0,get:function(){return S.DeleteContextMenuItemProvider}}),t(Nf,n),t(Vl,n),t(Bf,n);var w=$f;Object.defineProperty(n,"checkEdgePlacement",{enumerable:!0,get:function(){return w.checkEdgePlacement}}),Object.defineProperty(n,"DEFAULT_EDGE_PLACEMENT",{enumerable:!0,get:function(){return w.DEFAULT_EDGE_PLACEMENT}}),Object.defineProperty(n,"edgeLayoutFeature",{enumerable:!0,get:function(){return w.edgeLayoutFeature}}),Object.defineProperty(n,"isEdgeLayoutable",{enumerable:!0,get:function(){return w.isEdgeLayoutable}}),t(jf,n),t(_n,n),t(ca,n),t(_s,n),t(kf,n),t(Kf,n);var P=R0;Object.defineProperty(n,"expandFeature",{enumerable:!0,get:function(){return P.expandFeature}}),Object.defineProperty(n,"isExpandable",{enumerable:!0,get:function(){return P.isExpandable}}),t(cg,n);var E=Wi;Object.defineProperty(n,"ExportSvgCommand",{enumerable:!0,get:function(){return E.ExportSvgCommand}}),Object.defineProperty(n,"ExportSvgKeyListener",{enumerable:!0,get:function(){return E.ExportSvgKeyListener}}),Object.defineProperty(n,"ExportSvgPostprocessor",{enumerable:!0,get:function(){return E.ExportSvgPostprocessor}}),t(y0,n);var A=sr;Object.defineProperty(n,"SvgExporter",{enumerable:!0,get:function(){return A.SvgExporter}}),t(ua,n);var L=Lf;Object.defineProperty(n,"fadeFeature",{enumerable:!0,get:function(){return L.fadeFeature}}),Object.defineProperty(n,"isFadeable",{enumerable:!0,get:function(){return L.isFadeable}}),t(fn,n);var B=$u;Object.defineProperty(n,"hasPopupFeature",{enumerable:!0,get:function(){return B.hasPopupFeature}}),Object.defineProperty(n,"hoverFeedbackFeature",{enumerable:!0,get:function(){return B.hoverFeedbackFeature}}),Object.defineProperty(n,"isHoverable",{enumerable:!0,get:function(){return B.isHoverable}}),Object.defineProperty(n,"popupFeature",{enumerable:!0,get:function(){return B.popupFeature}}),t(hg,n),t(zf,n);var U=D0;Object.defineProperty(n,"decorationFeature",{enumerable:!0,get:function(){return U.decorationFeature}}),Object.defineProperty(n,"GDecoration",{enumerable:!0,get:function(){return U.SDecoration}}),Object.defineProperty(n,"isDecoration",{enumerable:!0,get:function(){return U.isDecoration}}),Object.defineProperty(n,"SIssueMarkerImpl",{enumerable:!0,get:function(){return U.SIssueMarkerImpl}}),t(Vf,n),t(Qn,n),t(Ln,n),t(Gf,n);var p=xc;Object.defineProperty(n,"isLocateable",{enumerable:!0,get:function(){return p.isLocateable}}),Object.defineProperty(n,"isMoveable",{enumerable:!0,get:function(){return p.isMoveable}}),Object.defineProperty(n,"moveFeature",{enumerable:!0,get:function(){return p.moveFeature}}),t(Jn,n),t(dg,n),t(uA,n),t(SA,n),t(ug,n);var b=Yo;Object.defineProperty(n,"getModelBounds",{enumerable:!0,get:function(){return b.getModelBounds}}),Object.defineProperty(n,"getProjectedBounds",{enumerable:!0,get:function(){return b.getProjectedBounds}}),Object.defineProperty(n,"getProjections",{enumerable:!0,get:function(){return b.getProjections}}),Object.defineProperty(n,"isProjectable",{enumerable:!0,get:function(){return b.isProjectable}}),t(lg,n),t(Xo,n),t(Ra,n),t(Jo,n),t(Zi,n),t(er,n),t(Uf,n);var v=an;Object.defineProperty(n,"connectableFeature",{enumerable:!0,get:function(){return v.connectableFeature}}),Object.defineProperty(n,"edgeInProgressID",{enumerable:!0,get:function(){return v.edgeInProgressID}}),Object.defineProperty(n,"edgeInProgressTargetHandleID",{enumerable:!0,get:function(){return v.edgeInProgressTargetHandleID}}),Object.defineProperty(n,"GConnectableElement",{enumerable:!0,get:function(){return v.SConnectableElementImpl}}),Object.defineProperty(n,"GDanglingAnchor",{enumerable:!0,get:function(){return v.SDanglingAnchorImpl}}),Object.defineProperty(n,"getAbsoluteRouteBounds",{enumerable:!0,get:function(){return v.getAbsoluteRouteBounds}}),Object.defineProperty(n,"getRouteBounds",{enumerable:!0,get:function(){return v.getRouteBounds}}),Object.defineProperty(n,"GRoutableElement",{enumerable:!0,get:function(){return v.SRoutableElementImpl}}),Object.defineProperty(n,"GRoutingHandle",{enumerable:!0,get:function(){return v.SRoutingHandleImpl}}),Object.defineProperty(n,"isConnectable",{enumerable:!0,get:function(){return v.isConnectable}}),t(wo,n),t(Hc,n),t(vi,n),t(Yf,n);var R=no;Object.defineProperty(n,"isSelectable",{enumerable:!0,get:function(){return R.isSelectable}}),Object.defineProperty(n,"isSelected",{enumerable:!0,get:function(){return R.isSelected}}),Object.defineProperty(n,"selectFeature",{enumerable:!0,get:function(){return R.selectFeature}});var D=fi;Object.defineProperty(n,"GetSelectionCommand",{enumerable:!0,get:function(){return D.GetSelectionCommand}}),Object.defineProperty(n,"SelectKeyboardListener",{enumerable:!0,get:function(){return D.SelectKeyboardListener}}),Object.defineProperty(n,"SelectMouseListener",{enumerable:!0,get:function(){return D.SelectMouseListener}}),Object.defineProperty(n,"SprottySelectAllCommand",{enumerable:!0,get:function(){return D.SelectAllCommand}}),Object.defineProperty(n,"SprottySelectCommand",{enumerable:!0,get:function(){return D.SelectCommand}}),t(ss,n),t(Fu,n),t(Bi,n),t(Rs,n),t(hc,n),t(Ao,n);var j=Ff;Object.defineProperty(n,"GViewportRootElement",{enumerable:!0,get:function(){return j.ViewportRootElementImpl}}),t(uc,n),t(qf,n);var T=Sn;Object.defineProperty(n,"GCompartment",{enumerable:!0,get:function(){return T.SCompartmentImpl}}),Object.defineProperty(n,"GGraphIndex",{enumerable:!0,get:function(){return T.SGraphIndex}}),Object.defineProperty(n,"GLabel",{enumerable:!0,get:function(){return T.SLabelImpl}}),Object.defineProperty(n,"GNode",{enumerable:!0,get:function(){return T.SNodeImpl}}),Object.defineProperty(n,"GPort",{enumerable:!0,get:function(){return T.SPortImpl}}),Object.defineProperty(n,"SEdgeImpl",{enumerable:!0,get:function(){return T.SEdgeImpl}}),Object.defineProperty(n,"SGraphImpl",{enumerable:!0,get:function(){return T.SGraphImpl}});var $=gt;Object.defineProperty(n,"BezierCurveEdgeView",{enumerable:!0,get:function(){return $.BezierCurveEdgeView}}),Object.defineProperty(n,"GBezierControlHandleView",{enumerable:!0,get:function(){return $.SBezierControlHandleView}}),Object.defineProperty(n,"GBezierCreateHandleView",{enumerable:!0,get:function(){return $.SBezierCreateHandleView}}),Object.defineProperty(n,"GCompartmentView",{enumerable:!0,get:function(){return $.SCompartmentView}}),Object.defineProperty(n,"GLabelView",{enumerable:!0,get:function(){return $.SLabelView}}),Object.defineProperty(n,"GRoutingHandleView",{enumerable:!0,get:function(){return $.SRoutingHandleView}}),Object.defineProperty(n,"JumpingPolylineEdgeView",{enumerable:!0,get:function(){return $.JumpingPolylineEdgeView}}),Object.defineProperty(n,"PolylineEdgeView",{enumerable:!0,get:function(){return $.PolylineEdgeView}}),Object.defineProperty(n,"PolylineEdgeViewWithGapsOnIntersections",{enumerable:!0,get:function(){return $.PolylineEdgeViewWithGapsOnIntersections}}),Object.defineProperty(n,"SGraphView",{enumerable:!0,get:function(){return $.SGraphView}}),t(pc,n),t(pg,n),t(ti,n);var Q=Mt;Object.defineProperty(n,"CircularNode",{enumerable:!0,get:function(){return Q.CircularNode}}),Object.defineProperty(n,"CircularPort",{enumerable:!0,get:function(){return Q.CircularPort}}),Object.defineProperty(n,"DiamondNode",{enumerable:!0,get:function(){return Q.DiamondNode}}),Object.defineProperty(n,"GForeignObjectElement",{enumerable:!0,get:function(){return Q.ForeignObjectElementImpl}}),Object.defineProperty(n,"GHtmlRoot",{enumerable:!0,get:function(){return Q.HtmlRootImpl}}),Object.defineProperty(n,"GPreRenderedElement",{enumerable:!0,get:function(){return Q.PreRenderedElementImpl}}),Object.defineProperty(n,"GShapedPreRenderedElement",{enumerable:!0,get:function(){return Q.ShapedPreRenderedElementImpl}}),Object.defineProperty(n,"RectangularNode",{enumerable:!0,get:function(){return Q.RectangularNode}}),Object.defineProperty(n,"RectangularPort",{enumerable:!0,get:function(){return Q.RectangularPort}}),t(V0,n);var K=zn;Object.defineProperty(n,"EmptyGroupView",{enumerable:!0,get:function(){return K.EmptyGroupView}}),Object.defineProperty(n,"RectangularNodeView",{enumerable:!0,get:function(){return K.RectangularNodeView}}),Object.defineProperty(n,"SvgViewportView",{enumerable:!0,get:function(){return K.SvgViewportView}}),t(vs,n),t(mg,n),t(rr,n),t(sn,n),t(lA,n),t(ic,n),t(ei,n),t(wa,n),t(Io,n),t(qt,n),t(Zo,n),t(pn,n)})(bY);var Rr={},HY=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Rr,"__esModule",{value:!0});Rr.applyHiddenBoundingRect=Rr.hiddenBoundingRect=Rr.CircularNodeView=Rr.DiamondNodeView=void 0;const Xye=ct,KY=k,ry=d0;let x8=class extends ry.DiamondNodeView{render(e,t,i){return G7(e,t,super.render(e,t,i))}};Rr.DiamondNodeView=x8;Rr.DiamondNodeView=x8=HY([(0,KY.injectable)()],x8);let H8=class extends ry.CircularNodeView{render(e,t,i){return G7(e,t,super.render(e,t,i))}};Rr.CircularNodeView=H8;Rr.CircularNodeView=H8=HY([(0,KY.injectable)()],H8);function VY(n,e){return!e||e.targetKind==="hidden"?(0,ry.svg)("rect",{attrs:{[ry.ATTR_BBOX_ELEMENT]:!0},...Xye.Bounds.dimension(n.bounds),style:{fill:"transparent"}}):void 0}Rr.hiddenBoundingRect=VY;function G7(n,e,t){var i;if(t&&e.targetKind==="hidden"){const o=t.sel==="g"?t:(0,ry.svg)("g",null,t);return(i=o.children)===null||i===void 0||i.unshift(VY(n)),o}return t}Rr.applyHiddenBoundingRect=G7;var yR={};Object.defineProperty(yR,"__esModule",{value:!0});yR.TYPES=void 0;const Jye=d0,Tx=Symbol("IGModelRootListener");yR.TYPES={...Jye.TYPES,IAsyncClipboardService:Symbol("IAsyncClipboardService"),IEditorContextServiceProvider:Symbol("IEditorContextProvider"),IFeedbackActionDispatcher:Symbol("IFeedbackActionDispatcher"),IToolFactory:Symbol("Factory<Tool>"),ITypeHintProvider:Symbol("ITypeHintProvider"),IMovementRestrictor:Symbol("IMovementRestrictor"),ISelectionListener:Symbol("ISelectionListener"),ISModelRootListener:Tx,IGModelRootListener:Tx,IContextMenuProvider:Symbol("IContextMenuProvider"),ICopyPasteHandler:Symbol("ICopyPasteHandler"),ITool:Symbol("ITool"),IDefaultTool:Symbol("IDefaultTool"),IEditModeListener:Symbol("IEditModeListener"),IMarqueeBehavior:Symbol("IMarqueeBehavior"),IHelperLineManager:Symbol("IHelperLineManager"),IHelperLineOptions:Symbol("IHelperLineOptions"),IElementNavigator:Symbol("IElementNavigator"),ILocalElementNavigator:Symbol("ILocalElementNavigator"),IDiagramOptions:Symbol("IDiagramOptions"),IDiagramStartup:Symbol("IDiagramStartup"),IToolManager:Symbol("IToolManager"),IContainerManager:Symbol("IContainerManager"),IChangeBoundsManager:Symbol("IChangeBoundsManager"),IGridManager:Symbol("IGridManager"),IDebugManager:Symbol("IDebugManager"),Grid:Symbol("Grid")};(function(n){var e=f&&f.__createBinding||(Object.create?function(i,o,r,s){s===void 0&&(s=r);var a=Object.getOwnPropertyDescriptor(o,r);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,s,a)}:function(i,o,r,s){s===void 0&&(s=r),i[s]=o[r]}),t=f&&f.__exportStar||function(i,o){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(o,r)&&e(o,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),t(Xd,n),t(Nt,n),t(bY,n),t(Rr,n),t(yR,n)})(z);var Qf={},zY=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},GY=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Dx=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Qf,"__esModule",{value:!0});Qf.GLSPActionHandlerRegistry=void 0;const u3=z,l3=k;let QC=class extends u3.ActionHandlerRegistry{constructor(e=[],t=[]){super(e,t),this.initialized=!1}getHandledActionKinds(){return Array.from(this.elements.keys())}initialize(){this.initialized||(this.lazyInjector.getAll(u3.TYPES.ActionHandlerRegistration).forEach(e=>this.register(e.actionKind,e.factory())),this.lazyInjector.getAll(u3.TYPES.IActionHandlerInitializer).forEach(e=>this.initializeActionHandler(e)))}};Qf.GLSPActionHandlerRegistry=QC;zY([(0,l3.inject)(u3.LazyInjector),GY("design:type",Object)],QC.prototype,"lazyInjector",void 0);Qf.GLSPActionHandlerRegistry=QC=zY([(0,l3.injectable)(),Dx(0,(0,l3.optional)()),Dx(1,(0,l3.optional)()),GY("design:paramtypes",[Array,Array])],QC);var Ro={},bR=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},d_=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Ro,"__esModule",{value:!0});Ro.GLSPModelSource=Ro.OptionalAction=Ro.ServerAction=void 0;const kl=z,SR=k;var XC;(function(n){function e(i){return kl.Action.is(i)&&"__receivedFromServer"in i&&i.__receivedFromServer===!0}n.is=e;function t(i){i.__receivedFromServer=!0}n.mark=t})(XC||(Ro.ServerAction=XC={}));var Ox;(function(n){function e(i){return kl.Action.is(i)&&"__skipErrorIfNoHandler"in i&&i.__skipErrorIfNoHandler===!0}n.is=e;function t(i){return i.__skipErrorIfNoHandler=!0,i}n.mark=t})(Ox||(Ro.OptionalAction=Ox={}));let sm=class extends kl.ModelSource{constructor(){super(...arguments),this.toDispose=new kl.DisposableCollection}get diagramType(){return this.options.diagramType}get sourceUri(){return this.options.sourceUri}configure(e){if(this.glspClient=e,!e.initializeResult)throw new Error("Could not configure model source. The GLSP client is not initialized yet!");const t=this.createInitializeClientSessionParameters(e.initializeResult);return this.configureServeActions(e.initializeResult),this.toDispose.push(e.onActionMessage(i=>this.messageReceived(i),this.clientId),kl.Disposable.create(()=>e.disposeClientSession(this.createDisposeClientSessionParameters()))),e.initializeClientSession(t)}createInitializeClientSessionParameters(e){const t=this.registry.getHandledActionKinds();return{clientSessionId:this.clientId,clientActionKinds:t,diagramType:this.diagramType}}createDisposeClientSessionParameters(){return{clientSessionId:this.clientId}}configureServeActions(e){const t=e.serverActions[this.diagramType];if((t==null?void 0:t.length)===0)throw new Error(`No server-handled actions could be derived from the initialize result for diagramType: ${this.diagramType}!`);t.forEach(i=>this.registry.register(i,this))}messageReceived(e){if(this.clientId!==e.clientId)return;const t=e.action;XC.mark(t),this.logger.log(this,"receiving",t),this.actionDispatcher.dispatch(t)}initialize(e){var t;this.clientId||(this.clientId=(t=this.options.clientId)!==null&&t!==void 0?t:this.viewerOptions.baseDiv),this.registry=e}handle(e){this.shouldForwardToServer(e)&&this.forwardToServer(e)}forwardToServer(e){const t={clientId:this.clientId,action:e};if(this.logger.log(this,"sending",t),this.glspClient)this.glspClient.sendActionMessage(t);else throw new Error("GLSPClient is not connected")}shouldForwardToServer(e){return!XC.is(e)}commitModel(e){return this._currentRoot=e,e}get model(){return this._currentRoot}dispose(){this.toDispose.dispose()}};Ro.GLSPModelSource=sm;bR([(0,SR.inject)(kl.TYPES.ILogger),d_("design:type",Object)],sm.prototype,"logger",void 0);bR([(0,SR.inject)(kl.TYPES.IDiagramOptions),d_("design:type",Object)],sm.prototype,"options",void 0);bR([(0,SR.preDestroy)(),d_("design:type",Function),d_("design:paramtypes",[]),d_("design:returntype",void 0)],sm.prototype,"dispose",null);Ro.GLSPModelSource=sm=bR([(0,SR.injectable)()],sm);var ys={},UY=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(ys,"__esModule",{value:!0});ys.DefaultModelInitializationConstraint=ys.ModelInitializationConstraint=void 0;const YY=k,Pp=z;let JC=class{constructor(){this.completion=new Pp.Deferred,this._isCompleted=!1,this.onInitializedEmitter=new Pp.Emitter}get isCompleted(){return this._isCompleted}onInitialized(e){return e?this.isCompleted?(e(),Pp.Disposable.empty()):this.onInitializedEmitter.event(e):this.completion.promise}setCompleted(){this.isCompleted||(this._isCompleted=!0,this.completion.resolve(),this.onInitializedEmitter.fire(),this.onInitializedEmitter.dispose())}notifyDispatched(e){this.isCompleted||this.isInitializedAfter(e)&&this.setCompleted()}};ys.ModelInitializationConstraint=JC;ys.ModelInitializationConstraint=JC=UY([(0,YY.injectable)()],JC);let K8=class extends JC{constructor(){super(...arguments),this.seenNonEmptyModelAction=!1}isInitializedAfter(e){if(this.isNonEmptyModelAction(e))this.seenNonEmptyModelAction=!0;else if(this.seenNonEmptyModelAction&&e.kind===Pp.InitializeCanvasBoundsAction.KIND)return!0;return!1}isNonEmptyModelAction(e){return Pp.SetModelAction.is(e)||Pp.UpdateModelAction.is(e)?e.newRoot.type!=="NONE":!1}};ys.DefaultModelInitializationConstraint=K8;ys.DefaultModelInitializationConstraint=K8=UY([(0,YY.injectable)()],K8);var qY=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},e0e=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Pt,"__esModule",{value:!0});Pt.GLSPActionDispatcher=void 0;const Gh=z,WY=k,t0e=Qf,n0e=Ro,Lx=ys;let eP=class extends Gh.ActionDispatcher{constructor(){super(...arguments),this.timeouts=new Map,this.initializedConstraint=!1,this.postUpdateQueue=[]}initialize(){return this.initialized||(this.initialized=this.doInitialize()),this.initialized}async doInitialize(){const e=await this.actionHandlerRegistryProvider();this.actionHandlerRegistry=e,e instanceof t0e.GLSPActionHandlerRegistry&&e.initialize(),this.handleAction(Gh.SetModelAction.create(Gh.EMPTY_ROOT)).catch(()=>{}),this.startModelInitialization()}startModelInitialization(){this.initializedConstraint||(this.logger.log(this,"Starting model initialization mode"),this.initializationConstraint.onInitialized(()=>this.logger.log(this,"Model initialization completed")),this.initializedConstraint=!0)}onceModelInitialized(){return this.initializationConstraint.onInitialized()}hasHandler(e){return this.actionHandlerRegistry.get(e.kind).length>0}dispatchOnceModelInitialized(...e){this.initializationConstraint.onInitialized(()=>this.dispatchAll(e))}dispatchAfterNextUpdate(...e){this.postUpdateQueue.push(...e)}modelRootChanged(e){if(this.postUpdateQueue.length===0)return;const t=[...this.postUpdateQueue];this.postUpdateQueue=[],this.dispatchAll(t)}async dispatch(e){const t=await super.dispatch(e);return this.initializationConstraint.notifyDispatched(e),t}handleAction(e){if(Gh.ResponseAction.hasValidResponseId(e)){const t=this.timeouts.get(e.responseId);t!==void 0&&(clearTimeout(t),this.timeouts.delete(e.responseId)),this.requests.get(e.responseId)===void 0&&(e.responseId="")}return!this.hasHandler(e)&&n0e.OptionalAction.is(e)?Promise.resolve():super.handleAction(e)}request(e){return!e.requestId&&e.requestId===""&&(e.requestId=Gh.RequestAction.generateRequestId()),super.request(e)}requestUntil(e,t=2e3,i=!1){!e.requestId&&e.requestId===""&&(e.requestId=Gh.RequestAction.generateRequestId());const o=e.requestId,r=setTimeout(()=>{const s=this.requests.get(o);if(s!==void 0){clearTimeout(r),this.requests.delete(o);const a="Request "+o+" ("+e+") time out after "+t+"ms.";i?s.reject(a):(this.logger.info(this,a),s.resolve())}},t);return this.timeouts.set(o,r),super.request(e)}};Pt.GLSPActionDispatcher=eP;qY([(0,WY.inject)(Lx.ModelInitializationConstraint),e0e("design:type",Lx.ModelInitializationConstraint)],eP.prototype,"initializationConstraint",void 0);Pt.GLSPActionDispatcher=eP=qY([(0,WY.injectable)()],eP);var Cg={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.ensureArgs=n.hasArgs=n.isArgsAware=n.argsFeature=void 0,n.argsFeature=Symbol("argsFeature");function e(o){return o!==void 0&&o.hasFeature(n.argsFeature)}n.isArgsAware=e;function t(o){return o!==void 0&&e(o)&&o.args!==void 0}n.hasArgs=t;function i(o){return e(o)?(o.args===void 0&&(o.args={}),!0):!1}n.ensureArgs=i})(Cg);var nb={};Object.defineProperty(nb,"__esModule",{value:!0});nb.AutoCompleteValue=void 0;const jx=z;var Nx;(function(n){function e(t){return jx.LabeledAction.is(t)&&(0,jx.hasStringProp)(t,"text")}n.is=e})(Nx||(nb.AutoCompleteValue=Nx={}));var uu={},Wl={};Object.defineProperty(Wl,"__esModule",{value:!0});Wl.ValidationDecorator=Wl.IValidationDecorator=void 0;const PE=z;var Bx;(function(n){n.NO_DECORATION={decorateValidationResult(e){},isValidatedOk(){return!1},invalidate(){},dispose(){}}})(Bx||(Wl.IValidationDecorator=Bx={}));class i0e{constructor(e){this.containerElement=e,this.warningClasses=["warning"],this.warningIconClasses=(0,PE.codiconCSSString)("warning"),this.errorClasses=["error"],this.errorIconClasses=(0,PE.codiconCSSString)("error"),this.isValidated=!1,this.hasValidationError=!1}decorateValidationResult(e){PE.ValidationStatus.isError(e)?(this.hasValidationError=!0,this.decorateError(e.message?e.message:"Error")):PE.ValidationStatus.isWarning(e)?(this.hasValidationError=!1,this.decorateWarning(e.message?e.message:"Warning")):(this.hasValidationError=!1,this.dispose()),this.isValidated=!0}decorateError(e){this.switchCssClasses(this.containerElement,this.errorClasses);const t=this.createDecorationDiv();this.switchCssClasses(t,this.errorClasses),t.innerHTML=`<span class="${this.errorIconClasses}"></span> ${e}`,this.adjustPosition()}decorateWarning(e){this.switchCssClasses(this.containerElement,this.warningClasses);const t=this.createDecorationDiv();this.switchCssClasses(t,this.warningClasses),t.innerHTML=`<span class="${this.warningIconClasses}"></span> ${e}`,this.adjustPosition()}switchCssClasses(e,t){e.classList.remove(...this.errorClasses,...this.warningClasses),e.classList.add(...t)}createDecorationDiv(){return this.decorationDiv||(this.containerElement.classList.add("validation"),this.decorationDiv=document.createElement("div"),this.decorationDiv.style.width=`${this.decorationContainerWidth()}px`,this.decorationDiv.classList.add("validation-decorator"),this.containerElement.appendChild(this.decorationDiv)),this.decorationDiv}decorationContainerWidth(){return this.containerElement.clientWidth-5}adjustPosition(){if(this.decorationDiv){const e=this.decorationDiv.clientHeight+2;this.decorationDiv.style.top=`-${e}px`}}isValidatedOk(){return this.isValidated&&!this.hasValidationError}invalidate(){this.isValidated=!1}dispose(){this.hasValidationError=!1,this.isValidated=!1,this.decorationDiv&&this.containerElement&&this.containerElement.contains(this.decorationDiv)&&(this.containerElement.removeChild(this.decorationDiv),this.switchCssClasses(this.containerElement,[]),this.decorationDiv=void 0)}}Wl.ValidationDecorator=i0e;Object.defineProperty(uu,"__esModule",{value:!0});uu.toActionArray=uu.AutoCompleteWidget=void 0;const Sl=z,o0e=nb,$x=Wl,r0e=AG;class s0e{constructor(e,t,i,o=()=>{},r,s){this.autoSuggestionSettings=e,this.suggestionProvider=t,this.suggestionSubmitHandler=i,this.notifyClose=o,this.logger=r,this.options=s,this.loadingIndicatorClasses=(0,Sl.codiconCSSClasses)("loading",!1,!0,["loading"]),this.validationDecorator=$x.IValidationDecorator.NO_DECORATION}configureValidation(e,t=$x.IValidationDecorator.NO_DECORATION){this.inputValidator=e,this.validationDecorator=t}configureTextSubmitHandler(e){this.textSubmitHandler=e}initialize(e){this.containerElement=e,this.inputElement=this.createInputElement(),this.containerElement.appendChild(this.inputElement),this.containerElement.style.position="absolute"}createInputElement(){const e=document.createElement("input");return e.style.position="absolute",e.spellcheck=!1,e.autocapitalize="false",e.autocomplete="off",e.style.width="100%",e.addEventListener("keydown",t=>this.handleKeyDown(t)),e.addEventListener("blur",()=>{this.containerElement.style.visibility!=="hidden"&&window.setTimeout(()=>this.notifyClose("blur"),200)}),e}handleKeyDown(e){if((0,Sl.matchesKeystroke)(e,"Escape")){this.notifyClose("escape");return}if(!((0,Sl.matchesKeystroke)(e,"Enter")&&!this.isInputElementChanged()&&this.isSuggestionAvailable())&&(this.isInputElementChanged()&&this.invalidateValidationResultAndContextActions(),!(!(0,Sl.matchesKeystroke)(e,"Enter")||this.isSuggestionAvailable()))){if(!this.validationDecorator.isValidatedOk()){e.stopImmediatePropagation();return}this.textSubmitHandler&&(this.executeFromTextOnlyInput(),this.notifyClose("submission"))}}isInputElementChanged(){return this.inputElement.value!==this.previousContent}invalidateValidationResultAndContextActions(){this.contextActions=void 0,this.validationDecorator.invalidate()}open(e,...t){this.contextActions=void 0,this.autoCompleteResult=r0e(this.autocompleteSettings(e)),this.previousContent=this.inputElement.value,this.inputElement.setSelectionRange(0,this.inputElement.value.length),this.inputElement.focus()}autocompleteSettings(e){return{input:this.inputElement,emptyMsg:this.autoSuggestionSettings.noSuggestionsMessage,className:this.autoSuggestionSettings.suggestionsClass,showOnFocus:this.autoSuggestionSettings.showOnFocus,debounceWaitMs:this.autoSuggestionSettings.debounceWaitMs,minLength:-1,fetch:(t,i)=>this.updateSuggestions(i,t,e),onSelect:t=>this.onSelect(t),render:(t,i)=>this.renderSuggestions(t,i),customize:(t,i,o,r)=>{this.customizeInputElement(t,i,o,r)}}}customizeInputElement(e,t,i,o){var r;if(i.style.position="fixed",this.containerElement&&(this.containerElement.appendChild(i),this.options&&this.options.selectedSuggestionChanged)){const s=i.querySelector(".selected");if(s!=null){const a=Array.from(i.children).indexOf(s);this.options.selectedSuggestionChanged((r=this.contextActions)===null||r===void 0?void 0:r[a])}else this.options.selectedSuggestionChanged(void 0)}}updateSuggestions(e,t,i,...o){this.onLoading(),this.doUpdateSuggestions(t,i).then(r=>{var s,a;this.contextActions=this.filterActions(t,r),e(this.contextActions),(a=(s=this.options)===null||s===void 0?void 0:s.visibleSuggestionsChanged)===null||a===void 0||a.call(s,this.contextActions),this.onLoaded("success")}).catch(r=>{this.logger&&this.logger.error(this,"Failed to obtain suggestions",r),this.onLoaded("error")})}onLoading(){this.loadingIndicator&&this.containerElement.contains(this.loadingIndicator)||(this.loadingIndicator=document.createElement("span"),this.loadingIndicator.classList.add(...this.loadingIndicatorClasses),this.containerElement.appendChild(this.loadingIndicator))}doUpdateSuggestions(e,t,...i){return this.suggestionProvider.provideSuggestions(e)}onLoaded(e){this.containerElement.contains(this.loadingIndicator)&&this.containerElement.removeChild(this.loadingIndicator),this.validationDecorator.invalidate(),this.validateInputIfNoContextActions(),this.previousContent=this.inputElement.value}renderSuggestions(e,t){const i=document.createElement("div"),o=this.escapeForRegExp(t).split(" ").join("|"),r=new RegExp(o,"gi");return e.icon&&this.renderIcon(i,e.icon),i.innerHTML+=e.label.replace(r,s=>"<em>"+s+"</em>").replace(/ /g,"&nbsp;"),i}escapeForRegExp(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}renderIcon(e,t){e.innerHTML+=`<span class="icon ${t}"></span>`}filterActions(e,t){return(0,Sl.toArray)(t.filter(i=>{const o=i.label.toLowerCase();return e.split(" ").every(s=>o.indexOf(s.toLowerCase())!==-1)}))}onSelect(e){o0e.AutoCompleteValue.is(e)?(this.inputElement.value=e.text,window.setTimeout(()=>this.inputElement.dispatchEvent(new Event("input")))):(this.executeFromSuggestion(e),this.notifyClose("submission"))}validateInputIfNoContextActions(){this.isNoOrExactlyOneMatchingContextAction()?this.validateInput():this.validationDecorator.dispose()}isNoOrExactlyOneMatchingContextAction(){return!this.isSuggestionAvailable()||this.contextActions&&this.contextActions.length===1&&this.inputElement.value.endsWith(this.contextActions[0].label)}isSuggestionAvailable(){return this.contextActions&&this.contextActions.length>0}validateInput(){this.inputValidator&&this.inputValidator.validate(this.inputElement.value).then(e=>this.validationDecorator.decorateValidationResult(e)).catch(e=>this.handleErrorDuringValidation(e))}handleErrorDuringValidation(e){this.logger&&this.logger.error(this,"Failed to validate input",e),this.validationDecorator.dispose()}executeFromSuggestion(e){this.suggestionSubmitHandler.executeFromSuggestion(e)}executeFromTextOnlyInput(){this.textSubmitHandler&&this.textSubmitHandler.executeFromTextOnlyInput(this.inputElement.value)}get inputField(){return this.inputElement}dispose(){this.validationDecorator.dispose(),this.autoCompleteResult&&this.autoCompleteResult.destroy()}}uu.AutoCompleteWidget=s0e;function a0e(n){return Sl.LabeledAction.is(n)?n.actions:Sl.Action.is(n)?[n]:[]}uu.toActionArray=a0e;var ZY={};Object.defineProperty(ZY,"__esModule",{value:!0});var ib={},Ms={};(function(n){var e=f&&f.__decorate||function(r,s,a,u){var h=arguments.length,g=h<3?s:u===null?u=Object.getOwnPropertyDescriptor(s,a):u,y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(r,s,a,u);else for(var S=r.length-1;S>=0;S--)(y=r[S])&&(g=(h<3?y(g):h>3?y(s,a,g):y(s,a))||g);return h>3&&g&&Object.defineProperty(s,a,g),g};Object.defineProperty(n,"__esModule",{value:!0}),n.GLSPAbstractUIExtension=n.CSS_HIDDEN_EXTENSION_CLASS=n.CSS_UI_EXTENSION_CLASS=void 0;const t=z,i=k;n.CSS_UI_EXTENSION_CLASS="ui-extension",n.CSS_HIDDEN_EXTENSION_CLASS="hidden";let o=class extends t.AbstractUIExtension{get diagramContainerId(){return this.options.baseDiv}get parentContainerSelector(){return"#"+this.diagramContainerId}get containerSelector(){return"#"+this.id()}get initialized(){return!!this.containerElement}initialize(){if(this.initialized)return!0;try{this.containerElement=this.getOrCreateContainer(),this.initializeContainer(this.containerElement),this.initializeContents(this.containerElement)}catch(s){const a=s instanceof Error?s.message:`Could not retrieve container element for UI extension ${this.id}`;return this.logger.error(this,a),!1}return!0}getOrCreateContainer(){if(this.containerElement)return this.containerElement;const s=this.getContainer();if(s)return s;const a=this.getParentContainer();if(!(a!=null&&a.isConnected))throw new Error(`Could not obtain attached parent for initializing UI extension ${this.id}`);const u=this.createContainer(a);return this.insertContainerIntoParent(u,a),u}getContainer(){return document.querySelector(this.containerSelector)}createContainer(s){const a=document.createElement("div");return a.id=s.id+"_"+this.id(),a}initializeContainer(s){s.classList.add(n.CSS_UI_EXTENSION_CLASS,this.containerClass())}getParentContainer(){return document.querySelector(this.parentContainerSelector)}insertContainerIntoParent(s,a){a.insertBefore(s,a.firstChild)}setContainerVisible(s){var a,u;s?(a=this.containerElement)===null||a===void 0||a.classList.remove(n.CSS_HIDDEN_EXTENSION_CLASS):(u=this.containerElement)===null||u===void 0||u.classList.add(n.CSS_HIDDEN_EXTENSION_CLASS)}isContainerVisible(){var s;return!(!((s=this.containerElement)===null||s===void 0)&&s.classList.contains(n.CSS_HIDDEN_EXTENSION_CLASS))}toggleContainerVisible(){this.setContainerVisible(!this.isContainerVisible())}};n.GLSPAbstractUIExtension=o,n.GLSPAbstractUIExtension=o=e([(0,i.injectable)()],o)})(Ms);var c0e=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},d0e=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(ib,"__esModule",{value:!0});ib.BaseAutocompletePalette=void 0;const u0e=z,l0e=k,f0e=Pt,h0e=Ms,kx=uu;class QY extends h0e.GLSPAbstractUIExtension{constructor(){super(...arguments),this.autoSuggestionSettings={noSuggestionsMessage:"No suggestions available",suggestionsClass:"command-palette-suggestions",debounceWaitMs:50,showOnFocus:!0}}containerClass(){return"autocomplete-palette"}show(e,...t){super.show(e,...t),this.root=e,this.autocompleteWidget.open(e)}hide(){var e;(e=this.autocompleteWidget)===null||e===void 0||e.dispose(),this.root=void 0,super.hide()}initializeContents(e){e.classList.add("command-palette"),this.autocompleteWidget=new kx.AutoCompleteWidget(this.autoSuggestionSettings,{provideSuggestions:t=>this.retrieveSuggestions(this.root,t)},{executeFromSuggestion:t=>this.executeSuggestion(t)},t=>this.autocompleteHide(t),this.logger,{visibleSuggestionsChanged:t=>this.visibleSuggestionsChanged(this.root,t),selectedSuggestionChanged:t=>this.selectedSuggestionChanged(this.root,t)}),this.autocompleteWidget.initialize(e)}async visibleSuggestionsChanged(e,t){}async selectedSuggestionChanged(e,t){}autocompleteHide(e){this.hide()}executeSuggestion(e){this.actionDispatcher.dispatchAll((0,kx.toActionArray)(e))}}ib.BaseAutocompletePalette=QY;c0e([(0,l0e.inject)(u0e.TYPES.IActionDispatcher),d0e("design:type",f0e.GLSPActionDispatcher)],QY.prototype,"actionDispatcher",void 0);var Pg={},An={},Vc={},Ma={};Object.defineProperty(Ma,"__esModule",{value:!0});Ma.FocusStateChangedAction=void 0;const Fx=z;var xx;(function(n){n.KIND="focusStateChanged";function e(i){return Fx.Action.hasKind(i,n.KIND)&&(0,Fx.hasBooleanProp)(i,"hasFocus")}n.is=e;function t(i=!0){return{kind:n.KIND,hasFocus:i}}n.create=t})(xx||(Ma.FocusStateChangedAction=xx={}));var XY=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},p0e=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Vc,"__esModule",{value:!0});Vc.FocusTracker=void 0;const JY=z,eq=k,m0e=Ma;let tP=class{constructor(){this.inActiveCssClass="inactive",this._hasFocus=!0,this.onFocusChangedEmitter=new JY.Emitter}get onFocusChanged(){return this.onFocusChangedEmitter.event}get hasFocus(){return this._hasFocus}get focusElement(){return this._focusElement}get diagramElement(){return this._diagramElement}handle(e){m0e.FocusStateChangedAction.is(e)&&(this._hasFocus=e.hasFocus,this._focusElement=document.activeElement,this._diagramElement=document.getElementById(this.options.baseDiv),this._diagramElement&&(this.hasFocus?this._diagramElement.classList.contains(this.inActiveCssClass)&&this._diagramElement.classList.remove(this.inActiveCssClass):this._diagramElement.classList.add(this.inActiveCssClass),this.onFocusChangedEmitter.fire({hasFocus:this.hasFocus,focusElement:this.focusElement,diagramElement:this.diagramElement})))}};Vc.FocusTracker=tP;XY([(0,eq.inject)(JY.TYPES.ViewerOptions),p0e("design:type",Object)],tP.prototype,"options",void 0);Vc.FocusTracker=tP=XY([(0,eq.injectable)()],tP);var Yt={},kt={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.removeDescendants=n.isNotDescendantOfAnyElement=n.getDescendantIds=n.isVisibleOnCanvas=n.calculateDeltaBetweenPoints=n.findTopLevelElementByFeature=n.getElementTypeId=n.calcRoute=n.calcElementAndRoute=n.calcElementAndRoutingPoints=n.ROUTE_KINDS=n.ROUTING_POINT_KINDS=n.ALL_ROUTING_POINTS=n.toElementAndRoutingPoints=n.toElementAndBounds=n.isSelectableAndBoundsAware=n.isRoutingHandle=n.isRoutable=n.isNonRoutableSelectedBoundsAware=n.isNonRoutableSelectedMovableBoundsAware=n.toggleCssClass=n.removeCssClassOfElements=n.addCssClassToElements=n.removeCssClasses=n.addCssClasses=n.isNotUndefined=n.hasSelectedElements=n.getSelectedElementCount=n.getElements=n.getMatchingElements=n.forEachElement=n.filter=void 0;const e=z;function t(H,M){return H.all().filter(M)}n.filter=t;function i(H,M,Y){t(H,M).forEach(Y)}n.forEachElement=i;function o(H,M){return Array.from(t(H,M))}n.getMatchingElements=o;function r(H,M,Y){const te=ue=>ue!==void 0?Y?Y(ue):!0:!1;return M.map(ue=>H.getById(ue)).filter(te)}n.getElements=r;function s(H){let M=0;return i(H,e.isSelected,Y=>M++),M}n.getSelectedElementCount=s;function a(H){return s(H)>0}n.hasSelectedElements=a;function u(H){return H!==void 0}n.isNotUndefined=u;function h(H,...M){var Y;const te=Array.isArray(M[0])?M[0]:M,ue=(Y=H.cssClasses)!==null&&Y!==void 0?Y:[];(0,e.distinctAdd)(ue,...te),H.cssClasses=ue}n.addCssClasses=h;function g(H,...M){if(!H.cssClasses||H.cssClasses.length===0)return;const Y=Array.isArray(M[0])?M[0]:M;(0,e.remove)(H.cssClasses,...Y)}n.removeCssClasses=g;function y(H,...M){for(const Y of H)h(Y,M)}n.addCssClassToElements=y;function S(H,...M){for(const Y of H)g(Y,M)}n.removeCssClassOfElements=S;function w(H,M,Y){return Y?h(H,M):g(H,M)}n.toggleCssClass=w;function P(H){return E(H)&&(0,e.isMoveable)(H)}n.isNonRoutableSelectedMovableBoundsAware=P;function E(H){return(0,e.isBoundsAware)(H)&&(0,e.isSelected)(H)&&!A(H)}n.isNonRoutableSelectedBoundsAware=E;function A(H){return H instanceof e.GRoutableElement&&H.routingPoints!==void 0}n.isRoutable=A;function L(H){return H!==void 0&&H instanceof e.GRoutingHandle}n.isRoutingHandle=L;function B(H){return(0,e.isSelectable)(H)&&(0,e.isBoundsAware)(H)}n.isSelectableAndBoundsAware=B;function U(H){return{elementId:H.id,newPosition:{x:H.bounds.x,y:H.bounds.y},newSize:{width:H.bounds.width,height:H.bounds.height}}}n.toElementAndBounds=U;function p(H){return{elementId:H.id,newRoutingPoints:H.routingPoints}}n.toElementAndRoutingPoints=p,n.ALL_ROUTING_POINTS=void 0,n.ROUTING_POINT_KINDS=["linear","bezier-junction"],n.ROUTE_KINDS=[...n.ROUTING_POINT_KINDS,"source","target"];function b(H,M){const Y=M?R(H,M,n.ROUTING_POINT_KINDS):H.routingPoints;return{elementId:H.id,newRoutingPoints:Y}}n.calcElementAndRoutingPoints=b;function v(H,M){var Y,te;let ue=M?R(H,M,n.ROUTE_KINDS):void 0;return ue||(ue=[...H.routingPoints],ue.splice(0,0,((Y=H.source)===null||Y===void 0?void 0:Y.position)||e.Point.ORIGIN),ue.push(((te=H.target)===null||te===void 0?void 0:te.position)||e.Point.ORIGIN)),{elementId:H.id,newRoutingPoints:ue}}n.calcElementAndRoute=v;function R(H,M,Y=n.ALL_ROUTING_POINTS,te=Number.EPSILON){const ue=M.get(H.routerKind).route(H),Re=[];for(const ae of ue)Y&&!Y.includes(ae.kind)||n.ROUTING_POINT_KINDS.includes(ae.kind)&&Re.find(ot=>e.Point.maxDistance(ae,ot)<te)||Re.push(ae);return Re}n.calcRoute=R;function D(H){return typeof H=="string"?H:H.type}n.getElementTypeId=D;function j(H,M,Y=te=>!1){let te,ue=H;for(;ue!==void 0;)!Y(ue)&&M(ue)&&(te=ue),ue instanceof e.GChildElement?ue=ue.parent:ue=void 0;return te}n.findTopLevelElementByFeature=j;function T(H,M,Y){const te=e.Point.subtract(H,M),ue=(0,e.getZoom)(Y);return e.Point.divideScalar(te,ue)}n.calculateDeltaBetweenPoints=T;function $(H){const M=(0,e.getAbsoluteBounds)(H),Y=H.root.canvasBounds;return M.x<=Y.width&&M.x+M.width>=0&&M.y<=Y.height&&M.y+M.height>=0}n.isVisibleOnCanvas=$;function Q(H,M){if(!H||M!=null&&M(H))return[];const Y=H,te=[Y.id];return Y instanceof e.GParentElement&&te.push(...Y.children.flatMap(ue=>Q(ue,M))),te}n.getDescendantIds=Q;function K(H){const M=new Set(H);return Y=>{let te=Y;for(;te instanceof e.GChildElement;)if(te=te.parent,M.has(te))return!1;return!0}}n.isNotDescendantOfAnyElement=K;function Z(H){return H.filter(K(H))}n.removeDescendants=Z})(kt);var xu=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},cs=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},nP=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.SelectFeedbackAction=Yt.SelectAllCommand=Yt.SelectCommand=Yt.SelectionService=void 0;const Kt=z,Ir=k,iP=kt;let jr=class{constructor(){this.selectedElementIDs=new Set,this.toDispose=new Kt.DisposableCollection,this.onSelectionChangedEmitter=new Kt.Emitter}initialize(){this.toDispose.push(this.onSelectionChangedEmitter)}preLoadDiagram(){this.lazyInjector.getAll(Kt.TYPES.ISelectionListener).forEach(e=>this.onSelectionChanged(t=>e.selectionChanged(t.root,t.selectedElements,t.deselectedElements)))}dispose(){this.toDispose.dispose()}get onSelectionChanged(){return this.onSelectionChangedEmitter.event}modelRootChanged(e){this.updateSelection(e,[],[])}updateSelection(e,t,i){if(e===void 0&&t.length===0&&i.length===0)return;const o=this.root,r=new Set(this.selectedElementIDs);this.root=e;const s=[...t].filter(g=>i.indexOf(g)===-1),a=[...i].filter(g=>t.indexOf(g)===-1&&this.selectedElementIDs.has(g));a.forEach(g=>this.selectedElementIDs.delete(g)),s.forEach(g=>this.selectedElementIDs.add(g));const u=new Set(a);for(const g of this.selectedElementIDs)e.index.getById(g)===void 0&&(this.selectedElementIDs.delete(g),o!=null&&o.index.getById(g)&&u.add(g));(r.size!==this.selectedElementIDs.size||![...r].every(g=>this.selectedElementIDs.has(g)))&&(this.dispatchFeedback([V8.create({selectedElementsIDs:[...this.selectedElementIDs],deselectedElementsIDs:[...u]})]),this.notifyListeners(this.root,this.selectedElementIDs,u))}dispatchFeedback(e){this.feedbackDispatcher.registerFeedback(this,e)}notifyListeners(e,t,i){this.onSelectionChangedEmitter.fire({root:e,selectedElements:Array.from(t),deselectedElements:Array.from(i)})}getModelRoot(){return this.root}getSelectedElements(){return this.root?(0,iP.getElements)(this.root.index,Array.from(this.selectedElementIDs),Kt.isSelectable):[]}getSelectedElementIDs(){return[...this.selectedElementIDs]}hasSelectedElements(){return this.selectedElementIDs.size>0}isSingleSelection(){return this.selectedElementIDs.size===1}isMultiSelection(){return this.selectedElementIDs.size>1}};Yt.SelectionService=jr;xu([(0,Ir.inject)(Kt.TYPES.IFeedbackActionDispatcher),cs("design:type",Object)],jr.prototype,"feedbackDispatcher",void 0);xu([(0,Ir.inject)(Kt.LazyInjector),cs("design:type",Object)],jr.prototype,"lazyInjector",void 0);xu([(0,Ir.inject)(Kt.TYPES.ILogger),cs("design:type",Object)],jr.prototype,"logger",void 0);xu([(0,Ir.postConstruct)(),cs("design:type",Function),cs("design:paramtypes",[]),cs("design:returntype",void 0)],jr.prototype,"initialize",null);xu([(0,Ir.preDestroy)(),cs("design:type",Function),cs("design:paramtypes",[]),cs("design:returntype",void 0)],jr.prototype,"dispose",null);Yt.SelectionService=jr=xu([(0,Ir.injectable)()],jr);let oP=class extends Kt.Command{constructor(e,t){super(),this.action=e,this.selectionService=t,this.selected=[],this.deselected=[]}execute(e){const t=e.root,i=s=>s instanceof Kt.GChildElement&&(0,Kt.isSelectable)(s),o=(0,iP.getElements)(t.index,this.action.selectedElementsIDs,i),r=this.action.deselectAll?this.selectionService.getSelectedElements():(0,iP.getElements)(t.index,this.action.deselectedElementsIDs,i);return this.selectionService.updateSelection(t,(0,Kt.pluck)(o,"id"),(0,Kt.pluck)(r,"id")),t}undo(e){return e.root}redo(e){return e.root}};Yt.SelectCommand=oP;oP.KIND=Kt.SprottySelectCommand.KIND;Yt.SelectCommand=oP=xu([(0,Ir.injectable)(),nP(0,(0,Ir.inject)(Kt.TYPES.Action)),nP(1,(0,Ir.inject)(jr)),cs("design:paramtypes",[Object,jr])],oP);let rP=class extends Kt.Command{constructor(e,t){super(),this.action=e,this.selectionService=t,this.previousSelection=new Map}execute(e){const t=e.root,i=s=>s instanceof Kt.GChildElement&&(0,Kt.isSelectable)(s),o=(0,iP.getMatchingElements)(t.index,i),r=(0,Kt.pluck)(o,"id");return this.action.select?this.selectionService.updateSelection(t,r,[]):this.selectionService.updateSelection(t,[],r),t}undo(e){return e.root}redo(e){return e.root}};Yt.SelectAllCommand=rP;rP.KIND=Kt.SprottySelectAllCommand.KIND;Yt.SelectAllCommand=rP=xu([(0,Ir.injectable)(),nP(0,(0,Ir.inject)(Kt.TYPES.Action)),nP(1,(0,Ir.inject)(jr)),cs("design:paramtypes",[Object,jr])],rP);var V8;(function(n){n.KIND="selectFeedback";function e(s){return Kt.Action.hasKind(s,n.KIND)&&(0,Kt.hasArrayProp)(s,"selectedElementsIDs")&&(0,Kt.hasArrayProp)(s,"deselectedElementsIDs")}n.is=e;function t(s){return{...Kt.SelectAction.create(s),kind:n.KIND}}n.create=t;function i(s){return{...Kt.SelectAction.addSelection(s),kind:n.KIND}}n.addSelection=i;function o(s){return{...Kt.SelectAction.removeSelection(s),kind:n.KIND}}n.removeSelection=o;function r(s){return{...Kt.SelectAction.setSelection(s),kind:n.KIND}}n.setSelection=r})(V8||(Yt.SelectFeedbackAction=V8={}));var zc=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Tr=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(An,"__esModule",{value:!0});An.EditorContextService=void 0;const zi=z,Gc=k,Hx=Pt,Kx=Vc,Vx=Yt;let bs=class{constructor(){this.onEditModeChangedEmitter=new zi.Emitter,this.onDirtyStateChangedEmitter=new zi.Emitter,this.onModelRootChangedEmitter=new zi.Emitter,this.toDispose=new zi.DisposableCollection}get onEditModeChanged(){return this.onEditModeChangedEmitter.event}get onDirtyStateChanged(){return this.onDirtyStateChangedEmitter.event}get onModelRootChanged(){return this.onModelRootChangedEmitter.event}get onFocusChanged(){return this.focusTracker.onFocusChanged}get onSelectionChanged(){return this.selectionService.onSelectionChanged}initialize(){var e;this._editMode=(e=this.diagramOptions.editMode)!==null&&e!==void 0?e:zi.EditMode.EDITABLE,this.toDispose.push(this.onEditModeChangedEmitter,this.onDirtyStateChangedEmitter)}preLoadDiagram(){this.lazyInjector.getAll(zi.TYPES.IGModelRootListener).forEach(e=>{this.onModelRootChanged(t=>e.modelRootChanged(t))}),this.lazyInjector.getAll(zi.TYPES.IEditModeListener).forEach(e=>{this.onEditModeChanged(t=>e.editModeChanged(t.newValue,t.oldValue))})}dispose(){this.toDispose.dispose()}get(e){return{selectedElementIds:Array.from(this.selectionService.getSelectedElementIDs()),lastMousePosition:this.mousePositionTracker.lastPositionOnDiagram,args:e}}getWithSelection(e,t){return{selectedElementIds:e,lastMousePosition:this.mousePositionTracker.lastPositionOnDiagram,args:t}}notifyModelRootChanged(e,t){if(!(t instanceof zi.CommandStack))throw new Error("Invalid model root change notification. Notifier is not an instance of `CommandStack`.");this._modelRoot=e,this.onModelRootChangedEmitter.fire(e)}handle(e){zi.SetEditModeAction.is(e)?this.handleSetEditModeAction(e):zi.SetDirtyStateAction.is(e)&&this.handleSetDirtyStateAction(e)}handleSetEditModeAction(e){const t=this._editMode;this._editMode=e.editMode,this.onEditModeChangedEmitter.fire({newValue:this.editMode,oldValue:t})}handleSetDirtyStateAction(e){e.isDirty!==this._isDirty&&(this._isDirty=e.isDirty,this.onDirtyStateChangedEmitter.fire(e))}get sourceUri(){return this.diagramOptions.sourceUri}get editMode(){return this._editMode}get diagramType(){return this.diagramOptions.diagramType}get clientId(){return this.diagramOptions.clientId}get modelRoot(){if(!this._modelRoot)throw new Error("Model root not available yet");return this._modelRoot}get selectedElements(){return this.selectionService.getSelectedElements()}get isReadonly(){return this.editMode===zi.EditMode.READONLY}get isDirty(){return this._isDirty}};An.EditorContextService=bs;zc([(0,Gc.inject)(Vx.SelectionService),Tr("design:type",Vx.SelectionService)],bs.prototype,"selectionService",void 0);zc([(0,Gc.inject)(zi.MousePositionTracker),Tr("design:type",zi.MousePositionTracker)],bs.prototype,"mousePositionTracker",void 0);zc([(0,Gc.inject)(zi.LazyInjector),Tr("design:type",Object)],bs.prototype,"lazyInjector",void 0);zc([(0,Gc.inject)(zi.TYPES.IDiagramOptions),Tr("design:type",Object)],bs.prototype,"diagramOptions",void 0);zc([(0,Gc.inject)(Hx.GLSPActionDispatcher),Tr("design:type",Hx.GLSPActionDispatcher)],bs.prototype,"actionDispatcher",void 0);zc([(0,Gc.inject)(Kx.FocusTracker),Tr("design:type",Kx.FocusTracker)],bs.prototype,"focusTracker",void 0);zc([(0,Gc.postConstruct)(),Tr("design:type",Function),Tr("design:paramtypes",[]),Tr("design:returntype",void 0)],bs.prototype,"initialize",null);zc([(0,Gc.preDestroy)(),Tr("design:type",Function),Tr("design:paramtypes",[]),Tr("design:returntype",void 0)],bs.prototype,"dispose",null);An.EditorContextService=bs=zc([(0,Gc.injectable)()],bs);var U7=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},f3=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Pg,"__esModule",{value:!0});Pg.GLSPCommandStack=void 0;const xv=z,Y7=k,g0e=An;let sy=class extends xv.CommandStack{constructor(){super(...arguments),this.toDispose=new xv.DisposableCollection}dispose(){this.toDispose.dispose()}get editorContext(){return this.lazyInjector.get(g0e.EditorContextService)}get onModelRootChanged(){return this.editorContext.onModelRootChanged}undo(){return this.logger.warn(this,"GLSPCommandStack.undo() was called. This should never happen as the GLSP server is responsible for handling undo requests"),this.currentModel}redo(){return this.logger.warn(this,"GLSPCommandStack.redo() was called. This should never happen as the GLSP server is responsible for handling redo requests"),this.currentModel}async execute(e){if(e instanceof xv.SetModelCommand||e instanceof xv.UpdateModelCommand){const t=await super.execute(e);return this.notifyListeners(t),t}return super.execute(e)}notifyListeners(e){this.editorContext.notifyModelRootChanged(e,this)}};Pg.GLSPCommandStack=sy;U7([(0,Y7.inject)(xv.LazyInjector),f3("design:type",Object)],sy.prototype,"lazyInjector",void 0);U7([(0,Y7.preDestroy)(),f3("design:type",Function),f3("design:paramtypes",[]),f3("design:returntype",void 0)],sy.prototype,"dispose",null);Pg.GLSPCommandStack=sy=U7([(0,Y7.injectable)()],sy);var ob={},it={},Gn={},Is={};Object.defineProperty(Is,"__esModule",{value:!0});Is.Ranked=void 0;const zx=z;var Gx;(function(n){n.DEFAULT_RANK=0;function e(i){return zx.AnyObject.is(i)&&(0,zx.hasNumberProp)(i,"rank")}n.is=e;function t(i){return e(i)?i.rank:n.DEFAULT_RANK}n.getRank=t,n.sortAsc=(i,o)=>t(i)-t(o),n.sortDesc=(i,o)=>t(o)-t(i),n.sort=n.sortAsc})(Gx||(Is.Ranked=Gx={}));Object.defineProperty(Gn,"__esModule",{value:!0});Gn.getFeedbackRank=Gn.FeedbackCommand=void 0;const v0e=z,tq=Is;class _0e extends v0e.Command{constructor(){super(...arguments),this.priority=0,this.rank=this.priority?-this.priority:tq.Ranked.DEFAULT_RANK}undo(e){return e.root}redo(e){return e.root}}Gn.FeedbackCommand=_0e;function y0e(n){var e;const t=n;return t!=null&&t.priority?-t.priority:(e=t.rank)!==null&&e!==void 0?e:tq.Ranked.DEFAULT_RANK}Gn.getFeedbackRank=y0e;var b0e=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},S0e=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},E0e=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(it,"__esModule",{value:!0});it.toggleCssClasses=it.deleteCssClasses=it.applyCssClasses=it.cursorFeedbackAction=it.CursorCSS=it.CSS_HIDDEN=it.CSS_GHOST_ELEMENT=it.ModifyCssFeedbackCommand=it.ModifyCSSFeedbackAction=void 0;const z8=z,Ux=k,TT=kt,C0e=Gn;var am;(function(n){n.KIND="modifyCSSFeedback";function e(i){return z8.Action.hasKind(i,n.KIND)&&(0,z8.hasArrayProp)(i,"elementIds")}n.is=e;function t(i){const{elements:o,...r}=i,s=o?o.map(a=>typeof a=="string"?a:a.id):void 0;return{kind:n.KIND,elementIds:s,...r}}n.create=t})(am||(it.ModifyCSSFeedbackAction=am={}));let sP=class extends C0e.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){return(this.action.elementIds?(0,TT.getElements)(e.root.index,this.action.elementIds):[e.root]).forEach(i=>{this.action.remove&&(0,TT.removeCssClasses)(i,this.action.remove),this.action.add&&(0,TT.addCssClasses)(i,this.action.add)}),e.root}};it.ModifyCssFeedbackCommand=sP;sP.KIND=am.KIND;it.ModifyCssFeedbackCommand=sP=b0e([(0,Ux.injectable)(),E0e(0,(0,Ux.inject)(z8.TYPES.Action)),S0e("design:paramtypes",[Object])],sP);it.CSS_GHOST_ELEMENT="ghost-element";it.CSS_HIDDEN="hidden";var G8;(function(n){n.DEFAULT="default-mode",n.OVERLAP_FORBIDDEN="overlap-forbidden-mode",n.NODE_CREATION="node-creation-mode",n.EDGE_CREATION_SOURCE="edge-creation-select-source-mode",n.EDGE_CREATION_TARGET="edge-creation-select-target-mode",n.EDGE_RECONNECT="edge-reconnect-select-target-mode",n.EDGE_CHECK_PENDING="edge-check-pending-mode",n.OPERATION_NOT_ALLOWED="edge-modification-not-allowed-mode",n.ELEMENT_DELETION="element-deletion-mode",n.RESIZE_NESW="resize-nesw-mode",n.RESIZE_NWSE="resize-nwse-mode",n.RESIZE_NW="resize-nw-mode",n.RESIZE_N="resize-n-mode",n.RESIZE_NE="resize-ne-mode",n.RESIZE_E="resize-e-mode",n.RESIZE_SE="resize-se-mode",n.RESIZE_S="resize-s-mode",n.RESIZE_SW="resize-sw-mode",n.RESIZE_W="resize-w-mode",n.MOVE="move-mode",n.MARQUEE="marquee-mode"})(G8||(it.CursorCSS=G8={}));function P0e(n){const e=[];return n&&e.push(n),am.create({add:e,remove:Object.values(G8)})}it.cursorFeedbackAction=P0e;function nq(n,...e){return am.create({elements:[n],add:e})}it.applyCssClasses=nq;function iq(n,...e){return am.create({elements:[n],remove:e})}it.deleteCssClasses=iq;function w0e(n,e,...t){return e?nq(n,...t):iq(n,...t)}it.toggleCssClasses=w0e;var wg={},rb={},gc={};Object.defineProperty(gc,"__esModule",{value:!0});gc.MaybeActions=gc.feedbackFeature=void 0;const Yx=z;gc.feedbackFeature=Symbol("feedbackFeature");var qx;(function(n){function e(t){const i=t?(0,Yx.call)(t):[];return i?(0,Yx.asArray)(i):[]}n.asArray=e})(qx||(gc.MaybeActions=qx={}));Object.defineProperty(rb,"__esModule",{value:!0});rb.FeedbackEmitter=void 0;const Wx=z,A0e=gc;let R0e=0;class M0e{constructor(e){this.feedbackDispatcher=e,this.id=R0e++,this.feedbackActions=[],this.cleanupActions=[]}add(e,t){if(!e&&!t)return this;const i=this.feedbackActions.length;return this.feedbackActions[i]=e,t&&(this.cleanupActions[i]=t),this}merge(e){return this.feedbackActions.push(...e.feedbackActions),this.cleanupActions.push(...e.cleanupActions),this}remove(e){const t=this.feedbackActions.indexOf(e);return t>=0&&(this.feedbackActions.splice(t,1),this.cleanupActions.splice(t,1)),this}clear(){return this.feedbackActions=[],this.cleanupActions=[],this}submit(){const e=(0,Wx.arrayOf)(...this.feedbackActions),t=(0,Wx.arrayOf)(...this.cleanupActions);return(e.length>0||t.length>0)&&(this.deregistration=this.feedbackDispatcher.registerFeedback(this,e,()=>t.flatMap(A0e.MaybeActions.asArray)),this.clear()),this}discard(){return this.feedbackDispatcher.deregisterFeedback(this),this.deregistration=void 0,this}revert(){var e;return(e=this.deregistration)===null||e===void 0||e.dispose(),this.deregistration=void 0,this}dispose(){return this.revert(),this.clear(),this}}rb.FeedbackEmitter=M0e;var ER=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},q7=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(wg,"__esModule",{value:!0});wg.FeedbackActionDispatcher=void 0;const Nd=z,CR=k,Zx=Gn,I0e=rb,T0e=gc;let cm=class{constructor(){this.registeredFeedback=new Map}registerFeedback(e,t,i){return e instanceof Nd.GModelElement&&this.logger.log(this,"GModelElements as feedback emitters are discouraged, as they usually change between model updates and are considered unstable."),t.length>0&&(this.registeredFeedback.set(e,t),this.dispatchFeedback(t,e)),Nd.Disposable.create(()=>this.deregisterFeedback(e,i))}deregisterFeedback(e,t){this.registeredFeedback.delete(e);const i=T0e.MaybeActions.asArray(t);i.length>0&&this.dispatchFeedback(i,e)}getRegisteredFeedback(){const e=[];return this.registeredFeedback.forEach(t=>e.push(...t)),e}getRegisteredFeedbackEmitters(e){const t=[];return this.registeredFeedback.forEach((i,o)=>{i.includes(e)&&t.push(o)}),t}getFeedbackCommands(){return this.getRegisteredFeedback().flatMap(e=>this.actionToCommands(e)).sort((e,t)=>(0,Zx.getFeedbackRank)(e)-(0,Zx.getFeedbackRank)(t))}async applyFeedbackCommands(e){var t;const i=(t=this.getFeedbackCommands())!==null&&t!==void 0?t:[];if((i==null?void 0:i.length)>0){const o=i.map(r=>r.execute(e));await Promise.all(o)}}actionToCommands(e){var t;return(t=this.actionHandlerRegistry.get(e.kind).filter((0,Nd.toTypeGuard)(Nd.CommandActionHandler)).map(i=>i.handle(e)))!==null&&t!==void 0?t:[]}createEmitter(){return new I0e.FeedbackEmitter(this)}async dispatchFeedback(e,t){try{await(await this.actionDispatcher()).dispatchAll(e),this.logger.info(this,`Dispatched feedback actions for ${t}`)}catch(i){this.logger.error(this,"Failed to dispatch feedback actions",i)}}};wg.FeedbackActionDispatcher=cm;ER([(0,CR.inject)(Nd.TYPES.IActionDispatcherProvider),q7("design:type",Function)],cm.prototype,"actionDispatcher",void 0);ER([(0,CR.inject)(Nd.TYPES.ILogger),q7("design:type",Object)],cm.prototype,"logger",void 0);ER([(0,CR.inject)(Nd.ActionHandlerRegistry),q7("design:type",Nd.ActionHandlerRegistry)],cm.prototype,"actionHandlerRegistry",void 0);wg.FeedbackActionDispatcher=cm=ER([(0,CR.injectable)()],cm);var Ag={},W7=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Z7=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},D0e=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Ag,"__esModule",{value:!0});Ag.FeedbackAwareSetModelCommand=void 0;const PR=z,ay=k;let cy=class extends PR.SetModelCommand{constructor(e){super(e)}execute(e){const t=super.execute(e);return this.applyFeedback(t,e),t}applyFeedback(e,t){var i;const o={...t,root:e};(i=this.feedbackActionDispatcher)===null||i===void 0||i.applyFeedbackCommands(o)}};Ag.FeedbackAwareSetModelCommand=cy;W7([(0,ay.inject)(PR.TYPES.ILogger),Z7("design:type",Object)],cy.prototype,"logger",void 0);W7([(0,ay.inject)(PR.TYPES.IFeedbackActionDispatcher),(0,ay.optional)(),Z7("design:type",Object)],cy.prototype,"feedbackActionDispatcher",void 0);Ag.FeedbackAwareSetModelCommand=cy=W7([(0,ay.injectable)(),D0e(0,(0,ay.inject)(PR.TYPES.Action)),Z7("design:paramtypes",[Object])],cy);var Rg={},Q7=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},X7=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},O0e=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Rg,"__esModule",{value:!0});Rg.FeedbackAwareUpdateModelCommand=void 0;const dy=z,uy=k;let ly=class extends dy.UpdateModelCommand{constructor(e){super({animate:!0,...e})}performUpdate(e,t,i){var o;const r={...i,root:t};return(o=this.feedbackActionDispatcher)===null||o===void 0||o.applyFeedbackCommands(r),super.performUpdate(e,t,i)}createAnimations(e,t,i){return super.createAnimations(e,t,i).filter(r=>!(r instanceof dy.MorphEdgesAnimation))}};Rg.FeedbackAwareUpdateModelCommand=ly;Q7([(0,uy.inject)(dy.TYPES.ILogger),X7("design:type",Object)],ly.prototype,"logger",void 0);Q7([(0,uy.inject)(dy.TYPES.IFeedbackActionDispatcher),(0,uy.optional)(),X7("design:type",Object)],ly.prototype,"feedbackActionDispatcher",void 0);Rg.FeedbackAwareUpdateModelCommand=ly=Q7([(0,uy.injectable)(),O0e(0,(0,uy.inject)(dy.TYPES.Action)),X7("design:paramtypes",[Object])],ly);var lu={},Mg=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},sb=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(lu,"__esModule",{value:!0});lu.DiagramLoader=lu.IDiagramStartup=void 0;const Sr=z,Ig=k,Qx=Pt,L0e=Is,Xx=Ro,Jx=ys;var eH;(function(n){function e(t){return Sr.AnyObject.is(t)&&(0,Sr.hasNumberProp)(t,"rank",!0)&&("preLoadDiagram"in t||"preInitialize"in t||"preRequestModel"in t||"postRequestModel"in t||"postModelInitialization"in t)}n.is=e})(eH||(lu.IDiagramStartup=eH={}));let fu=class{get diagramStartups(){return this.lazyInjector.getAll(Sr.TYPES.IDiagramStartup)}async load(e={}){var t,i;this.diagramStartups.sort(L0e.Ranked.sort),await this.invokeStartupHook("preLoadDiagram");const o={requestModelOptions:{sourceUri:(t=this.options.sourceUri)!==null&&t!==void 0?t:"",diagramType:this.options.diagramType,...e.requestModelOptions},initializeParameters:{applicationId:Sr.ApplicationIdProvider.get(),protocolVersion:Sr.GLSPClient.protocolVersion,...e.initializeParameters},enableNotifications:(i=e.enableNotifications)!==null&&i!==void 0?i:!0};await this.actionDispatcher.dispatch(Sr.SetModelAction.create(Sr.EMPTY_ROOT)),await this.invokeStartupHook("preInitialize"),await this.initialize(o),await this.invokeStartupHook("preRequestModel"),await this.requestModel(o),await this.invokeStartupHook("postRequestModel"),this.modelInitializationConstraint.onInitialized(()=>this.invokeStartupHook("postModelInitialization"))}async invokeStartupHook(e){var t;for(const i of this.diagramStartups)try{await((t=i[e])===null||t===void 0?void 0:t.call(i))}catch(o){console.error(`Error invoking diagram startup hook '${e}':`,`
`,o)}}async requestModel(e){const t=await this.actionDispatcher.request(Sr.RequestModelAction.create({options:e.requestModelOptions}));return this.actionDispatcher.dispatch(t)}async initialize(e){e.enableNotifications&&await this.actionDispatcher.dispatch(Sr.StatusAction.create("Initializing...",{severity:"INFO"}));const t=await this.options.glspClientProvider();await t.start(),t.initializeResult||await t.initializeServer(e.initializeParameters),this.modelSource.configure(t),e.enableNotifications&&this.actionDispatcher.dispatch(Sr.StatusAction.create("",{severity:"NONE"}))}};lu.DiagramLoader=fu;Mg([(0,Ig.inject)(Sr.TYPES.IDiagramOptions),sb("design:type",Object)],fu.prototype,"options",void 0);Mg([(0,Ig.inject)(Qx.GLSPActionDispatcher),sb("design:type",Qx.GLSPActionDispatcher)],fu.prototype,"actionDispatcher",void 0);Mg([(0,Ig.inject)(Xx.GLSPModelSource),sb("design:type",Xx.GLSPModelSource)],fu.prototype,"modelSource",void 0);Mg([(0,Ig.inject)(Jx.ModelInitializationConstraint),sb("design:type",Jx.ModelInitializationConstraint)],fu.prototype,"modelInitializationConstraint",void 0);Mg([(0,Ig.inject)(Sr.LazyInjector),sb("design:type",Object)],fu.prototype,"lazyInjector",void 0);lu.DiagramLoader=fu=Mg([(0,Ig.injectable)()],fu);var Tg={},j0e=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Tg,"__esModule",{value:!0});Tg.GModelRegistry=void 0;const N0e=z,B0e=k,tH=Cg;let U8=class extends N0e.SModelRegistry{register(e,t){if(e===void 0)throw new Error("Key is undefined");this.hasKey(e)&&(console.log(`Key is already registered: ${e}.Factory for model element '${e}' will be overwritten.`),console.warn(`Implicit overwriting by registering the same key twice is deprecated
 Use 'overrideModelElement()' instead of 'configureModelElement()' for explicit overwriting.`)),this.elements.set(e,t)}getDefaultFeatures(e){var t;const i=[...(t=super.getDefaultFeatures(e))!==null&&t!==void 0?t:[]];return i.includes(tH.argsFeature)||i.push(tH.argsFeature),i}};Tg.GModelRegistry=U8;Tg.GModelRegistry=U8=j0e([(0,B0e.injectable)()],U8);var Dg={},$0e=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Dg,"__esModule",{value:!0});Dg.GLSPMousePositionTracker=void 0;const nH=z,k0e=k,F0e=Is;let Y8=class extends nH.MousePositionTracker{constructor(){super(...arguments),this.rank=F0e.Ranked.DEFAULT_RANK-200}mouseMove(e,t){const i=e.root.canvasBounds,o={x:t.clientX,y:t.clientY},r=nH.Point.subtract(o,i),s=e.root.parentToLocal(r);return this.lastPosition=s,[]}};Dg.GLSPMousePositionTracker=Y8;Dg.GLSPMousePositionTracker=Y8=$0e([(0,k0e.injectable)()],Y8);var Og={},x0e=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Og,"__esModule",{value:!0});Og.SelectionClearingMouseListener=void 0;const H0e=k,K0e=z;let q8=class extends K0e.MouseListener{mouseDown(e,t){const i=document.getSelection();return i===null?[]:(i.removeAllRanges(),i.addRange(document.createRange()),[])}};Og.SelectionClearingMouseListener=q8;Og.SelectionClearingMouseListener=q8=x0e([(0,H0e.injectable)()],q8);var It={};Object.defineProperty(It,"__esModule",{value:!0});It.Tool=It.EnableDefaultToolsAction=It.EnableToolsAction=void 0;const Ad=z;var iH;(function(n){n.KIND="enable-tools";function e(i){return Ad.Action.hasKind(i,n.KIND)&&(0,Ad.hasArrayProp)(i,"toolIds")}n.is=e;function t(i){return{kind:n.KIND,toolIds:i}}n.create=t})(iH||(It.EnableToolsAction=iH={}));var oH;(function(n){n.KIND="enable-default-tools";function e(i){return Ad.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(oH||(It.EnableDefaultToolsAction=oH={}));var rH;(function(n){function e(t){return Ad.AnyObject.is(t)&&(0,Ad.hasStringProp)(t,"id")&&(0,Ad.hasFunctionProp)(t,"enable")&&(0,Ad.hasFunctionProp)(t,"disable")&&(0,Ad.hasBooleanProp)(t,"isEditTool",!0)}n.is=e})(rH||(It.Tool=rH={}));var Dr={},Lg=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},J7=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.DefaultToolsEnablingKeyListener=Dr.ToolManagerActionHandler=Dr.ToolManager=void 0;const ts=z,jg=k,sH=An,V0e=Is,W8=It;let fy=class{constructor(){this.actives=[],this.tools=[],this.defaultTools=[],this._defaultToolsEnabled=!1}get defaultToolsEnabled(){return this._defaultToolsEnabled}preLoadDiagram(){const e=this.lazyInjector.getAll(ts.TYPES.ITool),t=this.lazyInjector.getAll(ts.TYPES.IDefaultTool);this.registerTools(...e),this.registerDefaultTools(...t),this.enableDefaultTools()}get managedTools(){return this.defaultTools.concat(this.tools)}get activeTools(){return this.actives}get rank(){return V0e.Ranked.DEFAULT_RANK-100}registerDefaultTools(...e){(0,ts.distinctAdd)(this.defaultTools,...e)}registerTools(...e){(0,ts.distinctAdd)(this.tools,...e)}disableActiveTools(){this._defaultToolsEnabled=!1,this.actives.forEach(e=>e.disable()),this.actives.splice(0,this.actives.length)}enableDefaultTools(){this.defaultToolsEnabled||(this.enable((0,ts.pluck)(this.defaultTools,"id")),this._defaultToolsEnabled=!0)}enable(e){this.disableActiveTools();let t=e.map(i=>this.tool(i));this.editorContext&&this.editorContext.isReadonly&&(t=t.filter(i=>!(i!=null&&i.isEditTool))),t.forEach(i=>{i!==void 0&&(i.enable(),this.actives.push(i))})}tool(e){return this.managedTools.find(t=>t.id===e)}disableEditTools(){this.disableActiveTools(),this.enable(this.defaultTools.filter(e=>!e.isEditTool).map(e=>e.id))}editModeChanged(e,t){t!==e&&(e===ts.EditMode.READONLY?this.disableEditTools():e===ts.EditMode.EDITABLE&&this.enableDefaultTools())}};Dr.ToolManager=fy;Lg([(0,jg.inject)(sH.EditorContextService),J7("design:type",sH.EditorContextService)],fy.prototype,"editorContext",void 0);Lg([(0,jg.inject)(ts.LazyInjector),J7("design:type",Object)],fy.prototype,"lazyInjector",void 0);Dr.ToolManager=fy=Lg([(0,jg.injectable)()],fy);let aP=class{handle(e){W8.EnableDefaultToolsAction.is(e)?this.toolManager.enableDefaultTools():W8.EnableToolsAction.is(e)&&this.toolManager.enable(e.toolIds)}};Dr.ToolManagerActionHandler=aP;Lg([(0,jg.inject)(ts.TYPES.IToolManager),J7("design:type",Object)],aP.prototype,"toolManager",void 0);Dr.ToolManagerActionHandler=aP=Lg([(0,jg.injectable)()],aP);let Z8=class extends ts.KeyListener{keyDown(e,t){return(0,ts.matchesKeystroke)(t,"Escape")?[W8.EnableDefaultToolsAction.create()]:[]}};Dr.DefaultToolsEnablingKeyListener=Z8;Dr.DefaultToolsEnablingKeyListener=Z8=Lg([(0,jg.injectable)()],Z8);var Ng={},oq=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},rq=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},z0e=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Ng,"__esModule",{value:!0});Ng.GLSPUIExtensionRegistry=void 0;const Q8=z,X8=k;let cP=class extends Q8.UIExtensionRegistry{constructor(e=[]){super(e)}preLoadDiagram(){this.lazyInjector.getAll(Q8.TYPES.IUIExtension).forEach(e=>this.register(e.id(),e))}};Ng.GLSPUIExtensionRegistry=cP;oq([(0,X8.inject)(Q8.LazyInjector),rq("design:type",Object)],cP.prototype,"lazyInjector",void 0);Ng.GLSPUIExtensionRegistry=cP=oq([(0,X8.injectable)(),z0e(0,(0,X8.optional)()),rq("design:paramtypes",[Array])],cP);var Xf={},sq=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},aq=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},G0e=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Xf,"__esModule",{value:!0});Xf.GLSPKeyTool=void 0;const h3=z,J8=k;let dP=class extends h3.KeyTool{constructor(e=[]){super(e)}registerListener(e){return super.register(e),h3.Disposable.create(()=>this.deregister(e))}preLoadDiagram(){this.lazyInjector.getAll(h3.TYPES.KeyListener).forEach(e=>this.register(e))}};Xf.GLSPKeyTool=dP;sq([(0,J8.inject)(h3.LazyInjector),aq("design:type",Object)],dP.prototype,"lazyInjector",void 0);Xf.GLSPKeyTool=dP=sq([(0,J8.injectable)(),G0e(0,(0,J8.optional)()),aq("design:paramtypes",[Array])],dP);var Jf={},cq=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},dq=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},U0e=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Jf,"__esModule",{value:!0});Jf.GLSPMouseTool=void 0;const Hv=z,eO=k,aH=Is;let uP=class extends Hv.MouseTool{constructor(e=[]){super(e)}preLoadDiagram(){this.lazyInjector.getAll(Hv.TYPES.MouseListener).forEach(e=>this.register(e))}register(e){super.register(e),this.rankedMouseListeners=cH(this.mouseListeners,t=>aH.Ranked.getRank(t))}registerListener(e){return this.register(e),Hv.Disposable.create(()=>this.deregister(e))}deregister(e){super.deregister(e),this.rankedMouseListeners=cH(this.mouseListeners,t=>aH.Ranked.getRank(t))}handleEvent(e,t,i){this.focusOnMouseEvent(e,t);const o=this.getTargetElement(t,i);o&&this.notifyListenersByRank(o,e,i)}async notifyListenersByRank(e,t,i){for(const o of this.rankedMouseListeners)await this.dispatchActions(o[1],t,e,i)}async dispatchActions(e,t,i,o){const r=e.map(s=>s[t](i,o)).reduce((s,a)=>s.concat(a));if(r.length>0){o.preventDefault();for(const s of r)Hv.Action.is(s)?await this.actionDispatcher.dispatch(s):s.then(a=>{this.actionDispatcher.dispatch(a)})}}};Jf.GLSPMouseTool=uP;cq([(0,eO.inject)(Hv.LazyInjector),dq("design:type",Object)],uP.prototype,"lazyInjector",void 0);Jf.GLSPMouseTool=uP=cq([(0,eO.injectable)(),U0e(0,(0,eO.optional)()),dq("design:paramtypes",[Array])],uP);function cH(n,e){const t=n.reduce((i,o)=>{const r=e(o);if(!i.has(r))i.set(r,[o]);else{const s=i.get(r);s&&s.push(o)}return i},new Map);return new Map([...t.entries()].sort())}var Bg={},Y0e=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Bg,"__esModule",{value:!0});Bg.GViewRegistry=void 0;const q0e=z,W0e=k;let tO=class extends q0e.ViewRegistry{register(e,t){if(e===void 0)throw new Error("Key is undefined");this.hasKey(e)&&console.log(`View instance for type '${e}' will be overwritten.`),this.elements.set(e,t)}};Bg.GViewRegistry=tO;Bg.GViewRegistry=tO=Y0e([(0,W0e.injectable)()],tO);Object.defineProperty(ob,"__esModule",{value:!0});ob.defaultModule=void 0;const Me=z,DT=Pt,Z0e=Qf,Q0e=Pg,_v=An,X0e=it,J0e=wg,ebe=Ag,tbe=Rg,nbe=Ma,dH=Vc,ibe=lu,obe=Ro,uH=ys,rbe=Tg,lH=Dg,sbe=Og,OT=Yt,fH=It,Uh=Dr,LT=Ng,jT=Xf,NT=Jf,abe=Bg;ob.defaultModule=new Me.FeatureModule((n,e,t,i,...o)=>{Me.sprottyDefaultModule.registry(n,e,t,i,...o);const r={bind:n,unbind:e,isBound:t,rebind:i};(0,Me.bindLazyInjector)(r),n(_v.EditorContextService).toSelf().inSingletonScope(),n(Me.TYPES.IDiagramStartup).toService(_v.EditorContextService),n(Me.TYPES.IEditorContextServiceProvider).toProvider(s=>async()=>s.container.get(_v.EditorContextService)),(0,Me.configureActionHandler)(r,Me.SetEditModeAction.KIND,_v.EditorContextService),(0,Me.configureActionHandler)(r,Me.SetDirtyStateAction.KIND,_v.EditorContextService),n(dH.FocusTracker).toSelf().inSingletonScope(),(0,Me.configureActionHandler)(r,nbe.FocusStateChangedAction.KIND,dH.FocusTracker),n(Me.TYPES.IFeedbackActionDispatcher).to(J0e.FeedbackActionDispatcher).inSingletonScope(),(0,Me.configureCommand)(r,tbe.FeedbackAwareUpdateModelCommand),i(Me.SetModelCommand).to(ebe.FeedbackAwareSetModelCommand),n(NT.GLSPMouseTool).toSelf().inSingletonScope(),(0,Me.bindOrRebind)(r,Me.MouseTool).toService(NT.GLSPMouseTool),n(Me.TYPES.IDiagramStartup).toService(NT.GLSPMouseTool),n(lH.GLSPMousePositionTracker).toSelf().inSingletonScope(),(0,Me.bindOrRebind)(r,Me.MousePositionTracker).toService(lH.GLSPMousePositionTracker),n(jT.GLSPKeyTool).toSelf().inSingletonScope(),(0,Me.bindOrRebind)(r,Me.KeyTool).toService(jT.GLSPKeyTool),n(Me.TYPES.IDiagramStartup).toService(jT.GLSPKeyTool),(0,Me.bindAsService)(r,Me.TYPES.MouseListener,sbe.SelectionClearingMouseListener),(0,Me.bindOrRebind)(r,Me.TYPES.ICommandStack).to(Q0e.GLSPCommandStack).inSingletonScope(),n(DT.GLSPActionDispatcher).toSelf().inSingletonScope(),n(Me.TYPES.IGModelRootListener).toService(DT.GLSPActionDispatcher),(0,Me.bindOrRebind)(r,Me.TYPES.IActionDispatcher).toService(DT.GLSPActionDispatcher),(0,Me.bindOrRebind)(r,Me.ActionHandlerRegistry).to(Z0e.GLSPActionHandlerRegistry).inSingletonScope(),(0,Me.bindAsService)(r,Me.TYPES.ModelSource,obe.GLSPModelSource),n(ibe.DiagramLoader).toSelf().inSingletonScope(),n(uH.ModelInitializationConstraint).to(uH.DefaultModelInitializationConstraint).inSingletonScope(),(0,Me.bindOrRebind)(r,Me.TYPES.SModelRegistry).to(rbe.GModelRegistry).inSingletonScope(),(0,Me.bindOrRebind)(r,Me.TYPES.ViewRegistry).to(abe.GViewRegistry).inSingletonScope(),n(OT.SelectionService).toSelf().inSingletonScope(),n(Me.TYPES.IGModelRootListener).toService(OT.SelectionService),n(Me.TYPES.IDiagramStartup).toService(OT.SelectionService),(0,Me.configureCommand)(r,X0e.ModifyCssFeedbackCommand),(0,Me.configureCommand)(r,Me.MoveCommand),(0,Me.bindAsService)(r,Me.TYPES.IVNodePostprocessor,Me.LocationPostprocessor),n(Me.TYPES.HiddenVNodePostprocessor).toService(Me.LocationPostprocessor),n(Me.TYPES.IToolManager).to(Uh.ToolManager).inSingletonScope(),n(Me.TYPES.IDiagramStartup).toService(Me.TYPES.IToolManager),n(Me.TYPES.IEditModeListener).toService(Me.TYPES.IToolManager),n(Uh.DefaultToolsEnablingKeyListener).toSelf().inSingletonScope(),n(Me.TYPES.KeyListener).toService(Uh.DefaultToolsEnablingKeyListener),n(Uh.ToolManagerActionHandler).toSelf().inSingletonScope(),(0,Me.configureActionHandler)(r,fH.EnableDefaultToolsAction.KIND,Uh.ToolManagerActionHandler),(0,Me.configureActionHandler)(r,fH.EnableToolsAction.KIND,Uh.ToolManagerActionHandler),n(LT.GLSPUIExtensionRegistry).toSelf().inSingletonScope(),(0,Me.bindOrRebind)(r,Me.TYPES.UIExtensionRegistry).toService(LT.GLSPUIExtensionRegistry),n(Me.TYPES.IDiagramStartup).toService(LT.GLSPUIExtensionRegistry)},{featureId:Symbol("default")});var Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.DragAwareMouseListener=void 0;const hH=z;class cbe extends hH.MouseListener{constructor(e=0){super(),this._isMouseDown=!1,this._isMouseDrag=!1,this._dragSensitivity=0,this._dragSensitivity=e}mouseDown(e,t){return this._isMouseDown=!0,this._dragStart=this._dragSensitivity>0?{x:t.clientX,y:t.clientY}:void 0,[]}mouseMove(e,t){return this._isMouseDown?this._dragStart&&hH.Point.maxDistance(this._dragStart,{x:t.clientX,y:t.clientY})<this._dragSensitivity?this.nonDraggingMouseMove(e,t):(this._isMouseDrag=!0,this.draggingMouseMove(e,t)):this.nonDraggingMouseMove(e,t)}draggingMouseMove(e,t){return[]}nonDraggingMouseMove(e,t){return[]}mouseUp(e,t){return this._isMouseDown=!1,this._dragStart=void 0,this._isMouseDrag?(this._isMouseDrag=!1,this.draggingMouseUp(e,t)):this.nonDraggingMouseUp(e,t)}nonDraggingMouseUp(e,t){return[]}draggingMouseUp(e,t){return[]}get isMouseDrag(){return this._isMouseDrag}get isMouseDown(){return this._isMouseDown}dispose(){this._isMouseDrag=!1,this._isMouseDown=!1}}Kr.DragAwareMouseListener=cbe;var uq={},ab={},eh={},th={},io={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.SResizeHandle=n.removeResizeHandles=n.addResizeHandles=n.GResizeHandle=n.isBoundsAwareMoveable=n.ResizeHandleLocation=n.isResizable=n.resizeFeature=void 0;const e=z,t=it;n.resizeFeature=Symbol("resizeFeature");function i(h){return(0,e.isBoundsAware)(h)&&(0,e.isSelectable)(h)&&h instanceof e.GParentElement&&h.hasFeature(n.resizeFeature)}n.isResizable=i;var o;(function(h){h.TopLeft="top-left",h.Top="top",h.TopRight="top-right",h.Right="right",h.BottomRight="bottom-right",h.Bottom="bottom",h.BottomLeft="bottom-left",h.Left="left"})(o||(n.ResizeHandleLocation=o={})),function(h){h.CORNERS=[h.TopLeft,h.TopRight,h.BottomRight,h.BottomLeft],h.CROSS=[h.Top,h.Right,h.Bottom,h.Left],h.ALL=[...h.CORNERS,...h.CROSS];function g(S){switch(S){case h.TopLeft:return h.BottomRight;case h.Top:return h.Bottom;case h.TopRight:return h.BottomLeft;case h.Right:return h.Left;case h.BottomRight:return h.TopLeft;case h.Bottom:return h.Top;case h.BottomLeft:return h.TopRight;case h.Left:return h.Right}}h.opposite=g;function y(S){switch(S){case h.TopLeft:return[e.Direction.Up,e.Direction.Left];case h.Top:return[e.Direction.Up];case h.TopRight:return[e.Direction.Up,e.Direction.Right];case h.Right:return[e.Direction.Right];case h.BottomRight:return[e.Direction.Down,e.Direction.Right];case h.Bottom:return[e.Direction.Down];case h.BottomLeft:return[e.Direction.Down,e.Direction.Left];case h.Left:return[e.Direction.Left]}}h.direction=y}(o||(n.ResizeHandleLocation=o={}));function r(h){return(0,e.isMoveable)(h)&&(0,e.isBoundsAware)(h)}n.isBoundsAwareMoveable=r;class s extends e.GChildElement{constructor(g,y=s.TYPE,S=!1){super(),this.location=g,this.type=y,this.hoverFeedback=S}hasFeature(g){return g===e.hoverFeedbackFeature}isNwResize(){return this.location===o.TopLeft}isNResize(){return this.location===o.Top}isNeResize(){return this.location===o.TopRight}isEResize(){return this.location===o.Right}isSeResize(){return this.location===o.BottomRight}isSResize(){return this.location===o.Bottom}isSwResize(){return this.location===o.BottomLeft}isWResize(){return this.location===o.Left}isNwSeResize(){return this.isNwResize()||this.isSeResize()}isNeSwResize(){return this.isNeResize()||this.isSwResize()}static getHandlePosition(g,y){const S=s.is(g)?g.parent.bounds:g instanceof e.GModelElement?g.bounds:g;switch(s.is(g)?g.location:y){case o.TopLeft:return e.Bounds.topLeft(S);case o.Top:return e.Bounds.topCenter(S);case o.TopRight:return e.Bounds.topRight(S);case o.Right:return e.Bounds.middleRight(S);case o.BottomRight:return e.Bounds.bottomRight(S);case o.Bottom:return e.Bounds.bottomCenter(S);case o.BottomLeft:return e.Bounds.bottomLeft(S);case o.Left:return e.Bounds.middleLeft(S)}}static getCursorCss(g){switch(g.location){case o.TopLeft:return t.CursorCSS.RESIZE_NW;case o.Top:return t.CursorCSS.RESIZE_N;case o.TopRight:return t.CursorCSS.RESIZE_NE;case o.Right:return t.CursorCSS.RESIZE_E;case o.BottomRight:return t.CursorCSS.RESIZE_SE;case o.Bottom:return t.CursorCSS.RESIZE_S;case o.BottomLeft:return t.CursorCSS.RESIZE_SW;case o.Left:return t.CursorCSS.RESIZE_W}}static is(g){return typeof g=="object"&&!!g&&"type"in g&&g.type===s.TYPE}}n.GResizeHandle=s,n.SResizeHandle=s,s.TYPE="resize-handle";function a(h,g=o.CORNERS){for(const y of o.ALL){const S=h.children.find(w=>w instanceof s&&w.location===y);g.includes(y)&&!S?h.add(new s(y)):!g.includes(y)&&S&&h.remove(S)}}n.addResizeHandles=a;function u(h){h.removeAll(g=>g instanceof s)}n.removeResizeHandles=u})(io);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Direction=n.getDirectionFrom=n.getDirectionOf=n.isSelectionBounds=n.SelectionBounds=n.SELECTION_BOUNDS=n.isHelperLine=n.HelperLine=n.HELPER_LINE=n.HelperLineType=void 0;const e=z,t=_g,i=io;n.HelperLineType={Left:"left",Right:"right",Center:"center",Top:"top",Bottom:"bottom",Middle:"middle",LeftRight:"left-right",RightLeft:"right-left",BottomTop:"bottom-top",TopBottom:"top-bottom"},n.HELPER_LINE="helper-line";class o extends e.GChildElement{constructor(y=e.Point.ORIGIN,S=e.Point.ORIGIN,w=n.HelperLineType.Left){super(),this.startPoint=y,this.endPoint=S,this.lineType=w,this.id=(0,t.v4)(),this.type=n.HELPER_LINE}get isLeft(){return this.lineType===n.HelperLineType.Left||this.lineType===n.HelperLineType.LeftRight}get isRight(){return this.lineType===n.HelperLineType.Right||this.lineType===n.HelperLineType.RightLeft}get isTop(){return this.lineType===n.HelperLineType.Top||this.lineType===n.HelperLineType.TopBottom}get isBottom(){return this.lineType===n.HelperLineType.Bottom||this.lineType===n.HelperLineType.BottomTop}get isMiddle(){return this.lineType===n.HelperLineType.Middle}get isCenter(){return this.lineType===n.HelperLineType.Center}}n.HelperLine=o;function r(g){return g.type===n.HELPER_LINE}n.isHelperLine=r,n.SELECTION_BOUNDS="selection-bounds";class s extends e.GShapeElement{constructor(y){super(),this.id=(0,t.v4)(),this.type=n.SELECTION_BOUNDS,y&&(this.bounds=y)}}n.SelectionBounds=s;function a(g){return g.type===n.SELECTION_BOUNDS}n.isSelectionBounds=a,n.getDirectionOf=e.Vector.direction;function u(g){return g===i.ResizeHandleLocation.TopLeft?[e.Direction.Up,e.Direction.Left]:g===i.ResizeHandleLocation.TopRight?[e.Direction.Up,e.Direction.Right]:g===i.ResizeHandleLocation.BottomLeft?[e.Direction.Down,e.Direction.Left]:g===i.ResizeHandleLocation.BottomRight?[e.Direction.Down,e.Direction.Right]:[]}n.getDirectionFrom=u;var h=z;Object.defineProperty(n,"Direction",{enumerable:!0,get:function(){return h.Direction}})})(th);var dbe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},ube=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},wE=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(eh,"__esModule",{value:!0});eh.PositionSnapper=void 0;const pH=z,yv=k,Ha=th;let nO=class{constructor(e,t){this.snapper=e,this.helperLineManager=t}snapPosition(e,t,i=!0){return i&&this.snapper?this.snapper.snap(e,t):{x:e.x,y:e.y}}snapDelta(e,t,i,o){const r=this.snapPosition(e,t,i),s=this.getMinimumDelta(t,i,o);return s&&(r.x=Math.abs(r.x)>=s.x?r.x:0,r.y=Math.abs(r.y)>=s.y?r.y:0),r}getMinimumDelta(e,t,i){return this.getHelperLineMinimum(e,t,i)}getHelperLineMinimum(e,t,i){if(!this.helperLineManager)return;const o=e.root.children.filter(s=>(0,Ha.isHelperLine)(s));if(o.length===0)return;const r={x:0,y:0};return i.includes(Ha.Direction.Left)&&o.some(s=>s.isLeft||s.isCenter)?r.x=this.helperLineManager.getMinimumMoveDelta(e,t,Ha.Direction.Left):i.includes(Ha.Direction.Right)&&o.some(s=>s.isRight||s.isCenter)&&(r.x=this.helperLineManager.getMinimumMoveDelta(e,t,Ha.Direction.Right)),i.includes(Ha.Direction.Up)&&o.some(s=>s.isTop||s.isMiddle)?r.y=this.helperLineManager.getMinimumMoveDelta(e,t,Ha.Direction.Up):i.includes(Ha.Direction.Down)&&o.some(s=>s.isBottom||s.isMiddle)&&(r.y=this.helperLineManager.getMinimumMoveDelta(e,t,Ha.Direction.Down)),r}};eh.PositionSnapper=nO;eh.PositionSnapper=nO=dbe([(0,yv.injectable)(),wE(0,(0,yv.optional)()),wE(0,(0,yv.inject)(pH.TYPES.ISnapper)),wE(1,(0,yv.optional)()),wE(1,(0,yv.inject)(pH.TYPES.IHelperLineManager)),ube("design:paramtypes",[Object,Object])],nO);var $g={},Ia={};Object.defineProperty(Ia,"__esModule",{value:!0});Ia.LayoutAware=void 0;var mH;(function(n){function e(a){return"layoutData"in a}n.is=e;function t(a){return e(a)?a.layoutData:void 0}n.getLayoutData=t;function i(a,u){a.layoutData=u}n.setLayoutData=i;function o(a,u){s(a).layoutData.computedDimensions=u}n.setComputedDimensions=o;function r(a){var u;return(u=t(a))===null||u===void 0?void 0:u.computedDimensions}n.getComputedDimensions=r;function s(a){var u;return a.layoutData=(u=a.layoutData)!==null&&u!==void 0?u:{},a}})(mH||(Ia.LayoutAware=mH={}));var lbe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty($g,"__esModule",{value:!0});$g.FreeFormLayouter=void 0;const gH=z,fbe=k,hbe=Ia;let lP=class extends gH.AbstractLayout{layout(e,t){const i=t.getBoundsData(e),o=this.getLayoutOptions(e),r=this.getChildrenSize(e,o,t),s=r.width>0?r.width+o.paddingLeft+o.paddingRight:0,a=r.height>0?r.height+o.paddingTop+o.paddingBottom:0;if(r.width>0&&r.height>0){const u=this.layoutChildren(e,t,o,s,a),h=this.getComputedContainerDimensions(o,r.width,r.height);hbe.LayoutAware.setComputedDimensions(i,h),i.bounds=this.getFinalContainerBounds(e,u,o,h.width,h.height),i.boundsChanged=!0}else i.bounds={x:i.bounds.x,y:i.bounds.y,width:0,height:0},i.boundsChanged=!0}getChildrenSize(e,t,i){let o=0,r=0;return e.children.forEach(s=>{const a=i.getBoundsData(s).bounds;if(a!==void 0&&gH.Dimension.isValid(a)){const u=a.x+a.width,h=a.y+a.height;o=Math.max(o,u),r=Math.max(r,h)}}),{width:o,height:r}}layoutChild(e,t,i,o,r,s,a,u){return t.bounds={x:e.bounds.x,y:e.bounds.y,width:i.width,height:i.height},t.boundsChanged=!0,s}getComputedContainerDimensions(e,t,i){return{width:t+e.paddingLeft+e.paddingRight,height:i+e.paddingTop+e.paddingBottom}}getFinalContainerBounds(e,t,i,o,r){return{x:e.bounds.x,y:e.bounds.y,width:Math.max(i.minWidth,o),height:Math.max(i.minHeight,r)}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingFactor:1,minWidth:0,minHeight:0}}spread(e,t){return{...e,...t}}};$g.FreeFormLayouter=lP;lP.KIND="freeform";$g.FreeFormLayouter=lP=lbe([(0,fbe.injectable)()],lP);var hu={},Mo={},e9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},t9=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},pbe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Mo,"__esModule",{value:!0});Mo.LocalComputedBoundsCommand=Mo.LocalComputedBoundsAction=Mo.LocalRequestBoundsAction=void 0;const na=z,fP=k,iO=Ro,vH=Ia;var _H;(function(n){function e(o){return na.RequestBoundsAction.is(o)&&!iO.ServerAction.is(o)&&(0,na.hasArrayProp)(o,"elementIDs",!0)}n.is=e;function t(o,r){return{...na.RequestBoundsAction.create(o),elementIDs:r}}n.create=t;function i({root:o},r,s,a){return r.dispatch(n.create(o,a)),{model:o,modelChanged:!1,cause:s}}n.fromCommand=i})(_H||(Mo.LocalRequestBoundsAction=_H={}));var oO;(function(n){function e(i){return na.ComputedBoundsAction.is(i)&&iO.ServerAction.is(i)}n.is=e;function t(i){return iO.ServerAction.mark(i),i}n.mark=t})(oO||(Mo.LocalComputedBoundsAction=oO={}));let dm=class extends na.Command{constructor(e){super(),this.action=e}execute(e){var t,i;return oO.is(this.action)?(this.viewerOptions.needsClientLayout&&(this.computedBoundsApplicator.apply(e.root,this.action),(t=this.action.layoutData)===null||t===void 0||t.forEach(({elementId:o,layoutData:r})=>{const s=e.root.index.getById(o);s!==void 0&&vH.LayoutAware.setLayoutData(s,r)})),e.root):((i=this.action.layoutData)===null||i===void 0||i.forEach(({elementId:o,layoutData:r})=>{const s=e.root.index.getById(o);s!==void 0&&vH.LayoutAware.setLayoutData(s,r)}),{model:e.root,modelChanged:!1})}undo(e){return e.root}redo(e){return e.root}};Mo.LocalComputedBoundsCommand=dm;dm.KIND=na.ComputedBoundsAction.KIND;e9([(0,fP.inject)(na.ComputedBoundsApplicator),t9("design:type",na.ComputedBoundsApplicator)],dm.prototype,"computedBoundsApplicator",void 0);e9([(0,fP.inject)(na.TYPES.ViewerOptions),t9("design:type",Object)],dm.prototype,"viewerOptions",void 0);Mo.LocalComputedBoundsCommand=dm=e9([(0,fP.injectable)(),pbe(0,(0,fP.inject)(na.TYPES.Action)),t9("design:paramtypes",[Object])],dm);var lq=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},mbe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(hu,"__esModule",{value:!0});hu.GLSPHiddenBoundsUpdater=hu.BoundsDataExt=void 0;const Pl=z,rO=k,BT=kt,gbe=Ia,$T=Mo;class vbe extends Pl.BoundsData{}hu.BoundsDataExt=vbe;let hP=class extends Pl.HiddenBoundsUpdater{constructor(){super(...arguments),this.element2route=[]}getElement2BoundsData(){return this.element2boundsData}decorate(e,t){return super.decorate(e,t),(0,BT.isRoutable)(t)&&this.element2route.push((0,BT.calcElementAndRoute)(t,this.edgeRouterRegistry)),e}postUpdate(e){$T.LocalRequestBoundsAction.is(e)&&e.elementIDs&&this.focusOnElements(e.elementIDs),this.getBoundsFromDOM(),this.layouter.layout(this.getElement2BoundsData());const t=[],i=[],o=[];this.getElement2BoundsData().forEach((h,g)=>{if(h.boundsChanged&&h.bounds!==void 0){const y={elementId:g.id,newSize:{width:h.bounds.width,height:h.bounds.height}};g instanceof Pl.GChildElement&&(0,Pl.isLayoutContainer)(g.parent)&&(y.newPosition={x:h.bounds.x,y:h.bounds.y}),t.push(y)}h.alignmentChanged&&h.alignment!==void 0&&i.push({elementId:g.id,newAlignment:h.alignment}),gbe.LayoutAware.is(h)&&o.push({elementId:g.id,layoutData:h.layoutData})});const r=this.element2route.length===0?void 0:this.element2route,s=e.requestId,a=this.root!==void 0?this.root.revision:void 0,u=Pl.ComputedBoundsAction.create(t,{revision:a,alignments:i,layoutData:o,routes:r,responseId:s});$T.LocalRequestBoundsAction.is(e)&&$T.LocalComputedBoundsAction.mark(u),this.actionDispatcher.dispatch(u),this.getElement2BoundsData().clear(),this.element2route=[]}focusOnElements(e){const t=this.getElement2BoundsData();if(t.size>0){const i=[...t.keys()][0].index,o=new Set(e.flatMap(r=>this.expandElementId(r,i,e)));t.forEach((r,s)=>!o.has(s.id)&&t.delete(s))}}expandElementId(e,t,i){return(0,BT.getDescendantIds)(t.getById(e))}};hu.GLSPHiddenBoundsUpdater=hP;lq([(0,rO.inject)(Pl.EdgeRouterRegistry),(0,rO.optional)(),mbe("design:type",Pl.EdgeRouterRegistry)],hP.prototype,"edgeRouterRegistry",void 0);hu.GLSPHiddenBoundsUpdater=hP=lq([(0,rO.injectable)()],hP);var kg={},_be=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(kg,"__esModule",{value:!0});kg.HBoxLayouterExt=void 0;const yd=z,ybe=k,bbe=Ia;let pP=class extends yd.HBoxLayouter{layout(e,t){var i,o;const r=t.getBoundsData(e),s=this.getLayoutOptions(e),a=this.getChildrenSize(e,s,t),u=this.getFixedContainerBounds(e,s,t),h=r.bounds?((i=r.bounds)===null||i===void 0?void 0:i.width)-s.paddingLeft-s.paddingRight:0,g=r.bounds?((o=r.bounds)===null||o===void 0?void 0:o.height)-s.paddingTop-s.paddingBottom:0,y=s.paddingFactor*(s.resizeContainer?Math.max(u.width-s.paddingLeft-s.paddingRight,a.width):Math.max(0,u.width-s.paddingLeft-s.paddingRight)),S=s.paddingFactor*(s.resizeContainer?Math.max(u.height-s.paddingTop-s.paddingBottom,a.height):Math.max(0,u.height-s.paddingTop-s.paddingBottom)),w=Math.max(h,y),P=Math.max(g,S),E=w-a.width,A=e.children.map(L=>this.getChildLayoutOptions(L,s)).filter(L=>L.hGrab).length;if(w>0&&P>0){const L=this.layoutChildren(e,t,s,w,P,E,A),B=this.getComputedContainerDimensions(s,a.width,a.height);bbe.LayoutAware.setComputedDimensions(r,B),r.bounds=this.getFinalContainerBounds(e,L,s,B.width,B.height),r.boundsChanged=!0}}getChildrenSize(e,t,i){let o=0,r=-1,s=!0;return e.children.forEach(u=>{if((0,yd.isLayoutableChild)(u)){const h=i.getBoundsData(u).bounds;h!==void 0&&yd.Dimension.isValid(h)&&(o+=h.width,s?s=!1:o+=t.hGap,r=Math.max(r,h.height))}}),{width:o,height:r}}layoutChildren(e,t,i,o,r,s,a){let u={x:i.paddingLeft+.5*(o-o/i.paddingFactor),y:i.paddingTop+.5*(r-r/i.paddingFactor)};return e.children.forEach(h=>{if((0,yd.isLayoutableChild)(h)){const g=t.getBoundsData(h),y=g.bounds,S=this.getChildLayoutOptions(h,i);y!==void 0&&yd.Dimension.isValid(y)&&(u=this.layoutChild(h,g,y,S,i,u,o,r,s,a))}}),u}layoutChild(e,t,i,o,r,s,a,u,h,g){const y=o.vGrab?"top":o.vAlign,S=this.getDy(y,i,u);let w=super.layoutChild(e,t,i,o,r,s,a,u);if(t.bounds={...t.bounds,x:s.x,y:s.y+S},o.vGrab&&(t.bounds={x:t.bounds.x,y:t.bounds.y,width:t.bounds.width,height:u},t.boundsChanged=!0),o.hGrab&&h&&g){const P=t.bounds.width+h/g;t.bounds={x:t.bounds.x,y:t.bounds.y,width:P,height:t.bounds.height},t.boundsChanged=!0,w={x:s.x+P,y:s.y}}return w}getFixedContainerBounds(e,t,i){var o,r;const s=e;if((0,yd.isBoundsAware)(s)){const a=s.bounds,u=this.getElementLayoutOptions(s),h=(o=u==null?void 0:u.prefWidth)!==null&&o!==void 0?o:0,g=(r=u==null?void 0:u.prefHeight)!==null&&r!==void 0?r:0;return{...a,width:h,height:g}}return yd.Bounds.EMPTY}getChildLayoutOptions(e,t){return super.getChildLayoutOptions(e,this.filterContainerOptions(t))}getLayoutOptions(e){return super.getLayoutOptions(e)}getElementLayoutOptions(e){return e.layoutOptions}getComputedContainerDimensions(e,t,i){return{width:t+e.paddingLeft+e.paddingRight,height:i+e.paddingTop+e.paddingBottom}}getFinalContainerBounds(e,t,i,o,r){var s,a;const u=this.getElementLayoutOptions(e),h=(s=u==null?void 0:u.prefWidth)!==null&&s!==void 0?s:i.minWidth,g=(a=u==null?void 0:u.prefHeight)!==null&&a!==void 0?a:i.minHeight;return{x:e.bounds.x,y:e.bounds.y,width:Math.max(h,o),height:Math.max(g,r)}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,hGap:1,vAlign:"center",minWidth:0,minHeight:0,hGrab:!1,vGrab:!1,prefHeight:null,prefWidth:null}}filterContainerOptions(e){return{...e,...{vGrab:!1,hGrab:!1,prefHeight:null,prefWidth:null}}}};kg.HBoxLayouterExt=pP;pP.KIND=yd.HBoxLayouter.KIND;kg.HBoxLayouterExt=pP=_be([(0,ybe.injectable)()],pP);var pu={},Sbe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(pu,"__esModule",{value:!0});pu.StatefulLayouterExt=pu.LayouterExt=void 0;const Ebe=k,yl=z;let sO=class extends yl.Layouter{layout(e){new fq(e,this.layoutRegistry,this.logger).layout()}};pu.LayouterExt=sO;pu.LayouterExt=sO=Sbe([(0,Ebe.injectable)()],sO);class fq extends yl.StatefulLayouter{constructor(e,t,i){super(e,t,i),this.elementToBoundsData=e,this.layoutRegistry2=t,this.toBeLayouted2=[],e.forEach((o,r)=>{(0,yl.isLayoutContainer)(r)&&this.toBeLayouted2.push(r)});for(const o of this.toBeLayouted2)e.delete(o)}getBoundsData(e){let t=this.elementToBoundsData.get(e),i=e.bounds;return(0,yl.isLayoutContainer)(e)&&this.toBeLayouted2.indexOf(e)>=0?i=this.doLayout(e):(0,yl.isLayoutContainer)(e)&&(i={x:0,y:0,width:-1,height:-1}),t||(t={bounds:i,boundsChanged:!1,alignmentChanged:!1},this.elementToBoundsData.set(e,t)),t}layout(){for(;this.toBeLayouted2.length>0;){const e=this.toBeLayouted2[0];this.doLayout(e)}for(this.toBeLayouted2=[],this.elementToBoundsData.forEach((e,t)=>{(0,yl.isLayoutContainer)(t)&&this.toBeLayouted2.push(t)});this.toBeLayouted2.length>0;){const e=this.toBeLayouted2[0];this.doLayout(e)}}doLayout(e){const t=this.toBeLayouted2.indexOf(e);t>=0&&this.toBeLayouted2.splice(t,1);const i=this.layoutRegistry2.get(e.layout);i&&i.layout(e,this);const o=this.elementToBoundsData.get(e);return o!==void 0&&o.bounds!==void 0?o.bounds:(this.log.error(e,"Layout failed"),yl.Bounds.EMPTY)}}pu.StatefulLayouterExt=fq;var Ss={},hq=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Cbe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Ss,"__esModule",{value:!0});Ss.SetBoundsFeedbackCommand=Ss.SetBoundsFeedbackAction=void 0;const mP=z,pq=k,Pbe=Pt,wbe=Is,Abe=Mo;var aO;(function(n){n.KIND="setBoundsFeedback";function e(i){return mP.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,bounds:i}}n.create=t})(aO||(Ss.SetBoundsFeedbackAction=aO={}));let hy=class extends mP.SetBoundsCommand{constructor(){super(...arguments),this.rank=wbe.Ranked.DEFAULT_RANK}execute(e){super.execute(e),this.action.bounds.forEach(i=>{var o;const r=e.root.index.getById(i.elementId);if(r&&(0,mP.isLayoutContainer)(r)){const s=(o=r.layoutOptions)!==null&&o!==void 0?o:{};s.prefHeight=i.newSize.height,s.prefWidth=i.newSize.width,r.layoutOptions=s}});const t=this.action.bounds.map(i=>i.elementId);return Abe.LocalRequestBoundsAction.fromCommand(e,this.actionDispatcher,this.action,t)}};Ss.SetBoundsFeedbackCommand=hy;hy.KIND=aO.KIND;hq([(0,pq.inject)(mP.TYPES.IActionDispatcher),Cbe("design:type",Pbe.GLSPActionDispatcher)],hy.prototype,"actionDispatcher",void 0);Ss.SetBoundsFeedbackCommand=hy=hq([(0,pq.injectable)()],hy);var Fg={},Rbe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Fg,"__esModule",{value:!0});Fg.VBoxLayouterExt=void 0;const bd=z,Mbe=k,Ibe=Ia;let gP=class extends bd.VBoxLayouter{layout(e,t){var i,o;const r=t.getBoundsData(e),s=this.getLayoutOptions(e),a=this.getChildrenSize(e,s,t),u=this.getFixedContainerBounds(e,s,t),h=(((i=r.bounds)===null||i===void 0?void 0:i.width)||0)-s.paddingLeft-s.paddingRight,g=(((o=r.bounds)===null||o===void 0?void 0:o.height)||0)-s.paddingTop-s.paddingBottom,y=s.paddingFactor*(s.resizeContainer?Math.max(u.width-s.paddingLeft-s.paddingRight,a.width):Math.max(0,u.width-s.paddingLeft-s.paddingRight)),S=s.paddingFactor*(s.resizeContainer?Math.max(u.height-s.paddingTop-s.paddingBottom,a.height):Math.max(0,u.height-s.paddingTop-s.paddingBottom)),w=Math.max(h,y),P=Math.max(g,S),E=P-a.height,A=e.children.map(L=>this.getChildLayoutOptions(L,s)).filter(L=>L.vGrab).length;if(y>0&&S>0){const L=this.layoutChildren(e,t,s,w,P,E,A),B=this.getComputedContainerDimensions(s,a.width,a.height);Ibe.LayoutAware.setComputedDimensions(r,B),r.bounds=this.getFinalContainerBounds(e,L,s,B.width,B.height),r.boundsChanged=!0}}getChildrenSize(e,t,i){let o=-1,r=0,s=!0;return e.children.forEach(u=>{if((0,bd.isLayoutableChild)(u)){const h=i.getBoundsData(u).bounds;h!==void 0&&bd.Dimension.isValid(h)&&(r+=h.height,s?s=!1:r+=t.vGap,o=Math.max(o,h.width))}}),{width:o,height:r}}layoutChildren(e,t,i,o,r,s,a){let u={x:i.paddingLeft+.5*(o-o/i.paddingFactor),y:i.paddingTop+.5*(r-r/i.paddingFactor)};return e.children.forEach(h=>{if((0,bd.isLayoutableChild)(h)){const g=t.getBoundsData(h),y=g.bounds,S=this.getChildLayoutOptions(h,i);y!==void 0&&bd.Dimension.isValid(y)&&(u=this.layoutChild(h,g,y,S,i,u,o,r,s,a))}}),u}layoutChild(e,t,i,o,r,s,a,u,h,g){const y=o.hGrab?"left":o.hAlign,S=this.getDx(y,i,a);let w=super.layoutChild(e,t,i,o,r,s,a,u);if(t.bounds={...t.bounds,x:s.x+S,y:s.y},o.hGrab&&(t.bounds={x:t.bounds.x,y:t.bounds.y,width:a,height:t.bounds.height},t.boundsChanged=!0),o.vGrab&&h&&g){const P=t.bounds.height+h/g;t.bounds={x:t.bounds.x,y:t.bounds.y,width:t.bounds.width,height:P},t.boundsChanged=!0,w={x:s.x,y:s.y+P}}return w}getFixedContainerBounds(e,t,i){var o,r;const s=e;if((0,bd.isBoundsAware)(s)){const a=s.bounds,u=this.getElementLayoutOptions(s),h=(o=u==null?void 0:u.prefWidth)!==null&&o!==void 0?o:0,g=(r=u==null?void 0:u.prefHeight)!==null&&r!==void 0?r:0;return{...a,width:h,height:g}}return bd.Bounds.EMPTY}getChildLayoutOptions(e,t){return super.getChildLayoutOptions(e,this.filterContainerOptions(t))}getLayoutOptions(e){return super.getLayoutOptions(e)}getElementLayoutOptions(e){return e.layoutOptions}getComputedContainerDimensions(e,t,i){return{width:t+e.paddingLeft+e.paddingRight,height:i+e.paddingTop+e.paddingBottom}}getFinalContainerBounds(e,t,i,o,r){var s,a;const u=this.getElementLayoutOptions(e),h=(s=u==null?void 0:u.prefWidth)!==null&&s!==void 0?s:i.minWidth,g=(a=u==null?void 0:u.prefHeight)!==null&&a!==void 0?a:i.minHeight;return{x:e.bounds.x,y:e.bounds.y,width:Math.max(h,o),height:Math.max(g,r)}}getDefaultLayoutOptions(){return{resizeContainer:!0,paddingTop:5,paddingBottom:5,paddingLeft:5,paddingRight:5,paddingFactor:1,vGap:1,hAlign:"center",minWidth:0,minHeight:0,hGrab:!1,vGrab:!1,prefHeight:null,prefWidth:null}}filterContainerOptions(e){return{...e,...{vGrab:!1,hGrab:!1,prefHeight:null,prefWidth:null}}}};Fg.VBoxLayouterExt=gP;gP.KIND=bd.VBoxLayouter.KIND;Fg.VBoxLayouterExt=gP=Rbe([(0,Mbe.injectable)()],gP);Object.defineProperty(ab,"__esModule",{value:!0});ab.boundsModule=void 0;const qn=z,Tbe=eh,yH=$g,Dbe=hu,Obe=kg,Lbe=pu,jbe=Mo,Nbe=Ss,Bbe=Fg;ab.boundsModule=new qn.FeatureModule((n,e,t,i)=>{const o={bind:n,isBound:t};(0,qn.configureCommand)(o,qn.SetBoundsCommand),(0,qn.configureCommand)(o,qn.RequestBoundsCommand),n(qn.HiddenBoundsUpdater).toSelf().inSingletonScope(),(0,qn.bindAsService)(o,qn.TYPES.HiddenVNodePostprocessor,Dbe.GLSPHiddenBoundsUpdater),(0,qn.configureCommand)(o,jbe.LocalComputedBoundsCommand),(0,qn.configureCommand)(o,Nbe.SetBoundsFeedbackCommand),n(qn.TYPES.Layouter).to(Lbe.LayouterExt).inSingletonScope(),n(qn.TYPES.LayoutRegistry).to(qn.LayoutRegistry).inSingletonScope(),(0,qn.configureLayout)(o,qn.VBoxLayouter.KIND,Bbe.VBoxLayouterExt),(0,qn.configureLayout)(o,qn.HBoxLayouter.KIND,Obe.HBoxLayouterExt),(0,qn.configureLayout)(o,yH.FreeFormLayouter.KIND,yH.FreeFormLayouter),n(Tbe.PositionSnapper).toSelf()},{featureId:Symbol("bounds")});var cb={},xg={},$be=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(xg,"__esModule",{value:!0});xg.GlspCommandPalette=void 0;const kbe=z,Fbe=k,kT=Ms;let cO=class extends kbe.CommandPalette{initializeContents(e){super.initializeContents(e),e.classList.add(kT.CSS_UI_EXTENSION_CLASS)}setContainerVisible(e){var t,i;e?(t=this.containerElement)===null||t===void 0||t.classList.remove(kT.CSS_HIDDEN_EXTENSION_CLASS):(i=this.containerElement)===null||i===void 0||i.classList.add(kT.CSS_HIDDEN_EXTENSION_CLASS)}};xg.GlspCommandPalette=cO;xg.GlspCommandPalette=cO=$be([(0,Fbe.injectable)()],cO);var Hg={},n9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},p3=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},dO;Object.defineProperty(Hg,"__esModule",{value:!0});Hg.CommandPaletteTool=void 0;const i9=k,uO=z;let um=dO=class{postConstruct(){this.commandPaletteKeyListener=this.createCommandPaletteKeyListener()}get id(){return dO.ID}enable(){this.keyTool.register(this.commandPaletteKeyListener)}disable(){this.keyTool.deregister(this.commandPaletteKeyListener)}createCommandPaletteKeyListener(){return new uO.CommandPaletteKeyListener}};Hg.CommandPaletteTool=um;um.ID="glsp.command-palette-tool";n9([(0,i9.inject)(uO.KeyTool),p3("design:type",uO.KeyTool)],um.prototype,"keyTool",void 0);n9([(0,i9.postConstruct)(),p3("design:type",Function),p3("design:paramtypes",[]),p3("design:returntype",void 0)],um.prototype,"postConstruct",null);Hg.CommandPaletteTool=um=dO=n9([(0,i9.injectable)()],um);var mu={},o9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},mq=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(mu,"__esModule",{value:!0});mu.ServerCommandPaletteActionProvider=mu.ServerCommandPalette=void 0;const r9=k,lO=z,xbe=Pt,bH=An;var u_;(function(n){n.CONTEXT_ID="command-palette",n.TEXT="text",n.INDEX="index"})(u_||(mu.ServerCommandPalette=u_={}));let py=class{async getActions(e,t,i,o){const r=lO.RequestContextActions.create({contextId:u_.CONTEXT_ID,editorContext:this.editorContext.get({[u_.TEXT]:t,[u_.INDEX]:o||0})}),s=await this.actionDispatcher.requestUntil(r);return s?this.getPaletteActionsFromResponse(s):[]}getPaletteActionsFromResponse(e){return lO.SetContextActions.is(e)?e.actions:[]}};mu.ServerCommandPaletteActionProvider=py;o9([(0,r9.inject)(lO.TYPES.IActionDispatcher),mq("design:type",xbe.GLSPActionDispatcher)],py.prototype,"actionDispatcher",void 0);o9([(0,r9.inject)(bH.EditorContextService),mq("design:type",bH.EditorContextService)],py.prototype,"editorContext",void 0);mu.ServerCommandPaletteActionProvider=py=o9([(0,r9.injectable)()],py);Object.defineProperty(cb,"__esModule",{value:!0});cb.commandPaletteModule=void 0;const Ka=z,Hbe=xg,Kbe=Hg,Vbe=mu;cb.commandPaletteModule=new Ka.FeatureModule(n=>{(0,Ka.bindAsService)(n,Ka.TYPES.IUIExtension,Hbe.GlspCommandPalette),n(Ka.TYPES.ICommandPaletteActionProviderRegistry).to(Ka.CommandPaletteActionProviderRegistry).inSingletonScope(),(0,Ka.bindAsService)(n,Ka.TYPES.ICommandPaletteActionProvider,Vbe.ServerCommandPaletteActionProvider),(0,Ka.bindAsService)(n,Ka.TYPES.IDefaultTool,Kbe.CommandPaletteTool)},{featureId:Symbol("commandPalette")});var db={},Kg={},ub=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},wp=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Kg,"__esModule",{value:!0});Kg.GLSPContextMenuMouseListener=void 0;const Rd=z,Zl=k,SH=Pt,zbe=Ma;let Ql=class extends Rd.MouseListener{initialize(){var e;(e=this.contextMenuServiceProvider)===null||e===void 0||e.call(this).then(t=>this.menuService=t)}contextMenu(e,t){return this.openContextMenu(e,t)}openContextMenu(e,t){return!this.menuService||!this.menuProvider?[]:[this.showContextMenuItems(e,t)]}async showContextMenuItems(e,t){await this.handleContextElementSelection(e,t);const i={x:t.x,y:t.y},o=await this.menuProvider.getItems(e.root,i);return this.menuService.show(o,i,()=>this.focusEventTarget(t)),zbe.FocusStateChangedAction.create(!1)}async handleContextElementSelection(e,t){const i=(0,Rd.findParentByFeature)(e,Rd.isSelectable);if(!i)return this.actionDispatcher.dispatch(Rd.SelectAction.setSelection([]));if(!i.selected)return this.actionDispatcher.dispatch(Rd.SelectAction.setSelection([i.id]))}focusEventTarget(e){const t=e.target instanceof SVGElement?e.target:void 0,i=t==null?void 0:t.closest("svg");i&&i.focus()}};Kg.GLSPContextMenuMouseListener=Ql;ub([(0,Zl.inject)(Rd.TYPES.IContextMenuServiceProvider),(0,Zl.optional)(),wp("design:type",Function)],Ql.prototype,"contextMenuServiceProvider",void 0);ub([(0,Zl.inject)(Rd.TYPES.IContextMenuProviderRegistry),(0,Zl.optional)(),wp("design:type",Rd.ContextMenuProviderRegistry)],Ql.prototype,"menuProvider",void 0);ub([(0,Zl.inject)(SH.GLSPActionDispatcher),wp("design:type",SH.GLSPActionDispatcher)],Ql.prototype,"actionDispatcher",void 0);ub([(0,Zl.postConstruct)(),wp("design:type",Function),wp("design:paramtypes",[]),wp("design:returntype",void 0)],Ql.prototype,"initialize",null);Kg.GLSPContextMenuMouseListener=Ql=ub([(0,Zl.injectable)()],Ql);var gu={},s9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},gq=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(gu,"__esModule",{value:!0});gu.ServerContextMenuItemProvider=gu.ServerContextMenu=void 0;const a9=k,m3=z,Gbe=Pt,EH=An;var fO;(function(n){n.CONTEXT_ID="context-menu"})(fO||(gu.ServerContextMenu=fO={}));let my=class{async getItems(e,t){const i=Array.from(e.index.all().filter(m3.isSelected).map(a=>a.id)),o=this.editorContext.getWithSelection(i),r=m3.RequestContextActions.create({contextId:fO.CONTEXT_ID,editorContext:o}),s=await this.actionDispatcher.requestUntil(r);return s?this.getContextActionsFromResponse(s):[]}getContextActionsFromResponse(e){return m3.SetContextActions.is(e)?e.actions:[]}};gu.ServerContextMenuItemProvider=my;s9([(0,a9.inject)(m3.TYPES.IActionDispatcher),gq("design:type",Gbe.GLSPActionDispatcher)],my.prototype,"actionDispatcher",void 0);s9([(0,a9.inject)(EH.EditorContextService),gq("design:type",EH.EditorContextService)],my.prototype,"editorContext",void 0);gu.ServerContextMenuItemProvider=my=s9([(0,a9.injectable)()],my);Object.defineProperty(db,"__esModule",{value:!0});db.contextMenuModule=void 0;const Bs=z,Ube=Kg,Ybe=gu;db.contextMenuModule=new Bs.FeatureModule(n=>{n(Bs.TYPES.IContextMenuServiceProvider).toProvider(e=>async()=>e.container.isBound(Bs.TYPES.IContextMenuService)?e.container.get(Bs.TYPES.IContextMenuService):(console.warn("'TYPES.IContextMenuService' is not bound. Use no-op implementation instead"),{show:()=>{}})),(0,Bs.bindAsService)(n,Bs.TYPES.MouseListener,Ube.GLSPContextMenuMouseListener),n(Bs.TYPES.IContextMenuProviderRegistry).to(Bs.ContextMenuProviderRegistry),(0,Bs.bindAsService)(n,Bs.TYPES.IContextMenuItemProvider,Ybe.ServerContextMenuItemProvider)},{featureId:Symbol("contextMenu")});var wR={},vc={},Vg=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},AR=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(vc,"__esModule",{value:!0});vc.ServerCopyPasteHandler=vc.LocalClipboardService=void 0;const zg=k,qbe=_g,Ap=z,Wbe=Pt,CH=An;let hO=class{clear(){this.currentId=void 0,this.data=void 0}put(e,t){this.currentId=t,this.data=e}get(e){if(e===this.currentId)return this.data}};vc.LocalClipboardService=hO;vc.LocalClipboardService=hO=Vg([(0,zg.injectable)()],hO);function Zbe(n){return JSON.stringify({clipboardId:n})}function Qbe(n){return n!==void 0&&"clipboardId"in n}function Xbe(n){const e=n.getData(vq),t=e?JSON.parse(e):void 0;return Qbe(t)?t.clipboardId:void 0}const vq="text/plain";let Xl=class{handleCopy(e){if(e.clipboardData&&this.shouldCopy(e)){const t=(0,qbe.v4)();e.clipboardData.setData(vq,Zbe(t)),this.actionDispatcher.request(Ap.RequestClipboardDataAction.create(this.editorContext.get())).then(i=>this.clipboardService.put(i.clipboardData,t)),e.preventDefault()}else e.clipboardData&&e.clipboardData.clearData(),this.clipboardService.clear()}handleCut(e){e.clipboardData&&this.shouldCopy(e)&&(this.handleCopy(e),this.actionDispatcher.dispatch(Ap.CutOperation.create(this.editorContext.get())),e.preventDefault())}handlePaste(e){if(e.clipboardData&&this.shouldPaste(e)){const t=Xbe(e.clipboardData),i=this.clipboardService.get(t);i&&this.actionDispatcher.dispatch(Ap.PasteOperation.create({clipboardData:i,editorContext:this.editorContext.get()})),e.preventDefault()}}shouldCopy(e){return this.editorContext.get().selectedElementIds.length>0&&this.isDiagramActive()}shouldPaste(e){return this.isDiagramActive()}isDiagramActive(){var e,t;return((t=(e=document.activeElement)===null||e===void 0?void 0:e.parentElement)===null||t===void 0?void 0:t.id)===this.viewerOptions.baseDiv}};vc.ServerCopyPasteHandler=Xl;Vg([(0,zg.inject)(Ap.TYPES.IActionDispatcher),AR("design:type",Wbe.GLSPActionDispatcher)],Xl.prototype,"actionDispatcher",void 0);Vg([(0,zg.inject)(Ap.TYPES.ViewerOptions),AR("design:type",Object)],Xl.prototype,"viewerOptions",void 0);Vg([(0,zg.inject)(Ap.TYPES.IAsyncClipboardService),AR("design:type",Object)],Xl.prototype,"clipboardService",void 0);Vg([(0,zg.inject)(CH.EditorContextService),AR("design:type",CH.EditorContextService)],Xl.prototype,"editorContext",void 0);vc.ServerCopyPasteHandler=Xl=Vg([(0,zg.injectable)()],Xl);var Gg={},c9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},g3=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Gg,"__esModule",{value:!0});Gg.CopyPasteStartup=void 0;const pO=z,vP=k;let gy=class{constructor(){this.toDispose=new pO.DisposableCollection}postModelInitialization(){if(!this.copyPasteHandler)return;const e=o=>{var r;(r=this.copyPasteHandler)===null||r===void 0||r.handleCopy(o)},t=o=>{var r;(r=this.copyPasteHandler)===null||r===void 0||r.handleCut(o)},i=o=>{var r;(r=this.copyPasteHandler)===null||r===void 0||r.handlePaste(o)};window.addEventListener("copy",e),window.addEventListener("cut",t),window.addEventListener("paste",i),this.toDispose.push(pO.Disposable.create(()=>{window.removeEventListener("copy",e),window.removeEventListener("cut",t),window.removeEventListener("paste",i)}))}dispose(){this.toDispose.dispose()}};Gg.CopyPasteStartup=gy;c9([(0,vP.inject)(pO.TYPES.ICopyPasteHandler),(0,vP.optional)(),g3("design:type",Object)],gy.prototype,"copyPasteHandler",void 0);c9([(0,vP.preDestroy)(),g3("design:type",Function),g3("design:paramtypes",[]),g3("design:returntype",void 0)],gy.prototype,"dispose",null);Gg.CopyPasteStartup=gy=c9([(0,vP.injectable)()],gy);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.standaloneCopyPasteModule=n.copyPasteModule=void 0;const e=z,t=vc,i=Gg;n.copyPasteModule=new e.FeatureModule((o,r,s)=>{o(e.TYPES.ICopyPasteHandler).to(t.ServerCopyPasteHandler),o(e.TYPES.IAsyncClipboardService).to(t.LocalClipboardService).inSingletonScope()},{featureId:Symbol("copyPaste")}),n.standaloneCopyPasteModule=new e.FeatureModule((o,r,s)=>{(0,e.bindAsService)(o,e.TYPES.IDiagramStartup,i.CopyPasteStartup)},{featureId:Symbol("standaloneCopyPaste"),requires:n.copyPasteModule})})(wR);var lb={},Ug={},Jbe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},v3;Object.defineProperty(Ug,"__esModule",{value:!0});Ug.GlspDecorationPlacer=void 0;const bv=z,eSe=k;let _P=v3=class extends bv.DecorationPlacer{getPosition(e){return e instanceof bv.GChildElement&&e.parent instanceof bv.GRoutableElement?super.getPosition(e):(0,bv.isSizeable)(e)?{x:-v3.DECORATION_OFFSET.x,y:-v3.DECORATION_OFFSET.y}:bv.Point.ORIGIN}};Ug.GlspDecorationPlacer=_P;_P.DECORATION_OFFSET={x:12,y:10};Ug.GlspDecorationPlacer=_P=v3=Jbe([(0,eSe.injectable)()],_P);Object.defineProperty(lb,"__esModule",{value:!0});lb.decorationModule=void 0;const FT=z,tSe=Ug;lb.decorationModule=new FT.FeatureModule(n=>{(0,FT.bindAsService)(n,FT.TYPES.IVNodePostprocessor,tSe.GlspDecorationPlacer)},{featureId:Symbol("decoration")});var Yg={},yo={},_q=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},yq=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},nSe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(yo,"__esModule",{value:!0});yo.templateToSchema=yo.AddTemplateElementsFeedbackCommand=yo.getTemplateElementId=yo.AddTemplateElementsAction=void 0;const yP=z,mO=k,iSe=Pt,oSe=Gn,rSe=kt,sSe=Mo;var gO;(function(n){n.KIND="addTemplateElements";function e(t){return{kind:n.KIND,...t}}n.create=e})(gO||(yo.AddTemplateElementsAction=gO={}));function bq(n){return typeof n=="string"?`${n}_feedback`:n.id}yo.getTemplateElementId=bq;let vy=class extends oSe.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){const t=this.action.templates.map(o=>Sq(o,e)).filter(rSe.isNotUndefined).map(o=>e.modelFactory.createElement(o)).map(o=>this.applyRootCssClasses(o,this.action.addClasses,this.action.removeClasses));t.forEach(o=>e.root.add(o));const i=t.map(o=>o.id);return sSe.LocalRequestBoundsAction.fromCommand(e,this.actionDispatcher,this.action,i)}applyRootCssClasses(e,t,i){return e.cssClasses=aSe(e.cssClasses,t,i),e}};yo.AddTemplateElementsFeedbackCommand=vy;vy.KIND=gO.KIND;_q([(0,mO.inject)(yP.TYPES.IActionDispatcher),yq("design:type",iSe.GLSPActionDispatcher)],vy.prototype,"actionDispatcher",void 0);yo.AddTemplateElementsFeedbackCommand=vy=_q([(0,mO.injectable)(),nSe(0,(0,mO.inject)(yP.TYPES.Action)),yq("design:paramtypes",[Object])],vy);function Sq(n,e){if(typeof n=="string"){const t=e.root.index.getById(n),i=t?e.modelFactory.createSchema(t):void 0;return i&&Eq(i),i}return n}yo.templateToSchema=Sq;function Eq(n){var e;return n.id=bq(n.id),(e=n.children)===null||e===void 0||e.forEach(t=>Eq(t)),n}function aSe(n,e,t){const i=n??[];return e&&(0,yP.distinctAdd)(i,...e),t&&(0,yP.remove)(i,...t),i}var _c={},cSe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},dSe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},uSe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(_c,"__esModule",{value:!0});_c.RemoveTemplateElementsFeedbackCommand=_c.RemoveTemplateElementsAction=void 0;const Cq=z,PH=k,lSe=Gn,fSe=yo;var vO;(function(n){n.KIND="removeTemplateElements";function e(t){return{kind:n.KIND,...t}}n.create=e})(vO||(_c.RemoveTemplateElementsAction=vO={}));let bP=class extends lSe.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){const t=e.root.index;for(const i of this.action.templates){const o=t.getById((0,fSe.getTemplateElementId)(i));o&&o instanceof Cq.GChildElement&&o.parent.remove(o)}return e.root}};_c.RemoveTemplateElementsFeedbackCommand=bP;bP.KIND=vO.KIND;_c.RemoveTemplateElementsFeedbackCommand=bP=cSe([(0,PH.injectable)(),uSe(0,(0,PH.inject)(Cq.TYPES.Action)),dSe("design:paramtypes",[Object])],bP);Object.defineProperty(Yg,"__esModule",{value:!0});Yg.elementTemplateModule=void 0;const xT=z,hSe=yo,pSe=_c;Yg.elementTemplateModule=new xT.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,xT.configureCommand)(o,hSe.AddTemplateElementsFeedbackCommand),(0,xT.configureCommand)(o,pSe.RemoveTemplateElementsFeedbackCommand)},{featureId:Symbol("elementTemplate")});var RR={},qg={},mSe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(qg,"__esModule",{value:!0});qg.ExportSvgActionHandler=void 0;const gSe=R7,vSe=k;let _O=class{handle(e){const t=new Blob([e.svg],{type:"text/plain;charset=utf-8"});(0,gSe.saveAs)(t,"diagram.svg")}};qg.ExportSvgActionHandler=_O;qg.ExportSvgActionHandler=_O=mSe([(0,vSe.injectable)()],_O);var Wg={},_Se=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Wg,"__esModule",{value:!0});Wg.GLSPSvgExporter=void 0;const wH=z,ySe=k,bSe=_g;let yO=class extends wH.SvgExporter{export(e,t){if(typeof document<"u"){let i=this.findSvgElement();if(i){i=this.prepareSvgElement(i,e,t);const o=this.createSvg(i,e),r=this.getSvgExport(o,i,e,t);this.actionDispatcher.dispatch(wH.ExportSvgAction.create(r))}}}createSvg(e,t){const i=e.id;try{return e.id=i||(0,bSe.v4)(),super.createSvg(e,t)}finally{e.id=i}}findSvgElement(){const e=document.getElementById(this.options.hiddenDiv);return e&&e.querySelector("svg")}prepareSvgElement(e,t,i){return e}copyStyles(e,t,i){this.copyStyle(e,t,i);for(let o=0;o<e.childNodes.length;++o){const r=e.childNodes[o],s=t.childNodes[o];r instanceof Element&&this.copyStyles(r,s,[])}}copyStyle(e,t,i){const o=getComputedStyle(e),r=getComputedStyle(t);let s="";for(let a=0;a<o.length;a++){const u=o[a];if(!i.includes(u)){const h=o.getPropertyValue(u),g=o.getPropertyPriority(u);r.getPropertyValue(u)!==h&&(this.shouldUpdateStyle(t)?t.style.setProperty(u,h):s+=`${u}: ${h}${g?" !"+g:""}; `)}}s!==""&&t.setAttribute("style",s.trim())}shouldUpdateStyle(e){return"tagName"in e&&"style"in e}getSvgExport(e,t,i,o){const r=this.getSvgExportStyle(t,i,o);return r?e.replace('style="',`style="${r}`):e}getSvgExportStyle(e,t,i){const o=this.getBounds(t);return`width: ${o.width}px !important;height: ${o.height}px !important;border: none !important;cursor: default !important;`}};Wg.GLSPSvgExporter=yO;Wg.GLSPSvgExporter=yO=_Se([(0,ySe.injectable)()],yO);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.standaloneExportModule=n.exportModule=void 0;const e=z,t=qg,i=Wg;n.exportModule=new e.FeatureModule((o,r,s)=>{const a={bind:o,isBound:s};(0,e.bindAsService)(a,e.TYPES.HiddenVNodePostprocessor,e.ExportSvgPostprocessor),(0,e.configureCommand)(a,e.ExportSvgCommand),o(e.TYPES.SvgExporter).to(i.GLSPSvgExporter).inSingletonScope()},{featureId:Symbol("export")}),n.standaloneExportModule=new e.FeatureModule((o,r,s)=>{const a={bind:o,isBound:s};(0,e.bindAsService)(a,e.TYPES.KeyListener,e.ExportSvgKeyListener),o(t.ExportSvgActionHandler).toSelf().inSingletonScope(),(0,e.configureActionHandler)(a,e.ExportSvgAction.KIND,t.ExportSvgActionHandler)},{featureId:Symbol("standaloneExport"),requires:n.exportModule})})(RR);var fb={},ds={},ni={},Zg={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.isReparentable=n.reparentFeature=n.isContainable=n.containerFeature=void 0,n.containerFeature=Symbol("containable");function e(i){return i.hasFeature(n.containerFeature)}n.isContainable=e,n.reparentFeature=Symbol("reparentFeature");function t(i){return i.hasFeature(n.reparentFeature)}n.isReparentable=t})(Zg);Object.defineProperty(ni,"__esModule",{value:!0});ni.GEdge=ni.GGraph=void 0;const Md=z,Pq=Cg,SSe=Zg;class wq extends Md.SGraphImpl{isContainableElement(e){return!0}}ni.GGraph=wq;wq.DEFAULT_FEATURES=[...Md.SGraphImpl.DEFAULT_FEATURES,SSe.containerFeature,Pq.argsFeature];class Aq extends Md.SEdgeImpl{localToParent(e){const t=(0,Md.getRouteBounds)(this.routingPoints),i={x:e.x+t.x,y:e.y+t.y,width:-1,height:-1};return(0,Md.isBounds)(e)&&(i.width=e.width,i.height=e.height),i}parentToLocal(e){const t=(0,Md.getRouteBounds)(this.routingPoints),i={x:e.x-t.x,y:e.y-t.y,width:-1,height:-1};return(0,Md.isBounds)(e)&&(i.width=e.width,i.height=e.height),i}}ni.GEdge=Aq;Aq.DEFAULT_FEATURES=[...Md.SEdgeImpl.DEFAULT_FEATURES,Pq.argsFeature];var hb={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.GReconnectHandle=n.createReconnectHandle=n.isTargetRoutingHandle=n.isSourceRoutingHandle=n.removeReconnectHandles=n.addReconnectHandles=n.isReconnectHandle=n.isReconnectable=n.reconnectFeature=void 0;const e=z;n.reconnectFeature=Symbol("reconnectFeature");function t(y){return y instanceof e.GRoutableElement&&y.hasFeature(n.reconnectFeature)}n.isReconnectable=t;const i=-2;function o(y){return y!==void 0&&y instanceof g}n.isReconnectHandle=o;function r(y){s(y),h(y,"source",i),h(y,"target",y.routingPoints.length)}n.addReconnectHandles=r;function s(y){y.removeAll(S=>S instanceof g)}n.removeReconnectHandles=s;function a(y,S){return S.pointIndex===i}n.isSourceRoutingHandle=a;function u(y,S){return S.pointIndex===y.routingPoints.length}n.isTargetRoutingHandle=u;function h(y,S,w){const P=new g;return P.kind=S,P.pointIndex=w,P.type="routing-point",S==="target"&&y.id===e.edgeInProgressID&&(P.id=e.edgeInProgressTargetHandleID),y.add(P),P}n.createReconnectHandle=h;class g extends e.GRoutingHandle{hasFeature(S){return S!==e.selectFeature&&super.hasFeature(S)}}n.GReconnectHandle=g})(hb);var Qg=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Fl=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},ESe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(ds,"__esModule",{value:!0});ds.TypeHintProvider=ds.ApplyTypeHintsCommand=ds.ApplyTypeHintsAction=void 0;const mo=z,Jl=k,AH=Pt,CSe=Gn,PSe=ni,Rq=kt,wSe=io,ASe=hb,HT=Zg;var SP;(function(n){n.KIND="applyTypeHints";function e(i){return mo.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(SP||(ds.ApplyTypeHintsAction=SP={}));let _y=class extends CSe.FeedbackCommand{constructor(e){super(),this.action=e,this.rank=-10}execute(e){return e.root.index.all().forEach(t=>{if(t instanceof mo.GShapeElement||t instanceof mo.GModelRoot)return this.applyShapeTypeHint(t);t instanceof PSe.GEdge&&this.applyEdgeTypeHint(t)}),e.root}applyEdgeTypeHint(e){const t=this.typeHintProvider.getEdgeTypeHint(e);t&&e.features instanceof Set&&(Va(e.features,mo.deletableFeature,t.deletable),Va(e.features,mo.editFeature,t.routable),Va(e.features,ASe.reconnectFeature,t.repositionable))}applyShapeTypeHint(e){const t=this.typeHintProvider.getShapeTypeHint(e);if(t&&e.features instanceof Set){Va(e.features,mo.deletableFeature,t.deletable),Va(e.features,mo.moveFeature,t.repositionable),Va(e.features,wSe.resizeFeature,t.resizable),Va(e.features,HT.reparentFeature,t.reparentable),Va(e.features,HT.containerFeature,!0),(0,HT.isContainable)(e)&&(e.isContainableElement=o=>this.isContainableElement(o,t));const i=(0,mo.isConnectable)(e)?e.canConnect.bind(e):void 0;Va(e.features,mo.connectableFeature,!0),(0,mo.isConnectable)(e)&&(e.canConnect=(o,r)=>this.canConnect(o,r,e,i))}}canConnect(e,t,i,o){var r;const s=this.typeHintProvider.getEdgeTypeHint(e.type);if(!s)return(r=o==null?void 0:o(e,t))!==null&&r!==void 0?r:!1;const a=t==="source"?s.sourceElementTypeIds:s.targetElementTypeIds;if(!a)return!0;const u=i.type+":";return a.some(h=>u.startsWith(h))}isContainableElement(e,t){var i,o;const r=(0,Rq.getElementTypeId)(e)+":";return(o=(i=t.containableElementTypeIds)===null||i===void 0?void 0:i.some(s=>r.startsWith(s)))!==null&&o!==void 0?o:!1}};ds.ApplyTypeHintsCommand=_y;_y.KIND=SP.KIND;Qg([(0,Jl.inject)(mo.TYPES.ITypeHintProvider),Fl("design:type",Object)],_y.prototype,"typeHintProvider",void 0);ds.ApplyTypeHintsCommand=_y=Qg([(0,Jl.injectable)(),ESe(0,(0,Jl.inject)(mo.TYPES.Action)),Fl("design:paramtypes",[Object])],_y);function Va(n,e,t){t&&!n.has(e)?n.add(e):!t&&n.has(e)&&n.delete(e)}let lm=class{constructor(){this.shapeHints=new Map,this.edgeHints=new Map}init(){this.typeHintsFeedback=this.feedbackActionDispatcher.createEmitter()}handle(e){this.shapeHints.clear(),this.edgeHints.clear(),e.shapeHints.forEach(t=>this.shapeHints.set(t.elementTypeId,t)),e.edgeHints.forEach(t=>this.edgeHints.set(t.elementTypeId,t)),this.typeHintsFeedback.add(SP.create()).submit()}getShapeTypeHint(e){return this.getTypeHint(e,this.shapeHints)}getEdgeTypeHint(e){return this.getTypeHint(e,this.edgeHints)}getTypeHint(e,t){const i=(0,Rq.getElementTypeId)(e);let o=t.get(i);if(o===void 0){const r=i.split(":");for(;o===void 0&&r.length>0;)if(r.pop(),o=t.get(r.join(":")),o){t.set(i,o);break}}return o}async postRequestModel(){const e=await this.actionDispatcher.request(mo.RequestTypeHintsAction.create());this.handle(e)}};ds.TypeHintProvider=lm;Qg([(0,Jl.inject)(mo.TYPES.IFeedbackActionDispatcher),Fl("design:type",Object)],lm.prototype,"feedbackActionDispatcher",void 0);Qg([(0,Jl.inject)(AH.GLSPActionDispatcher),Fl("design:type",AH.GLSPActionDispatcher)],lm.prototype,"actionDispatcher",void 0);Qg([(0,Jl.postConstruct)(),Fl("design:type",Function),Fl("design:paramtypes",[]),Fl("design:returntype",void 0)],lm.prototype,"init",null);ds.TypeHintProvider=lm=Qg([(0,Jl.injectable)()],lm);Object.defineProperty(fb,"__esModule",{value:!0});fb.typeHintsModule=void 0;const nl=z,AE=ds;fb.typeHintsModule=new nl.FeatureModule((n,e,t)=>{const i={bind:n,unbind:e,isBound:t};(0,nl.bindAsService)(i,nl.TYPES.ITypeHintProvider,AE.TypeHintProvider),n(nl.TYPES.IDiagramStartup).toService(AE.TypeHintProvider),(0,nl.configureActionHandler)(i,nl.SetTypeHintsAction.KIND,AE.TypeHintProvider),(0,nl.configureCommand)(i,AE.ApplyTypeHintsCommand)},{featureId:Symbol("typeHints")});var pb={},Xg={},yc={},_i={},nh=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},mb=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(_i,"__esModule",{value:!0});_i.BaseCreationTool=_i.BaseEditTool=void 0;const d9=z,ih=k,RSe=Pt,RH=An,MSe=It,MH=Xf,IH=Jf;let bc=class{constructor(){this.toDisposeOnDisable=new d9.DisposableCollection}disable(){this.toDisposeOnDisable.dispose()}get isEditTool(){return!0}dispatchActions(e){return this.actionDispatcher.dispatchAll(e)}createFeedbackEmitter(){return this.feedbackDispatcher.createEmitter()}registerFeedback(e,t=this,i){return this.feedbackDispatcher.registerFeedback(t,e,i)}deregisterFeedback(e=this,t){this.feedbackDispatcher.deregisterFeedback(e,t)}};_i.BaseEditTool=bc;nh([(0,ih.inject)(d9.TYPES.IFeedbackActionDispatcher),mb("design:type",Object)],bc.prototype,"feedbackDispatcher",void 0);nh([(0,ih.inject)(d9.TYPES.IActionDispatcher),mb("design:type",RSe.GLSPActionDispatcher)],bc.prototype,"actionDispatcher",void 0);nh([(0,ih.inject)(IH.GLSPMouseTool),mb("design:type",IH.GLSPMouseTool)],bc.prototype,"mouseTool",void 0);nh([(0,ih.inject)(MH.GLSPKeyTool),mb("design:type",MH.GLSPKeyTool)],bc.prototype,"keyTool",void 0);nh([(0,ih.inject)(RH.EditorContextService),mb("design:type",RH.EditorContextService)],bc.prototype,"editorContext",void 0);_i.BaseEditTool=bc=nh([(0,ih.injectable)()],bc);let bO=class extends bc{handle(e){if(this.isTriggerAction(e))return this.triggerAction=e,MSe.EnableToolsAction.create([this.id])}enable(){if(this.triggerAction===void 0)throw new TypeError(`Could not enable tool ${this.id}. The triggerAction cannot be undefined.`);this.doEnable()}};_i.BaseCreationTool=bO;_i.BaseCreationTool=bO=nh([(0,ih.injectable)()],bO);var Uc={},Ct={};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.outsideOfViewport=Ct.absoluteToLocal=Ct.absoluteToParent=Ct.toAbsoluteSize=Ct.toAbsolutePosition=Ct.toAbsoluteBounds=Ct.getViewportBounds=Ct.getAbsolutePositionByPoint=Ct.getAbsolutePosition=void 0;const vo=z;function ISe(n,e){return EP(n,{x:e.pageX,y:e.pageY})}Ct.getAbsolutePosition=ISe;function EP(n,e){let t=vo.Point.subtract(e,n.root.canvasBounds);const i=(0,vo.findParentByFeature)(n,vo.isViewport);if(i){const o=i.zoom,r=vo.Point.multiplyScalar(i.scroll,o);t=vo.Point.add(t,r),t=vo.Point.divideScalar(t,o)}return t}Ct.getAbsolutePositionByPoint=EP;function TSe(n,e){const t=EP(n,vo.Bounds.topLeft(e)),i=EP(n,vo.Bounds.bottomRight(e));return vo.Bounds.from(t,i)}Ct.getViewportBounds=TSe;function MR(n){const e=(0,vo.isAlignable)(n)?n.alignment:vo.Point.ORIGIN,t=e.x,i=e.y,o=n.bounds.width,r=n.bounds.height;return(0,vo.translateBounds)({x:t,y:i,width:o,height:r},n,n.root)}Ct.toAbsoluteBounds=MR;function DSe(n){return MR(n)}Ct.toAbsolutePosition=DSe;function OSe(n){return MR(n)}Ct.toAbsoluteSize=OSe;function LSe(n,e){return(0,vo.isBoundsAware)(n.parent)?SO(n.parent,e):SO(n,e)}Ct.absoluteToParent=LSe;function SO(n,e){const t=MR(n);return vo.Point.subtract(e,t)}Ct.absoluteToLocal=SO;function jSe(n,e){return n.x<e.scroll.x||n.x>e.scroll.x+e.canvasBounds.width||n.y<e.scroll.y||n.y>e.scroll.y+e.canvasBounds.height}Ct.outsideOfViewport=jSe;var Jg={},NSe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Jg,"__esModule",{value:!0});Jg.FeedbackEdgeEndView=void 0;const TH=z,BSe=k;let EO=class{render(e,t){var i;const o=(i=e.position)!==null&&i!==void 0?i:TH.Point.ORIGIN;return(0,TH.svg)("g",{x:o.x,y:o.y})}};Jg.FeedbackEdgeEndView=EO;Jg.FeedbackEdgeEndView=EO=NSe([(0,BSe.injectable)()],EO);(function(n){var e=f&&f.__decorate||function(b,v,R,D){var j=arguments.length,T=j<3?v:D===null?D=Object.getOwnPropertyDescriptor(v,R):D,$;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(b,v,R,D);else for(var Q=b.length-1;Q>=0;Q--)($=b[Q])&&(T=(j<3?$(T):j>3?$(v,R,T):$(v,R))||T);return j>3&&T&&Object.defineProperty(v,R,T),T},t=f&&f.__metadata||function(b,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(b,v)},i=f&&f.__param||function(b,v){return function(R,D){v(R,D,b)}};Object.defineProperty(n,"__esModule",{value:!0}),n.configureDanglingFeedbackEdge=n.removeDanglingFeedbackEdge=n.drawFeedbackEdge=n.defaultFeedbackEdgeSchema=n.feedbackEdgeEndId=n.feedbackEdgeId=n.FeedbackEdgeEnd=n.RemoveFeedbackEdgeCommand=n.RemoveFeedbackEdgeAction=n.DrawFeedbackEdgeCommand=n.DrawFeedbackEdgeAction=void 0;const o=z,r=k,s=gc,a=Gn,u=kt,h=Ct,g=Jg;var y;(function(b){b.KIND="drawFeedbackEdge";function v(D){return o.Action.hasKind(D,b.KIND)}b.is=v;function R(D){return{kind:b.KIND,...D}}b.create=R})(y||(n.DrawFeedbackEdgeAction=y={}));let S=class extends a.FeedbackCommand{constructor(v){super(),this.action=v}execute(v){return B(v,this.action.sourceId,this.action.elementTypeId,this.action.edgeSchema),v.root}};n.DrawFeedbackEdgeCommand=S,S.KIND=y.KIND,n.DrawFeedbackEdgeCommand=S=e([(0,r.injectable)(),i(0,(0,r.inject)(o.TYPES.Action)),t("design:paramtypes",[Object])],S);var w;(function(b){b.KIND="removeFeedbackEdgeCommand";function v(D){return o.Action.hasKind(D,b.KIND)}b.is=v;function R(){return{kind:b.KIND}}b.create=R})(w||(n.RemoveFeedbackEdgeAction=w={}));let P=class extends a.FeedbackCommand{execute(v){return U(v.root),v.root}};n.RemoveFeedbackEdgeCommand=P,P.KIND=w.KIND,n.RemoveFeedbackEdgeCommand=P=e([(0,r.injectable)()],P);class E extends o.GDanglingAnchor{constructor(v,R,D=void 0,j=E.TYPE){super(),this.sourceId=v,this.elementTypeId=R,this.feedbackEdge=D,this.type=j}}n.FeedbackEdgeEnd=E,E.DEFAULT_FEATURES=[o.deletableFeature,s.feedbackFeature],E.TYPE="feedback-edge-end";function A(b){return b.id+"_feedback_edge"}n.feedbackEdgeId=A;function L(b){return b.id+"_feedback_anchor"}n.feedbackEdgeEndId=L,n.defaultFeedbackEdgeSchema={cssClasses:["feedback-edge"],opacity:.3};function B(b,v,R,D){const j=b.root,T=j.index.getById(v);if(!T)return;const $=(0,o.findParentByFeature)(T,o.isConnectable);if(!$||!(0,o.isBoundsAware)($))return;const Q=new E($.id,R);Q.id=L(j),Q.position=(0,h.toAbsolutePosition)($);const K={id:A(j),type:R,sourceId:$.id,targetId:Q.id,...n.defaultFeedbackEdgeSchema,...D},Z=b.modelFactory.createElement(K);(0,u.isRoutable)(Z)&&(Q.feedbackEdge=Z,j.add(Q),j.add(Z))}n.drawFeedbackEdge=B;function U(b){const v=b.index.getById(A(b)),R=b.index.getById(L(b));v instanceof o.GChildElement&&b.remove(v),R instanceof o.GChildElement&&b.remove(R)}n.removeDanglingFeedbackEdge=U;function p(b){!b.isBound(S)&&!b.isBound(P)&&!b.isBound(g.FeedbackEdgeEndView)&&((0,o.configureCommand)(b,S),(0,o.configureCommand)(b,P),(0,o.configureView)(b,E.TYPE,g.FeedbackEdgeEndView))}n.configureDanglingFeedbackEdge=p})(Uc);var e1={};Object.defineProperty(e1,"__esModule",{value:!0});e1.FeedbackEdgeEndMovingMouseListener=void 0;const Fo=z,RE=Ct,DH=Uc;class $Se extends Fo.MouseListener{constructor(e,t){super(),this.anchorRegistry=e,this.feedbackDispatcher=t,this.feedback=t.createEmitter()}mouseMove(e,t){const i=e.root,o=i.index.getById((0,DH.feedbackEdgeEndId)(i));if(!(o instanceof DH.FeedbackEdgeEnd)||!o.feedbackEdge)return[];const r=o.feedbackEdge,s=(0,RE.getAbsolutePosition)(o,t),a=(0,Fo.findChildrenAtPosition)(e.root,s).reverse().find(u=>(0,Fo.isConnectable)(u)&&u.canConnect(r,"target"));if(a instanceof Fo.GConnectableElement&&r.source&&(0,Fo.isBoundsAware)(r.source)){const u=this.computeAbsoluteAnchor(a,Fo.Bounds.center((0,RE.toAbsoluteBounds)(r.source)));Fo.Point.euclideanDistance(u,o.position)>1&&this.feedback.add(Fo.MoveAction.create([{elementId:o.id,toPosition:u}],{animate:!1})).submit()}else this.feedback.add(Fo.MoveAction.create([{elementId:o.id,toPosition:s}],{animate:!1})).submit();return[]}computeAbsoluteAnchor(e,t,i){const o=(0,RE.absoluteToParent)(e,t);let s=this.anchorRegistry.get(Fo.PolylineEdgeRouter.KIND,e.anchorKind).getAnchor(e,o,i);if(e.parent!==e.root){const a=(0,Fo.findParentByFeature)(e.parent,Fo.isBoundsAware);if(a){const u=(0,RE.toAbsoluteBounds)(a);s=Fo.Point.add(u,s)}}return s}dispose(){this.feedback.dispose()}}e1.FeedbackEdgeEndMovingMouseListener=$Se;var IR=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},u9=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},CO;Object.defineProperty(yc,"__esModule",{value:!0});yc.EdgeCreationToolMouseListener=yc.EdgeCreationTool=void 0;const ns=z,yy=k,kSe=Kr,Jr=it,OH=It,FSe=ni,xSe=_i,LH=Uc,HSe=e1;let ef=CO=class extends xSe.BaseCreationTool{constructor(){super(...arguments),this.isTriggerAction=ns.TriggerEdgeCreationAction.is}get id(){return CO.ID}doEnable(){this.toolFeedback(),this.creationListener(),this.trackFeedbackEdge()}toolFeedback(){const e=this.createFeedbackEmitter().add((0,Jr.cursorFeedbackAction)(Jr.CursorCSS.OPERATION_NOT_ALLOWED),(0,Jr.cursorFeedbackAction)()).submit();this.toDisposeOnDisable.push(e)}creationListener(){const e=new Mq(this.triggerAction,this.actionDispatcher,this.typeHintProvider,this,this.grid?this.grid.x/2:void 0);this.toDisposeOnDisable.push(e,this.mouseTool.registerListener(e))}trackFeedbackEdge(){const e=new HSe.FeedbackEdgeEndMovingMouseListener(this.anchorRegistry,this.feedbackDispatcher);this.toDisposeOnDisable.push(e,this.mouseTool.registerListener(e))}};yc.EdgeCreationTool=ef;ef.ID="tool_create_edge";IR([(0,yy.inject)(ns.AnchorComputerRegistry),u9("design:type",ns.AnchorComputerRegistry)],ef.prototype,"anchorRegistry",void 0);IR([(0,yy.inject)(ns.TYPES.ITypeHintProvider),u9("design:type",Object)],ef.prototype,"typeHintProvider",void 0);IR([(0,yy.optional)(),(0,yy.inject)(ns.TYPES.Grid),u9("design:type",Object)],ef.prototype,"grid",void 0);yc.EdgeCreationTool=ef=CO=IR([(0,yy.injectable)()],ef);class Mq extends kSe.DragAwareMouseListener{constructor(e,t,i,o,r){super(r),this.triggerAction=e,this.actionDispatcher=t,this.typeHintProvider=i,this.tool=o,this.dragSensitivity=r,this.allowedTarget=!1,this.pendingDynamicCheck=!1,this.proxyEdge=new FSe.GEdge,this.proxyEdge.type=e.elementTypeId,this.cursorFeedback=o.createFeedbackEmitter(),this.feedbackEdgeFeedback=o.createFeedbackEmitter()}nonDraggingMouseUp(e,t){const i=[];return t.button===0?(this.isSourceSelected()?this.currentTarget&&this.allowedTarget&&(this.target=this.currentTarget.id):this.currentTarget&&this.allowedTarget&&(this.source=this.currentTarget.id,this.feedbackEdgeFeedback.add(LH.DrawFeedbackEdgeAction.create({elementTypeId:this.triggerAction.elementTypeId,sourceId:this.source}),LH.RemoveFeedbackEdgeAction.create()).submit()),this.source&&this.target&&(i.push(this.getCreateOperation(e,t,this.source,this.target)),this.isContinuousMode(e,t)?this.dispose():i.push(OH.EnableDefaultToolsAction.create()))):t.button===2&&(this.dispose(),i.push(OH.EnableDefaultToolsAction.create())),i}isContinuousMode(e,t){return(0,ns.isCtrlOrCmd)(t)}getCreateOperation(e,t,i,o){return ns.CreateEdgeOperation.create({elementTypeId:this.triggerAction.elementTypeId,sourceElementId:i,targetElementId:o,args:this.getCreateEdgeOperationArgs(e,t)})}getCreateEdgeOperationArgs(e,t){return{...this.triggerAction.args}}isSourceSelected(){return this.source!==void 0}isTargetSelected(){return this.target!==void 0}mouseOver(e,t){const i=(0,ns.findParentByFeature)(e,ns.isConnectable);if(i!==this.currentTarget){if(this.pendingDynamicCheck=!1,this.currentTarget=i,this.currentTarget){if(this.isSourceSelected()?this.isTargetSelected()||(this.allowedTarget=this.canConnect(i,"target")):this.allowedTarget=this.canConnect(i,"source"),this.pendingDynamicCheck)return[(0,Jr.cursorFeedbackAction)(Jr.CursorCSS.EDGE_CHECK_PENDING)]}else this.allowedTarget=!1;return[this.updateEdgeFeedback()]}return[]}updateEdgeFeedback(){return this.allowedTarget?this.isSourceSelected()?(0,Jr.cursorFeedbackAction)(Jr.CursorCSS.EDGE_CREATION_TARGET):(0,Jr.cursorFeedbackAction)(Jr.CursorCSS.EDGE_CREATION_SOURCE):(0,Jr.cursorFeedbackAction)(Jr.CursorCSS.OPERATION_NOT_ALLOWED)}canConnect(e,t){var i;if(!e||!(0,ns.isConnectable)(e)||!e.canConnect(this.proxyEdge,t))return!1;if(!this.isDynamic(this.proxyEdge.type))return!0;const o=(i=this.source)!==null&&i!==void 0?i:e,r=this.source?e:void 0;return this.pendingDynamicCheck=!0,this.actionDispatcher.request(ns.RequestCheckEdgeAction.create({sourceElement:o,targetElement:r,edgeType:this.proxyEdge.type})).then(s=>{this.pendingDynamicCheck&&(this.allowedTarget=s.isValid,this.actionDispatcher.dispatch(this.updateEdgeFeedback()),this.pendingDynamicCheck=!1)}).catch(s=>console.error("Dynamic edge check failed with: ",s)),!1}isDynamic(e){var t;const i=this.typeHintProvider.getEdgeTypeHint(e);return(t=i==null?void 0:i.dynamic)!==null&&t!==void 0?t:!1}dispose(){this.source=void 0,this.target=void 0,this.currentTarget=void 0,this.allowedTarget=!1,this.feedbackEdgeFeedback.dispose(),this.cursorFeedback.dispose(),super.dispose()}}yc.EdgeCreationToolMouseListener=Mq;var Ni={};Object.defineProperty(Ni,"__esModule",{value:!0});Ni.getSeverity=Ni.createGIssue=Ni.getGIssueMarker=Ni.getOrCreateGIssueMarker=Ni.GIssueMarker=void 0;const Rp=z;class l9 extends Rp.SIssueMarkerImpl{constructor(){super(),this.issues=[],this.type="marker",this.features=new Set(Rp.GDecoration.DEFAULT_FEATURES)}computeProjectionCssClasses(){const e=Tq(this);this.projectionCssClasses=["sprotty-issue","sprotty-"+e]}}Ni.GIssueMarker=l9;function KSe(n){let e;return e=Iq(n),e===void 0&&(e=new l9,(0,Rp.isBoundsAware)(n)&&(e.projectedBounds=n.parentToLocal(n.bounds)),n.add(e)),e}Ni.getOrCreateGIssueMarker=KSe;function Iq(n){let e;for(const t of n.children)t instanceof l9&&(e=t);return e}Ni.getGIssueMarker=Iq;function VSe(n,e){const t={message:n.description,severity:"info"};switch(n.kind){case Rp.MarkerKind.ERROR:{t.severity="error";break}case Rp.MarkerKind.INFO:{t.severity="info";break}case Rp.MarkerKind.WARNING:{t.severity="warning";break}}return t}Ni.createGIssue=VSe;function Tq(n){let e="info";for(const t of n.issues.map(i=>i.severity)){if(t==="error")return t;t==="warning"&&e==="info"&&(e=t)}return e}Ni.getSeverity=Tq;var zSe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Xg,"__esModule",{value:!0});Xg.GlspHoverMouseListener=void 0;const GSe=k,Yh=z,USe=Ma,jH=It,YSe=yc,NH=Ni;let PO=class extends Yh.HoverMouseListener{constructor(){super(...arguments),this.enableHover=!0}handle(e){if(USe.FocusStateChangedAction.is(e)&&!e.hasFocus){if(this.stopMouseOverTimer(),this.lastHoverFeedbackElementId){const t=this.lastHoverFeedbackElementId;return this.lastHoverFeedbackElementId=void 0,Yh.HoverFeedbackAction.create({mouseoverElement:t,mouseIsOver:!1})}}else jH.EnableToolsAction.is(e)?this.enableHover=!e.toolIds.includes(YSe.EdgeCreationTool.ID):jH.EnableDefaultToolsAction.is(e)&&(this.enableHover=!0)}mouseOver(e,t){return this.enableHover?super.mouseOver(e,t):[]}startMouseOverTimer(e,t){return this.stopMouseOverTimer(),new Promise(i=>{this.state.mouseOverTimer=window.setTimeout(()=>{const o=this.computePopupBounds(e,{x:t.pageX,y:t.pageY});e instanceof NH.GIssueMarker?i(Yh.SetPopupModelAction.create(this.createPopupModel(e,o))):i(Yh.RequestPopupModelAction.create({elementId:e.id,bounds:o})),this.state.popupOpen=!0,this.state.previousPopupElement=e},this.options.popupOpenDelay)})}createPopupModel(e,t){return e.issues!==void 0&&e.issues.length>0?{type:"html",id:"sprotty-popup",children:[this.createMarkerIssuePopup(e)],canvasBounds:this.modifyBounds(t)}:{type:Yh.EMPTY_ROOT.type,id:Yh.EMPTY_ROOT.id}}createMarkerIssuePopup(e){const t=this.createIssueMessage(e);return{type:"pre-rendered",id:"popup-title",code:`<div class="${(0,NH.getSeverity)(e)}"><div class="sprotty-popup-title">${t}</div></div>`}}createIssueMessage(e){return"<ul>"+e.issues.map(t=>"<li>"+t.severity.toUpperCase()+": "+t.message+"</li>").join("")+"</ul>"}modifyBounds(e){return e}};Xg.GlspHoverMouseListener=PO;Xg.GlspHoverMouseListener=PO=zSe([(0,GSe.injectable)()],PO);Object.defineProperty(pb,"__esModule",{value:!0});pb.hoverModule=void 0;const tt=z,BH=Ma,$H=It,ME=Xg;pb.hoverModule=new tt.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};(0,tt.bindAsService)(i,tt.TYPES.PopupVNodePostprocessor,tt.PopupPositionUpdater),(0,tt.bindAsService)(i,tt.TYPES.MouseListener,ME.GlspHoverMouseListener),(0,tt.bindAsService)(i,tt.TYPES.PopupMouseListener,tt.PopupHoverMouseListener),(0,tt.bindAsService)(i,tt.TYPES.KeyListener,tt.HoverKeyListener),n(tt.TYPES.HoverState).toConstantValue({mouseOverTimer:void 0,mouseOutTimer:void 0,popupOpen:!1,previousPopupElement:void 0}),n(tt.ClosePopupActionHandler).toSelf().inSingletonScope(),(0,tt.configureCommand)(i,tt.HoverFeedbackCommand),(0,tt.configureCommand)(i,tt.SetPopupModelCommand),(0,tt.configureActionHandler)(i,tt.SetPopupModelCommand.KIND,tt.ClosePopupActionHandler),(0,tt.configureActionHandler)(i,tt.FitToScreenCommand.KIND,tt.ClosePopupActionHandler),(0,tt.configureActionHandler)(i,tt.CenterCommand.KIND,tt.ClosePopupActionHandler),(0,tt.configureActionHandler)(i,tt.SetViewportCommand.KIND,tt.ClosePopupActionHandler),(0,tt.configureActionHandler)(i,tt.MoveCommand.KIND,tt.ClosePopupActionHandler),(0,tt.configureActionHandler)(i,BH.FocusStateChangedAction.KIND,tt.ClosePopupActionHandler),(0,tt.configureActionHandler)(i,$H.EnableToolsAction.KIND,ME.GlspHoverMouseListener),(0,tt.configureActionHandler)(i,$H.EnableDefaultToolsAction.KIND,ME.GlspHoverMouseListener),(0,tt.configureActionHandler)(i,BH.FocusStateChangedAction.KIND,ME.GlspHoverMouseListener)},{featureId:Symbol("hover")});var gb={},t1={},qSe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(t1,"__esModule",{value:!0});t1.GlspEditLabelUI=void 0;const WSe=z,ZSe=k,KT=Ms;let wO=class extends WSe.EditLabelUI{initializeContents(e){super.initializeContents(e),e.classList.add(KT.CSS_UI_EXTENSION_CLASS)}setContainerVisible(e){var t,i;e?((t=this.containerElement)===null||t===void 0||t.classList.remove(KT.CSS_HIDDEN_EXTENSION_CLASS),this.editControl.focus()):(i=this.containerElement)===null||i===void 0||i.classList.add(KT.CSS_HIDDEN_EXTENSION_CLASS)}};t1.GlspEditLabelUI=wO;t1.GlspEditLabelUI=wO=qSe([(0,ZSe.injectable)()],wO);Object.defineProperty(gb,"__esModule",{value:!0});gb.labelEditUiModule=void 0;const Sv=z,kH=t1;gb.labelEditUiModule=new Sv.FeatureModule((n,e,t,i,...o)=>{const r={bind:n,unbind:e,isBound:t,rebind:i};(0,Sv.configureActionHandler)(r,Sv.EditLabelAction.KIND,Sv.EditLabelActionHandler),n(kH.GlspEditLabelUI).toSelf().inSingletonScope(),n(Sv.TYPES.IUIExtension).toService(kH.GlspEditLabelUI)},{featureId:Symbol("labelEditUi")});var vb={},n1={},QSe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},AO;Object.defineProperty(n1,"__esModule",{value:!0});n1.DirectLabelEditTool=void 0;const XSe=k,FH=z,JSe=_i;let CP=AO=class extends JSe.BaseEditTool{get id(){return AO.ID}createEditLabelMouseListener(){return new FH.EditLabelMouseListener}createEditLabelKeyListener(){return new FH.EditLabelKeyListener}enable(){this.toDisposeOnDisable.push(this.mouseTool.registerListener(this.createEditLabelMouseListener()),this.keyTool.registerListener(this.createEditLabelKeyListener()))}};n1.DirectLabelEditTool=CP;CP.ID="glsp.direct-label-edit-tool";n1.DirectLabelEditTool=CP=AO=QSe([(0,XSe.injectable)()],CP);var us={},f9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},eEe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(us,"__esModule",{value:!0});us.BalloonLabelValidationDecorator=us.ServerEditLabelValidator=us.LabelEditValidation=void 0;const h9=k,l_=z,tEe=Pt;var PP;(function(n){n.CONTEXT_ID="label-edit";function e(i){const o=i.message;let r="ok";return l_.ValidationStatus.isError(i)?r="error":l_.ValidationStatus.isWarning(i)&&(r="warning"),{message:o,severity:r}}n.toEditLabelValidationResult=e;function t(i,o){return l_.RequestEditValidationAction.create({contextId:n.CONTEXT_ID,modelElementId:o,text:i})}n.createValidationRequestAction=t})(PP||(us.LabelEditValidation=PP={}));let wP=class{async validate(e,t){const i=PP.createValidationRequestAction(e,t.id),o=await this.actionDispatcher.requestUntil(i);return o?this.getValidationResultFromResponse(o):{severity:"ok"}}getValidationResultFromResponse(e){return l_.SetEditValidationResultAction.is(e)?PP.toEditLabelValidationResult(e.status):{severity:"ok"}}};us.ServerEditLabelValidator=wP;f9([(0,h9.inject)(l_.TYPES.IActionDispatcher),eEe("design:type",tEe.GLSPActionDispatcher)],wP.prototype,"actionDispatcher",void 0);us.ServerEditLabelValidator=wP=f9([(0,h9.injectable)()],wP);let RO=class{decorate(e,t){const i=e.parentElement;if(i)switch(t.message&&(i.setAttribute("data-balloon",t.message),i.setAttribute("data-balloon-pos","up-left"),i.setAttribute("data-balloon-visible","true")),t.severity){case"ok":i.classList.add("validation-ok");break;case"warning":i.classList.add("validation-warning");break;case"error":i.classList.add("validation-error");break}}dispose(e){const t=e.parentElement;t&&(t.removeAttribute("data-balloon"),t.removeAttribute("data-balloon-pos"),t.removeAttribute("data-balloon-visible"),t.classList.remove("validation-ok","validation-warning","validation-error"))}};us.BalloonLabelValidationDecorator=RO;us.BalloonLabelValidationDecorator=RO=f9([(0,h9.injectable)()],RO);Object.defineProperty(vb,"__esModule",{value:!0});vb.labelEditModule=void 0;const il=z,nEe=n1,xH=us;vb.labelEditModule=new il.FeatureModule((n,e,t,i)=>{n(il.TYPES.IEditLabelValidator).to(xH.ServerEditLabelValidator),n(il.TYPES.IEditLabelValidationDecorator).to(xH.BalloonLabelValidationDecorator),(0,il.bindAsService)(n,il.TYPES.IDefaultTool,nEe.DirectLabelEditTool),(0,il.configureCommand)({bind:n,isBound:t},il.ApplyLabelEditCommand)},{featureId:Symbol("labelEdit")});var _b={},on={},yn={};Object.defineProperty(yn,"__esModule",{value:!0});yn.toValidElementAndBounds=yn.toValidElementMove=yn.isValidMove=yn.isValidSize=yn.getLayoutOptions=yn.minDimensions=yn.minHeight=yn.minWidth=void 0;function TR(n){const e=p9(n);return e!==void 0&&typeof e.minWidth=="number"?e.minWidth:1}yn.minWidth=TR;function DR(n){const e=p9(n);return e!==void 0&&typeof e.minHeight=="number"?e.minHeight:1}yn.minHeight=DR;function iEe(n){return{width:TR(n),height:DR(n)}}yn.minDimensions=iEe;function p9(n){const e=n.layoutOptions;if(e!==void 0)return e}yn.getLayoutOptions=p9;function oEe(n,e){return e.width>=TR(n)&&e.height>=DR(n)}yn.isValidSize=oEe;function m9(n,e,t){var i;return(i=t==null?void 0:t.validate(n,e))!==null&&i!==void 0?i:!0}yn.isValidMove=m9;function rEe(n,e,t){if(m9(n,e.toPosition,t))return e}yn.toValidElementMove=rEe;function sEe(n,e,t){if(!m9(n,e.newPosition,t))return;const i=TR(n);e.newSize.width<i&&(e.newSize.width=i);const o=DR(n);return e.newSize.height<o&&(e.newSize.height=o),e}yn.toValidElementAndBounds=sEe;var i1=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},g9=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(on,"__esModule",{value:!0});on.AlignElementsActionHandler=on.AlignElementsAction=on.SelectFunction=on.Alignment=on.ResizeElementsActionHandler=on.LayoutElementsActionHandler=on.ResizeElementsAction=on.ReduceFunction=on.ResizeDimension=void 0;const hi=z,tf=k,HH=Yt,aEe=kt,Dq=yn,Oq=io;var Mp;(function(n){n[n.Width=0]="Width",n[n.Height=1]="Height",n[n.Width_And_Height=2]="Width_And_Height"})(Mp||(on.ResizeDimension=Mp={}));var MO;(function(n){function e(...a){return Math.min(...a)}n.min=e;function t(...a){return Math.max(...a)}n.max=t;function i(...a){return a.reduce((u,h)=>u+h,0)/a.length}n.avg=i;function o(...a){return a[0]}n.first=o;function r(...a){return a[a.length-1]}n.last=r;function s(a){return n[a]}n.get=s})(MO||(on.ReduceFunction=MO={}));var KH;(function(n){n.KIND="resizeElementAction";function e(i){return hi.Action.hasKind(i,n.KIND)&&(0,hi.hasArrayProp)(i,"elementIds")&&(0,hi.hasNumberProp)(i,"dimension")&&(0,hi.hasStringProp)(i,"reduceFunction")}n.is=e;function t(i){return{kind:n.KIND,dimension:Mp.Width,elementIds:[],...i}}n.create=t})(KH||(on.ResizeElementsAction=KH={}));let vu=class{getSelectedElements(e){const t=this.selectionService.getModelRoot().index,i=e.elementIds.length>0?e.elementIds:this.selectionService.getSelectedElementIDs();return(0,aEe.getElements)(t,i,this.isActionElement)}dispatchAction(e){this.actionDispatcher.dispatch(e)}dispatchActions(e){this.actionDispatcher.dispatchAll(e)}};on.LayoutElementsActionHandler=vu;i1([(0,tf.inject)(hi.TYPES.IActionDispatcher),g9("design:type",Object)],vu.prototype,"actionDispatcher",void 0);i1([(0,tf.inject)(HH.SelectionService),g9("design:type",HH.SelectionService)],vu.prototype,"selectionService",void 0);i1([(0,tf.inject)(hi.TYPES.IMovementRestrictor),(0,tf.optional)(),g9("design:type",Object)],vu.prototype,"movementRestrictor",void 0);on.LayoutElementsActionHandler=vu=i1([(0,tf.injectable)()],vu);let IO=class extends vu{handle(e){const t=this.getSelectedElements(e);if(t.length>1){const i=MO.get(e.reduceFunction);switch(e.dimension){case Mp.Width:return this.resizeWidth(t,i);case Mp.Height:return this.resizeHeight(t,i);case Mp.Width_And_Height:return this.resizeWidthAndHeight(t,i)}}}resizeWidth(e,t){const i=t(...e.map(o=>o.bounds.width));this.dispatchResizeActions(e,(o,r)=>{const s=.5*(i-o.bounds.width);r.newPosition.x=o.bounds.x-s,r.newSize.width=i})}resizeHeight(e,t){const i=t(...e.map(o=>o.bounds.height));this.dispatchResizeActions(e,(o,r)=>{const s=.5*(i-o.bounds.height);r.newPosition.y=o.bounds.y-s,r.newSize.height=i})}resizeWidthAndHeight(e,t){const i=t(...e.map(s=>s.bounds.width)),o=t(...e.map(s=>s.bounds.height)),r={width:i,height:o};this.dispatchResizeActions(e,(s,a)=>{const u=hi.Dimension.subtract(r,s.bounds),h=hi.Dimension.center(u);a.newPosition=hi.Point.subtract(s.bounds,h),a.newSize=r})}dispatchResizeActions(e,t){const i=[];e.forEach(o=>{const r=this.createElementAndBounds(o,t);r&&i.push(r)}),this.dispatchActions([hi.SetBoundsAction.create(i),hi.ChangeBoundsOperation.create(i)])}createElementAndBounds(e,t){const i={elementId:e.id,newPosition:{x:e.bounds.x,y:e.bounds.y},newSize:{width:e.bounds.width,height:e.bounds.height}};return t(e,i),(0,Dq.toValidElementAndBounds)(e,i,this.movementRestrictor)}isActionElement(e){return(0,Oq.isResizable)(e)}};on.ResizeElementsActionHandler=IO;on.ResizeElementsActionHandler=IO=i1([(0,tf.injectable)()],IO);var Za;(function(n){n[n.Left=0]="Left",n[n.Center=1]="Center",n[n.Right=2]="Right",n[n.Top=3]="Top",n[n.Middle=4]="Middle",n[n.Bottom=5]="Bottom"})(Za||(on.Alignment=Za={}));var TO;(function(n){function e(r){return r}n.all=e;function t(r){return[r[0]]}n.first=t;function i(r){return[r[r.length-1]]}n.last=i;function o(r){return n[r]}n.get=o})(TO||(on.SelectFunction=TO={}));var VH;(function(n){n.KIND="alignElements";function e(i){return hi.Action.hasKind(i,n.KIND)&&(0,hi.hasArrayProp)(i,"elementIds")&&(0,hi.hasNumberProp)(i,"alignment")&&(0,hi.hasStringProp)(i,"selectFunction")}n.is=e;function t(i={}){return{kind:n.KIND,elementIds:[],alignment:Za.Left,selectFunction:"all",...i}}n.create=t})(VH||(on.AlignElementsAction=VH={}));let DO=class extends vu{handle(e){const t=this.getSelectedElements(e),o=TO.get(e.selectFunction)(t);if(t.length>1)switch(e.alignment){case Za.Left:return this.alignLeft(o);case Za.Center:return this.alignCenter(o);case Za.Right:return this.alignRight(o);case Za.Top:return this.alignTop(o);case Za.Middle:return this.alignMiddle(o);case Za.Bottom:return this.alignBottom(o)}}alignLeft(e){const t=e.map(i=>i.bounds.x).reduce((i,o)=>Math.min(i,o));this.dispatchAlignActions(e,(i,o)=>o.toPosition.x=t)}alignCenter(e){const t=e.map(s=>s.bounds.x).reduce((s,a)=>Math.min(s,a)),o=e.map(s=>s.bounds.x+s.bounds.width).reduce((s,a)=>Math.max(s,a))-t,r=t+.5*o;this.dispatchAlignActions(e,(s,a)=>a.toPosition.x=r-.5*s.bounds.width)}alignRight(e){const t=e.map(i=>i.bounds.x+i.bounds.width).reduce((i,o)=>Math.max(i,o));this.dispatchAlignActions(e,(i,o)=>o.toPosition.x=t-i.bounds.width)}alignTop(e){const t=e.map(i=>i.bounds.y).reduce((i,o)=>Math.min(i,o));this.dispatchAlignActions(e,(i,o)=>o.toPosition.y=t)}alignMiddle(e){const t=e.map(s=>s.bounds.y).reduce((s,a)=>Math.min(s,a)),o=e.map(s=>s.bounds.y+s.bounds.height).reduce((s,a)=>Math.max(s,a))-t,r=t+.5*o;this.dispatchAlignActions(e,(s,a)=>a.toPosition.y=r-.5*s.bounds.height)}alignBottom(e){const t=e.map(i=>i.bounds.y+i.bounds.height).reduce((i,o)=>Math.max(i,o));this.dispatchAlignActions(e,(i,o)=>o.toPosition.y=t-i.bounds.height)}dispatchAlignActions(e,t){const i=[],o=[];e.forEach(r=>{const s=this.createElementMove(r,t);if(s){i.push(s);const a=this.createElementAndBounds(r,s);o.push(a)}}),this.dispatchActions([hi.MoveAction.create(i),hi.ChangeBoundsOperation.create(o)])}createElementMove(e,t){const i={elementId:e.id,fromPosition:{x:e.bounds.x,y:e.bounds.y},toPosition:{x:e.bounds.x,y:e.bounds.y}};return t(e,i),(0,Dq.toValidElementMove)(e,i,this.movementRestrictor)}createElementAndBounds(e,t){return{elementId:e.id,newPosition:{x:t.toPosition.x,y:t.toPosition.y},newSize:{width:e.bounds.width,height:e.bounds.height}}}isActionElement(e){return(0,Oq.isBoundsAwareMoveable)(e)}};on.AlignElementsActionHandler=DO;on.AlignElementsActionHandler=DO=i1([(0,tf.injectable)()],DO);Object.defineProperty(_b,"__esModule",{value:!0});_b.layoutModule=void 0;const VT=z,IE=on;_b.layoutModule=new VT.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};(0,VT.configureActionHandler)(i,IE.ResizeElementsAction.KIND,IE.ResizeElementsActionHandler),(0,VT.configureActionHandler)(i,IE.AlignElementsAction.KIND,IE.AlignElementsActionHandler)},{featureId:Symbol("layout")});var yb={},ia={},oh={},OR=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},v9=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(oh,"__esModule",{value:!0});oh.NavigationTargetResolver=void 0;const LR=k,Id=z;let fm=class{async resolve(e){return this.resolveWithSourceUri(this.diagramOptions.sourceUri,e)}async resolveWithSourceUri(e,t){const i=decodeURIComponent(t.uri);if(e&&e!==i&&`file://${e}`!==i){this.logger.info("Source and Target URI are different. Can't resolve locally.",e,i);return}if(Id.NavigationTarget.getElementIds(t).length>0)return Id.SetResolvedNavigationTargetAction.create(Id.NavigationTarget.getElementIds(t));const o=await this.requestResolution(t);if(Id.SetResolvedNavigationTargetAction.is(o))return o}requestResolution(e){return this.dispatcher.request(Id.ResolveNavigationTargetAction.create(e))}};oh.NavigationTargetResolver=fm;OR([(0,LR.inject)(Id.TYPES.IActionDispatcher),v9("design:type",Object)],fm.prototype,"dispatcher",void 0);OR([(0,LR.inject)(Id.TYPES.ILogger),v9("design:type",Object)],fm.prototype,"logger",void 0);OR([(0,LR.inject)(Id.TYPES.IDiagramOptions),v9("design:type",Object)],fm.prototype,"diagramOptions",void 0);oh.NavigationTargetResolver=fm=OR([(0,LR.injectable)()],fm);var o1=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},bb=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(ia,"__esModule",{value:!0});ia.NavigationActionHandler=ia.ProcessNavigationArgumentsAction=ia.NavigateAction=void 0;const On=z,r1=k,zH=oh;var OO;(function(n){n.KIND="navigate";function e(i){return On.Action.hasKind(i,n.KIND)&&(0,On.hasStringProp)(i,"targetTypeId")}n.is=e;function t(i,o={}){return{kind:n.KIND,targetTypeId:i,...o}}n.create=t})(OO||(ia.NavigateAction=OO={}));var AP;(function(n){n.KIND="processNavigationArguments";function e(i){return On.Action.hasKind(i,n.KIND)&&(0,On.hasObjectProp)(i,"args")}n.is=e;function t(i){return{kind:n.KIND,args:i}}n.create=t})(AP||(ia.ProcessNavigationArgumentsAction=AP={}));let _u=class{constructor(){this.notificationTimeout=5e3}handle(e){OO.is(e)?this.handleNavigateAction(e):On.NavigateToTargetAction.is(e)?this.handleNavigateToTarget(e):AP.is(e)?this.processNavigationArguments(e.args):On.NavigateToExternalTargetAction.is(e)&&this.handleNavigateToExternalTarget(e)}async handleNavigateAction(e){try{const i=(await this.editorContextService()).get(e.args),o=await this.dispatcher.request(On.RequestNavigationTargetsAction.create({targetTypeId:e.targetTypeId,editorContext:i}));if(On.SetNavigationTargetsAction.is(o)&&o.targets&&o.targets.length===1)return o.targets.length>1&&this.logger.warn(this,"Processing of multiple targets is not supported yet. Only the first is being processed.",o.targets),this.dispatcher.dispatch(On.NavigateToTargetAction.create(o.targets[0]));this.warnAboutFailedNavigation("No valid navigation target found")}catch(t){this.logger.error(this,"Failed to obtain navigation target",t,e)}}async handleNavigateToTarget(e){try{const t=await this.resolveElements(e);if(this.containsElementIdsOrArguments(t)){this.navigateTo(t),this.handleResolutionArguments(t);return}else{this.navigateToExternal(e.target);return}}catch(t){this.logger.error(this,"Failed to navigate",t,e)}}resolveElements(e){return this.resolver.resolve(e.target)}containsElementIdsOrArguments(e){return e!==void 0&&(this.containsElementIds(e.elementIds)||this.containsArguments(e.args))}containsElementIds(e){return e!==void 0&&e.length>0}containsArguments(e){return e!==void 0&&e!==void 0&&Object.keys(e).length>0}navigateTo(e){const t=e.elementIds;this.containsElementIds(t)&&this.dispatcher.dispatchAll([On.SelectAllAction.create(!1),On.SelectAction.create({selectedElementsIDs:t}),On.CenterAction.create(t)])}handleResolutionArguments(e){const t=e.args;this.containsArguments(t)&&this.dispatcher.dispatch(AP.create(t))}navigateToExternal(e){return this.dispatcher.dispatch(On.NavigateToExternalTargetAction.create(e))}processNavigationArguments(e){e.info&&e.info.toString().length>0&&this.notify("INFO",e.info.toString()),e.warning&&e.warning.toString().length>0&&this.notify("WARNING",e.warning.toString()),e.error&&e.error.toString().length>0&&this.notify("ERROR",e.error.toString())}async handleNavigateToExternalTarget(e){(await this.actionHandlerRegistryProvider()).get(On.NavigateToExternalTargetAction.KIND).length===1&&this.warnAboutFailedNavigation("Could not resolve or navigate to target",e.target)}warnAboutFailedNavigation(e,t){const i=`${e}`+(t?`: '${t.uri}' (arguments: ${JSON.stringify(t.args)})`:"");this.logger.warn(this,e,t),this.notify("WARNING",i)}notify(e,t){const i=this.notificationTimeout;this.dispatcher.dispatchAll([On.StatusAction.create(t,{severity:e,timeout:i}),On.MessageAction.create(t,{severity:e})])}};ia.NavigationActionHandler=_u;o1([(0,r1.inject)(On.TYPES.ILogger),bb("design:type",Object)],_u.prototype,"logger",void 0);o1([(0,r1.inject)(On.TYPES.IActionDispatcher),bb("design:type",Object)],_u.prototype,"dispatcher",void 0);o1([(0,r1.inject)(On.TYPES.ActionHandlerRegistryProvider),bb("design:type",Function)],_u.prototype,"actionHandlerRegistryProvider",void 0);o1([(0,r1.inject)(On.TYPES.IEditorContextServiceProvider),bb("design:type",Function)],_u.prototype,"editorContextService",void 0);o1([(0,r1.inject)(zH.NavigationTargetResolver),bb("design:type",zH.NavigationTargetResolver)],_u.prototype,"resolver",void 0);ia.NavigationActionHandler=_u=o1([(0,r1.injectable)()],_u);Object.defineProperty(yb,"__esModule",{value:!0});yb.navigationModule=void 0;const ol=z,rl=ia,cEe=oh;yb.navigationModule=new ol.FeatureModule((n,e,t)=>{n(cEe.NavigationTargetResolver).toSelf().inSingletonScope(),n(rl.NavigationActionHandler).toSelf().inSingletonScope(),(0,ol.configureActionHandler)({bind:n,isBound:t},rl.NavigateAction.KIND,rl.NavigationActionHandler),(0,ol.configureActionHandler)({bind:n,isBound:t},ol.NavigateToTargetAction.KIND,rl.NavigationActionHandler),(0,ol.configureActionHandler)({bind:n,isBound:t},rl.ProcessNavigationArgumentsAction.KIND,rl.NavigationActionHandler),(0,ol.configureActionHandler)({bind:n,isBound:t},ol.NavigateToExternalTargetAction.KIND,rl.NavigationActionHandler)},{featureId:Symbol("navigation")});var Sb={},Qi={},jR=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Qi,"__esModule",{value:!0});Qi.GLSPBezierEdgeRouter=Qi.GLSPManhattanEdgeRouter=Qi.GLSPPolylineEdgeRouter=Qi.GLSPAbstractEdgeRouter=void 0;const os=z,NR=k;let LO=class extends os.AbstractEdgeRouter{getTranslatedAnchor(e,t,i,o,r){const s=super.getTranslatedAnchor(e,t,i,o,r);return os.Point.isValid(s)?s:t}cleanupRoutingPoints(e,t,i,o){yu(e.source)&&yu(e.target)&&super.cleanupRoutingPoints(e,t,i,o)}};Qi.GLSPAbstractEdgeRouter=LO;Qi.GLSPAbstractEdgeRouter=LO=jR([(0,NR.injectable)()],LO);let jO=class extends os.PolylineEdgeRouter{getTranslatedAnchor(e,t,i,o,r){const s=super.getTranslatedAnchor(e,t,i,o,r);return os.Point.isValid(s)?s:t}cleanupRoutingPoints(e,t,i,o){yu(e.source)&&yu(e.target)&&super.cleanupRoutingPoints(e,t,i,o)}};Qi.GLSPPolylineEdgeRouter=jO;Qi.GLSPPolylineEdgeRouter=jO=jR([(0,NR.injectable)()],jO);let NO=class extends os.ManhattanEdgeRouter{getTranslatedAnchor(e,t,i,o,r){const s=super.getTranslatedAnchor(e,t,i,o,r);return os.Point.isValid(s)?s:t}applyInnerHandleMoves(e,t){const i=this.route(e),o=e.routingPoints,r=this.getOptions(e).minimalPointDistance;t.forEach(s=>{const a=s.handle,u=a.pointIndex,h=this.correctX(o,u,s.toPosition.x,r),g=this.correctY(o,u,s.toPosition.y,r);switch(a.kind){case"manhattan-50%":u<0?o.length===0?(o.push({x:h,y:g}),s.handle.pointIndex=0):(0,os.almostEquals)(i[0].x,i[1].x)?this.alignX(o,0,h):this.alignY(o,0,g):u<o.length-1?(0,os.almostEquals)(o[u].x,o[u+1].x)?(this.alignX(o,u,h),this.alignX(o,u+1,h)):(this.alignY(o,u,g),this.alignY(o,u+1,g)):(0,os.almostEquals)(i[i.length-2].x,i[i.length-1].x)?this.alignX(o,o.length-1,h):this.alignY(o,o.length-1,g);break}})}cleanupRoutingPoints(e,t,i,o){yu(e.source)&&yu(e.target)&&super.cleanupRoutingPoints(e,t,i,o)}};Qi.GLSPManhattanEdgeRouter=NO;Qi.GLSPManhattanEdgeRouter=NO=jR([(0,NR.injectable)()],NO);let BO=class extends os.BezierEdgeRouter{getTranslatedAnchor(e,t,i,o,r){const s=super.getTranslatedAnchor(e,t,i,o,r);return os.Point.isValid(s)?s:t}cleanupRoutingPoints(e,t,i,o){yu(e.source)&&yu(e.target)&&super.cleanupRoutingPoints(e,t,i,o)}};Qi.GLSPBezierEdgeRouter=BO;Qi.GLSPBezierEdgeRouter=BO=jR([(0,NR.injectable)()],BO);function yu(n){return n?n.bounds?!0:n.position&&n.size?(n.bounds={...n.position,...n.size},!0):!1:!1}Object.defineProperty(Sb,"__esModule",{value:!0});Sb.routingModule=void 0;const nt=z,zT=Qi;Sb.routingModule=new nt.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};n(nt.EdgeRouterRegistry).toSelf().inSingletonScope(),n(nt.AnchorComputerRegistry).toSelf().inSingletonScope(),(0,nt.bindAsService)(o,nt.TYPES.IEdgeRouter,zT.GLSPManhattanEdgeRouter),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.ManhattanEllipticAnchor),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.ManhattanRectangularAnchor),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.ManhattanDiamondAnchor),(0,nt.bindAsService)(o,nt.TYPES.IEdgeRouter,zT.GLSPPolylineEdgeRouter),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.EllipseAnchor),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.RectangleAnchor),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.DiamondAnchor),(0,nt.bindAsService)(o,nt.TYPES.IEdgeRouter,zT.GLSPBezierEdgeRouter),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.BezierEllipseAnchor),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.BezierRectangleAnchor),(0,nt.bindAsService)(o,nt.TYPES.IAnchorComputer,nt.BezierDiamondAnchor),(0,nt.configureCommand)({bind:n,isBound:t},nt.AddRemoveBezierSegmentCommand)},{featureId:Symbol("routing")});var BR={},s1={},dEe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},uEe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},lEe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(s1,"__esModule",{value:!0});s1.SelectFeedbackCommand=void 0;const GH=k,_3=z,fEe=Yt;let RP=class extends _3.Command{constructor(e){super(),this.action=e,this.sprottySelectCommand=new _3.SprottySelectCommand({...e,kind:_3.SelectAction.KIND})}execute(e){return this.sprottySelectCommand.execute(e)}undo(e){return this.sprottySelectCommand.undo(e)}redo(e){return this.sprottySelectCommand.redo(e)}};s1.SelectFeedbackCommand=RP;RP.KIND=fEe.SelectFeedbackAction.KIND;s1.SelectFeedbackCommand=RP=dEe([(0,GH.injectable)(),lEe(0,(0,GH.inject)(_3.TYPES.Action)),uEe("design:paramtypes",[Object])],RP);var a1={},Lq=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},hEe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(a1,"__esModule",{value:!0});a1.RankedSelectMouseListener=void 0;const ap=z,$O=k,pEe=Is,mEe=io;let MP=class extends ap.SelectMouseListener{constructor(){super(...arguments),this.rank=pEe.Ranked.DEFAULT_RANK-100}handleSelectTarget(e,t,i){const o=[];return o.push(ap.SelectAction.create({selectedElementsIDs:[e.id],deselectedElementsIDs:t.map(r=>r.id)})),o.push(ap.BringToFrontAction.create([e.id])),o}handleDeselectTarget(e,t){const i=[];return i.push(ap.SelectAction.create({selectedElementsIDs:[],deselectedElementsIDs:[e.id]})),i}handleDeselectAll(e,t){const i=[];return i.push(ap.SelectAction.create({selectedElementsIDs:[],deselectedElementsIDs:e.map(o=>o.id)})),i}handleButton(e,t){var i;return e instanceof mEe.GResizeHandle&&(!((i=this.changeBoundsManager)===null||i===void 0)&&i.useSymmetricResize(t))?[]:super.handleButton(e,t)}};a1.RankedSelectMouseListener=MP;Lq([(0,$O.inject)(ap.TYPES.IChangeBoundsManager),(0,$O.optional)(),hEe("design:type",Object)],MP.prototype,"changeBoundsManager",void 0);a1.RankedSelectMouseListener=MP=Lq([(0,$O.injectable)()],MP);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.standaloneSelectModule=n.selectModule=void 0;const e=z,t=Yt,i=s1,o=a1;n.selectModule=new e.FeatureModule((r,s,a)=>{const u={bind:r,isBound:a};(0,e.configureCommand)(u,t.SelectCommand),(0,e.configureCommand)(u,t.SelectAllCommand),(0,e.configureCommand)(u,i.SelectFeedbackCommand),(0,e.bindAsService)(u,e.TYPES.MouseListener,o.RankedSelectMouseListener)},{featureId:Symbol("select")}),n.standaloneSelectModule=new e.FeatureModule(r=>{(0,e.bindAsService)(r,e.TYPES.KeyListener,e.SelectKeyboardListener)},{featureId:Symbol("standaloneSelect"),requires:n.selectModule})})(BR);var Eb={},Sc={},Cb=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},_9=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.SourceModelChangedActionHandler=Sc.ExternalSourceModelChangedHandler=void 0;const hm=k,f_=z;let by=class{};Sc.ExternalSourceModelChangedHandler=by;Sc.ExternalSourceModelChangedHandler=by=Cb([(0,hm.injectable)()],by);let pm=class{handle(e){if(f_.SourceModelChangedAction.is(e)){if(this.externalModelSourceChangedHandler){this.externalModelSourceChangedHandler.notifySourceModelChange(e.sourceModelName,this.options).then(t=>this.dispatcher.dispatchAll(t));return}this.showSimpleNotification(e)}}showSimpleNotification(e){const t=`The source model ${e.sourceModelName} has changed. You might want to consider reloading.`,i=0,o="WARNING";this.dispatcher.dispatchAll([f_.StatusAction.create(t,{severity:o,timeout:i}),f_.MessageAction.create(t,{severity:o})])}};Sc.SourceModelChangedActionHandler=pm;Cb([(0,hm.inject)(f_.TYPES.IActionDispatcher),_9("design:type",Object)],pm.prototype,"dispatcher",void 0);Cb([(0,hm.inject)(f_.TYPES.ViewerOptions),_9("design:type",Object)],pm.prototype,"options",void 0);Cb([(0,hm.inject)(by),(0,hm.optional)(),_9("design:type",by)],pm.prototype,"externalModelSourceChangedHandler",void 0);Sc.SourceModelChangedActionHandler=pm=Cb([(0,hm.injectable)()],pm);Object.defineProperty(Eb,"__esModule",{value:!0});Eb.sourceModelWatcherModule=void 0;const GT=z,gEe=Sc;Eb.sourceModelWatcherModule=new GT.FeatureModule((n,e,t)=>{(0,GT.configureActionHandler)({bind:n,isBound:t},GT.SourceModelChangedAction.KIND,gEe.SourceModelChangedActionHandler)},{featureId:Symbol("sourceModelWatcher")});var Pb={},c1={},y9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},jq=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},kO;Object.defineProperty(c1,"__esModule",{value:!0});c1.StatusOverlay=void 0;const Ev=z,b9=k,UH=Pt,YH=An,vEe=Ms;let mm=kO=class extends vEe.GLSPAbstractUIExtension{id(){return kO.ID}containerClass(){return"sprotty-status"}initializeContents(e){this.statusIconDiv=document.createElement("div"),e.appendChild(this.statusIconDiv),this.statusMessageDiv=document.createElement("div"),this.statusMessageDiv.classList.add("sprotty-status-message"),e.appendChild(this.statusMessageDiv)}setStatus(e){if(this.statusMessageDiv&&(this.statusMessageDiv.textContent=e.message,this.removeClasses(this.statusMessageDiv,1),this.statusMessageDiv.classList.add(e.severity.toLowerCase())),this.statusIconDiv){this.removeClasses(this.statusIconDiv,0);const t=this.statusIconDiv.classList;switch(t.add(e.severity.toLowerCase()),e.severity){case"FATAL":t.add(...(0,Ev.codiconCSSClasses)("error"));break;case"ERROR":t.add(...(0,Ev.codiconCSSClasses)("warning"));break;case"WARNING":t.add(...(0,Ev.codiconCSSClasses)("warning"));break;case"INFO":t.add(...(0,Ev.codiconCSSClasses)("info"));break}}}clearStatus(){this.setStatus(Ev.StatusAction.create("",{severity:"NONE"}))}clearTimeout(){this.pendingTimeout&&(window.clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0)}removeClasses(e,t){const i=e.classList;for(;i.length>t;){const o=i.item(i.length-1);o&&i.remove(o)}}handle(e){var t;if(this.clearTimeout(),e.severity==="NONE"){this.clearStatus();return}this.setStatus(e);const i=(t=e.timeout)!==null&&t!==void 0?t:-1;i>0&&(this.pendingTimeout=window.setTimeout(()=>this.clearStatus(),i))}preInitialize(){this.show(this.editorContext.modelRoot)}};c1.StatusOverlay=mm;mm.ID="glsp.server.status.overlay";y9([(0,b9.inject)(UH.GLSPActionDispatcher),jq("design:type",UH.GLSPActionDispatcher)],mm.prototype,"actionDispatcher",void 0);y9([(0,b9.inject)(YH.EditorContextService),jq("design:type",YH.EditorContextService)],mm.prototype,"editorContext",void 0);c1.StatusOverlay=mm=kO=y9([(0,b9.injectable)()],mm);Object.defineProperty(Pb,"__esModule",{value:!0});Pb.statusModule=void 0;const qh=z,UT=c1;Pb.statusModule=new qh.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,qh.bindAsService)(o,qh.TYPES.IUIExtension,UT.StatusOverlay),n(qh.TYPES.IDiagramStartup).toService(UT.StatusOverlay),(0,qh.configureActionHandler)(o,qh.StatusAction.KIND,UT.StatusOverlay)},{featureId:Symbol("status")});var wb={},d1={},Nq=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},_Ee=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(d1,"__esModule",{value:!0});d1.MetadataPlacer=void 0;const qa=z,Bq=k,yEe=ni;let IP=class{decorate(e,t){return t instanceof qa.GModelRoot&&(0,qa.setAttr)(e,"data-svg-metadata-api",!0),(0,qa.setAttr)(e,"data-svg-metadata-type",t.type),t instanceof qa.GChildElement&&(0,qa.setAttr)(e,"data-svg-metadata-parent-id",this.domHelper.createUniqueDOMElementId(t.parent)),t instanceof yEe.GEdge&&(t.source!==void 0&&(0,qa.setAttr)(e,"data-svg-metadata-edge-source-id",this.domHelper.createUniqueDOMElementId(t.source)),t.target!==void 0&&(0,qa.setAttr)(e,"data-svg-metadata-edge-target-id",this.domHelper.createUniqueDOMElementId(t.target))),e}postUpdate(){}};d1.MetadataPlacer=IP;Nq([(0,Bq.inject)(qa.TYPES.DOMHelper),_Ee("design:type",qa.DOMHelper)],IP.prototype,"domHelper",void 0);d1.MetadataPlacer=IP=Nq([(0,Bq.injectable)()],IP);Object.defineProperty(wb,"__esModule",{value:!0});wb.svgMetadataModule=void 0;const qH=z,WH=d1;wb.svgMetadataModule=new qH.FeatureModule(n=>{n(WH.MetadataPlacer).toSelf().inSingletonScope(),n(qH.TYPES.IVNodePostprocessor).toService(WH.MetadataPlacer)},{featureId:Symbol("svgMetadata")});var Ab={},Tn={},mi={},Rb=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},bEe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},FO,xO;Object.defineProperty(mi,"__esModule",{value:!0});mi.DeleteToolMouseListener=mi.MouseDeleteTool=mi.DeleteKeyListener=mi.DelKeyDeleteTool=void 0;const Pr=z,Mb=k,YT=it,SEe=It,EEe=_i;let Sy=FO=class{constructor(){this.isEditTool=!0,this.deleteKeyListener=new TP}get id(){return FO.ID}enable(){this.keytool.register(this.deleteKeyListener)}disable(){this.keytool.deregister(this.deleteKeyListener)}};mi.DelKeyDeleteTool=Sy;Sy.ID="glsp.delete-keyboard";Rb([(0,Mb.inject)(Pr.KeyTool),bEe("design:type",Pr.KeyTool)],Sy.prototype,"keytool",void 0);mi.DelKeyDeleteTool=Sy=FO=Rb([(0,Mb.injectable)()],Sy);let TP=class extends Pr.KeyListener{keyDown(e,t){if((0,Pr.matchesKeystroke)(t,"Delete")){const i=Array.from(e.root.index.all().filter(o=>(0,Pr.isDeletable)(o)&&(0,Pr.isSelectable)(o)&&o.selected).filter(o=>o.id!==o.root.id).map(o=>o.id));if(i.length>0)return[Pr.DeleteElementOperation.create(i)]}return[]}};mi.DeleteKeyListener=TP;mi.DeleteKeyListener=TP=Rb([(0,Mb.injectable)()],TP);let DP=xO=class extends EEe.BaseEditTool{constructor(){super(...arguments),this.deleteToolMouseListener=new OP}get id(){return xO.ID}enable(){const e=this.createFeedbackEmitter().add((0,YT.cursorFeedbackAction)(YT.CursorCSS.ELEMENT_DELETION),(0,YT.cursorFeedbackAction)()).submit();this.toDisposeOnDisable.push(this.mouseTool.registerListener(this.deleteToolMouseListener),e)}};mi.MouseDeleteTool=DP;DP.ID="glsp.delete-mouse";mi.MouseDeleteTool=DP=xO=Rb([(0,Mb.injectable)()],DP);let OP=class extends Pr.MouseListener{mouseUp(e,t){const i=(0,Pr.findParentByFeature)(e,Pr.isDeletable);if(i===void 0)return[];const o=[];return o.push(Pr.DeleteElementOperation.create([i.id])),(0,Pr.isCtrlOrCmd)(t)||o.push(SEe.EnableDefaultToolsAction.create()),o}};mi.DeleteToolMouseListener=OP;mi.DeleteToolMouseListener=OP=Rb([(0,Mb.injectable)()],OP);var eo={},rh={},Ib={};(function(n){var e=f&&f.__decorate||function(E,A,L,B){var U=arguments.length,p=U<3?A:B===null?B=Object.getOwnPropertyDescriptor(A,L):B,b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(E,A,L,B);else for(var v=E.length-1;v>=0;v--)(b=E[v])&&(p=(U<3?b(p):U>3?b(A,L,p):b(A,L))||p);return U>3&&p&&Object.defineProperty(A,L,p),p},t=f&&f.__metadata||function(E,A){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(E,A)},i=f&&f.__param||function(E,A){return function(L,B){A(L,B,E)}};Object.defineProperty(n,"__esModule",{value:!0}),n.removeMarquee=n.drawMarquee=n.MARQUEE=n.marqueeId=n.MarqueeEndMovingMouseListener=n.RemoveMarqueeCommand=n.RemoveMarqueeAction=n.DrawMarqueeCommand=n.DrawMarqueeAction=void 0;const o=k,r=z,s=Gn;var a;(function(E){E.KIND="drawMarquee";function A(B){return r.Action.hasKind(B,E.KIND)&&(0,r.hasObjectProp)(B,"startPoint")&&(0,r.hasObjectProp)(B,"endPoint")}E.is=A;function L(B){return{kind:E.KIND,...B}}E.create=L})(a||(n.DrawMarqueeAction=a={}));let u=class extends s.FeedbackCommand{constructor(A){super(),this.action=A}execute(A){return w(A,this.action.startPoint,this.action.endPoint),A.root}};n.DrawMarqueeCommand=u,u.KIND=a.KIND,n.DrawMarqueeCommand=u=e([(0,o.injectable)(),i(0,(0,o.inject)(r.TYPES.Action)),t("design:paramtypes",[Object])],u);var h;(function(E){E.KIND="removeMarquee";function A(B){return r.Action.hasKind(B,E.KIND)}E.is=A;function L(){return{kind:E.KIND}}E.create=L})(h||(n.RemoveMarqueeAction=h={}));let g=class extends s.FeedbackCommand{execute(A){return P(A.root),A.root}};n.RemoveMarqueeCommand=g,g.KIND=h.KIND,n.RemoveMarqueeCommand=g=e([(0,o.injectable)()],g);class y extends r.MouseListener{constructor(A){super(),this.anchorRegistry=A}mouseMove(A,L){return[]}}n.MarqueeEndMovingMouseListener=y;function S(E){return E.id+"_"+n.MARQUEE}n.marqueeId=S,n.MARQUEE="marquee";function w(E,A,L){const B=E.root;P(B);const U={type:n.MARQUEE,id:S(B),startPoint:A,endPoint:L},p=E.modelFactory.createElement(U);B.add(p)}n.drawMarquee=w;function P(E){const A=E.index.getById(S(E));A instanceof r.GChildElement&&E.remove(A)}n.removeMarquee=P})(Ib);var CEe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},PEe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},qT=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(rh,"__esModule",{value:!0});rh.MarqueeUtil=void 0;const es=z,TE=k,ZH=ni,WT=kt,wEe=Ct,AEe=Ib;let HO=class{constructor(e={entireElement:!1,entireEdge:!1},t){this.marqueeBehavior=e,this.domHelper=t}isContinuousMode(e,t){return t.shiftKey}getMarkableNodes(e){return(0,WT.getMatchingElements)(e.index,this.isMarkableNode())}isMarkableNode(){return(0,es.typeGuard)((0,es.toTypeGuard)(es.GNode),WT.isSelectableAndBoundsAware)}getMarkableEdges(e){return(0,WT.getMatchingElements)(e.index,this.isMarkableEdge())}isMarkableEdge(){return(0,es.typeGuard)((0,es.toTypeGuard)(ZH.GEdge),es.isSelectable)}updateStartPoint(e){this.startPoint=e}updateCurrentPoint(e){this.currentPoint=e}isMarked(e){return e instanceof ZH.GEdge?this.isMarkedEdge(e):this.isMarkedNode(e)}drawMarqueeAction(){return AEe.DrawMarqueeAction.create({startPoint:this.startPoint,endPoint:this.currentPoint})}isMarkedEdge(e){const t=this.domHelper.createUniqueDOMElementId(e),i=document.getElementById(t);if(!i||i.getAttribute("transform")||!i.children[0])return!1;const o=i.children[0].getAttribute("d");return this.isEdgePathMarked(o)}isMarkedNode(e){return this.isNodeMarked(this.getNodeBounds(e))}getNodeBounds(e){return(0,wEe.toAbsoluteBounds)(e)}isEdgePathMarked(e){if(!e)return!1;const t=e.split(/M|L/).filter(i=>i).map(i=>{const o=i.split(",");return{x:parseInt(o[0],10),y:parseInt(o[1],10)}});return this.isEdgeMarked(t)}isEdgeMarked(e){return this.marqueeBehavior.entireEdge?this.isEntireEdgeMarked(e):this.isPartOfEdgeMarked(e)}isNodeMarked(e){const t=this.startPoint.x<this.currentPoint.x?this.isElementBetweenXAxis(e,this.startPoint.x,this.currentPoint.x):this.isElementBetweenXAxis(e,this.currentPoint.x,this.startPoint.x),i=this.startPoint.y<this.currentPoint.y?this.isElementBetweenYAxis(e,this.startPoint.y,this.currentPoint.y):this.isElementBetweenYAxis(e,this.currentPoint.y,this.startPoint.y);return t&&i}isEntireEdgeMarked(e){for(let t=0;t<e.length;t++)if(!this.pointInRect(e[t]))return!1;return!0}isPartOfEdgeMarked(e){for(let t=0;t<e.length-1;t++)if(this.isLineMarked(e[t],e[t+1]))return!0;return!1}isLineMarked(e,t){const i=new es.PointToPointLine(e,t);return this.pointInRect(e)||this.pointInRect(t)||this.lineIntersect(i,this.startPoint,{x:this.startPoint.x,y:this.currentPoint.y})||this.lineIntersect(i,this.startPoint,{x:this.currentPoint.x,y:this.startPoint.y})||this.lineIntersect(i,{x:this.currentPoint.x,y:this.startPoint.y},this.currentPoint)||this.lineIntersect(i,{x:this.startPoint.x,y:this.currentPoint.y},this.currentPoint)}lineIntersect(e,t,i){return e.intersection(new es.PointToPointLine(t,i))!==void 0}pointInRect(e){const t=this.startPoint.x<=this.currentPoint.x?this.isBetween(e.x,this.startPoint.x,this.currentPoint.x):this.isBetween(e.x,this.currentPoint.x,this.startPoint.x),i=this.startPoint.y<=this.currentPoint.y?this.isBetween(e.y,this.startPoint.y,this.currentPoint.y):this.isBetween(e.y,this.currentPoint.y,this.startPoint.y);return t&&i}isElementBetweenXAxis(e,t,i){const o=this.isBetween(e.x,t,i),r=this.isBetween(e.x+e.width,t,i);return this.marqueeBehavior.entireElement?o&&r:o||r||this.isBetween(t,e.x,e.x+e.width)||this.isBetween(i,e.x,e.x+e.width)}isElementBetweenYAxis(e,t,i){const o=this.isBetween(e.y,t,i),r=this.isBetween(e.y+e.height,t,i);return this.marqueeBehavior.entireElement?o&&r:o||r||this.isBetween(t,e.y,e.y+e.height)||this.isBetween(i,e.y,e.y+e.height)}isBetween(e,t,i){return t<=e&&e<=i}};rh.MarqueeUtil=HO;rh.MarqueeUtil=HO=CEe([(0,TE.injectable)(),qT(0,(0,TE.inject)(es.TYPES.IMarqueeBehavior)),qT(0,(0,TE.optional)()),qT(1,(0,TE.inject)(es.TYPES.DOMHelper)),PEe("design:paramtypes",[Object,es.DOMHelper])],HO);var S9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},REe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},KO;Object.defineProperty(eo,"__esModule",{value:!0});eo.ShiftKeyListener=eo.MarqueeMouseListener=eo.MarqueeMouseTool=void 0;const y3=z,E9=k,MEe=Kr,ZT=it,$q=It,QH=kt,XH=Ct,IEe=_i,JH=rh,VO=Ib;let Ey=KO=class extends IEe.BaseEditTool{constructor(){super(...arguments),this.shiftKeyListener=new LP}get id(){return KO.ID}enable(){this.toDisposeOnDisable.push(this.mouseTool.registerListener(new kq(this.editorContext.modelRoot,this.marqueeUtil)),this.keyTool.registerListener(this.shiftKeyListener),this.createFeedbackEmitter().add((0,ZT.cursorFeedbackAction)(ZT.CursorCSS.MARQUEE),(0,ZT.cursorFeedbackAction)()).submit())}get isEditTool(){return!1}};eo.MarqueeMouseTool=Ey;Ey.ID="glsp.marquee-mouse-tool";S9([(0,E9.inject)(JH.MarqueeUtil),REe("design:type",JH.MarqueeUtil)],Ey.prototype,"marqueeUtil",void 0);eo.MarqueeMouseTool=Ey=KO=S9([(0,E9.injectable)()],Ey);class kq extends MEe.DragAwareMouseListener{constructor(e,t){super(),this.marqueeUtil=t,this.isActive=!1,this.nodes=this.marqueeUtil.getMarkableNodes(e),this.edges=this.marqueeUtil.getMarkableEdges(e)}mouseDown(e,t){return this.isActive=!0,this.marqueeUtil.updateStartPoint((0,XH.getAbsolutePosition)(e,t)),t.ctrlKey&&(this.previouslySelected=(0,QH.getMatchingElements)(e.index,(0,y3.typeGuard)(QH.isSelectableAndBoundsAware,y3.isSelected)).map(i=>i.id)),[]}mouseMove(e,t){if(this.marqueeUtil.updateCurrentPoint((0,XH.getAbsolutePosition)(e,t)),this.isActive){const i=this.nodes.filter(a=>this.marqueeUtil.isMarked(a)).map(a=>a.id),o=this.edges.filter(a=>this.marqueeUtil.isMarked(a)).map(a=>a.id),s=i.concat(o).concat(this.previouslySelected);return[y3.SelectAction.setSelection(s),this.marqueeUtil.drawMarqueeAction()]}return[]}mouseUp(e,t){return this.isActive=!1,this.marqueeUtil.isContinuousMode(e,t)?[VO.RemoveMarqueeAction.create()]:[VO.RemoveMarqueeAction.create(),$q.EnableDefaultToolsAction.create()]}}eo.MarqueeMouseListener=kq;let LP=class extends y3.KeyListener{keyUp(e,t){return t.shiftKey?[]:[VO.RemoveMarqueeAction.create(),$q.EnableDefaultToolsAction.create()]}};eo.ShiftKeyListener=LP;eo.ShiftKeyListener=LP=S9([(0,E9.injectable)()],LP);var Ec={},TEe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},DEe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},OEe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Ec,"__esModule",{value:!0});Ec.OriginViewportCommand=Ec.OriginViewportAction=void 0;const gp=z,eK=k;var zO;(function(n){n.KIND="originViewport";function e(i){return gp.Action.hasKind(i,n.KIND)}n.is=e;function t(i={}){return{kind:n.KIND,animate:!0,...i}}n.create=t})(zO||(Ec.OriginViewportAction=zO={}));let jP=class extends gp.BoundsAwareViewportCommand{constructor(e){super(e.animate),this.action=e}getElementIds(){return[]}initialize(e){if(!(0,gp.isViewport)(e))return;this.oldViewport={scroll:e.scroll,zoom:e.zoom};const t=this.getNewViewport(gp.Bounds.EMPTY,e);if(t){const{zoomLimits:i,horizontalScrollLimits:o,verticalScrollLimits:r}=this.viewerOptions;this.newViewport=(0,gp.limitViewport)(t,e.canvasBounds,o,r,i)}}getNewViewport(e,t){return{zoom:1,scroll:{x:0,y:0}}}};Ec.OriginViewportCommand=jP;jP.KIND=zO.KIND;Ec.OriginViewportCommand=jP=TEe([(0,eK.injectable)(),OEe(0,(0,eK.inject)(gp.TYPES.Action)),DEe("design:paramtypes",[Object])],jP);var sh=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Gd=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},cp;Object.defineProperty(Tn,"__esModule",{value:!0});Tn.changeCodiconClass=Tn.changeCSSClass=Tn.createToolGroup=Tn.createIcon=Tn.compare=Tn.ToolPalette=Tn.EnableToolPaletteAction=void 0;const Oi=z,Cc=k,tK=Pt,nK=An,iK=Vc,DE=It,LEe=Ms,jEe=mi,NEe=eo,BEe=Ec,za="clicked",$Ee="search",oK="tools",rK="chevron-right",sK="500px";var aK;(function(n){n.KIND="enableToolPalette";function e(i){return Oi.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(aK||(Tn.EnableToolPaletteAction=aK={}));let ha=cp=class extends LEe.GLSPAbstractUIExtension{constructor(){super(...arguments),this.paletteItemsCopy=[],this.dynamic=!1}id(){return cp.ID}containerClass(){return cp.ID}postConstruct(){this.editorContext.onEditModeChanged(e=>this.editModeChanged(e.newValue,e.oldValue))}initialize(){return this.paletteItems?super.initialize():!1}initializeContents(e){this.createHeader(),this.createBody(),this.lastActiveButton=this.defaultToolsButton,e.setAttribute("aria-label","Tool-Palette")}onBeforeShow(e,t){this.modelRootId=t.id,this.containerElement.style.maxHeight=sK}addMinimizePaletteButton(){const e=document.getElementById(this.options.baseDiv),t=document.createElement("div");if(t.classList.add("minimize-palette-button"),this.containerElement.classList.add("collapsible-palette"),e){const i=e.insertBefore(t,e.firstChild),o=xo(rK);this.updateMinimizePaletteButtonTooltip(t),o.onclick=r=>{this.isPaletteMaximized()?this.containerElement.style.maxHeight="0px":this.containerElement.style.maxHeight=sK,this.updateMinimizePaletteButtonTooltip(t),YO(o,oK),YO(o,rK)},i.appendChild(o)}}updateMinimizePaletteButtonTooltip(e){this.isPaletteMaximized()?e.title="Minimize palette":e.title="Maximize palette"}isPaletteMaximized(){return this.containerElement&&this.containerElement.style.maxHeight!=="0px"}createBody(){const e=document.createElement("div");e.classList.add("palette-body");let t=0;if(this.paletteItems.sort(GO).forEach(i=>{if(i.children){const o=Fq(i);i.children.sort(GO).forEach(r=>o.appendChild(this.createToolButton(r,t++))),e.appendChild(o)}else e.appendChild(this.createToolButton(i,t++))}),this.paletteItems.length===0){const i=document.createElement("div");i.innerText="No results found.",i.classList.add("tool-button"),e.appendChild(i)}this.bodyDiv&&this.containerElement.removeChild(this.bodyDiv),this.containerElement.appendChild(e),this.bodyDiv=e}createHeader(){this.addMinimizePaletteButton();const e=document.createElement("div");e.classList.add("palette-header"),e.append(this.createHeaderTitle()),e.appendChild(this.createHeaderTools()),e.appendChild(this.searchField=this.createHeaderSearchField()),this.containerElement.appendChild(e)}createHeaderTools(){const e=document.createElement("div");e.classList.add("header-tools"),this.defaultToolsButton=this.createDefaultToolButton(),e.appendChild(this.defaultToolsButton);const t=this.createMouseDeleteToolButton();e.appendChild(t);const i=this.createMarqueeToolButton();e.appendChild(i);const o=this.createValidateButton();e.appendChild(o);const r=this.createResetViewportButton();if(e.appendChild(r),this.gridManager){const a=this.createToggleGridButton();e.appendChild(a)}if(this.debugManager){const a=this.createToggleDebugButton();e.appendChild(a)}const s=this.createSearchButton();return e.appendChild(s),e}createDefaultToolButton(){const e=xo("inspect");return e.id="btn_default_tools",e.title="Enable selection tool",e.onclick=this.onClickStaticToolButton(e),e.ariaLabel=e.title,e.tabIndex=1,e}createMouseDeleteToolButton(){const e=xo("chrome-close");return e.title="Enable deletion tool",e.onclick=this.onClickStaticToolButton(e,jEe.MouseDeleteTool.ID),e.ariaLabel=e.title,e.tabIndex=1,e}createMarqueeToolButton(){const e=xo("screen-full");return e.title="Enable marquee tool",e.onclick=this.onClickStaticToolButton(e,NEe.MarqueeMouseTool.ID),e.ariaLabel=e.title,e.tabIndex=1,e}createValidateButton(){const e=xo("pass");return e.title="Validate model",e.onclick=t=>{const i=[this.modelRootId];this.actionDispatcher.dispatch(Oi.RequestMarkersAction.create(i,{reason:Oi.MarkersReason.BATCH})),e.focus()},e.ariaLabel=e.title,e.tabIndex=1,e}createResetViewportButton(){const e=xo("screen-normal");return e.title="Reset Viewport",e.onclick=t=>{this.actionDispatcher.dispatch(BEe.OriginViewportAction.create()),e.focus()},e.ariaLabel=e.title,e.tabIndex=1,e}createToggleGridButton(){var e;const t=xo("symbol-numeric");return t.title="Toggle Grid",t.onclick=()=>{var i,o,r;!((i=this.gridManager)===null||i===void 0)&&i.isGridVisible?(t.classList.remove(za),(o=this.gridManager)===null||o===void 0||o.setGridVisible(!1)):(t.classList.add(za),(r=this.gridManager)===null||r===void 0||r.setGridVisible(!0))},!((e=this.gridManager)===null||e===void 0)&&e.isGridVisible&&t.classList.add(za),t.ariaLabel=t.title,t.tabIndex=1,t}createToggleDebugButton(){var e;const t=xo("debug");return t.title="Debug Mode",t.onclick=()=>{var i,o,r;!((i=this.debugManager)===null||i===void 0)&&i.isDebugEnabled?(t.classList.remove(za),(o=this.debugManager)===null||o===void 0||o.setDebugEnabled(!1)):(t.classList.add(za),(r=this.debugManager)===null||r===void 0||r.setDebugEnabled(!0))},!((e=this.debugManager)===null||e===void 0)&&e.isDebugEnabled&&t.classList.add(za),t.ariaLabel=t.title,t.tabIndex=1,t}createSearchButton(){const e=xo($Ee);return e.onclick=t=>{const i=document.getElementById(this.containerElement.id+"_search_field");i&&(i.style.display==="none"?(i.style.display="",i.focus()):i.style.display="none")},e.classList.add("search-icon"),e.title="Filter palette entries",e.ariaLabel=e.title,e.tabIndex=1,e}createHeaderSearchField(){const e=document.createElement("input");return e.classList.add("search-input"),e.id=this.containerElement.id+"_search_field",e.type="text",e.placeholder="Search...",e.style.display="none",e.onkeyup=()=>this.requestFilterUpdate(this.searchField.value),e.onkeydown=t=>this.clearOnEscape(t),e}createHeaderTitle(){const e=document.createElement("div");return e.classList.add("header-icon"),e.appendChild(xo(oK)),e.insertAdjacentText("beforeend","Palette"),e}createToolButton(e,t){const i=document.createElement("div");return i.tabIndex=t,i.classList.add("tool-button"),e.icon&&i.appendChild(xo(e.icon)),i.insertAdjacentText("beforeend",e.label),i.onclick=this.onClickCreateToolButton(i,e),i.onkeydown=o=>this.clearToolOnEscape(o),i}onClickCreateToolButton(e,t){return i=>{this.editorContext.isReadonly||(this.actionDispatcher.dispatchAll(t.actions),this.changeActiveButton(e),e.focus())}}onClickStaticToolButton(e,t){return i=>{if(!this.editorContext.isReadonly){const o=t?DE.EnableToolsAction.create([t]):DE.EnableDefaultToolsAction.create();this.actionDispatcher.dispatch(o),this.changeActiveButton(e),e.focus()}}}changeActiveButton(e){this.lastActiveButton&&this.lastActiveButton.classList.remove(za),e?(e.classList.add(za),this.lastActiveButton=e):this.defaultToolsButton&&(this.defaultToolsButton.classList.add(za),this.lastActiveButton=this.defaultToolsButton)}handle(e){var t;this.changeActiveButton(),Oi.UpdateModelAction.is(e)||Oi.SetModelAction.is(e)?this.reloadPaletteBody():DE.EnableDefaultToolsAction.is(e)&&this.focusTracker.hasFocus&&((t=this.focusTracker.diagramElement)===null||t===void 0||t.focus())}editModeChanged(e,t){this.actionDispatcher.dispatch(Oi.SetUIExtensionVisibilityAction.create({extensionId:cp.ID,visible:!this.editorContext.isReadonly}))}clearOnEscape(e){(0,Oi.matchesKeystroke)(e,"Escape")&&(this.searchField.value="",this.requestFilterUpdate(""))}clearToolOnEscape(e){(0,Oi.matchesKeystroke)(e,"Escape")&&this.actionDispatcher.dispatch(DE.EnableDefaultToolsAction.create())}requestFilterUpdate(e){this.paletteItemsCopy.length===0&&(this.paletteItemsCopy=JSON.parse(JSON.stringify(this.paletteItems))),this.paletteItems=JSON.parse(JSON.stringify(this.paletteItemsCopy));const t=[];for(const i of this.paletteItems)if(i.children){const o=i.children.filter(r=>r.label.toLowerCase().includes(e.toLowerCase()));o.length>0&&(i.children.splice(0,i.children.length),o.forEach(r=>i.children.push(r)),t.push(i))}this.paletteItems=t,this.createBody()}async preRequestModel(){await this.setPaletteItems(),this.editorContext.isReadonly||this.show(this.editorContext.modelRoot)}async postRequestModel(){this.reloadPaletteBody()}async setPaletteItems(){const e=Oi.RequestContextActions.create({contextId:cp.ID,editorContext:{selectedElementIds:[]}}),t=await this.actionDispatcher.request(e);this.paletteItems=t.actions.map(i=>i),this.dynamic=this.paletteItems.some(i=>this.hasDynamicAction(i))}hasDynamicAction(e){var t;const i=!!e.actions.find(o=>{var r;return Oi.TriggerNodeCreationAction.is(o)&&((r=o.ghostElement)===null||r===void 0?void 0:r.dynamic)});return i||((t=e.children)===null||t===void 0?void 0:t.some(o=>this.hasDynamicAction(o)))||!1}async reloadPaletteBody(){this.dynamic&&(await this.setPaletteItems(),this.paletteItemsCopy=[],this.requestFilterUpdate(this.searchField.value))}};Tn.ToolPalette=ha;ha.ID="tool-palette";sh([(0,Cc.inject)(tK.GLSPActionDispatcher),Gd("design:type",tK.GLSPActionDispatcher)],ha.prototype,"actionDispatcher",void 0);sh([(0,Cc.inject)(nK.EditorContextService),Gd("design:type",nK.EditorContextService)],ha.prototype,"editorContext",void 0);sh([(0,Cc.inject)(iK.FocusTracker),Gd("design:type",iK.FocusTracker)],ha.prototype,"focusTracker",void 0);sh([(0,Cc.inject)(Oi.TYPES.IGridManager),(0,Cc.optional)(),Gd("design:type",Object)],ha.prototype,"gridManager",void 0);sh([(0,Cc.inject)(Oi.TYPES.IDebugManager),(0,Cc.optional)(),Gd("design:type",Object)],ha.prototype,"debugManager",void 0);sh([(0,Cc.postConstruct)(),Gd("design:type",Function),Gd("design:paramtypes",[]),Gd("design:returntype",void 0)],ha.prototype,"postConstruct",null);Tn.ToolPalette=ha=cp=sh([(0,Cc.injectable)()],ha);function GO(n,e){const t=n.sortString.localeCompare(e.sortString);return t!==0?t:n.label.localeCompare(e.label)}Tn.compare=GO;function xo(n){const e=document.createElement("i");return e.classList.add(...(0,Oi.codiconCSSClasses)(n)),e}Tn.createIcon=xo;function Fq(n){const e=document.createElement("div");e.classList.add("tool-group"),e.id=n.id;const t=document.createElement("div");return t.classList.add("group-header"),n.icon&&t.appendChild(xo(n.icon)),t.insertAdjacentText("beforeend",n.label),t.ondblclick=i=>{const o="collapsed";UO(e,o),Array.from(e.children).forEach(r=>UO(r,o)),window.getSelection().removeAllRanges()},e.appendChild(t),e}Tn.createToolGroup=Fq;function UO(n,e){n.classList.contains(e)?n.classList.remove(e):n.classList.add(e)}Tn.changeCSSClass=UO;function YO(n,e){n.classList.contains((0,Oi.codiconCSSClasses)(e)[1])?n.classList.remove((0,Oi.codiconCSSClasses)(e)[1]):n.classList.add((0,Oi.codiconCSSClasses)(e)[1])}Tn.changeCodiconClass=YO;Object.defineProperty(Ab,"__esModule",{value:!0});Ab.toolPaletteModule=void 0;const Ga=z,kEe=It,Cv=Tn;Ab.toolPaletteModule=new Ga.FeatureModule((n,e,t,i)=>{(0,Ga.bindAsService)(n,Ga.TYPES.IUIExtension,Cv.ToolPalette),n(Ga.TYPES.IDiagramStartup).toService(Cv.ToolPalette),(0,Ga.configureActionHandler)({bind:n,isBound:t},kEe.EnableDefaultToolsAction.KIND,Cv.ToolPalette),(0,Ga.configureActionHandler)({bind:n,isBound:t},Ga.UpdateModelAction.KIND,Cv.ToolPalette),(0,Ga.configureActionHandler)({bind:n,isBound:t},Ga.SetModelAction.KIND,Cv.ToolPalette)},{featureId:Symbol("toolPalette")});var Tb={},$R={},Mr={},FEe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Mr,"__esModule",{value:!0});Mr.movementRestrictionFeedback=Mr.removeMovementRestrictionFeedback=Mr.createMovementRestrictionFeedback=Mr.NoOverlapMovementRestrictor=void 0;const Ed=z,xEe=k,xq=it,cK=Ct,Hq=io;let qO=class{constructor(){this.cssClasses=["movement-not-allowed"]}validate(e,t){if(!(0,Ed.isMoveable)(e)||!t)return!1;const i=(0,Ed.isBoundsAware)(e)?e.bounds:{width:1,height:1},o=Object.create(e);return o.bounds={...i,...t},o.type="Ghost",o.id=e.id,!Array.from(e.root.index.all().filter(r=>r.id!==o.id&&r!==o.root&&r instanceof Ed.GNode).map(r=>r)).some(r=>this.areOverlapping(r,o))}isBoundsRelevant(e,t){return e.id!==t.id&&e!==t.root&&e instanceof Ed.GNode&&(0,Ed.isBoundsAware)(e)}areOverlapping(e,t){return Ed.Bounds.overlap((0,cK.toAbsoluteBounds)(e),(0,cK.toAbsoluteBounds)(t))}};Mr.NoOverlapMovementRestrictor=qO;Mr.NoOverlapMovementRestrictor=qO=FEe([(0,xEe.injectable)()],qO);function Kq(n,e){const t=[n];return n instanceof Ed.GParentElement&&n.children.filter(i=>i instanceof Hq.GResizeHandle).forEach(i=>t.push(i)),xq.ModifyCSSFeedbackAction.create({elements:t,add:e.cssClasses})}Mr.createMovementRestrictionFeedback=Kq;function Vq(n,e){const t=[n];return n instanceof Ed.GParentElement&&n.children.filter(i=>i instanceof Hq.GResizeHandle).forEach(i=>t.push(i)),xq.ModifyCSSFeedbackAction.create({elements:t,remove:e.cssClasses})}Mr.removeMovementRestrictionFeedback=Vq;function HEe(n,e,t){return t?Vq(n,e):Kq(n,e)}Mr.movementRestrictionFeedback=HEe;var u1={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.InsertIndicator=n.ARG_LENGTH=void 0;const e=z,t=_g,i=Cg;n.ARG_LENGTH="length";class o extends e.GNode{constructor(s){super(),this.id=(0,t.v4)(),this.type=o.TYPE,this.features=(0,e.createFeatureSet)(o.DEFAULT_FEATURES),this.cssClasses=["insert-indicator","sprotty-node"],this.size=e.Dimension.ZERO,this.args={},s&&(this.args={[n.ARG_LENGTH]:s})}}n.InsertIndicator=o,o.DEFAULT_FEATURES=[e.boundsFeature,e.moveFeature,i.argsFeature],o.TYPE="node:insert-indicator"})(u1);var kR={},nf={};Object.defineProperty(nf,"__esModule",{value:!0});nf.DiagramMovementCalculator=nf.MovementCalculator=void 0;const dp=z;class zq{setPosition(e){this.position={...e}}updatePosition(e){var t;const i=dp.Vector.is(e)?e:e.vector;this.setPosition(dp.Point.add((t=this.position)!==null&&t!==void 0?t:dp.Point.ORIGIN,i))}get hasPosition(){return this.position!==void 0}calculateMoveTo(e){return this.position?dp.Point.move(this.position,e):dp.Movement.ZERO}dispose(){this.position=void 0}}nf.MovementCalculator=zq;class KEe extends zq{constructor(e){super(),this.positionTracker=e}init(){const e=this.positionTracker.lastPositionOnDiagram;e&&this.setPosition(e)}calculateMoveToCurrent(){const e=this.positionTracker.lastPositionOnDiagram;return e?this.calculateMoveTo(e):dp.Movement.ZERO}reset(){this.dispose()}}nf.DiagramMovementCalculator=KEe;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.MoveableRoutingHandle=n.MoveableResizeHandle=n.ChangeBoundsTracker=n.TrackedElementResize=n.DEFAULT_RESIZE_OPTIONS=n.TrackedMove=n.TrackedElementMove=n.DEFAULT_MOVE_OPTIONS=void 0;const e=z,t=kt,i=io,o=nf;n.DEFAULT_MOVE_OPTIONS={snap:!0,restrict:!0,validate:!0,skipStatic:!0,skipInvalid:!1};var r;(function(y){function S(w){return(0,e.hasObjectProp)(w,"element")&&(0,e.hasObjectProp)(w,"fromPosition")&&(0,e.hasObjectProp)(w,"toPosition")&&(0,e.hasBooleanProp)(w,"valid")}y.is=S})(r||(n.TrackedElementMove=r={}));var s;(function(y){function S(w){return e.Movement.is(w)&&(0,e.hasBooleanProp)(w,"valid")}y.is=S})(s||(n.TrackedMove=s={})),n.DEFAULT_RESIZE_OPTIONS={snap:!0,restrict:!0,validate:!0,symmetric:!0,constrainResize:!0,skipStatic:!0,skipInvalidSize:!1,skipInvalidMove:!1};var a;(function(y){function S(w){return(0,e.isBoundsAware)(w.element)&&(0,e.hasObjectProp)(w,"fromBounds")&&(0,e.hasObjectProp)(w,"toBounds")&&(0,e.hasObjectProp)(w,"valid")}y.is=S})(a||(n.TrackedElementResize=a={}));class u{constructor(S){this.manager=S,this.diagramMovement=new o.DiagramMovementCalculator(S.positionTracker)}startTracking(){return this.diagramMovement.init(),this}updateTrackingPosition(S){const w=s.is(S)?e.Vector.max(...S.elementMoves.map(P=>P.moveVector)):S;this.diagramMovement.updatePosition(w)}isTracking(){return this.diagramMovement.hasPosition}stopTracking(){return this.diagramMovement.dispose(),this}moveElements(S,w){const P=this.resolveMoveOptions(w),E=this.calculateDiagramMovement(),A={...E,elementMoves:[],valid:!0,options:P};if(e.Vector.isZero(E.vector)&&P.skipStatic)return A;const L=this.getMoveableElements(S,P);for(const B of L){const U=this.calculateElementMove(B,E.vector,P);this.skipElementMove(U,P)||(A.elementMoves.push(U),A.valid&&(A.valid=U.valid))}return A}resolveMoveOptions(S){var w,P;return{...n.DEFAULT_MOVE_OPTIONS,...S,snap:this.manager.usePositionSnap((w=S==null?void 0:S.snap)!==null&&w!==void 0?w:n.DEFAULT_MOVE_OPTIONS.snap),restrict:this.manager.useMovementRestriction((P=S==null?void 0:S.restrict)!==null&&P!==void 0?P:n.DEFAULT_MOVE_OPTIONS.restrict)}}calculateDiagramMovement(){return this.diagramMovement.calculateMoveToCurrent()}getMoveableElements(S,w){var P;return Array.isArray(S)?S:(0,t.getElements)(S.ctx.index,S.elementIDs,(P=S.guard)!==null&&P!==void 0?P:e.isMoveable)}skipElementMove(S,w){return w.skipInvalid&&!S.valid||w.skipStatic&&e.Vector.isZero(S.moveVector)}calculateElementMove(S,w,P){const E=S.position,A=e.Point.add(E,w),L={element:S,fromPosition:E,toPosition:A,valid:!0,moveVector:w,sourceVector:w};return P.snap&&(L.toPosition=this.snapPosition(L,P)),P.restrict&&(L.toPosition=this.restrictMovement(L,P)),P.validate&&(L.valid=this.validateElementMove(L,P)),L.moveVector=e.Point.vector(L.fromPosition,L.toPosition),L}snapPosition(S,w){return this.manager.snapPosition(S.element,S.toPosition)}restrictMovement(S,w){const P=e.Point.move(S.fromPosition,S.toPosition);return this.manager.restrictMovement(S.element,P).to}validateElementMove(S,w){return this.manager.hasValidPosition(S.element,S.toPosition)}resizeElements(S,w){const P=this.resolveResizeOptions(w),E=this.calculateDiagramMovement(),A=this.calculateHandleMove(new h(S),E.vector,P),L={...E,valid:{move:!0,size:!0},options:P,handleMove:A,elementResizes:[]};if(e.Vector.isZero(A.moveVector)&&P.skipStatic)return L;const B=this.getResizableElements(S,P);for(const U of B){const p=this.calculateElementResize(U,A,P);this.skipElementResize(p,P)||(L.elementResizes.push(p),L.valid.move=L.valid.move&&p.valid.move,L.valid.size=L.valid.size&&p.valid.size)}return L}resolveResizeOptions(S){var w,P,E;return{...n.DEFAULT_RESIZE_OPTIONS,...S,snap:this.manager.usePositionSnap((w=S==null?void 0:S.snap)!==null&&w!==void 0?w:n.DEFAULT_RESIZE_OPTIONS.snap),restrict:this.manager.useMovementRestriction((P=S==null?void 0:S.restrict)!==null&&P!==void 0?P:n.DEFAULT_RESIZE_OPTIONS.restrict),symmetric:this.manager.useSymmetricResize((E=S==null?void 0:S.symmetric)!==null&&E!==void 0?E:n.DEFAULT_RESIZE_OPTIONS.symmetric)}}calculateHandleMove(S,w,P){const E=this.resolveMoveOptions({...P,validate:!1});return this.calculateElementMove(S,w,E)}getResizableElements(S,w){return[S.parent]}skipElementResize(S,w){return w.skipInvalidMove&&!S.valid.move||w.skipInvalidSize&&!S.valid.size||w.skipStatic&&e.Dimension.equals(S.fromBounds,S.toBounds)}calculateElementResize(S,w,P){const E=S.bounds,A=this.calculateElementBounds(S,w,P),L={element:S,fromBounds:E,toBounds:A,valid:{size:!0,move:!0}};return P.validate&&(L.valid.size=this.manager.hasValidSize(L.element,L.toBounds),L.valid.move=w.valid&&this.manager.hasValidPosition(L.element,L.toBounds)),L}calculateElementBounds(S,w,P){let E=this.calculateBounds(S.bounds,w);if(P.symmetric){const L=this.calculateSymmetricHandleMove(w,P);E=this.calculateBounds(E,L)}if(!P.constrainResize||this.manager.hasValidSize(S,E))return E;const A=this.manager.getMinimumSize(S);if(w.moveVector=this.constrainResizeVector(S.bounds,w,A),P.symmetric&&(w.moveVector.x=S.bounds.width>A.width?w.moveVector.x/2:w.moveVector.x,w.moveVector.y=S.bounds.height>A.height?w.moveVector.y/2:w.moveVector.y),E=this.calculateBounds(S.bounds,w),P.symmetric){const L=this.calculateSymmetricHandleMove(w,{...P,snap:!1});E=this.calculateBounds(E,L)}return E}calculateSymmetricHandleMove(S,w){const P=this.resolveMoveOptions({...w,validate:!1,restrict:!1});return this.calculateElementMove(S.element.opposite(),e.Vector.reverse(S.moveVector),P)}calculateBounds(S,w){return!w||e.Vector.isZero(w.moveVector)?S:this.doCalculateBounds(S,w.moveVector,w.element.location)}doCalculateBounds(S,w,P){switch(P){case i.ResizeHandleLocation.TopLeft:return{x:S.x+w.x,y:S.y+w.y,width:S.width-w.x,height:S.height-w.y};case i.ResizeHandleLocation.Top:return{...S,y:S.y+w.y,height:S.height-w.y};case i.ResizeHandleLocation.TopRight:return{...S,y:S.y+w.y,width:S.width+w.x,height:S.height-w.y};case i.ResizeHandleLocation.Right:return{...S,width:S.width+w.x};case i.ResizeHandleLocation.BottomRight:return{...S,width:S.width+w.x,height:S.height+w.y};case i.ResizeHandleLocation.Bottom:return{...S,height:S.height+w.y};case i.ResizeHandleLocation.BottomLeft:return{...S,x:S.x+w.x,width:S.width-w.x,height:S.height+w.y};case i.ResizeHandleLocation.Left:return{...S,x:S.x+w.x,width:S.width-w.x}}}constrainResizeVector(S,w,P){const E=w.moveVector;switch(w.element.location){case i.ResizeHandleLocation.TopLeft:E.x=S.width-E.x<P.width?S.width-P.width:E.x,E.y=S.height-E.y<P.height?S.height-P.height:E.y;break;case i.ResizeHandleLocation.Top:E.y=S.height-E.y<P.height?S.height-P.height:E.y;break;case i.ResizeHandleLocation.TopRight:E.x=S.width+E.x<P.width?P.width-S.width:E.x,E.y=S.height-E.y<P.height?S.height-P.height:E.y;break;case i.ResizeHandleLocation.Right:E.x=S.width+E.x<P.width?P.width-S.width:E.x;break;case i.ResizeHandleLocation.BottomRight:E.x=S.width+E.x<P.width?P.width-S.width:E.x,E.y=S.height+E.y<P.height?P.height-S.height:E.y;break;case i.ResizeHandleLocation.Bottom:E.y=S.height+E.y<P.height?P.height-S.height:E.y;break;case i.ResizeHandleLocation.BottomLeft:E.x=S.width-E.x<P.width?S.width-P.width:E.x,E.y=S.height+E.y<P.height?P.height-S.height:E.y;break;case i.ResizeHandleLocation.Left:E.x=S.width-E.x<P.width?S.width-P.width:E.x;break}return E}dispose(){this.stopTracking()}}n.ChangeBoundsTracker=u;class h extends i.GResizeHandle{constructor(S,w=S.location,P=i.GResizeHandle.getHandlePosition(S.parent,w)){super(w,S.type,S.hoverFeedback),this.handle=S,this.location=w,this.position=P,this.id=S.id,this.parent=S.parent}opposite(){return new h(this.handle,i.ResizeHandleLocation.opposite(this.location))}}n.MoveableResizeHandle=h;class g extends e.GRoutingHandle{constructor(S,w){super(),this.handle=S,this.position=w,this.id=S.id,this.parent=S.parent}}n.MoveableRoutingHandle=g})(kR);(function(n){var e=f&&f.__decorate||function(P,E,A,L){var B=arguments.length,U=B<3?E:L===null?L=Object.getOwnPropertyDescriptor(E,A):L,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(P,E,A,L);else for(var b=P.length-1;b>=0;b--)(p=P[b])&&(U=(B<3?p(U):B>3?p(E,A,U):p(E,A))||U);return B>3&&U&&Object.defineProperty(E,A,U),U},t=f&&f.__metadata||function(P,E){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(P,E)},i=f&&f.__param||function(P,E){return function(A,L){E(A,L,P)}};Object.defineProperty(n,"__esModule",{value:!0}),n.ChangeBoundsManager=n.CSS_ACTIVE_HANDLE=n.CSS_RESTRICTED_RESIZE=n.CSS_RESIZE_MODE=void 0;const o=z,r=k,s=it,a=yn,u=Ia,h=io,g=Mr,y=u1,S=kR;n.CSS_RESIZE_MODE="resize-mode",n.CSS_RESTRICTED_RESIZE="resize-not-allowed",n.CSS_ACTIVE_HANDLE="active";let w=class{constructor(E,A,L,B,U){this.positionTracker=E,this.movementRestrictor=A,this.snapper=L,this.helperLineManager=B,this.gridManager=U}unsnapModifier(){return"shift"}usePositionSnap(E){return typeof E=="boolean"?E:!E.shiftKey}snapPosition(E,A){var L,B;return(B=(L=this.snapper)===null||L===void 0?void 0:L.snap(A,E))!==null&&B!==void 0?B:A}isValid(E){return this.hasValidPosition(E)&&this.hasValidSize(E)}hasValidPosition(E,A){return!(0,o.isLocateable)(E)||(0,a.isValidMove)(E,A??E.position,this.movementRestrictor)}hasValidSize(E,A){if(!(0,o.isBoundsAware)(E))return!0;const L=A??E.bounds,B=this.getMinimumSize(E);return!(L.width<B.width||L.height<B.height)}getMinimumSize(E){if(!(0,o.isBoundsAware)(E))return o.Dimension.EMPTY;const A=(0,a.minDimensions)(E),L=u.LayoutAware.getComputedDimensions(E);return L?{width:Math.max(A.width,L.width),height:Math.max(A.height,L.height)}:A}useMovementRestriction(E){return this.usePositionSnap(E)}restrictMovement(E,A){const L=this.getMinimumMovement(E,A);if(!L)return A;const B=o.Vector.abs(A.vector),U={x:B.x<L.x?A.from.x:A.to.x,y:B.y<L.y?A.from.y:A.to.y};return o.Point.move(A.from,U)}getMinimumMovement(E,A){var L;return E instanceof y.InsertIndicator&&this.gridManager?this.gridManager.grid:(L=this.helperLineManager)===null||L===void 0?void 0:L.getMinimumMoveVector(E,!0,A.direction)}addMoveFeedback(E,A,L,B){return E.add((0,s.cursorFeedbackAction)(s.CursorCSS.MOVE),(0,s.cursorFeedbackAction)(s.CursorCSS.DEFAULT)),A.elementMoves.forEach(U=>this.addMoveRestrictionFeedback(E,U,L,B)),E}addResizeFeedback(E,A,L,B){E.add(s.ModifyCSSFeedbackAction.create({add:[n.CSS_RESIZE_MODE]}),s.ModifyCSSFeedbackAction.create({remove:[n.CSS_RESIZE_MODE]}));const U=h.GResizeHandle.getCursorCss(A.handleMove.element);E.add((0,s.cursorFeedbackAction)(U),(0,s.cursorFeedbackAction)(s.CursorCSS.DEFAULT));const p=A.handleMove.element;return E.add((0,s.applyCssClasses)(p,n.CSS_ACTIVE_HANDLE),(0,s.deleteCssClasses)(p,n.CSS_ACTIVE_HANDLE)),E.add((0,s.toggleCssClasses)(p,!A.valid.size,n.CSS_RESTRICTED_RESIZE),(0,s.deleteCssClasses)(p,n.CSS_RESTRICTED_RESIZE)),A.elementResizes.forEach(b=>{this.addMoveRestrictionFeedback(E,b,L,B),E.add((0,s.toggleCssClasses)(b.element,!b.valid.size,n.CSS_RESTRICTED_RESIZE),(0,s.deleteCssClasses)(b.element,n.CSS_RESTRICTED_RESIZE))}),E}addMoveRestrictionFeedback(E,A,L,B){if(this.movementRestrictor){const U=S.TrackedElementMove.is(A)?A.valid:A.valid.move;E.add((0,g.movementRestrictionFeedback)(A.element,this.movementRestrictor,U),(0,g.removeMovementRestrictionFeedback)(A.element,this.movementRestrictor))}return E}defaultResizeLocations(){return h.ResizeHandleLocation.CORNERS}useSymmetricResize(E){return typeof E=="boolean"?E:E.ctrlKey}createTracker(){return new S.ChangeBoundsTracker(this)}};n.ChangeBoundsManager=w,n.ChangeBoundsManager=w=e([(0,r.injectable)(),i(0,(0,r.inject)(o.MousePositionTracker)),i(1,(0,r.optional)()),i(1,(0,r.inject)(o.TYPES.IMovementRestrictor)),i(2,(0,r.optional)()),i(2,(0,r.inject)(o.TYPES.ISnapper)),i(3,(0,r.optional)()),i(3,(0,r.inject)(o.TYPES.IHelperLineManager)),i(4,(0,r.optional)()),i(4,(0,r.inject)(o.TYPES.IGridManager)),t("design:paramtypes",[o.MousePositionTracker,Object,Object,Object,Object])],w)})($R);var bu={},Pn={},Db=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},C9=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Pn,"__esModule",{value:!0});Pn.MoveFinishedEventAction=Pn.MoveInitializedEventAction=Pn.HideChangeBoundsToolResizeFeedbackCommand=Pn.ShowChangeBoundsToolResizeFeedbackCommand=Pn.HideChangeBoundsToolResizeFeedbackAction=Pn.ShowChangeBoundsToolResizeFeedbackAction=void 0;const Su=z,Ob=k,Gq=Gn,Uq=Ro,Yq=kt,vp=io;var WO;(function(n){n.KIND="showChangeBoundsToolResizeFeedback";function e(i){return Su.Action.hasKind(i,n.KIND)&&(0,Su.hasStringProp)(i,"elementId")}n.is=e;function t(i){const o=typeof i=="string"?{elementId:i}:i;return{kind:n.KIND,...o}}n.create=t})(WO||(Pn.ShowChangeBoundsToolResizeFeedbackAction=WO={}));var ZO;(function(n){n.KIND="hideChangeBoundsToolResizeFeedback";function e(i){return Su.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(ZO||(Pn.HideChangeBoundsToolResizeFeedbackAction=ZO={}));let gm=class extends Gq.FeedbackCommand{execute(e){var t,i;const o=e.root.index;if((0,Yq.forEachElement)(o,vp.isResizable,r=>r.id!==this.action.elementId&&(0,vp.removeResizeHandles)(r)),this.action.elementId){const r=o.getById(this.action.elementId);r&&(0,vp.isResizable)(r)&&(0,vp.addResizeHandles)(r,(i=(t=this.action.resizeLocations)!==null&&t!==void 0?t:r.resizeLocations)!==null&&i!==void 0?i:this.changeBoundsManager.defaultResizeLocations())}return e.root}};Pn.ShowChangeBoundsToolResizeFeedbackCommand=gm;gm.KIND=WO.KIND;Db([(0,Ob.inject)(Su.TYPES.Action),C9("design:type",Object)],gm.prototype,"action",void 0);Db([(0,Ob.inject)(Su.TYPES.IChangeBoundsManager),C9("design:type",Object)],gm.prototype,"changeBoundsManager",void 0);Pn.ShowChangeBoundsToolResizeFeedbackCommand=gm=Db([(0,Ob.injectable)()],gm);let Cy=class extends Gq.FeedbackCommand{execute(e){const t=e.root.index;return(0,Yq.forEachElement)(t,vp.isResizable,vp.removeResizeHandles),e.root}};Pn.HideChangeBoundsToolResizeFeedbackCommand=Cy;Cy.KIND=ZO.KIND;Db([(0,Ob.inject)(Su.TYPES.Action),C9("design:type",Object)],Cy.prototype,"action",void 0);Pn.HideChangeBoundsToolResizeFeedbackCommand=Cy=Db([(0,Ob.injectable)()],Cy);var dK;(function(n){n.KIND="move-initialized-event";function e(i){return Su.Action.hasKind(i,n.KIND)}n.is=e;function t(){return Uq.OptionalAction.mark({kind:n.KIND})}n.create=t})(dK||(Pn.MoveInitializedEventAction=dK={}));var uK;(function(n){n.KIND="move-finished-event";function e(i){return Su.Action.hasKind(i,n.KIND)}n.is=e;function t(){return Uq.OptionalAction.mark({kind:n.KIND})}n.create=t})(uK||(Pn.MoveFinishedEventAction=uK={}));var Lb={},NP={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */NP.exports;(function(n,e){(function(){var t,i="4.17.21",o=200,r="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",s="Expected a function",a="Invalid `variable` option passed into `_.template`",u="__lodash_hash_undefined__",h=500,g="__lodash_placeholder__",y=1,S=2,w=4,P=1,E=2,A=1,L=2,B=4,U=8,p=16,b=32,v=64,R=128,D=256,j=512,T=30,$="...",Q=800,K=16,Z=1,H=2,M=3,Y=1/0,te=9007199254740991,ue=17976931348623157e292,Re=NaN,ae=4294967295,ot=ae-1,Ft=ae>>>1,et=[["ary",R],["bind",A],["bindKey",L],["curry",U],["curryRight",p],["flip",j],["partial",b],["partialRight",v],["rearg",D]],ht="[object Arguments]",wt="[object Array]",Ot="[object AsyncFunction]",vt="[object Boolean]",At="[object Date]",bi="[object DOMException]",Wt="[object Error]",Ze="[object Function]",ii="[object GeneratorFunction]",he="[object Map]",je="[object Number]",en="[object Null]",xt="[object Object]",Rn="[object Promise]",gn="[object Proxy]",oi="[object RegExp]",_t="[object Set]",Zt="[object String]",Si="[object Symbol]",X="[object Undefined]",ne="[object WeakMap]",fe="[object WeakSet]",ve="[object ArrayBuffer]",we="[object DataView]",Qt="[object Float32Array]",Fe="[object Float64Array]",xe="[object Int8Array]",De="[object Int16Array]",Qe="[object Int32Array]",Xe="[object Uint8Array]",oo="[object Uint8ClampedArray]",Zc="[object Uint16Array]",k1="[object Uint32Array]",PM=/\b__p \+= '';/g,wM=/\b(__p \+=) '' \+/g,AM=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Vr=/&(?:amp|lt|gt|quot|#39);/g,fS=/[&<>"']/g,RM=RegExp(Vr.source),gh=RegExp(fS.source),MM=/<%-([\s\S]+?)%>/g,F1=/<%([\s\S]+?)%>/g,hS=/<%=([\s\S]+?)%>/g,Qc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Vu=/^\w*$/,IM=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,x1=/[\\^$.*+?()[\]{}|]/g,zu=RegExp(x1.source),vh=/^\s+/,pS=/\s/,H1=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,mS=/\{\n\/\* \[wrapped with (.+)\] \*/,Xc=/,? & /,V=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,oe=/[()=,{}\[\]\/\s]/,pe=/\\(\\)?/g,Pe=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Lt=/\w*$/,Tt=/^[-+]0x[0-9a-f]+$/i,jt=/^0b[01]+$/i,cn=/^\[object .+?Constructor\]$/,dt=/^0o[0-7]+$/i,Xt=/^(?:0|[1-9]\d*)$/,bt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,tn=/($^)/,ri=/['\n\r\u2028\u2029\\]/g,Fi="\\ud800-\\udfff",TM="\\u0300-\\u036f",yQ="\\ufe20-\\ufe2f",bQ="\\u20d0-\\u20ff",_4=TM+yQ+bQ,y4="\\u2700-\\u27bf",b4="a-z\\xdf-\\xf6\\xf8-\\xff",SQ="\\xac\\xb1\\xd7\\xf7",EQ="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",CQ="\\u2000-\\u206f",PQ=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",S4="A-Z\\xc0-\\xd6\\xd8-\\xde",E4="\\ufe0e\\ufe0f",C4=SQ+EQ+CQ+PQ,DM="['’]",wQ="["+Fi+"]",P4="["+C4+"]",gS="["+_4+"]",w4="\\d+",AQ="["+y4+"]",A4="["+b4+"]",R4="[^"+Fi+C4+w4+y4+b4+S4+"]",OM="\\ud83c[\\udffb-\\udfff]",RQ="(?:"+gS+"|"+OM+")",M4="[^"+Fi+"]",LM="(?:\\ud83c[\\udde6-\\uddff]){2}",jM="[\\ud800-\\udbff][\\udc00-\\udfff]",_h="["+S4+"]",I4="\\u200d",T4="(?:"+A4+"|"+R4+")",MQ="(?:"+_h+"|"+R4+")",D4="(?:"+DM+"(?:d|ll|m|re|s|t|ve))?",O4="(?:"+DM+"(?:D|LL|M|RE|S|T|VE))?",L4=RQ+"?",j4="["+E4+"]?",IQ="(?:"+I4+"(?:"+[M4,LM,jM].join("|")+")"+j4+L4+")*",TQ="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",DQ="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",N4=j4+L4+IQ,OQ="(?:"+[AQ,LM,jM].join("|")+")"+N4,LQ="(?:"+[M4+gS+"?",gS,LM,jM,wQ].join("|")+")",jQ=RegExp(DM,"g"),NQ=RegExp(gS,"g"),NM=RegExp(OM+"(?="+OM+")|"+LQ+N4,"g"),BQ=RegExp([_h+"?"+A4+"+"+D4+"(?="+[P4,_h,"$"].join("|")+")",MQ+"+"+O4+"(?="+[P4,_h+T4,"$"].join("|")+")",_h+"?"+T4+"+"+D4,_h+"+"+O4,DQ,TQ,w4,OQ].join("|"),"g"),$Q=RegExp("["+I4+Fi+_4+E4+"]"),kQ=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,FQ=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],xQ=-1,Jt={};Jt[Qt]=Jt[Fe]=Jt[xe]=Jt[De]=Jt[Qe]=Jt[Xe]=Jt[oo]=Jt[Zc]=Jt[k1]=!0,Jt[ht]=Jt[wt]=Jt[ve]=Jt[vt]=Jt[we]=Jt[At]=Jt[Wt]=Jt[Ze]=Jt[he]=Jt[je]=Jt[xt]=Jt[oi]=Jt[_t]=Jt[Zt]=Jt[ne]=!1;var Vt={};Vt[ht]=Vt[wt]=Vt[ve]=Vt[we]=Vt[vt]=Vt[At]=Vt[Qt]=Vt[Fe]=Vt[xe]=Vt[De]=Vt[Qe]=Vt[he]=Vt[je]=Vt[xt]=Vt[oi]=Vt[_t]=Vt[Zt]=Vt[Si]=Vt[Xe]=Vt[oo]=Vt[Zc]=Vt[k1]=!0,Vt[Wt]=Vt[Ze]=Vt[ne]=!1;var HQ={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},KQ={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},VQ={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},zQ={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},GQ=parseFloat,UQ=parseInt,B4=typeof f=="object"&&f&&f.Object===Object&&f,YQ=typeof self=="object"&&self&&self.Object===Object&&self,si=B4||YQ||Function("return this")(),BM=e&&!e.nodeType&&e,Gu=BM&&!0&&n&&!n.nodeType&&n,$4=Gu&&Gu.exports===BM,$M=$4&&B4.process,cr=function(){try{var q=Gu&&Gu.require&&Gu.require("util").types;return q||$M&&$M.binding&&$M.binding("util")}catch{}}(),k4=cr&&cr.isArrayBuffer,F4=cr&&cr.isDate,x4=cr&&cr.isMap,H4=cr&&cr.isRegExp,K4=cr&&cr.isSet,V4=cr&&cr.isTypedArray;function Oo(q,ee,J){switch(J.length){case 0:return q.call(ee);case 1:return q.call(ee,J[0]);case 2:return q.call(ee,J[0],J[1]);case 3:return q.call(ee,J[0],J[1],J[2])}return q.apply(ee,J)}function qQ(q,ee,J,Se){for(var He=-1,St=q==null?0:q.length;++He<St;){var xn=q[He];ee(Se,xn,J(xn),q)}return Se}function dr(q,ee){for(var J=-1,Se=q==null?0:q.length;++J<Se&&ee(q[J],J,q)!==!1;);return q}function WQ(q,ee){for(var J=q==null?0:q.length;J--&&ee(q[J],J,q)!==!1;);return q}function z4(q,ee){for(var J=-1,Se=q==null?0:q.length;++J<Se;)if(!ee(q[J],J,q))return!1;return!0}function Jc(q,ee){for(var J=-1,Se=q==null?0:q.length,He=0,St=[];++J<Se;){var xn=q[J];ee(xn,J,q)&&(St[He++]=xn)}return St}function vS(q,ee){var J=q==null?0:q.length;return!!J&&yh(q,ee,0)>-1}function kM(q,ee,J){for(var Se=-1,He=q==null?0:q.length;++Se<He;)if(J(ee,q[Se]))return!0;return!1}function nn(q,ee){for(var J=-1,Se=q==null?0:q.length,He=Array(Se);++J<Se;)He[J]=ee(q[J],J,q);return He}function ed(q,ee){for(var J=-1,Se=ee.length,He=q.length;++J<Se;)q[He+J]=ee[J];return q}function FM(q,ee,J,Se){var He=-1,St=q==null?0:q.length;for(Se&&St&&(J=q[++He]);++He<St;)J=ee(J,q[He],He,q);return J}function ZQ(q,ee,J,Se){var He=q==null?0:q.length;for(Se&&He&&(J=q[--He]);He--;)J=ee(J,q[He],He,q);return J}function xM(q,ee){for(var J=-1,Se=q==null?0:q.length;++J<Se;)if(ee(q[J],J,q))return!0;return!1}var QQ=HM("length");function XQ(q){return q.split("")}function JQ(q){return q.match(V)||[]}function G4(q,ee,J){var Se;return J(q,function(He,St,xn){if(ee(He,St,xn))return Se=St,!1}),Se}function _S(q,ee,J,Se){for(var He=q.length,St=J+(Se?1:-1);Se?St--:++St<He;)if(ee(q[St],St,q))return St;return-1}function yh(q,ee,J){return ee===ee?lX(q,ee,J):_S(q,U4,J)}function eX(q,ee,J,Se){for(var He=J-1,St=q.length;++He<St;)if(Se(q[He],ee))return He;return-1}function U4(q){return q!==q}function Y4(q,ee){var J=q==null?0:q.length;return J?VM(q,ee)/J:Re}function HM(q){return function(ee){return ee==null?t:ee[q]}}function KM(q){return function(ee){return q==null?t:q[ee]}}function q4(q,ee,J,Se,He){return He(q,function(St,xn,Ht){J=Se?(Se=!1,St):ee(J,St,xn,Ht)}),J}function tX(q,ee){var J=q.length;for(q.sort(ee);J--;)q[J]=q[J].value;return q}function VM(q,ee){for(var J,Se=-1,He=q.length;++Se<He;){var St=ee(q[Se]);St!==t&&(J=J===t?St:J+St)}return J}function zM(q,ee){for(var J=-1,Se=Array(q);++J<q;)Se[J]=ee(J);return Se}function nX(q,ee){return nn(ee,function(J){return[J,q[J]]})}function W4(q){return q&&q.slice(0,J4(q)+1).replace(vh,"")}function Lo(q){return function(ee){return q(ee)}}function GM(q,ee){return nn(ee,function(J){return q[J]})}function K1(q,ee){return q.has(ee)}function Z4(q,ee){for(var J=-1,Se=q.length;++J<Se&&yh(ee,q[J],0)>-1;);return J}function Q4(q,ee){for(var J=q.length;J--&&yh(ee,q[J],0)>-1;);return J}function iX(q,ee){for(var J=q.length,Se=0;J--;)q[J]===ee&&++Se;return Se}var oX=KM(HQ),rX=KM(KQ);function sX(q){return"\\"+zQ[q]}function aX(q,ee){return q==null?t:q[ee]}function bh(q){return $Q.test(q)}function cX(q){return kQ.test(q)}function dX(q){for(var ee,J=[];!(ee=q.next()).done;)J.push(ee.value);return J}function UM(q){var ee=-1,J=Array(q.size);return q.forEach(function(Se,He){J[++ee]=[He,Se]}),J}function X4(q,ee){return function(J){return q(ee(J))}}function td(q,ee){for(var J=-1,Se=q.length,He=0,St=[];++J<Se;){var xn=q[J];(xn===ee||xn===g)&&(q[J]=g,St[He++]=J)}return St}function yS(q){var ee=-1,J=Array(q.size);return q.forEach(function(Se){J[++ee]=Se}),J}function uX(q){var ee=-1,J=Array(q.size);return q.forEach(function(Se){J[++ee]=[Se,Se]}),J}function lX(q,ee,J){for(var Se=J-1,He=q.length;++Se<He;)if(q[Se]===ee)return Se;return-1}function fX(q,ee,J){for(var Se=J+1;Se--;)if(q[Se]===ee)return Se;return Se}function Sh(q){return bh(q)?pX(q):QQ(q)}function zr(q){return bh(q)?mX(q):XQ(q)}function J4(q){for(var ee=q.length;ee--&&pS.test(q.charAt(ee)););return ee}var hX=KM(VQ);function pX(q){for(var ee=NM.lastIndex=0;NM.test(q);)++ee;return ee}function mX(q){return q.match(NM)||[]}function gX(q){return q.match(BQ)||[]}var vX=function q(ee){ee=ee==null?si:Eh.defaults(si.Object(),ee,Eh.pick(si,FQ));var J=ee.Array,Se=ee.Date,He=ee.Error,St=ee.Function,xn=ee.Math,Ht=ee.Object,YM=ee.RegExp,_X=ee.String,ur=ee.TypeError,bS=J.prototype,yX=St.prototype,Ch=Ht.prototype,SS=ee["__core-js_shared__"],ES=yX.toString,Dt=Ch.hasOwnProperty,bX=0,ej=function(){var c=/[^.]+$/.exec(SS&&SS.keys&&SS.keys.IE_PROTO||"");return c?"Symbol(src)_1."+c:""}(),CS=Ch.toString,SX=ES.call(Ht),EX=si._,CX=YM("^"+ES.call(Dt).replace(x1,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),PS=$4?ee.Buffer:t,nd=ee.Symbol,wS=ee.Uint8Array,tj=PS?PS.allocUnsafe:t,AS=X4(Ht.getPrototypeOf,Ht),nj=Ht.create,ij=Ch.propertyIsEnumerable,RS=bS.splice,oj=nd?nd.isConcatSpreadable:t,V1=nd?nd.iterator:t,Uu=nd?nd.toStringTag:t,MS=function(){try{var c=Qu(Ht,"defineProperty");return c({},"",{}),c}catch{}}(),PX=ee.clearTimeout!==si.clearTimeout&&ee.clearTimeout,wX=Se&&Se.now!==si.Date.now&&Se.now,AX=ee.setTimeout!==si.setTimeout&&ee.setTimeout,IS=xn.ceil,TS=xn.floor,qM=Ht.getOwnPropertySymbols,RX=PS?PS.isBuffer:t,rj=ee.isFinite,MX=bS.join,IX=X4(Ht.keys,Ht),Hn=xn.max,Ei=xn.min,TX=Se.now,DX=ee.parseInt,sj=xn.random,OX=bS.reverse,WM=Qu(ee,"DataView"),z1=Qu(ee,"Map"),ZM=Qu(ee,"Promise"),Ph=Qu(ee,"Set"),G1=Qu(ee,"WeakMap"),U1=Qu(Ht,"create"),DS=G1&&new G1,wh={},LX=Xu(WM),jX=Xu(z1),NX=Xu(ZM),BX=Xu(Ph),$X=Xu(G1),OS=nd?nd.prototype:t,Y1=OS?OS.valueOf:t,aj=OS?OS.toString:t;function I(c){if(vn(c)&&!Ge(c)&&!(c instanceof st)){if(c instanceof lr)return c;if(Dt.call(c,"__wrapped__"))return cN(c)}return new lr(c)}var Ah=function(){function c(){}return function(d){if(!dn(d))return{};if(nj)return nj(d);c.prototype=d;var l=new c;return c.prototype=t,l}}();function LS(){}function lr(c,d){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=t}I.templateSettings={escape:MM,evaluate:F1,interpolate:hS,variable:"",imports:{_:I}},I.prototype=LS.prototype,I.prototype.constructor=I,lr.prototype=Ah(LS.prototype),lr.prototype.constructor=lr;function st(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=ae,this.__views__=[]}function kX(){var c=new st(this.__wrapped__);return c.__actions__=ro(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=ro(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=ro(this.__views__),c}function FX(){if(this.__filtered__){var c=new st(this);c.__dir__=-1,c.__filtered__=!0}else c=this.clone(),c.__dir__*=-1;return c}function xX(){var c=this.__wrapped__.value(),d=this.__dir__,l=Ge(c),_=d<0,C=l?c.length:0,O=XJ(0,C,this.__views__),F=O.start,G=O.end,W=G-F,ie=_?G:F-1,re=this.__iteratees__,ce=re.length,_e=0,Ae=Ei(W,this.__takeCount__);if(!l||!_&&C==W&&Ae==W)return Dj(c,this.__actions__);var Ne=[];e:for(;W--&&_e<Ae;){ie+=d;for(var qe=-1,Be=c[ie];++qe<ce;){var rt=re[qe],ut=rt.iteratee,Bo=rt.type,Ki=ut(Be);if(Bo==H)Be=Ki;else if(!Ki){if(Bo==Z)continue e;break e}}Ne[_e++]=Be}return Ne}st.prototype=Ah(LS.prototype),st.prototype.constructor=st;function Yu(c){var d=-1,l=c==null?0:c.length;for(this.clear();++d<l;){var _=c[d];this.set(_[0],_[1])}}function HX(){this.__data__=U1?U1(null):{},this.size=0}function KX(c){var d=this.has(c)&&delete this.__data__[c];return this.size-=d?1:0,d}function VX(c){var d=this.__data__;if(U1){var l=d[c];return l===u?t:l}return Dt.call(d,c)?d[c]:t}function zX(c){var d=this.__data__;return U1?d[c]!==t:Dt.call(d,c)}function GX(c,d){var l=this.__data__;return this.size+=this.has(c)?0:1,l[c]=U1&&d===t?u:d,this}Yu.prototype.clear=HX,Yu.prototype.delete=KX,Yu.prototype.get=VX,Yu.prototype.has=zX,Yu.prototype.set=GX;function Oa(c){var d=-1,l=c==null?0:c.length;for(this.clear();++d<l;){var _=c[d];this.set(_[0],_[1])}}function UX(){this.__data__=[],this.size=0}function YX(c){var d=this.__data__,l=jS(d,c);if(l<0)return!1;var _=d.length-1;return l==_?d.pop():RS.call(d,l,1),--this.size,!0}function qX(c){var d=this.__data__,l=jS(d,c);return l<0?t:d[l][1]}function WX(c){return jS(this.__data__,c)>-1}function ZX(c,d){var l=this.__data__,_=jS(l,c);return _<0?(++this.size,l.push([c,d])):l[_][1]=d,this}Oa.prototype.clear=UX,Oa.prototype.delete=YX,Oa.prototype.get=qX,Oa.prototype.has=WX,Oa.prototype.set=ZX;function La(c){var d=-1,l=c==null?0:c.length;for(this.clear();++d<l;){var _=c[d];this.set(_[0],_[1])}}function QX(){this.size=0,this.__data__={hash:new Yu,map:new(z1||Oa),string:new Yu}}function XX(c){var d=US(this,c).delete(c);return this.size-=d?1:0,d}function JX(c){return US(this,c).get(c)}function eJ(c){return US(this,c).has(c)}function tJ(c,d){var l=US(this,c),_=l.size;return l.set(c,d),this.size+=l.size==_?0:1,this}La.prototype.clear=QX,La.prototype.delete=XX,La.prototype.get=JX,La.prototype.has=eJ,La.prototype.set=tJ;function qu(c){var d=-1,l=c==null?0:c.length;for(this.__data__=new La;++d<l;)this.add(c[d])}function nJ(c){return this.__data__.set(c,u),this}function iJ(c){return this.__data__.has(c)}qu.prototype.add=qu.prototype.push=nJ,qu.prototype.has=iJ;function Gr(c){var d=this.__data__=new Oa(c);this.size=d.size}function oJ(){this.__data__=new Oa,this.size=0}function rJ(c){var d=this.__data__,l=d.delete(c);return this.size=d.size,l}function sJ(c){return this.__data__.get(c)}function aJ(c){return this.__data__.has(c)}function cJ(c,d){var l=this.__data__;if(l instanceof Oa){var _=l.__data__;if(!z1||_.length<o-1)return _.push([c,d]),this.size=++l.size,this;l=this.__data__=new La(_)}return l.set(c,d),this.size=l.size,this}Gr.prototype.clear=oJ,Gr.prototype.delete=rJ,Gr.prototype.get=sJ,Gr.prototype.has=aJ,Gr.prototype.set=cJ;function cj(c,d){var l=Ge(c),_=!l&&Ju(c),C=!l&&!_&&ad(c),O=!l&&!_&&!C&&Th(c),F=l||_||C||O,G=F?zM(c.length,_X):[],W=G.length;for(var ie in c)(d||Dt.call(c,ie))&&!(F&&(ie=="length"||C&&(ie=="offset"||ie=="parent")||O&&(ie=="buffer"||ie=="byteLength"||ie=="byteOffset")||$a(ie,W)))&&G.push(ie);return G}function dj(c){var d=c.length;return d?c[aI(0,d-1)]:t}function dJ(c,d){return YS(ro(c),Wu(d,0,c.length))}function uJ(c){return YS(ro(c))}function QM(c,d,l){(l!==t&&!Ur(c[d],l)||l===t&&!(d in c))&&ja(c,d,l)}function q1(c,d,l){var _=c[d];(!(Dt.call(c,d)&&Ur(_,l))||l===t&&!(d in c))&&ja(c,d,l)}function jS(c,d){for(var l=c.length;l--;)if(Ur(c[l][0],d))return l;return-1}function lJ(c,d,l,_){return id(c,function(C,O,F){d(_,C,l(C),F)}),_}function uj(c,d){return c&&Ls(d,Yn(d),c)}function fJ(c,d){return c&&Ls(d,ao(d),c)}function ja(c,d,l){d=="__proto__"&&MS?MS(c,d,{configurable:!0,enumerable:!0,value:l,writable:!0}):c[d]=l}function XM(c,d){for(var l=-1,_=d.length,C=J(_),O=c==null;++l<_;)C[l]=O?t:OI(c,d[l]);return C}function Wu(c,d,l){return c===c&&(l!==t&&(c=c<=l?c:l),d!==t&&(c=c>=d?c:d)),c}function fr(c,d,l,_,C,O){var F,G=d&y,W=d&S,ie=d&w;if(l&&(F=C?l(c,_,C,O):l(c)),F!==t)return F;if(!dn(c))return c;var re=Ge(c);if(re){if(F=eee(c),!G)return ro(c,F)}else{var ce=Ci(c),_e=ce==Ze||ce==ii;if(ad(c))return jj(c,G);if(ce==xt||ce==ht||_e&&!C){if(F=W||_e?{}:Jj(c),!G)return W?VJ(c,fJ(F,c)):KJ(c,uj(F,c))}else{if(!Vt[ce])return C?c:{};F=tee(c,ce,G)}}O||(O=new Gr);var Ae=O.get(c);if(Ae)return Ae;O.set(c,F),MN(c)?c.forEach(function(Be){F.add(fr(Be,d,l,Be,c,O))}):AN(c)&&c.forEach(function(Be,rt){F.set(rt,fr(Be,d,l,rt,c,O))});var Ne=ie?W?_I:vI:W?ao:Yn,qe=re?t:Ne(c);return dr(qe||c,function(Be,rt){qe&&(rt=Be,Be=c[rt]),q1(F,rt,fr(Be,d,l,rt,c,O))}),F}function hJ(c){var d=Yn(c);return function(l){return lj(l,c,d)}}function lj(c,d,l){var _=l.length;if(c==null)return!_;for(c=Ht(c);_--;){var C=l[_],O=d[C],F=c[C];if(F===t&&!(C in c)||!O(F))return!1}return!0}function fj(c,d,l){if(typeof c!="function")throw new ur(s);return tv(function(){c.apply(t,l)},d)}function W1(c,d,l,_){var C=-1,O=vS,F=!0,G=c.length,W=[],ie=d.length;if(!G)return W;l&&(d=nn(d,Lo(l))),_?(O=kM,F=!1):d.length>=o&&(O=K1,F=!1,d=new qu(d));e:for(;++C<G;){var re=c[C],ce=l==null?re:l(re);if(re=_||re!==0?re:0,F&&ce===ce){for(var _e=ie;_e--;)if(d[_e]===ce)continue e;W.push(re)}else O(d,ce,_)||W.push(re)}return W}var id=Fj(Os),hj=Fj(eI,!0);function pJ(c,d){var l=!0;return id(c,function(_,C,O){return l=!!d(_,C,O),l}),l}function NS(c,d,l){for(var _=-1,C=c.length;++_<C;){var O=c[_],F=d(O);if(F!=null&&(G===t?F===F&&!No(F):l(F,G)))var G=F,W=O}return W}function mJ(c,d,l,_){var C=c.length;for(l=Ye(l),l<0&&(l=-l>C?0:C+l),_=_===t||_>C?C:Ye(_),_<0&&(_+=C),_=l>_?0:TN(_);l<_;)c[l++]=d;return c}function pj(c,d){var l=[];return id(c,function(_,C,O){d(_,C,O)&&l.push(_)}),l}function ai(c,d,l,_,C){var O=-1,F=c.length;for(l||(l=iee),C||(C=[]);++O<F;){var G=c[O];d>0&&l(G)?d>1?ai(G,d-1,l,_,C):ed(C,G):_||(C[C.length]=G)}return C}var JM=xj(),mj=xj(!0);function Os(c,d){return c&&JM(c,d,Yn)}function eI(c,d){return c&&mj(c,d,Yn)}function BS(c,d){return Jc(d,function(l){return ka(c[l])})}function Zu(c,d){d=rd(d,c);for(var l=0,_=d.length;c!=null&&l<_;)c=c[js(d[l++])];return l&&l==_?c:t}function gj(c,d,l){var _=d(c);return Ge(c)?_:ed(_,l(c))}function xi(c){return c==null?c===t?X:en:Uu&&Uu in Ht(c)?QJ(c):uee(c)}function tI(c,d){return c>d}function gJ(c,d){return c!=null&&Dt.call(c,d)}function vJ(c,d){return c!=null&&d in Ht(c)}function _J(c,d,l){return c>=Ei(d,l)&&c<Hn(d,l)}function nI(c,d,l){for(var _=l?kM:vS,C=c[0].length,O=c.length,F=O,G=J(O),W=1/0,ie=[];F--;){var re=c[F];F&&d&&(re=nn(re,Lo(d))),W=Ei(re.length,W),G[F]=!l&&(d||C>=120&&re.length>=120)?new qu(F&&re):t}re=c[0];var ce=-1,_e=G[0];e:for(;++ce<C&&ie.length<W;){var Ae=re[ce],Ne=d?d(Ae):Ae;if(Ae=l||Ae!==0?Ae:0,!(_e?K1(_e,Ne):_(ie,Ne,l))){for(F=O;--F;){var qe=G[F];if(!(qe?K1(qe,Ne):_(c[F],Ne,l)))continue e}_e&&_e.push(Ne),ie.push(Ae)}}return ie}function yJ(c,d,l,_){return Os(c,function(C,O,F){d(_,l(C),O,F)}),_}function Z1(c,d,l){d=rd(d,c),c=iN(c,d);var _=c==null?c:c[js(pr(d))];return _==null?t:Oo(_,c,l)}function vj(c){return vn(c)&&xi(c)==ht}function bJ(c){return vn(c)&&xi(c)==ve}function SJ(c){return vn(c)&&xi(c)==At}function Q1(c,d,l,_,C){return c===d?!0:c==null||d==null||!vn(c)&&!vn(d)?c!==c&&d!==d:EJ(c,d,l,_,Q1,C)}function EJ(c,d,l,_,C,O){var F=Ge(c),G=Ge(d),W=F?wt:Ci(c),ie=G?wt:Ci(d);W=W==ht?xt:W,ie=ie==ht?xt:ie;var re=W==xt,ce=ie==xt,_e=W==ie;if(_e&&ad(c)){if(!ad(d))return!1;F=!0,re=!1}if(_e&&!re)return O||(O=new Gr),F||Th(c)?Zj(c,d,l,_,C,O):WJ(c,d,W,l,_,C,O);if(!(l&P)){var Ae=re&&Dt.call(c,"__wrapped__"),Ne=ce&&Dt.call(d,"__wrapped__");if(Ae||Ne){var qe=Ae?c.value():c,Be=Ne?d.value():d;return O||(O=new Gr),C(qe,Be,l,_,O)}}return _e?(O||(O=new Gr),ZJ(c,d,l,_,C,O)):!1}function CJ(c){return vn(c)&&Ci(c)==he}function iI(c,d,l,_){var C=l.length,O=C,F=!_;if(c==null)return!O;for(c=Ht(c);C--;){var G=l[C];if(F&&G[2]?G[1]!==c[G[0]]:!(G[0]in c))return!1}for(;++C<O;){G=l[C];var W=G[0],ie=c[W],re=G[1];if(F&&G[2]){if(ie===t&&!(W in c))return!1}else{var ce=new Gr;if(_)var _e=_(ie,re,W,c,d,ce);if(!(_e===t?Q1(re,ie,P|E,_,ce):_e))return!1}}return!0}function _j(c){if(!dn(c)||ree(c))return!1;var d=ka(c)?CX:cn;return d.test(Xu(c))}function PJ(c){return vn(c)&&xi(c)==oi}function wJ(c){return vn(c)&&Ci(c)==_t}function AJ(c){return vn(c)&&JS(c.length)&&!!Jt[xi(c)]}function yj(c){return typeof c=="function"?c:c==null?co:typeof c=="object"?Ge(c)?Ej(c[0],c[1]):Sj(c):HN(c)}function oI(c){if(!ev(c))return IX(c);var d=[];for(var l in Ht(c))Dt.call(c,l)&&l!="constructor"&&d.push(l);return d}function RJ(c){if(!dn(c))return dee(c);var d=ev(c),l=[];for(var _ in c)_=="constructor"&&(d||!Dt.call(c,_))||l.push(_);return l}function rI(c,d){return c<d}function bj(c,d){var l=-1,_=so(c)?J(c.length):[];return id(c,function(C,O,F){_[++l]=d(C,O,F)}),_}function Sj(c){var d=bI(c);return d.length==1&&d[0][2]?tN(d[0][0],d[0][1]):function(l){return l===c||iI(l,c,d)}}function Ej(c,d){return EI(c)&&eN(d)?tN(js(c),d):function(l){var _=OI(l,c);return _===t&&_===d?LI(l,c):Q1(d,_,P|E)}}function $S(c,d,l,_,C){c!==d&&JM(d,function(O,F){if(C||(C=new Gr),dn(O))MJ(c,d,F,l,$S,_,C);else{var G=_?_(PI(c,F),O,F+"",c,d,C):t;G===t&&(G=O),QM(c,F,G)}},ao)}function MJ(c,d,l,_,C,O,F){var G=PI(c,l),W=PI(d,l),ie=F.get(W);if(ie){QM(c,l,ie);return}var re=O?O(G,W,l+"",c,d,F):t,ce=re===t;if(ce){var _e=Ge(W),Ae=!_e&&ad(W),Ne=!_e&&!Ae&&Th(W);re=W,_e||Ae||Ne?Ge(G)?re=G:Mn(G)?re=ro(G):Ae?(ce=!1,re=jj(W,!0)):Ne?(ce=!1,re=Nj(W,!0)):re=[]:nv(W)||Ju(W)?(re=G,Ju(G)?re=DN(G):(!dn(G)||ka(G))&&(re=Jj(W))):ce=!1}ce&&(F.set(W,re),C(re,W,_,O,F),F.delete(W)),QM(c,l,re)}function Cj(c,d){var l=c.length;if(l)return d+=d<0?l:0,$a(d,l)?c[d]:t}function Pj(c,d,l){d.length?d=nn(d,function(O){return Ge(O)?function(F){return Zu(F,O.length===1?O[0]:O)}:O}):d=[co];var _=-1;d=nn(d,Lo(Le()));var C=bj(c,function(O,F,G){var W=nn(d,function(ie){return ie(O)});return{criteria:W,index:++_,value:O}});return tX(C,function(O,F){return HJ(O,F,l)})}function IJ(c,d){return wj(c,d,function(l,_){return LI(c,_)})}function wj(c,d,l){for(var _=-1,C=d.length,O={};++_<C;){var F=d[_],G=Zu(c,F);l(G,F)&&X1(O,rd(F,c),G)}return O}function TJ(c){return function(d){return Zu(d,c)}}function sI(c,d,l,_){var C=_?eX:yh,O=-1,F=d.length,G=c;for(c===d&&(d=ro(d)),l&&(G=nn(c,Lo(l)));++O<F;)for(var W=0,ie=d[O],re=l?l(ie):ie;(W=C(G,re,W,_))>-1;)G!==c&&RS.call(G,W,1),RS.call(c,W,1);return c}function Aj(c,d){for(var l=c?d.length:0,_=l-1;l--;){var C=d[l];if(l==_||C!==O){var O=C;$a(C)?RS.call(c,C,1):uI(c,C)}}return c}function aI(c,d){return c+TS(sj()*(d-c+1))}function DJ(c,d,l,_){for(var C=-1,O=Hn(IS((d-c)/(l||1)),0),F=J(O);O--;)F[_?O:++C]=c,c+=l;return F}function cI(c,d){var l="";if(!c||d<1||d>te)return l;do d%2&&(l+=c),d=TS(d/2),d&&(c+=c);while(d);return l}function Je(c,d){return wI(nN(c,d,co),c+"")}function OJ(c){return dj(Dh(c))}function LJ(c,d){var l=Dh(c);return YS(l,Wu(d,0,l.length))}function X1(c,d,l,_){if(!dn(c))return c;d=rd(d,c);for(var C=-1,O=d.length,F=O-1,G=c;G!=null&&++C<O;){var W=js(d[C]),ie=l;if(W==="__proto__"||W==="constructor"||W==="prototype")return c;if(C!=F){var re=G[W];ie=_?_(re,W,G):t,ie===t&&(ie=dn(re)?re:$a(d[C+1])?[]:{})}q1(G,W,ie),G=G[W]}return c}var Rj=DS?function(c,d){return DS.set(c,d),c}:co,jJ=MS?function(c,d){return MS(c,"toString",{configurable:!0,enumerable:!1,value:NI(d),writable:!0})}:co;function NJ(c){return YS(Dh(c))}function hr(c,d,l){var _=-1,C=c.length;d<0&&(d=-d>C?0:C+d),l=l>C?C:l,l<0&&(l+=C),C=d>l?0:l-d>>>0,d>>>=0;for(var O=J(C);++_<C;)O[_]=c[_+d];return O}function BJ(c,d){var l;return id(c,function(_,C,O){return l=d(_,C,O),!l}),!!l}function kS(c,d,l){var _=0,C=c==null?_:c.length;if(typeof d=="number"&&d===d&&C<=Ft){for(;_<C;){var O=_+C>>>1,F=c[O];F!==null&&!No(F)&&(l?F<=d:F<d)?_=O+1:C=O}return C}return dI(c,d,co,l)}function dI(c,d,l,_){var C=0,O=c==null?0:c.length;if(O===0)return 0;d=l(d);for(var F=d!==d,G=d===null,W=No(d),ie=d===t;C<O;){var re=TS((C+O)/2),ce=l(c[re]),_e=ce!==t,Ae=ce===null,Ne=ce===ce,qe=No(ce);if(F)var Be=_||Ne;else ie?Be=Ne&&(_||_e):G?Be=Ne&&_e&&(_||!Ae):W?Be=Ne&&_e&&!Ae&&(_||!qe):Ae||qe?Be=!1:Be=_?ce<=d:ce<d;Be?C=re+1:O=re}return Ei(O,ot)}function Mj(c,d){for(var l=-1,_=c.length,C=0,O=[];++l<_;){var F=c[l],G=d?d(F):F;if(!l||!Ur(G,W)){var W=G;O[C++]=F===0?0:F}}return O}function Ij(c){return typeof c=="number"?c:No(c)?Re:+c}function jo(c){if(typeof c=="string")return c;if(Ge(c))return nn(c,jo)+"";if(No(c))return aj?aj.call(c):"";var d=c+"";return d=="0"&&1/c==-Y?"-0":d}function od(c,d,l){var _=-1,C=vS,O=c.length,F=!0,G=[],W=G;if(l)F=!1,C=kM;else if(O>=o){var ie=d?null:YJ(c);if(ie)return yS(ie);F=!1,C=K1,W=new qu}else W=d?[]:G;e:for(;++_<O;){var re=c[_],ce=d?d(re):re;if(re=l||re!==0?re:0,F&&ce===ce){for(var _e=W.length;_e--;)if(W[_e]===ce)continue e;d&&W.push(ce),G.push(re)}else C(W,ce,l)||(W!==G&&W.push(ce),G.push(re))}return G}function uI(c,d){return d=rd(d,c),c=iN(c,d),c==null||delete c[js(pr(d))]}function Tj(c,d,l,_){return X1(c,d,l(Zu(c,d)),_)}function FS(c,d,l,_){for(var C=c.length,O=_?C:-1;(_?O--:++O<C)&&d(c[O],O,c););return l?hr(c,_?0:O,_?O+1:C):hr(c,_?O+1:0,_?C:O)}function Dj(c,d){var l=c;return l instanceof st&&(l=l.value()),FM(d,function(_,C){return C.func.apply(C.thisArg,ed([_],C.args))},l)}function lI(c,d,l){var _=c.length;if(_<2)return _?od(c[0]):[];for(var C=-1,O=J(_);++C<_;)for(var F=c[C],G=-1;++G<_;)G!=C&&(O[C]=W1(O[C]||F,c[G],d,l));return od(ai(O,1),d,l)}function Oj(c,d,l){for(var _=-1,C=c.length,O=d.length,F={};++_<C;){var G=_<O?d[_]:t;l(F,c[_],G)}return F}function fI(c){return Mn(c)?c:[]}function hI(c){return typeof c=="function"?c:co}function rd(c,d){return Ge(c)?c:EI(c,d)?[c]:aN(Rt(c))}var $J=Je;function sd(c,d,l){var _=c.length;return l=l===t?_:l,!d&&l>=_?c:hr(c,d,l)}var Lj=PX||function(c){return si.clearTimeout(c)};function jj(c,d){if(d)return c.slice();var l=c.length,_=tj?tj(l):new c.constructor(l);return c.copy(_),_}function pI(c){var d=new c.constructor(c.byteLength);return new wS(d).set(new wS(c)),d}function kJ(c,d){var l=d?pI(c.buffer):c.buffer;return new c.constructor(l,c.byteOffset,c.byteLength)}function FJ(c){var d=new c.constructor(c.source,Lt.exec(c));return d.lastIndex=c.lastIndex,d}function xJ(c){return Y1?Ht(Y1.call(c)):{}}function Nj(c,d){var l=d?pI(c.buffer):c.buffer;return new c.constructor(l,c.byteOffset,c.length)}function Bj(c,d){if(c!==d){var l=c!==t,_=c===null,C=c===c,O=No(c),F=d!==t,G=d===null,W=d===d,ie=No(d);if(!G&&!ie&&!O&&c>d||O&&F&&W&&!G&&!ie||_&&F&&W||!l&&W||!C)return 1;if(!_&&!O&&!ie&&c<d||ie&&l&&C&&!_&&!O||G&&l&&C||!F&&C||!W)return-1}return 0}function HJ(c,d,l){for(var _=-1,C=c.criteria,O=d.criteria,F=C.length,G=l.length;++_<F;){var W=Bj(C[_],O[_]);if(W){if(_>=G)return W;var ie=l[_];return W*(ie=="desc"?-1:1)}}return c.index-d.index}function $j(c,d,l,_){for(var C=-1,O=c.length,F=l.length,G=-1,W=d.length,ie=Hn(O-F,0),re=J(W+ie),ce=!_;++G<W;)re[G]=d[G];for(;++C<F;)(ce||C<O)&&(re[l[C]]=c[C]);for(;ie--;)re[G++]=c[C++];return re}function kj(c,d,l,_){for(var C=-1,O=c.length,F=-1,G=l.length,W=-1,ie=d.length,re=Hn(O-G,0),ce=J(re+ie),_e=!_;++C<re;)ce[C]=c[C];for(var Ae=C;++W<ie;)ce[Ae+W]=d[W];for(;++F<G;)(_e||C<O)&&(ce[Ae+l[F]]=c[C++]);return ce}function ro(c,d){var l=-1,_=c.length;for(d||(d=J(_));++l<_;)d[l]=c[l];return d}function Ls(c,d,l,_){var C=!l;l||(l={});for(var O=-1,F=d.length;++O<F;){var G=d[O],W=_?_(l[G],c[G],G,l,c):t;W===t&&(W=c[G]),C?ja(l,G,W):q1(l,G,W)}return l}function KJ(c,d){return Ls(c,SI(c),d)}function VJ(c,d){return Ls(c,Qj(c),d)}function xS(c,d){return function(l,_){var C=Ge(l)?qQ:lJ,O=d?d():{};return C(l,c,Le(_,2),O)}}function Rh(c){return Je(function(d,l){var _=-1,C=l.length,O=C>1?l[C-1]:t,F=C>2?l[2]:t;for(O=c.length>3&&typeof O=="function"?(C--,O):t,F&&Hi(l[0],l[1],F)&&(O=C<3?t:O,C=1),d=Ht(d);++_<C;){var G=l[_];G&&c(d,G,_,O)}return d})}function Fj(c,d){return function(l,_){if(l==null)return l;if(!so(l))return c(l,_);for(var C=l.length,O=d?C:-1,F=Ht(l);(d?O--:++O<C)&&_(F[O],O,F)!==!1;);return l}}function xj(c){return function(d,l,_){for(var C=-1,O=Ht(d),F=_(d),G=F.length;G--;){var W=F[c?G:++C];if(l(O[W],W,O)===!1)break}return d}}function zJ(c,d,l){var _=d&A,C=J1(c);function O(){var F=this&&this!==si&&this instanceof O?C:c;return F.apply(_?l:this,arguments)}return O}function Hj(c){return function(d){d=Rt(d);var l=bh(d)?zr(d):t,_=l?l[0]:d.charAt(0),C=l?sd(l,1).join(""):d.slice(1);return _[c]()+C}}function Mh(c){return function(d){return FM(FN(kN(d).replace(jQ,"")),c,"")}}function J1(c){return function(){var d=arguments;switch(d.length){case 0:return new c;case 1:return new c(d[0]);case 2:return new c(d[0],d[1]);case 3:return new c(d[0],d[1],d[2]);case 4:return new c(d[0],d[1],d[2],d[3]);case 5:return new c(d[0],d[1],d[2],d[3],d[4]);case 6:return new c(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new c(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var l=Ah(c.prototype),_=c.apply(l,d);return dn(_)?_:l}}function GJ(c,d,l){var _=J1(c);function C(){for(var O=arguments.length,F=J(O),G=O,W=Ih(C);G--;)F[G]=arguments[G];var ie=O<3&&F[0]!==W&&F[O-1]!==W?[]:td(F,W);if(O-=ie.length,O<l)return Uj(c,d,HS,C.placeholder,t,F,ie,t,t,l-O);var re=this&&this!==si&&this instanceof C?_:c;return Oo(re,this,F)}return C}function Kj(c){return function(d,l,_){var C=Ht(d);if(!so(d)){var O=Le(l,3);d=Yn(d),l=function(G){return O(C[G],G,C)}}var F=c(d,l,_);return F>-1?C[O?d[F]:F]:t}}function Vj(c){return Ba(function(d){var l=d.length,_=l,C=lr.prototype.thru;for(c&&d.reverse();_--;){var O=d[_];if(typeof O!="function")throw new ur(s);if(C&&!F&&GS(O)=="wrapper")var F=new lr([],!0)}for(_=F?_:l;++_<l;){O=d[_];var G=GS(O),W=G=="wrapper"?yI(O):t;W&&CI(W[0])&&W[1]==(R|U|b|D)&&!W[4].length&&W[9]==1?F=F[GS(W[0])].apply(F,W[3]):F=O.length==1&&CI(O)?F[G]():F.thru(O)}return function(){var ie=arguments,re=ie[0];if(F&&ie.length==1&&Ge(re))return F.plant(re).value();for(var ce=0,_e=l?d[ce].apply(this,ie):re;++ce<l;)_e=d[ce].call(this,_e);return _e}})}function HS(c,d,l,_,C,O,F,G,W,ie){var re=d&R,ce=d&A,_e=d&L,Ae=d&(U|p),Ne=d&j,qe=_e?t:J1(c);function Be(){for(var rt=arguments.length,ut=J(rt),Bo=rt;Bo--;)ut[Bo]=arguments[Bo];if(Ae)var Ki=Ih(Be),$o=iX(ut,Ki);if(_&&(ut=$j(ut,_,C,Ae)),O&&(ut=kj(ut,O,F,Ae)),rt-=$o,Ae&&rt<ie){var In=td(ut,Ki);return Uj(c,d,HS,Be.placeholder,l,ut,In,G,W,ie-rt)}var Yr=ce?l:this,xa=_e?Yr[c]:c;return rt=ut.length,G?ut=lee(ut,G):Ne&&rt>1&&ut.reverse(),re&&W<rt&&(ut.length=W),this&&this!==si&&this instanceof Be&&(xa=qe||J1(xa)),xa.apply(Yr,ut)}return Be}function zj(c,d){return function(l,_){return yJ(l,c,d(_),{})}}function KS(c,d){return function(l,_){var C;if(l===t&&_===t)return d;if(l!==t&&(C=l),_!==t){if(C===t)return _;typeof l=="string"||typeof _=="string"?(l=jo(l),_=jo(_)):(l=Ij(l),_=Ij(_)),C=c(l,_)}return C}}function mI(c){return Ba(function(d){return d=nn(d,Lo(Le())),Je(function(l){var _=this;return c(d,function(C){return Oo(C,_,l)})})})}function VS(c,d){d=d===t?" ":jo(d);var l=d.length;if(l<2)return l?cI(d,c):d;var _=cI(d,IS(c/Sh(d)));return bh(d)?sd(zr(_),0,c).join(""):_.slice(0,c)}function UJ(c,d,l,_){var C=d&A,O=J1(c);function F(){for(var G=-1,W=arguments.length,ie=-1,re=_.length,ce=J(re+W),_e=this&&this!==si&&this instanceof F?O:c;++ie<re;)ce[ie]=_[ie];for(;W--;)ce[ie++]=arguments[++G];return Oo(_e,C?l:this,ce)}return F}function Gj(c){return function(d,l,_){return _&&typeof _!="number"&&Hi(d,l,_)&&(l=_=t),d=Fa(d),l===t?(l=d,d=0):l=Fa(l),_=_===t?d<l?1:-1:Fa(_),DJ(d,l,_,c)}}function zS(c){return function(d,l){return typeof d=="string"&&typeof l=="string"||(d=mr(d),l=mr(l)),c(d,l)}}function Uj(c,d,l,_,C,O,F,G,W,ie){var re=d&U,ce=re?F:t,_e=re?t:F,Ae=re?O:t,Ne=re?t:O;d|=re?b:v,d&=~(re?v:b),d&B||(d&=~(A|L));var qe=[c,d,C,Ae,ce,Ne,_e,G,W,ie],Be=l.apply(t,qe);return CI(c)&&oN(Be,qe),Be.placeholder=_,rN(Be,c,d)}function gI(c){var d=xn[c];return function(l,_){if(l=mr(l),_=_==null?0:Ei(Ye(_),292),_&&rj(l)){var C=(Rt(l)+"e").split("e"),O=d(C[0]+"e"+(+C[1]+_));return C=(Rt(O)+"e").split("e"),+(C[0]+"e"+(+C[1]-_))}return d(l)}}var YJ=Ph&&1/yS(new Ph([,-0]))[1]==Y?function(c){return new Ph(c)}:kI;function Yj(c){return function(d){var l=Ci(d);return l==he?UM(d):l==_t?uX(d):nX(d,c(d))}}function Na(c,d,l,_,C,O,F,G){var W=d&L;if(!W&&typeof c!="function")throw new ur(s);var ie=_?_.length:0;if(ie||(d&=~(b|v),_=C=t),F=F===t?F:Hn(Ye(F),0),G=G===t?G:Ye(G),ie-=C?C.length:0,d&v){var re=_,ce=C;_=C=t}var _e=W?t:yI(c),Ae=[c,d,l,_,C,re,ce,O,F,G];if(_e&&cee(Ae,_e),c=Ae[0],d=Ae[1],l=Ae[2],_=Ae[3],C=Ae[4],G=Ae[9]=Ae[9]===t?W?0:c.length:Hn(Ae[9]-ie,0),!G&&d&(U|p)&&(d&=~(U|p)),!d||d==A)var Ne=zJ(c,d,l);else d==U||d==p?Ne=GJ(c,d,G):(d==b||d==(A|b))&&!C.length?Ne=UJ(c,d,l,_):Ne=HS.apply(t,Ae);var qe=_e?Rj:oN;return rN(qe(Ne,Ae),c,d)}function qj(c,d,l,_){return c===t||Ur(c,Ch[l])&&!Dt.call(_,l)?d:c}function Wj(c,d,l,_,C,O){return dn(c)&&dn(d)&&(O.set(d,c),$S(c,d,t,Wj,O),O.delete(d)),c}function qJ(c){return nv(c)?t:c}function Zj(c,d,l,_,C,O){var F=l&P,G=c.length,W=d.length;if(G!=W&&!(F&&W>G))return!1;var ie=O.get(c),re=O.get(d);if(ie&&re)return ie==d&&re==c;var ce=-1,_e=!0,Ae=l&E?new qu:t;for(O.set(c,d),O.set(d,c);++ce<G;){var Ne=c[ce],qe=d[ce];if(_)var Be=F?_(qe,Ne,ce,d,c,O):_(Ne,qe,ce,c,d,O);if(Be!==t){if(Be)continue;_e=!1;break}if(Ae){if(!xM(d,function(rt,ut){if(!K1(Ae,ut)&&(Ne===rt||C(Ne,rt,l,_,O)))return Ae.push(ut)})){_e=!1;break}}else if(!(Ne===qe||C(Ne,qe,l,_,O))){_e=!1;break}}return O.delete(c),O.delete(d),_e}function WJ(c,d,l,_,C,O,F){switch(l){case we:if(c.byteLength!=d.byteLength||c.byteOffset!=d.byteOffset)return!1;c=c.buffer,d=d.buffer;case ve:return!(c.byteLength!=d.byteLength||!O(new wS(c),new wS(d)));case vt:case At:case je:return Ur(+c,+d);case Wt:return c.name==d.name&&c.message==d.message;case oi:case Zt:return c==d+"";case he:var G=UM;case _t:var W=_&P;if(G||(G=yS),c.size!=d.size&&!W)return!1;var ie=F.get(c);if(ie)return ie==d;_|=E,F.set(c,d);var re=Zj(G(c),G(d),_,C,O,F);return F.delete(c),re;case Si:if(Y1)return Y1.call(c)==Y1.call(d)}return!1}function ZJ(c,d,l,_,C,O){var F=l&P,G=vI(c),W=G.length,ie=vI(d),re=ie.length;if(W!=re&&!F)return!1;for(var ce=W;ce--;){var _e=G[ce];if(!(F?_e in d:Dt.call(d,_e)))return!1}var Ae=O.get(c),Ne=O.get(d);if(Ae&&Ne)return Ae==d&&Ne==c;var qe=!0;O.set(c,d),O.set(d,c);for(var Be=F;++ce<W;){_e=G[ce];var rt=c[_e],ut=d[_e];if(_)var Bo=F?_(ut,rt,_e,d,c,O):_(rt,ut,_e,c,d,O);if(!(Bo===t?rt===ut||C(rt,ut,l,_,O):Bo)){qe=!1;break}Be||(Be=_e=="constructor")}if(qe&&!Be){var Ki=c.constructor,$o=d.constructor;Ki!=$o&&"constructor"in c&&"constructor"in d&&!(typeof Ki=="function"&&Ki instanceof Ki&&typeof $o=="function"&&$o instanceof $o)&&(qe=!1)}return O.delete(c),O.delete(d),qe}function Ba(c){return wI(nN(c,t,lN),c+"")}function vI(c){return gj(c,Yn,SI)}function _I(c){return gj(c,ao,Qj)}var yI=DS?function(c){return DS.get(c)}:kI;function GS(c){for(var d=c.name+"",l=wh[d],_=Dt.call(wh,d)?l.length:0;_--;){var C=l[_],O=C.func;if(O==null||O==c)return C.name}return d}function Ih(c){var d=Dt.call(I,"placeholder")?I:c;return d.placeholder}function Le(){var c=I.iteratee||BI;return c=c===BI?yj:c,arguments.length?c(arguments[0],arguments[1]):c}function US(c,d){var l=c.__data__;return oee(d)?l[typeof d=="string"?"string":"hash"]:l.map}function bI(c){for(var d=Yn(c),l=d.length;l--;){var _=d[l],C=c[_];d[l]=[_,C,eN(C)]}return d}function Qu(c,d){var l=aX(c,d);return _j(l)?l:t}function QJ(c){var d=Dt.call(c,Uu),l=c[Uu];try{c[Uu]=t;var _=!0}catch{}var C=CS.call(c);return _&&(d?c[Uu]=l:delete c[Uu]),C}var SI=qM?function(c){return c==null?[]:(c=Ht(c),Jc(qM(c),function(d){return ij.call(c,d)}))}:FI,Qj=qM?function(c){for(var d=[];c;)ed(d,SI(c)),c=AS(c);return d}:FI,Ci=xi;(WM&&Ci(new WM(new ArrayBuffer(1)))!=we||z1&&Ci(new z1)!=he||ZM&&Ci(ZM.resolve())!=Rn||Ph&&Ci(new Ph)!=_t||G1&&Ci(new G1)!=ne)&&(Ci=function(c){var d=xi(c),l=d==xt?c.constructor:t,_=l?Xu(l):"";if(_)switch(_){case LX:return we;case jX:return he;case NX:return Rn;case BX:return _t;case $X:return ne}return d});function XJ(c,d,l){for(var _=-1,C=l.length;++_<C;){var O=l[_],F=O.size;switch(O.type){case"drop":c+=F;break;case"dropRight":d-=F;break;case"take":d=Ei(d,c+F);break;case"takeRight":c=Hn(c,d-F);break}}return{start:c,end:d}}function JJ(c){var d=c.match(mS);return d?d[1].split(Xc):[]}function Xj(c,d,l){d=rd(d,c);for(var _=-1,C=d.length,O=!1;++_<C;){var F=js(d[_]);if(!(O=c!=null&&l(c,F)))break;c=c[F]}return O||++_!=C?O:(C=c==null?0:c.length,!!C&&JS(C)&&$a(F,C)&&(Ge(c)||Ju(c)))}function eee(c){var d=c.length,l=new c.constructor(d);return d&&typeof c[0]=="string"&&Dt.call(c,"index")&&(l.index=c.index,l.input=c.input),l}function Jj(c){return typeof c.constructor=="function"&&!ev(c)?Ah(AS(c)):{}}function tee(c,d,l){var _=c.constructor;switch(d){case ve:return pI(c);case vt:case At:return new _(+c);case we:return kJ(c,l);case Qt:case Fe:case xe:case De:case Qe:case Xe:case oo:case Zc:case k1:return Nj(c,l);case he:return new _;case je:case Zt:return new _(c);case oi:return FJ(c);case _t:return new _;case Si:return xJ(c)}}function nee(c,d){var l=d.length;if(!l)return c;var _=l-1;return d[_]=(l>1?"& ":"")+d[_],d=d.join(l>2?", ":" "),c.replace(H1,`{
/* [wrapped with `+d+`] */
`)}function iee(c){return Ge(c)||Ju(c)||!!(oj&&c&&c[oj])}function $a(c,d){var l=typeof c;return d=d??te,!!d&&(l=="number"||l!="symbol"&&Xt.test(c))&&c>-1&&c%1==0&&c<d}function Hi(c,d,l){if(!dn(l))return!1;var _=typeof d;return(_=="number"?so(l)&&$a(d,l.length):_=="string"&&d in l)?Ur(l[d],c):!1}function EI(c,d){if(Ge(c))return!1;var l=typeof c;return l=="number"||l=="symbol"||l=="boolean"||c==null||No(c)?!0:Vu.test(c)||!Qc.test(c)||d!=null&&c in Ht(d)}function oee(c){var d=typeof c;return d=="string"||d=="number"||d=="symbol"||d=="boolean"?c!=="__proto__":c===null}function CI(c){var d=GS(c),l=I[d];if(typeof l!="function"||!(d in st.prototype))return!1;if(c===l)return!0;var _=yI(l);return!!_&&c===_[0]}function ree(c){return!!ej&&ej in c}var see=SS?ka:xI;function ev(c){var d=c&&c.constructor,l=typeof d=="function"&&d.prototype||Ch;return c===l}function eN(c){return c===c&&!dn(c)}function tN(c,d){return function(l){return l==null?!1:l[c]===d&&(d!==t||c in Ht(l))}}function aee(c){var d=QS(c,function(_){return l.size===h&&l.clear(),_}),l=d.cache;return d}function cee(c,d){var l=c[1],_=d[1],C=l|_,O=C<(A|L|R),F=_==R&&l==U||_==R&&l==D&&c[7].length<=d[8]||_==(R|D)&&d[7].length<=d[8]&&l==U;if(!(O||F))return c;_&A&&(c[2]=d[2],C|=l&A?0:B);var G=d[3];if(G){var W=c[3];c[3]=W?$j(W,G,d[4]):G,c[4]=W?td(c[3],g):d[4]}return G=d[5],G&&(W=c[5],c[5]=W?kj(W,G,d[6]):G,c[6]=W?td(c[5],g):d[6]),G=d[7],G&&(c[7]=G),_&R&&(c[8]=c[8]==null?d[8]:Ei(c[8],d[8])),c[9]==null&&(c[9]=d[9]),c[0]=d[0],c[1]=C,c}function dee(c){var d=[];if(c!=null)for(var l in Ht(c))d.push(l);return d}function uee(c){return CS.call(c)}function nN(c,d,l){return d=Hn(d===t?c.length-1:d,0),function(){for(var _=arguments,C=-1,O=Hn(_.length-d,0),F=J(O);++C<O;)F[C]=_[d+C];C=-1;for(var G=J(d+1);++C<d;)G[C]=_[C];return G[d]=l(F),Oo(c,this,G)}}function iN(c,d){return d.length<2?c:Zu(c,hr(d,0,-1))}function lee(c,d){for(var l=c.length,_=Ei(d.length,l),C=ro(c);_--;){var O=d[_];c[_]=$a(O,l)?C[O]:t}return c}function PI(c,d){if(!(d==="constructor"&&typeof c[d]=="function")&&d!="__proto__")return c[d]}var oN=sN(Rj),tv=AX||function(c,d){return si.setTimeout(c,d)},wI=sN(jJ);function rN(c,d,l){var _=d+"";return wI(c,nee(_,fee(JJ(_),l)))}function sN(c){var d=0,l=0;return function(){var _=TX(),C=K-(_-l);if(l=_,C>0){if(++d>=Q)return arguments[0]}else d=0;return c.apply(t,arguments)}}function YS(c,d){var l=-1,_=c.length,C=_-1;for(d=d===t?_:d;++l<d;){var O=aI(l,C),F=c[O];c[O]=c[l],c[l]=F}return c.length=d,c}var aN=aee(function(c){var d=[];return c.charCodeAt(0)===46&&d.push(""),c.replace(IM,function(l,_,C,O){d.push(C?O.replace(pe,"$1"):_||l)}),d});function js(c){if(typeof c=="string"||No(c))return c;var d=c+"";return d=="0"&&1/c==-Y?"-0":d}function Xu(c){if(c!=null){try{return ES.call(c)}catch{}try{return c+""}catch{}}return""}function fee(c,d){return dr(et,function(l){var _="_."+l[0];d&l[1]&&!vS(c,_)&&c.push(_)}),c.sort()}function cN(c){if(c instanceof st)return c.clone();var d=new lr(c.__wrapped__,c.__chain__);return d.__actions__=ro(c.__actions__),d.__index__=c.__index__,d.__values__=c.__values__,d}function hee(c,d,l){(l?Hi(c,d,l):d===t)?d=1:d=Hn(Ye(d),0);var _=c==null?0:c.length;if(!_||d<1)return[];for(var C=0,O=0,F=J(IS(_/d));C<_;)F[O++]=hr(c,C,C+=d);return F}function pee(c){for(var d=-1,l=c==null?0:c.length,_=0,C=[];++d<l;){var O=c[d];O&&(C[_++]=O)}return C}function mee(){var c=arguments.length;if(!c)return[];for(var d=J(c-1),l=arguments[0],_=c;_--;)d[_-1]=arguments[_];return ed(Ge(l)?ro(l):[l],ai(d,1))}var gee=Je(function(c,d){return Mn(c)?W1(c,ai(d,1,Mn,!0)):[]}),vee=Je(function(c,d){var l=pr(d);return Mn(l)&&(l=t),Mn(c)?W1(c,ai(d,1,Mn,!0),Le(l,2)):[]}),_ee=Je(function(c,d){var l=pr(d);return Mn(l)&&(l=t),Mn(c)?W1(c,ai(d,1,Mn,!0),t,l):[]});function yee(c,d,l){var _=c==null?0:c.length;return _?(d=l||d===t?1:Ye(d),hr(c,d<0?0:d,_)):[]}function bee(c,d,l){var _=c==null?0:c.length;return _?(d=l||d===t?1:Ye(d),d=_-d,hr(c,0,d<0?0:d)):[]}function See(c,d){return c&&c.length?FS(c,Le(d,3),!0,!0):[]}function Eee(c,d){return c&&c.length?FS(c,Le(d,3),!0):[]}function Cee(c,d,l,_){var C=c==null?0:c.length;return C?(l&&typeof l!="number"&&Hi(c,d,l)&&(l=0,_=C),mJ(c,d,l,_)):[]}function dN(c,d,l){var _=c==null?0:c.length;if(!_)return-1;var C=l==null?0:Ye(l);return C<0&&(C=Hn(_+C,0)),_S(c,Le(d,3),C)}function uN(c,d,l){var _=c==null?0:c.length;if(!_)return-1;var C=_-1;return l!==t&&(C=Ye(l),C=l<0?Hn(_+C,0):Ei(C,_-1)),_S(c,Le(d,3),C,!0)}function lN(c){var d=c==null?0:c.length;return d?ai(c,1):[]}function Pee(c){var d=c==null?0:c.length;return d?ai(c,Y):[]}function wee(c,d){var l=c==null?0:c.length;return l?(d=d===t?1:Ye(d),ai(c,d)):[]}function Aee(c){for(var d=-1,l=c==null?0:c.length,_={};++d<l;){var C=c[d];_[C[0]]=C[1]}return _}function fN(c){return c&&c.length?c[0]:t}function Ree(c,d,l){var _=c==null?0:c.length;if(!_)return-1;var C=l==null?0:Ye(l);return C<0&&(C=Hn(_+C,0)),yh(c,d,C)}function Mee(c){var d=c==null?0:c.length;return d?hr(c,0,-1):[]}var Iee=Je(function(c){var d=nn(c,fI);return d.length&&d[0]===c[0]?nI(d):[]}),Tee=Je(function(c){var d=pr(c),l=nn(c,fI);return d===pr(l)?d=t:l.pop(),l.length&&l[0]===c[0]?nI(l,Le(d,2)):[]}),Dee=Je(function(c){var d=pr(c),l=nn(c,fI);return d=typeof d=="function"?d:t,d&&l.pop(),l.length&&l[0]===c[0]?nI(l,t,d):[]});function Oee(c,d){return c==null?"":MX.call(c,d)}function pr(c){var d=c==null?0:c.length;return d?c[d-1]:t}function Lee(c,d,l){var _=c==null?0:c.length;if(!_)return-1;var C=_;return l!==t&&(C=Ye(l),C=C<0?Hn(_+C,0):Ei(C,_-1)),d===d?fX(c,d,C):_S(c,U4,C,!0)}function jee(c,d){return c&&c.length?Cj(c,Ye(d)):t}var Nee=Je(hN);function hN(c,d){return c&&c.length&&d&&d.length?sI(c,d):c}function Bee(c,d,l){return c&&c.length&&d&&d.length?sI(c,d,Le(l,2)):c}function $ee(c,d,l){return c&&c.length&&d&&d.length?sI(c,d,t,l):c}var kee=Ba(function(c,d){var l=c==null?0:c.length,_=XM(c,d);return Aj(c,nn(d,function(C){return $a(C,l)?+C:C}).sort(Bj)),_});function Fee(c,d){var l=[];if(!(c&&c.length))return l;var _=-1,C=[],O=c.length;for(d=Le(d,3);++_<O;){var F=c[_];d(F,_,c)&&(l.push(F),C.push(_))}return Aj(c,C),l}function AI(c){return c==null?c:OX.call(c)}function xee(c,d,l){var _=c==null?0:c.length;return _?(l&&typeof l!="number"&&Hi(c,d,l)?(d=0,l=_):(d=d==null?0:Ye(d),l=l===t?_:Ye(l)),hr(c,d,l)):[]}function Hee(c,d){return kS(c,d)}function Kee(c,d,l){return dI(c,d,Le(l,2))}function Vee(c,d){var l=c==null?0:c.length;if(l){var _=kS(c,d);if(_<l&&Ur(c[_],d))return _}return-1}function zee(c,d){return kS(c,d,!0)}function Gee(c,d,l){return dI(c,d,Le(l,2),!0)}function Uee(c,d){var l=c==null?0:c.length;if(l){var _=kS(c,d,!0)-1;if(Ur(c[_],d))return _}return-1}function Yee(c){return c&&c.length?Mj(c):[]}function qee(c,d){return c&&c.length?Mj(c,Le(d,2)):[]}function Wee(c){var d=c==null?0:c.length;return d?hr(c,1,d):[]}function Zee(c,d,l){return c&&c.length?(d=l||d===t?1:Ye(d),hr(c,0,d<0?0:d)):[]}function Qee(c,d,l){var _=c==null?0:c.length;return _?(d=l||d===t?1:Ye(d),d=_-d,hr(c,d<0?0:d,_)):[]}function Xee(c,d){return c&&c.length?FS(c,Le(d,3),!1,!0):[]}function Jee(c,d){return c&&c.length?FS(c,Le(d,3)):[]}var ete=Je(function(c){return od(ai(c,1,Mn,!0))}),tte=Je(function(c){var d=pr(c);return Mn(d)&&(d=t),od(ai(c,1,Mn,!0),Le(d,2))}),nte=Je(function(c){var d=pr(c);return d=typeof d=="function"?d:t,od(ai(c,1,Mn,!0),t,d)});function ite(c){return c&&c.length?od(c):[]}function ote(c,d){return c&&c.length?od(c,Le(d,2)):[]}function rte(c,d){return d=typeof d=="function"?d:t,c&&c.length?od(c,t,d):[]}function RI(c){if(!(c&&c.length))return[];var d=0;return c=Jc(c,function(l){if(Mn(l))return d=Hn(l.length,d),!0}),zM(d,function(l){return nn(c,HM(l))})}function pN(c,d){if(!(c&&c.length))return[];var l=RI(c);return d==null?l:nn(l,function(_){return Oo(d,t,_)})}var ste=Je(function(c,d){return Mn(c)?W1(c,d):[]}),ate=Je(function(c){return lI(Jc(c,Mn))}),cte=Je(function(c){var d=pr(c);return Mn(d)&&(d=t),lI(Jc(c,Mn),Le(d,2))}),dte=Je(function(c){var d=pr(c);return d=typeof d=="function"?d:t,lI(Jc(c,Mn),t,d)}),ute=Je(RI);function lte(c,d){return Oj(c||[],d||[],q1)}function fte(c,d){return Oj(c||[],d||[],X1)}var hte=Je(function(c){var d=c.length,l=d>1?c[d-1]:t;return l=typeof l=="function"?(c.pop(),l):t,pN(c,l)});function mN(c){var d=I(c);return d.__chain__=!0,d}function pte(c,d){return d(c),c}function qS(c,d){return d(c)}var mte=Ba(function(c){var d=c.length,l=d?c[0]:0,_=this.__wrapped__,C=function(O){return XM(O,c)};return d>1||this.__actions__.length||!(_ instanceof st)||!$a(l)?this.thru(C):(_=_.slice(l,+l+(d?1:0)),_.__actions__.push({func:qS,args:[C],thisArg:t}),new lr(_,this.__chain__).thru(function(O){return d&&!O.length&&O.push(t),O}))});function gte(){return mN(this)}function vte(){return new lr(this.value(),this.__chain__)}function _te(){this.__values__===t&&(this.__values__=IN(this.value()));var c=this.__index__>=this.__values__.length,d=c?t:this.__values__[this.__index__++];return{done:c,value:d}}function yte(){return this}function bte(c){for(var d,l=this;l instanceof LS;){var _=cN(l);_.__index__=0,_.__values__=t,d?C.__wrapped__=_:d=_;var C=_;l=l.__wrapped__}return C.__wrapped__=c,d}function Ste(){var c=this.__wrapped__;if(c instanceof st){var d=c;return this.__actions__.length&&(d=new st(this)),d=d.reverse(),d.__actions__.push({func:qS,args:[AI],thisArg:t}),new lr(d,this.__chain__)}return this.thru(AI)}function Ete(){return Dj(this.__wrapped__,this.__actions__)}var Cte=xS(function(c,d,l){Dt.call(c,l)?++c[l]:ja(c,l,1)});function Pte(c,d,l){var _=Ge(c)?z4:pJ;return l&&Hi(c,d,l)&&(d=t),_(c,Le(d,3))}function wte(c,d){var l=Ge(c)?Jc:pj;return l(c,Le(d,3))}var Ate=Kj(dN),Rte=Kj(uN);function Mte(c,d){return ai(WS(c,d),1)}function Ite(c,d){return ai(WS(c,d),Y)}function Tte(c,d,l){return l=l===t?1:Ye(l),ai(WS(c,d),l)}function gN(c,d){var l=Ge(c)?dr:id;return l(c,Le(d,3))}function vN(c,d){var l=Ge(c)?WQ:hj;return l(c,Le(d,3))}var Dte=xS(function(c,d,l){Dt.call(c,l)?c[l].push(d):ja(c,l,[d])});function Ote(c,d,l,_){c=so(c)?c:Dh(c),l=l&&!_?Ye(l):0;var C=c.length;return l<0&&(l=Hn(C+l,0)),eE(c)?l<=C&&c.indexOf(d,l)>-1:!!C&&yh(c,d,l)>-1}var Lte=Je(function(c,d,l){var _=-1,C=typeof d=="function",O=so(c)?J(c.length):[];return id(c,function(F){O[++_]=C?Oo(d,F,l):Z1(F,d,l)}),O}),jte=xS(function(c,d,l){ja(c,l,d)});function WS(c,d){var l=Ge(c)?nn:bj;return l(c,Le(d,3))}function Nte(c,d,l,_){return c==null?[]:(Ge(d)||(d=d==null?[]:[d]),l=_?t:l,Ge(l)||(l=l==null?[]:[l]),Pj(c,d,l))}var Bte=xS(function(c,d,l){c[l?0:1].push(d)},function(){return[[],[]]});function $te(c,d,l){var _=Ge(c)?FM:q4,C=arguments.length<3;return _(c,Le(d,4),l,C,id)}function kte(c,d,l){var _=Ge(c)?ZQ:q4,C=arguments.length<3;return _(c,Le(d,4),l,C,hj)}function Fte(c,d){var l=Ge(c)?Jc:pj;return l(c,XS(Le(d,3)))}function xte(c){var d=Ge(c)?dj:OJ;return d(c)}function Hte(c,d,l){(l?Hi(c,d,l):d===t)?d=1:d=Ye(d);var _=Ge(c)?dJ:LJ;return _(c,d)}function Kte(c){var d=Ge(c)?uJ:NJ;return d(c)}function Vte(c){if(c==null)return 0;if(so(c))return eE(c)?Sh(c):c.length;var d=Ci(c);return d==he||d==_t?c.size:oI(c).length}function zte(c,d,l){var _=Ge(c)?xM:BJ;return l&&Hi(c,d,l)&&(d=t),_(c,Le(d,3))}var Gte=Je(function(c,d){if(c==null)return[];var l=d.length;return l>1&&Hi(c,d[0],d[1])?d=[]:l>2&&Hi(d[0],d[1],d[2])&&(d=[d[0]]),Pj(c,ai(d,1),[])}),ZS=wX||function(){return si.Date.now()};function Ute(c,d){if(typeof d!="function")throw new ur(s);return c=Ye(c),function(){if(--c<1)return d.apply(this,arguments)}}function _N(c,d,l){return d=l?t:d,d=c&&d==null?c.length:d,Na(c,R,t,t,t,t,d)}function yN(c,d){var l;if(typeof d!="function")throw new ur(s);return c=Ye(c),function(){return--c>0&&(l=d.apply(this,arguments)),c<=1&&(d=t),l}}var MI=Je(function(c,d,l){var _=A;if(l.length){var C=td(l,Ih(MI));_|=b}return Na(c,_,d,l,C)}),bN=Je(function(c,d,l){var _=A|L;if(l.length){var C=td(l,Ih(bN));_|=b}return Na(d,_,c,l,C)});function SN(c,d,l){d=l?t:d;var _=Na(c,U,t,t,t,t,t,d);return _.placeholder=SN.placeholder,_}function EN(c,d,l){d=l?t:d;var _=Na(c,p,t,t,t,t,t,d);return _.placeholder=EN.placeholder,_}function CN(c,d,l){var _,C,O,F,G,W,ie=0,re=!1,ce=!1,_e=!0;if(typeof c!="function")throw new ur(s);d=mr(d)||0,dn(l)&&(re=!!l.leading,ce="maxWait"in l,O=ce?Hn(mr(l.maxWait)||0,d):O,_e="trailing"in l?!!l.trailing:_e);function Ae(In){var Yr=_,xa=C;return _=C=t,ie=In,F=c.apply(xa,Yr),F}function Ne(In){return ie=In,G=tv(rt,d),re?Ae(In):F}function qe(In){var Yr=In-W,xa=In-ie,KN=d-Yr;return ce?Ei(KN,O-xa):KN}function Be(In){var Yr=In-W,xa=In-ie;return W===t||Yr>=d||Yr<0||ce&&xa>=O}function rt(){var In=ZS();if(Be(In))return ut(In);G=tv(rt,qe(In))}function ut(In){return G=t,_e&&_?Ae(In):(_=C=t,F)}function Bo(){G!==t&&Lj(G),ie=0,_=W=C=G=t}function Ki(){return G===t?F:ut(ZS())}function $o(){var In=ZS(),Yr=Be(In);if(_=arguments,C=this,W=In,Yr){if(G===t)return Ne(W);if(ce)return Lj(G),G=tv(rt,d),Ae(W)}return G===t&&(G=tv(rt,d)),F}return $o.cancel=Bo,$o.flush=Ki,$o}var Yte=Je(function(c,d){return fj(c,1,d)}),qte=Je(function(c,d,l){return fj(c,mr(d)||0,l)});function Wte(c){return Na(c,j)}function QS(c,d){if(typeof c!="function"||d!=null&&typeof d!="function")throw new ur(s);var l=function(){var _=arguments,C=d?d.apply(this,_):_[0],O=l.cache;if(O.has(C))return O.get(C);var F=c.apply(this,_);return l.cache=O.set(C,F)||O,F};return l.cache=new(QS.Cache||La),l}QS.Cache=La;function XS(c){if(typeof c!="function")throw new ur(s);return function(){var d=arguments;switch(d.length){case 0:return!c.call(this);case 1:return!c.call(this,d[0]);case 2:return!c.call(this,d[0],d[1]);case 3:return!c.call(this,d[0],d[1],d[2])}return!c.apply(this,d)}}function Zte(c){return yN(2,c)}var Qte=$J(function(c,d){d=d.length==1&&Ge(d[0])?nn(d[0],Lo(Le())):nn(ai(d,1),Lo(Le()));var l=d.length;return Je(function(_){for(var C=-1,O=Ei(_.length,l);++C<O;)_[C]=d[C].call(this,_[C]);return Oo(c,this,_)})}),II=Je(function(c,d){var l=td(d,Ih(II));return Na(c,b,t,d,l)}),PN=Je(function(c,d){var l=td(d,Ih(PN));return Na(c,v,t,d,l)}),Xte=Ba(function(c,d){return Na(c,D,t,t,t,d)});function Jte(c,d){if(typeof c!="function")throw new ur(s);return d=d===t?d:Ye(d),Je(c,d)}function ene(c,d){if(typeof c!="function")throw new ur(s);return d=d==null?0:Hn(Ye(d),0),Je(function(l){var _=l[d],C=sd(l,0,d);return _&&ed(C,_),Oo(c,this,C)})}function tne(c,d,l){var _=!0,C=!0;if(typeof c!="function")throw new ur(s);return dn(l)&&(_="leading"in l?!!l.leading:_,C="trailing"in l?!!l.trailing:C),CN(c,d,{leading:_,maxWait:d,trailing:C})}function nne(c){return _N(c,1)}function ine(c,d){return II(hI(d),c)}function one(){if(!arguments.length)return[];var c=arguments[0];return Ge(c)?c:[c]}function rne(c){return fr(c,w)}function sne(c,d){return d=typeof d=="function"?d:t,fr(c,w,d)}function ane(c){return fr(c,y|w)}function cne(c,d){return d=typeof d=="function"?d:t,fr(c,y|w,d)}function dne(c,d){return d==null||lj(c,d,Yn(d))}function Ur(c,d){return c===d||c!==c&&d!==d}var une=zS(tI),lne=zS(function(c,d){return c>=d}),Ju=vj(function(){return arguments}())?vj:function(c){return vn(c)&&Dt.call(c,"callee")&&!ij.call(c,"callee")},Ge=J.isArray,fne=k4?Lo(k4):bJ;function so(c){return c!=null&&JS(c.length)&&!ka(c)}function Mn(c){return vn(c)&&so(c)}function hne(c){return c===!0||c===!1||vn(c)&&xi(c)==vt}var ad=RX||xI,pne=F4?Lo(F4):SJ;function mne(c){return vn(c)&&c.nodeType===1&&!nv(c)}function gne(c){if(c==null)return!0;if(so(c)&&(Ge(c)||typeof c=="string"||typeof c.splice=="function"||ad(c)||Th(c)||Ju(c)))return!c.length;var d=Ci(c);if(d==he||d==_t)return!c.size;if(ev(c))return!oI(c).length;for(var l in c)if(Dt.call(c,l))return!1;return!0}function vne(c,d){return Q1(c,d)}function _ne(c,d,l){l=typeof l=="function"?l:t;var _=l?l(c,d):t;return _===t?Q1(c,d,t,l):!!_}function TI(c){if(!vn(c))return!1;var d=xi(c);return d==Wt||d==bi||typeof c.message=="string"&&typeof c.name=="string"&&!nv(c)}function yne(c){return typeof c=="number"&&rj(c)}function ka(c){if(!dn(c))return!1;var d=xi(c);return d==Ze||d==ii||d==Ot||d==gn}function wN(c){return typeof c=="number"&&c==Ye(c)}function JS(c){return typeof c=="number"&&c>-1&&c%1==0&&c<=te}function dn(c){var d=typeof c;return c!=null&&(d=="object"||d=="function")}function vn(c){return c!=null&&typeof c=="object"}var AN=x4?Lo(x4):CJ;function bne(c,d){return c===d||iI(c,d,bI(d))}function Sne(c,d,l){return l=typeof l=="function"?l:t,iI(c,d,bI(d),l)}function Ene(c){return RN(c)&&c!=+c}function Cne(c){if(see(c))throw new He(r);return _j(c)}function Pne(c){return c===null}function wne(c){return c==null}function RN(c){return typeof c=="number"||vn(c)&&xi(c)==je}function nv(c){if(!vn(c)||xi(c)!=xt)return!1;var d=AS(c);if(d===null)return!0;var l=Dt.call(d,"constructor")&&d.constructor;return typeof l=="function"&&l instanceof l&&ES.call(l)==SX}var DI=H4?Lo(H4):PJ;function Ane(c){return wN(c)&&c>=-te&&c<=te}var MN=K4?Lo(K4):wJ;function eE(c){return typeof c=="string"||!Ge(c)&&vn(c)&&xi(c)==Zt}function No(c){return typeof c=="symbol"||vn(c)&&xi(c)==Si}var Th=V4?Lo(V4):AJ;function Rne(c){return c===t}function Mne(c){return vn(c)&&Ci(c)==ne}function Ine(c){return vn(c)&&xi(c)==fe}var Tne=zS(rI),Dne=zS(function(c,d){return c<=d});function IN(c){if(!c)return[];if(so(c))return eE(c)?zr(c):ro(c);if(V1&&c[V1])return dX(c[V1]());var d=Ci(c),l=d==he?UM:d==_t?yS:Dh;return l(c)}function Fa(c){if(!c)return c===0?c:0;if(c=mr(c),c===Y||c===-Y){var d=c<0?-1:1;return d*ue}return c===c?c:0}function Ye(c){var d=Fa(c),l=d%1;return d===d?l?d-l:d:0}function TN(c){return c?Wu(Ye(c),0,ae):0}function mr(c){if(typeof c=="number")return c;if(No(c))return Re;if(dn(c)){var d=typeof c.valueOf=="function"?c.valueOf():c;c=dn(d)?d+"":d}if(typeof c!="string")return c===0?c:+c;c=W4(c);var l=jt.test(c);return l||dt.test(c)?UQ(c.slice(2),l?2:8):Tt.test(c)?Re:+c}function DN(c){return Ls(c,ao(c))}function One(c){return c?Wu(Ye(c),-te,te):c===0?c:0}function Rt(c){return c==null?"":jo(c)}var Lne=Rh(function(c,d){if(ev(d)||so(d)){Ls(d,Yn(d),c);return}for(var l in d)Dt.call(d,l)&&q1(c,l,d[l])}),ON=Rh(function(c,d){Ls(d,ao(d),c)}),tE=Rh(function(c,d,l,_){Ls(d,ao(d),c,_)}),jne=Rh(function(c,d,l,_){Ls(d,Yn(d),c,_)}),Nne=Ba(XM);function Bne(c,d){var l=Ah(c);return d==null?l:uj(l,d)}var $ne=Je(function(c,d){c=Ht(c);var l=-1,_=d.length,C=_>2?d[2]:t;for(C&&Hi(d[0],d[1],C)&&(_=1);++l<_;)for(var O=d[l],F=ao(O),G=-1,W=F.length;++G<W;){var ie=F[G],re=c[ie];(re===t||Ur(re,Ch[ie])&&!Dt.call(c,ie))&&(c[ie]=O[ie])}return c}),kne=Je(function(c){return c.push(t,Wj),Oo(LN,t,c)});function Fne(c,d){return G4(c,Le(d,3),Os)}function xne(c,d){return G4(c,Le(d,3),eI)}function Hne(c,d){return c==null?c:JM(c,Le(d,3),ao)}function Kne(c,d){return c==null?c:mj(c,Le(d,3),ao)}function Vne(c,d){return c&&Os(c,Le(d,3))}function zne(c,d){return c&&eI(c,Le(d,3))}function Gne(c){return c==null?[]:BS(c,Yn(c))}function Une(c){return c==null?[]:BS(c,ao(c))}function OI(c,d,l){var _=c==null?t:Zu(c,d);return _===t?l:_}function Yne(c,d){return c!=null&&Xj(c,d,gJ)}function LI(c,d){return c!=null&&Xj(c,d,vJ)}var qne=zj(function(c,d,l){d!=null&&typeof d.toString!="function"&&(d=CS.call(d)),c[d]=l},NI(co)),Wne=zj(function(c,d,l){d!=null&&typeof d.toString!="function"&&(d=CS.call(d)),Dt.call(c,d)?c[d].push(l):c[d]=[l]},Le),Zne=Je(Z1);function Yn(c){return so(c)?cj(c):oI(c)}function ao(c){return so(c)?cj(c,!0):RJ(c)}function Qne(c,d){var l={};return d=Le(d,3),Os(c,function(_,C,O){ja(l,d(_,C,O),_)}),l}function Xne(c,d){var l={};return d=Le(d,3),Os(c,function(_,C,O){ja(l,C,d(_,C,O))}),l}var Jne=Rh(function(c,d,l){$S(c,d,l)}),LN=Rh(function(c,d,l,_){$S(c,d,l,_)}),eie=Ba(function(c,d){var l={};if(c==null)return l;var _=!1;d=nn(d,function(O){return O=rd(O,c),_||(_=O.length>1),O}),Ls(c,_I(c),l),_&&(l=fr(l,y|S|w,qJ));for(var C=d.length;C--;)uI(l,d[C]);return l});function tie(c,d){return jN(c,XS(Le(d)))}var nie=Ba(function(c,d){return c==null?{}:IJ(c,d)});function jN(c,d){if(c==null)return{};var l=nn(_I(c),function(_){return[_]});return d=Le(d),wj(c,l,function(_,C){return d(_,C[0])})}function iie(c,d,l){d=rd(d,c);var _=-1,C=d.length;for(C||(C=1,c=t);++_<C;){var O=c==null?t:c[js(d[_])];O===t&&(_=C,O=l),c=ka(O)?O.call(c):O}return c}function oie(c,d,l){return c==null?c:X1(c,d,l)}function rie(c,d,l,_){return _=typeof _=="function"?_:t,c==null?c:X1(c,d,l,_)}var NN=Yj(Yn),BN=Yj(ao);function sie(c,d,l){var _=Ge(c),C=_||ad(c)||Th(c);if(d=Le(d,4),l==null){var O=c&&c.constructor;C?l=_?new O:[]:dn(c)?l=ka(O)?Ah(AS(c)):{}:l={}}return(C?dr:Os)(c,function(F,G,W){return d(l,F,G,W)}),l}function aie(c,d){return c==null?!0:uI(c,d)}function cie(c,d,l){return c==null?c:Tj(c,d,hI(l))}function die(c,d,l,_){return _=typeof _=="function"?_:t,c==null?c:Tj(c,d,hI(l),_)}function Dh(c){return c==null?[]:GM(c,Yn(c))}function uie(c){return c==null?[]:GM(c,ao(c))}function lie(c,d,l){return l===t&&(l=d,d=t),l!==t&&(l=mr(l),l=l===l?l:0),d!==t&&(d=mr(d),d=d===d?d:0),Wu(mr(c),d,l)}function fie(c,d,l){return d=Fa(d),l===t?(l=d,d=0):l=Fa(l),c=mr(c),_J(c,d,l)}function hie(c,d,l){if(l&&typeof l!="boolean"&&Hi(c,d,l)&&(d=l=t),l===t&&(typeof d=="boolean"?(l=d,d=t):typeof c=="boolean"&&(l=c,c=t)),c===t&&d===t?(c=0,d=1):(c=Fa(c),d===t?(d=c,c=0):d=Fa(d)),c>d){var _=c;c=d,d=_}if(l||c%1||d%1){var C=sj();return Ei(c+C*(d-c+GQ("1e-"+((C+"").length-1))),d)}return aI(c,d)}var pie=Mh(function(c,d,l){return d=d.toLowerCase(),c+(l?$N(d):d)});function $N(c){return jI(Rt(c).toLowerCase())}function kN(c){return c=Rt(c),c&&c.replace(bt,oX).replace(NQ,"")}function mie(c,d,l){c=Rt(c),d=jo(d);var _=c.length;l=l===t?_:Wu(Ye(l),0,_);var C=l;return l-=d.length,l>=0&&c.slice(l,C)==d}function gie(c){return c=Rt(c),c&&gh.test(c)?c.replace(fS,rX):c}function vie(c){return c=Rt(c),c&&zu.test(c)?c.replace(x1,"\\$&"):c}var _ie=Mh(function(c,d,l){return c+(l?"-":"")+d.toLowerCase()}),yie=Mh(function(c,d,l){return c+(l?" ":"")+d.toLowerCase()}),bie=Hj("toLowerCase");function Sie(c,d,l){c=Rt(c),d=Ye(d);var _=d?Sh(c):0;if(!d||_>=d)return c;var C=(d-_)/2;return VS(TS(C),l)+c+VS(IS(C),l)}function Eie(c,d,l){c=Rt(c),d=Ye(d);var _=d?Sh(c):0;return d&&_<d?c+VS(d-_,l):c}function Cie(c,d,l){c=Rt(c),d=Ye(d);var _=d?Sh(c):0;return d&&_<d?VS(d-_,l)+c:c}function Pie(c,d,l){return l||d==null?d=0:d&&(d=+d),DX(Rt(c).replace(vh,""),d||0)}function wie(c,d,l){return(l?Hi(c,d,l):d===t)?d=1:d=Ye(d),cI(Rt(c),d)}function Aie(){var c=arguments,d=Rt(c[0]);return c.length<3?d:d.replace(c[1],c[2])}var Rie=Mh(function(c,d,l){return c+(l?"_":"")+d.toLowerCase()});function Mie(c,d,l){return l&&typeof l!="number"&&Hi(c,d,l)&&(d=l=t),l=l===t?ae:l>>>0,l?(c=Rt(c),c&&(typeof d=="string"||d!=null&&!DI(d))&&(d=jo(d),!d&&bh(c))?sd(zr(c),0,l):c.split(d,l)):[]}var Iie=Mh(function(c,d,l){return c+(l?" ":"")+jI(d)});function Tie(c,d,l){return c=Rt(c),l=l==null?0:Wu(Ye(l),0,c.length),d=jo(d),c.slice(l,l+d.length)==d}function Die(c,d,l){var _=I.templateSettings;l&&Hi(c,d,l)&&(d=t),c=Rt(c),d=tE({},d,_,qj);var C=tE({},d.imports,_.imports,qj),O=Yn(C),F=GM(C,O),G,W,ie=0,re=d.interpolate||tn,ce="__p += '",_e=YM((d.escape||tn).source+"|"+re.source+"|"+(re===hS?Pe:tn).source+"|"+(d.evaluate||tn).source+"|$","g"),Ae="//# sourceURL="+(Dt.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++xQ+"]")+`
`;c.replace(_e,function(Be,rt,ut,Bo,Ki,$o){return ut||(ut=Bo),ce+=c.slice(ie,$o).replace(ri,sX),rt&&(G=!0,ce+=`' +
__e(`+rt+`) +
'`),Ki&&(W=!0,ce+=`';
`+Ki+`;
__p += '`),ut&&(ce+=`' +
((__t = (`+ut+`)) == null ? '' : __t) +
'`),ie=$o+Be.length,Be}),ce+=`';
`;var Ne=Dt.call(d,"variable")&&d.variable;if(!Ne)ce=`with (obj) {
`+ce+`
}
`;else if(oe.test(Ne))throw new He(a);ce=(W?ce.replace(PM,""):ce).replace(wM,"$1").replace(AM,"$1;"),ce="function("+(Ne||"obj")+`) {
`+(Ne?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(G?", __e = _.escape":"")+(W?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ce+`return __p
}`;var qe=xN(function(){return St(O,Ae+"return "+ce).apply(t,F)});if(qe.source=ce,TI(qe))throw qe;return qe}function Oie(c){return Rt(c).toLowerCase()}function Lie(c){return Rt(c).toUpperCase()}function jie(c,d,l){if(c=Rt(c),c&&(l||d===t))return W4(c);if(!c||!(d=jo(d)))return c;var _=zr(c),C=zr(d),O=Z4(_,C),F=Q4(_,C)+1;return sd(_,O,F).join("")}function Nie(c,d,l){if(c=Rt(c),c&&(l||d===t))return c.slice(0,J4(c)+1);if(!c||!(d=jo(d)))return c;var _=zr(c),C=Q4(_,zr(d))+1;return sd(_,0,C).join("")}function Bie(c,d,l){if(c=Rt(c),c&&(l||d===t))return c.replace(vh,"");if(!c||!(d=jo(d)))return c;var _=zr(c),C=Z4(_,zr(d));return sd(_,C).join("")}function $ie(c,d){var l=T,_=$;if(dn(d)){var C="separator"in d?d.separator:C;l="length"in d?Ye(d.length):l,_="omission"in d?jo(d.omission):_}c=Rt(c);var O=c.length;if(bh(c)){var F=zr(c);O=F.length}if(l>=O)return c;var G=l-Sh(_);if(G<1)return _;var W=F?sd(F,0,G).join(""):c.slice(0,G);if(C===t)return W+_;if(F&&(G+=W.length-G),DI(C)){if(c.slice(G).search(C)){var ie,re=W;for(C.global||(C=YM(C.source,Rt(Lt.exec(C))+"g")),C.lastIndex=0;ie=C.exec(re);)var ce=ie.index;W=W.slice(0,ce===t?G:ce)}}else if(c.indexOf(jo(C),G)!=G){var _e=W.lastIndexOf(C);_e>-1&&(W=W.slice(0,_e))}return W+_}function kie(c){return c=Rt(c),c&&RM.test(c)?c.replace(Vr,hX):c}var Fie=Mh(function(c,d,l){return c+(l?" ":"")+d.toUpperCase()}),jI=Hj("toUpperCase");function FN(c,d,l){return c=Rt(c),d=l?t:d,d===t?cX(c)?gX(c):JQ(c):c.match(d)||[]}var xN=Je(function(c,d){try{return Oo(c,t,d)}catch(l){return TI(l)?l:new He(l)}}),xie=Ba(function(c,d){return dr(d,function(l){l=js(l),ja(c,l,MI(c[l],c))}),c});function Hie(c){var d=c==null?0:c.length,l=Le();return c=d?nn(c,function(_){if(typeof _[1]!="function")throw new ur(s);return[l(_[0]),_[1]]}):[],Je(function(_){for(var C=-1;++C<d;){var O=c[C];if(Oo(O[0],this,_))return Oo(O[1],this,_)}})}function Kie(c){return hJ(fr(c,y))}function NI(c){return function(){return c}}function Vie(c,d){return c==null||c!==c?d:c}var zie=Vj(),Gie=Vj(!0);function co(c){return c}function BI(c){return yj(typeof c=="function"?c:fr(c,y))}function Uie(c){return Sj(fr(c,y))}function Yie(c,d){return Ej(c,fr(d,y))}var qie=Je(function(c,d){return function(l){return Z1(l,c,d)}}),Wie=Je(function(c,d){return function(l){return Z1(c,l,d)}});function $I(c,d,l){var _=Yn(d),C=BS(d,_);l==null&&!(dn(d)&&(C.length||!_.length))&&(l=d,d=c,c=this,C=BS(d,Yn(d)));var O=!(dn(l)&&"chain"in l)||!!l.chain,F=ka(c);return dr(C,function(G){var W=d[G];c[G]=W,F&&(c.prototype[G]=function(){var ie=this.__chain__;if(O||ie){var re=c(this.__wrapped__),ce=re.__actions__=ro(this.__actions__);return ce.push({func:W,args:arguments,thisArg:c}),re.__chain__=ie,re}return W.apply(c,ed([this.value()],arguments))})}),c}function Zie(){return si._===this&&(si._=EX),this}function kI(){}function Qie(c){return c=Ye(c),Je(function(d){return Cj(d,c)})}var Xie=mI(nn),Jie=mI(z4),eoe=mI(xM);function HN(c){return EI(c)?HM(js(c)):TJ(c)}function toe(c){return function(d){return c==null?t:Zu(c,d)}}var noe=Gj(),ioe=Gj(!0);function FI(){return[]}function xI(){return!1}function ooe(){return{}}function roe(){return""}function soe(){return!0}function aoe(c,d){if(c=Ye(c),c<1||c>te)return[];var l=ae,_=Ei(c,ae);d=Le(d),c-=ae;for(var C=zM(_,d);++l<c;)d(l);return C}function coe(c){return Ge(c)?nn(c,js):No(c)?[c]:ro(aN(Rt(c)))}function doe(c){var d=++bX;return Rt(c)+d}var uoe=KS(function(c,d){return c+d},0),loe=gI("ceil"),foe=KS(function(c,d){return c/d},1),hoe=gI("floor");function poe(c){return c&&c.length?NS(c,co,tI):t}function moe(c,d){return c&&c.length?NS(c,Le(d,2),tI):t}function goe(c){return Y4(c,co)}function voe(c,d){return Y4(c,Le(d,2))}function _oe(c){return c&&c.length?NS(c,co,rI):t}function yoe(c,d){return c&&c.length?NS(c,Le(d,2),rI):t}var boe=KS(function(c,d){return c*d},1),Soe=gI("round"),Eoe=KS(function(c,d){return c-d},0);function Coe(c){return c&&c.length?VM(c,co):0}function Poe(c,d){return c&&c.length?VM(c,Le(d,2)):0}return I.after=Ute,I.ary=_N,I.assign=Lne,I.assignIn=ON,I.assignInWith=tE,I.assignWith=jne,I.at=Nne,I.before=yN,I.bind=MI,I.bindAll=xie,I.bindKey=bN,I.castArray=one,I.chain=mN,I.chunk=hee,I.compact=pee,I.concat=mee,I.cond=Hie,I.conforms=Kie,I.constant=NI,I.countBy=Cte,I.create=Bne,I.curry=SN,I.curryRight=EN,I.debounce=CN,I.defaults=$ne,I.defaultsDeep=kne,I.defer=Yte,I.delay=qte,I.difference=gee,I.differenceBy=vee,I.differenceWith=_ee,I.drop=yee,I.dropRight=bee,I.dropRightWhile=See,I.dropWhile=Eee,I.fill=Cee,I.filter=wte,I.flatMap=Mte,I.flatMapDeep=Ite,I.flatMapDepth=Tte,I.flatten=lN,I.flattenDeep=Pee,I.flattenDepth=wee,I.flip=Wte,I.flow=zie,I.flowRight=Gie,I.fromPairs=Aee,I.functions=Gne,I.functionsIn=Une,I.groupBy=Dte,I.initial=Mee,I.intersection=Iee,I.intersectionBy=Tee,I.intersectionWith=Dee,I.invert=qne,I.invertBy=Wne,I.invokeMap=Lte,I.iteratee=BI,I.keyBy=jte,I.keys=Yn,I.keysIn=ao,I.map=WS,I.mapKeys=Qne,I.mapValues=Xne,I.matches=Uie,I.matchesProperty=Yie,I.memoize=QS,I.merge=Jne,I.mergeWith=LN,I.method=qie,I.methodOf=Wie,I.mixin=$I,I.negate=XS,I.nthArg=Qie,I.omit=eie,I.omitBy=tie,I.once=Zte,I.orderBy=Nte,I.over=Xie,I.overArgs=Qte,I.overEvery=Jie,I.overSome=eoe,I.partial=II,I.partialRight=PN,I.partition=Bte,I.pick=nie,I.pickBy=jN,I.property=HN,I.propertyOf=toe,I.pull=Nee,I.pullAll=hN,I.pullAllBy=Bee,I.pullAllWith=$ee,I.pullAt=kee,I.range=noe,I.rangeRight=ioe,I.rearg=Xte,I.reject=Fte,I.remove=Fee,I.rest=Jte,I.reverse=AI,I.sampleSize=Hte,I.set=oie,I.setWith=rie,I.shuffle=Kte,I.slice=xee,I.sortBy=Gte,I.sortedUniq=Yee,I.sortedUniqBy=qee,I.split=Mie,I.spread=ene,I.tail=Wee,I.take=Zee,I.takeRight=Qee,I.takeRightWhile=Xee,I.takeWhile=Jee,I.tap=pte,I.throttle=tne,I.thru=qS,I.toArray=IN,I.toPairs=NN,I.toPairsIn=BN,I.toPath=coe,I.toPlainObject=DN,I.transform=sie,I.unary=nne,I.union=ete,I.unionBy=tte,I.unionWith=nte,I.uniq=ite,I.uniqBy=ote,I.uniqWith=rte,I.unset=aie,I.unzip=RI,I.unzipWith=pN,I.update=cie,I.updateWith=die,I.values=Dh,I.valuesIn=uie,I.without=ste,I.words=FN,I.wrap=ine,I.xor=ate,I.xorBy=cte,I.xorWith=dte,I.zip=ute,I.zipObject=lte,I.zipObjectDeep=fte,I.zipWith=hte,I.entries=NN,I.entriesIn=BN,I.extend=ON,I.extendWith=tE,$I(I,I),I.add=uoe,I.attempt=xN,I.camelCase=pie,I.capitalize=$N,I.ceil=loe,I.clamp=lie,I.clone=rne,I.cloneDeep=ane,I.cloneDeepWith=cne,I.cloneWith=sne,I.conformsTo=dne,I.deburr=kN,I.defaultTo=Vie,I.divide=foe,I.endsWith=mie,I.eq=Ur,I.escape=gie,I.escapeRegExp=vie,I.every=Pte,I.find=Ate,I.findIndex=dN,I.findKey=Fne,I.findLast=Rte,I.findLastIndex=uN,I.findLastKey=xne,I.floor=hoe,I.forEach=gN,I.forEachRight=vN,I.forIn=Hne,I.forInRight=Kne,I.forOwn=Vne,I.forOwnRight=zne,I.get=OI,I.gt=une,I.gte=lne,I.has=Yne,I.hasIn=LI,I.head=fN,I.identity=co,I.includes=Ote,I.indexOf=Ree,I.inRange=fie,I.invoke=Zne,I.isArguments=Ju,I.isArray=Ge,I.isArrayBuffer=fne,I.isArrayLike=so,I.isArrayLikeObject=Mn,I.isBoolean=hne,I.isBuffer=ad,I.isDate=pne,I.isElement=mne,I.isEmpty=gne,I.isEqual=vne,I.isEqualWith=_ne,I.isError=TI,I.isFinite=yne,I.isFunction=ka,I.isInteger=wN,I.isLength=JS,I.isMap=AN,I.isMatch=bne,I.isMatchWith=Sne,I.isNaN=Ene,I.isNative=Cne,I.isNil=wne,I.isNull=Pne,I.isNumber=RN,I.isObject=dn,I.isObjectLike=vn,I.isPlainObject=nv,I.isRegExp=DI,I.isSafeInteger=Ane,I.isSet=MN,I.isString=eE,I.isSymbol=No,I.isTypedArray=Th,I.isUndefined=Rne,I.isWeakMap=Mne,I.isWeakSet=Ine,I.join=Oee,I.kebabCase=_ie,I.last=pr,I.lastIndexOf=Lee,I.lowerCase=yie,I.lowerFirst=bie,I.lt=Tne,I.lte=Dne,I.max=poe,I.maxBy=moe,I.mean=goe,I.meanBy=voe,I.min=_oe,I.minBy=yoe,I.stubArray=FI,I.stubFalse=xI,I.stubObject=ooe,I.stubString=roe,I.stubTrue=soe,I.multiply=boe,I.nth=jee,I.noConflict=Zie,I.noop=kI,I.now=ZS,I.pad=Sie,I.padEnd=Eie,I.padStart=Cie,I.parseInt=Pie,I.random=hie,I.reduce=$te,I.reduceRight=kte,I.repeat=wie,I.replace=Aie,I.result=iie,I.round=Soe,I.runInContext=q,I.sample=xte,I.size=Vte,I.snakeCase=Rie,I.some=zte,I.sortedIndex=Hee,I.sortedIndexBy=Kee,I.sortedIndexOf=Vee,I.sortedLastIndex=zee,I.sortedLastIndexBy=Gee,I.sortedLastIndexOf=Uee,I.startCase=Iie,I.startsWith=Tie,I.subtract=Eoe,I.sum=Coe,I.sumBy=Poe,I.template=Die,I.times=aoe,I.toFinite=Fa,I.toInteger=Ye,I.toLength=TN,I.toLower=Oie,I.toNumber=mr,I.toSafeInteger=One,I.toString=Rt,I.toUpper=Lie,I.trim=jie,I.trimEnd=Nie,I.trimStart=Bie,I.truncate=$ie,I.unescape=kie,I.uniqueId=doe,I.upperCase=Fie,I.upperFirst=jI,I.each=gN,I.eachRight=vN,I.first=fN,$I(I,function(){var c={};return Os(I,function(d,l){Dt.call(I.prototype,l)||(c[l]=d)}),c}(),{chain:!1}),I.VERSION=i,dr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){I[c].placeholder=I}),dr(["drop","take"],function(c,d){st.prototype[c]=function(l){l=l===t?1:Hn(Ye(l),0);var _=this.__filtered__&&!d?new st(this):this.clone();return _.__filtered__?_.__takeCount__=Ei(l,_.__takeCount__):_.__views__.push({size:Ei(l,ae),type:c+(_.__dir__<0?"Right":"")}),_},st.prototype[c+"Right"]=function(l){return this.reverse()[c](l).reverse()}}),dr(["filter","map","takeWhile"],function(c,d){var l=d+1,_=l==Z||l==M;st.prototype[c]=function(C){var O=this.clone();return O.__iteratees__.push({iteratee:Le(C,3),type:l}),O.__filtered__=O.__filtered__||_,O}}),dr(["head","last"],function(c,d){var l="take"+(d?"Right":"");st.prototype[c]=function(){return this[l](1).value()[0]}}),dr(["initial","tail"],function(c,d){var l="drop"+(d?"":"Right");st.prototype[c]=function(){return this.__filtered__?new st(this):this[l](1)}}),st.prototype.compact=function(){return this.filter(co)},st.prototype.find=function(c){return this.filter(c).head()},st.prototype.findLast=function(c){return this.reverse().find(c)},st.prototype.invokeMap=Je(function(c,d){return typeof c=="function"?new st(this):this.map(function(l){return Z1(l,c,d)})}),st.prototype.reject=function(c){return this.filter(XS(Le(c)))},st.prototype.slice=function(c,d){c=Ye(c);var l=this;return l.__filtered__&&(c>0||d<0)?new st(l):(c<0?l=l.takeRight(-c):c&&(l=l.drop(c)),d!==t&&(d=Ye(d),l=d<0?l.dropRight(-d):l.take(d-c)),l)},st.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},st.prototype.toArray=function(){return this.take(ae)},Os(st.prototype,function(c,d){var l=/^(?:filter|find|map|reject)|While$/.test(d),_=/^(?:head|last)$/.test(d),C=I[_?"take"+(d=="last"?"Right":""):d],O=_||/^find/.test(d);C&&(I.prototype[d]=function(){var F=this.__wrapped__,G=_?[1]:arguments,W=F instanceof st,ie=G[0],re=W||Ge(F),ce=function(rt){var ut=C.apply(I,ed([rt],G));return _&&_e?ut[0]:ut};re&&l&&typeof ie=="function"&&ie.length!=1&&(W=re=!1);var _e=this.__chain__,Ae=!!this.__actions__.length,Ne=O&&!_e,qe=W&&!Ae;if(!O&&re){F=qe?F:new st(this);var Be=c.apply(F,G);return Be.__actions__.push({func:qS,args:[ce],thisArg:t}),new lr(Be,_e)}return Ne&&qe?c.apply(this,G):(Be=this.thru(ce),Ne?_?Be.value()[0]:Be.value():Be)})}),dr(["pop","push","shift","sort","splice","unshift"],function(c){var d=bS[c],l=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",_=/^(?:pop|shift)$/.test(c);I.prototype[c]=function(){var C=arguments;if(_&&!this.__chain__){var O=this.value();return d.apply(Ge(O)?O:[],C)}return this[l](function(F){return d.apply(Ge(F)?F:[],C)})}}),Os(st.prototype,function(c,d){var l=I[d];if(l){var _=l.name+"";Dt.call(wh,_)||(wh[_]=[]),wh[_].push({name:d,func:l})}}),wh[HS(t,L).name]=[{name:"wrapper",func:t}],st.prototype.clone=kX,st.prototype.reverse=FX,st.prototype.value=xX,I.prototype.at=mte,I.prototype.chain=gte,I.prototype.commit=vte,I.prototype.next=_te,I.prototype.plant=bte,I.prototype.reverse=Ste,I.prototype.toJSON=I.prototype.valueOf=I.prototype.value=Ete,I.prototype.first=I.prototype.head,V1&&(I.prototype[V1]=yte),I},Eh=vX();Gu?((Gu.exports=Eh)._=Eh,BM._=Eh):si._=Eh}).call(f)})(NP,NP.exports);var ah=NP.exports;Object.defineProperty(Lb,"__esModule",{value:!0});Lb.FeedbackMoveMouseListener=void 0;const QT=z,VEe=ah,zEe=Kr,OE=it,LE=kt,lK=io,fK=Pn;class GEe extends zEe.DragAwareMouseListener{constructor(e){super(),this.tool=e,this.elementId2startPos=new Map,this.tracker=e.createChangeBoundsTracker(),this.moveInitializedFeedback=e.createFeedbackEmitter(),this.moveFeedback=e.createFeedbackEmitter()}mouseDown(e,t){return super.mouseDown(e,t),t.button===0?(this.initializeMove(e,t),[]):(this.tracker.stopTracking(),[])}initializeMove(e,t){if(e instanceof lK.GResizeHandle)return;(0,QT.findParentByFeature)(e,this.isValidMoveable)!==void 0?(this.tracker.startTracking(),this.scheduleMoveInitialized()):this.tracker.stopTracking()}scheduleMoveInitialized(){var e;(e=this.pendingMoveInitialized)===null||e===void 0||e.cancel(),this.pendingMoveInitialized=(0,VEe.debounce)(()=>{this.moveInitialized(),this.pendingMoveInitialized=void 0},750),this.pendingMoveInitialized()}moveInitializationTimeout(){return 750}moveInitialized(){this.isMouseDown&&this.moveInitializedFeedback.add(fK.MoveInitializedEventAction.create(),fK.MoveFinishedEventAction.create()).add((0,OE.cursorFeedbackAction)(OE.CursorCSS.MOVE),(0,OE.cursorFeedbackAction)(OE.CursorCSS.DEFAULT)).submit()}isValidMoveable(e){return!!e&&(0,LE.isNonRoutableSelectedMovableBoundsAware)(e)&&!(e instanceof lK.GResizeHandle)}nonDraggingMouseUp(e,t){return this.moveInitializedFeedback.dispose(),this.tracker.stopTracking(),[]}draggingMouseMove(e,t){return super.draggingMouseMove(e,t),this.tracker.isTracking()?this.moveElements(e,t):[]}moveElements(e,t){var i;this.elementId2startPos.size===0&&this.initializeElementsToMove(e.root);const o=this.getElementsToMove(e),r=this.tracker.moveElements(o,{snap:t,restrict:t});return r.elementMoves.length===0?[]:((i=this.pendingMoveInitialized)===null||i===void 0||i.cancel(),this.moveFeedback.add(this.createMoveAction(r),()=>this.resetElementPositions(e)),this.addMoveFeedback(r,e,t),this.tracker.updateTrackingPosition(r),this.moveFeedback.submit(),[])}createMoveAction(e){return QT.MoveAction.create(e.elementMoves.map(t=>({elementId:t.element.id,toPosition:t.toPosition})),{animate:!1})}addMoveFeedback(e,t,i){this.tool.changeBoundsManager.addMoveFeedback(this.moveFeedback,e,t,i)}initializeElementsToMove(e){this.collectElementsToMove(e).forEach(i=>this.elementId2startPos.set(i.id,i.position))}collectElementsToMove(e){const t=(0,LE.filter)(e.index,this.isValidMoveable),i=(0,LE.removeDescendants)(t);return Array.from(i)}getElementsToMove(e){return(0,LE.getElements)(e.root.index,Array.from(this.elementId2startPos.keys()),this.isValidMoveable)}resetElementPositions(e){const t=this.revertElementMoves(e);return QT.MoveAction.create(t,{animate:!1,finished:!0})}revertElementMoves(e){var t;const i=[];return!((t=e==null?void 0:e.root)===null||t===void 0)&&t.index&&this.getElementsToMove(e).forEach(r=>i.push({elementId:r.id,toPosition:this.elementId2startPos.get(r.id)})),i}draggingMouseUp(e,t){return this.tracker.isTracking()?(this.getElementsToMove(e).filter(i=>this.tool.changeBoundsManager.isValid(i)).forEach(i=>this.elementId2startPos.delete(i.id)),this.dispose(),[]):[]}dispose(){var e;(e=this.pendingMoveInitialized)===null||e===void 0||e.cancel(),this.moveInitializedFeedback.dispose(),this.moveFeedback.dispose(),this.tracker.dispose(),this.elementId2startPos.clear(),super.dispose()}}Lb.FeedbackMoveMouseListener=GEe;var jb=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},FR=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},QO;Object.defineProperty(bu,"__esModule",{value:!0});bu.ChangeBoundsListener=bu.ChangeBoundsTool=void 0;const of=k,Di=z,UEe=Kr,hK=Yt,Wh=kt,YEe=Mo,pK=Ss,mK=io,qEe=_i,WEe=$R,jE=Pn,ZEe=Lb;let Eu=QO=class extends qEe.BaseEditTool{get id(){return QO.ID}enable(){const e=this.createMoveMouseListener();Di.Disposable.is(e)&&this.toDisposeOnDisable.push(e);const t=this.createChangeBoundsListener();Di.Disposable.is(t)&&this.toDisposeOnDisable.push(t),this.toDisposeOnDisable.push(this.mouseTool.registerListener(e),this.mouseTool.registerListener(t),this.selectionService.onSelectionChanged(i=>t.selectionChanged(i.root,i.selectedElements)))}createChangeBoundsTracker(){return this.changeBoundsManager.createTracker()}createMoveMouseListener(){return new ZEe.FeedbackMoveMouseListener(this)}createChangeBoundsListener(){return new P9(this)}};bu.ChangeBoundsTool=Eu;Eu.ID="glsp.change-bounds-tool";jb([(0,of.inject)(hK.SelectionService),FR("design:type",hK.SelectionService)],Eu.prototype,"selectionService",void 0);jb([(0,of.inject)(Di.EdgeRouterRegistry),(0,of.optional)(),FR("design:type",Di.EdgeRouterRegistry)],Eu.prototype,"edgeRouterRegistry",void 0);jb([(0,of.inject)(Di.TYPES.IMovementRestrictor),(0,of.optional)(),FR("design:type",Object)],Eu.prototype,"movementRestrictor",void 0);jb([(0,of.inject)(Di.TYPES.IChangeBoundsManager),FR("design:type",Object)],Eu.prototype,"changeBoundsManager",void 0);bu.ChangeBoundsTool=Eu=QO=jb([(0,of.injectable)()],Eu);class P9 extends UEe.DragAwareMouseListener{constructor(e){super(),this.tool=e,this.tracker=e.createChangeBoundsTracker(),this.handleFeedback=e.createFeedbackEmitter(),this.resizeFeedback=e.createFeedbackEmitter()}mouseDown(e,t){return super.mouseDown(e,t),t.button!==0||e instanceof Di.GModelRoot?[]:(this.updateResizeElement(e,t),[])}updateResizeElement(e,t){var i,o;return this.activeResizeHandle=e instanceof mK.GResizeHandle?e:void 0,this.activeResizeElement=(o=(i=this.activeResizeHandle)===null||i===void 0?void 0:i.parent)!==null&&o!==void 0?o:this.findResizeElement(e),this.activeResizeElement?(t&&this.tracker.startTracking(),this.initialBounds={newSize:this.activeResizeElement.bounds,newPosition:this.activeResizeElement.bounds,elementId:this.activeResizeElement.id},this.tool.createFeedbackEmitter().add(YEe.LocalRequestBoundsAction.create(e.root,[this.activeResizeElement.id])).submit().dispose(),this.handleFeedback.add(jE.ShowChangeBoundsToolResizeFeedbackAction.create({elementId:this.activeResizeElement.id}),jE.HideChangeBoundsToolResizeFeedbackAction.create()),this.handleFeedback.submit(),!0):(this.disposeResize(),!1)}findResizeElement(e){return(0,Di.findParentByFeature)(e,mK.isResizable)}draggingMouseMove(e,t){if(this.activeResizeHandle&&this.tracker.isTracking()){const i=this.tracker.resizeElements(this.activeResizeHandle,{snap:t,symmetric:t,restrict:t}),o=this.resizeBoundsAction(i);o.bounds.length>0&&(this.resizeFeedback.add(o,()=>this.resetBounds()),this.tracker.updateTrackingPosition(i.handleMove.moveVector),this.addResizeFeedback(i,e,t),this.resizeFeedback.submit())}return super.draggingMouseMove(e,t)}resizeBoundsAction(e){const t=e.elementResizes.filter(i=>i.valid.size);return pK.SetBoundsFeedbackAction.create(t.map(i=>this.toElementAndBounds(i)))}toElementAndBounds(e){return{elementId:e.element.id,newSize:e.toBounds,newPosition:e.toBounds}}addResizeFeedback(e,t,i){this.tool.changeBoundsManager.addResizeFeedback(this.resizeFeedback,e,t,i)}resetBounds(){return this.initialBounds?[pK.SetBoundsFeedbackAction.create([this.initialBounds]),jE.MoveFinishedEventAction.create()]:[jE.MoveFinishedEventAction.create()]}draggingMouseUp(e,t){const i=[];return this.activeResizeHandle?i.push(...this.handleResizeOnServer(this.activeResizeHandle)):i.push(...this.handleMoveOnServer(e)),this.disposeResize({keepHandles:!0}),i}nonDraggingMouseUp(e,t){return this.disposeResize({keepHandles:!0}),super.nonDraggingMouseUp(e,t)}handleMoveOnServer(e){const t=[],i=this.getElementsToMove(e);return t.push(...this.handleMoveElementsOnServer(i)),t.push(...this.handleMoveRoutingPointsOnServer(i)),t.length>0?[Di.CompoundOperation.create(t)]:[]}getElementsToMove(e){const t=(0,Wh.getMatchingElements)(e.index,Wh.isNonRoutableSelectedMovableBoundsAware),i=new Set(t);return t.filter(o=>this.isValidMove(o,i))}handleMoveElementsOnServer(e){const t=e.map(Wh.toElementAndBounds);return t.length>0?[Di.ChangeBoundsOperation.create(t)]:[]}isValidMove(e,t=new Set){return this.tool.changeBoundsManager.hasValidPosition(e)&&!this.isChildOfSelected(t,e)}isChildOfSelected(e,t){if(e.size===0)return!1;for(;t instanceof Di.GChildElement;)if(t=t.parent,e.has(t))return!0;return!1}handleMoveRoutingPointsOnServer(e){const t=[],i=this.tool.edgeRouterRegistry;return i&&e.forEach(o=>{o instanceof Di.GConnectableElement&&(o.incomingEdges.map(r=>(0,Wh.calcElementAndRoutingPoints)(r,i)).forEach(r=>t.push(r)),o.outgoingEdges.map(r=>(0,Wh.calcElementAndRoutingPoints)(r,i)).forEach(r=>t.push(r)))}),t.length>0?[Di.ChangeRoutingPointsOperation.create(t)]:[]}handleResizeOnServer(e){if(this.initialBounds&&this.isValidResize(e.parent)){const t=(0,Wh.toElementAndBounds)(e.parent);if(!this.initialBounds.newPosition||!t.newPosition)return[];if(!Di.Point.equals(this.initialBounds.newPosition,t.newPosition)||!Di.Dimension.equals(this.initialBounds.newSize,t.newSize))return this.initialBounds=void 0,[Di.ChangeBoundsOperation.create([t])]}return[]}isValidResize(e){return this.tool.changeBoundsManager.isValid(e)}selectionChanged(e,t){if(!(this.activeResizeElement&&t.includes(this.activeResizeElement.id))){for(const i of t.reverse()){const o=e.index.getById(i);if(o&&this.updateResizeElement(o))return}this.dispose()}}isActiveResizeElement(e){return e!==void 0&&this.activeResizeElement!==void 0&&e.id===this.activeResizeElement.id}disposeResize(e={keepHandles:!1}){e.keepHandles||this.handleFeedback.dispose(),this.resizeFeedback.dispose(),this.tracker.dispose(),this.activeResizeElement=void 0,this.activeResizeHandle=void 0,this.initialBounds=void 0}dispose(){this.disposeResize(),super.dispose()}}bu.ChangeBoundsListener=P9;P9.CSS_CLASS_ACTIVE=WEe.CSS_ACTIVE_HANDLE;var Pc={},QEe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Pc,"__esModule",{value:!0});Pc.SResizeHandleView=Pc.GResizeHandleView=void 0;const NE=z,XEe=k,JEe=io;let BP=class{render(e,t){if(t.targetKind==="hidden")return;const i=this.getPosition(e);if(i!==void 0){const o=(0,NE.svg)("circle",{"class-sprotty-resize-handle":!0,"class-mouseover":e.hoverFeedback,cx:i.x,cy:i.y,r:this.getRadius()});return(0,NE.setAttr)(o,"data-kind",e.location),o}return(0,NE.svg)("g",null)}getPosition(e){return NE.Point.subtract(JEe.GResizeHandle.getHandlePosition(e),e.parent.bounds)}getRadius(){return 7}};Pc.GResizeHandleView=BP;Pc.SResizeHandleView=BP;Pc.SResizeHandleView=Pc.GResizeHandleView=BP=QEe([(0,XEe.injectable)()],BP);Object.defineProperty(Tb,"__esModule",{value:!0});Tb.changeBoundsToolModule=void 0;const ld=z,e3e=io,t3e=$R,n3e=bu,gK=Pn,i3e=Pc;Tb.changeBoundsToolModule=new ld.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,ld.bindAsService)(o,ld.TYPES.IChangeBoundsManager,t3e.ChangeBoundsManager),(0,ld.bindAsService)(o,ld.TYPES.IDefaultTool,n3e.ChangeBoundsTool),(0,ld.configureCommand)(o,gK.ShowChangeBoundsToolResizeFeedbackCommand),(0,ld.configureCommand)(o,gK.HideChangeBoundsToolResizeFeedbackCommand),(0,ld.configureView)(o,e3e.GResizeHandle.TYPE,i3e.GResizeHandleView)},{featureId:Symbol("changeBoundsTool")});var Nb={};Object.defineProperty(Nb,"__esModule",{value:!0});Nb.deletionToolModule=void 0;const Pv=z,vK=mi;Nb.deletionToolModule=new Pv.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,Pv.bindAsService)(o,Pv.TYPES.IDefaultTool,vK.DelKeyDeleteTool),(0,Pv.bindAsService)(o,Pv.TYPES.ITool,vK.MouseDeleteTool)},{featureId:Symbol("deletionTool")});var Bb={};Object.defineProperty(Bb,"__esModule",{value:!0});Bb.edgeCreationToolModule=void 0;const wv=z,o3e=Uc,_K=yc;Bb.edgeCreationToolModule=new wv.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,wv.bindAsService)(o,wv.TYPES.ITool,_K.EdgeCreationTool),(0,wv.configureActionHandler)(o,wv.TriggerEdgeCreationAction.KIND,_K.EdgeCreationTool),(0,o3e.configureDanglingFeedbackEdge)(o)},{featureId:Symbol("edgeCreationTool")});var $b={},Cu={},mt={},xR=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},HR=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},KR=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(mt,"__esModule",{value:!0});mt.drawFeedbackEdgeSource=mt.FeedbackEdgeRouteMovingMouseListener=mt.FeedbackEdgeSourceMovingMouseListener=mt.FeedbackEdgeTargetMovingMouseListener=mt.DrawFeedbackEdgeSourceCommand=mt.DrawFeedbackEdgeSourceAction=mt.SwitchRoutingModeCommand=mt.SwitchRoutingModeAction=mt.HideEdgeReconnectHandlesFeedbackCommand=mt.ShowEdgeReconnectHandlesFeedbackCommand=mt.HideEdgeReconnectHandlesFeedbackAction=mt.ShowEdgeReconnectHandlesFeedbackAction=void 0;const pt=z,Pu=k,r3e=Kr,w9=Gn,Xs=kt,yK=Ct,XO=hb,bK=kR,h_=Uc,s3e=e1;var JO;(function(n){n.KIND="showReconnectHandlesFeedback";function e(i){return pt.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,elementId:i}}n.create=t})(JO||(mt.ShowEdgeReconnectHandlesFeedbackAction=JO={}));var e5;(function(n){n.KIND="hideReconnectHandlesFeedback";function e(i){return pt.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(e5||(mt.HideEdgeReconnectHandlesFeedbackAction=e5={}));let $P=class extends w9.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){const t=e.root.index;(0,Xs.forEachElement)(t,Xs.isRoutable,XO.removeReconnectHandles);const i=t.getById(this.action.elementId);return i&&(0,Xs.isRoutable)(i)&&(0,XO.addReconnectHandles)(i),e.root}};mt.ShowEdgeReconnectHandlesFeedbackCommand=$P;$P.KIND=JO.KIND;mt.ShowEdgeReconnectHandlesFeedbackCommand=$P=xR([(0,Pu.injectable)(),KR(0,(0,Pu.inject)(pt.TYPES.Action)),HR("design:paramtypes",[Object])],$P);let kP=class extends w9.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){const t=e.root.index;return(0,Xs.forEachElement)(t,Xs.isRoutable,XO.removeReconnectHandles),e.root}};mt.HideEdgeReconnectHandlesFeedbackCommand=kP;kP.KIND=e5.KIND;mt.HideEdgeReconnectHandlesFeedbackCommand=kP=xR([(0,Pu.injectable)(),KR(0,(0,Pu.inject)(pt.TYPES.Action)),HR("design:paramtypes",[Object])],kP);var FP;(function(n){n.KIND="switchRoutingMode";function e(t){return{...pt.SwitchEditModeAction.create(t),kind:n.KIND}}n.create=e})(FP||(mt.SwitchRoutingModeAction=FP={}));let xP=class extends pt.SwitchEditModeCommand{constructor(e){super({...e,kind:pt.SwitchEditModeAction.KIND})}};mt.SwitchRoutingModeCommand=xP;xP.KIND=FP.KIND;mt.SwitchRoutingModeCommand=xP=xR([(0,Pu.injectable)(),KR(0,(0,Pu.inject)(pt.TYPES.Action)),HR("design:paramtypes",[Object])],xP);var t5;(function(n){n.KIND="drawFeedbackEdgeSource";function e(i){return pt.Action.hasKind(i,n.KIND)&&(0,pt.hasStringProp)(i,"elementTypeId")&&(0,pt.hasStringProp)(i,"targetId")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(t5||(mt.DrawFeedbackEdgeSourceAction=t5={}));let HP=class extends w9.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){return qq(e,this.action.targetId,this.action.elementTypeId),e.root}};mt.DrawFeedbackEdgeSourceCommand=HP;HP.KIND=t5.KIND;mt.DrawFeedbackEdgeSourceCommand=HP=xR([(0,Pu.injectable)(),KR(0,(0,Pu.inject)(pt.TYPES.Action)),HR("design:paramtypes",[Object])],HP);class a3e extends s3e.FeedbackEdgeEndMovingMouseListener{constructor(e,t){super(e,t)}}mt.FeedbackEdgeTargetMovingMouseListener=a3e;class c3e extends pt.MouseListener{constructor(e,t){super(),this.anchorRegistry=e,this.feedbackDispatcher=t,this.feedback=t.createEmitter()}mouseMove(e,t){const i=e.root,o=i.index.getById((0,h_.feedbackEdgeEndId)(i));if(!(o instanceof h_.FeedbackEdgeEnd)||!o.feedbackEdge)return[];const r=o.feedbackEdge,s=(0,yK.getAbsolutePosition)(o,t),a=(0,pt.findChildrenAtPosition)(e.root,s).find(u=>(0,pt.isConnectable)(u)&&u.canConnect(r,"source"));if(a instanceof pt.GConnectableElement&&r.target&&(0,pt.isBoundsAware)(r.target)){const u=this.computeAbsoluteAnchor(a,pt.Bounds.center(r.target.bounds));pt.Point.euclideanDistance(u,o.position)>1&&this.feedback.add(pt.MoveAction.create([{elementId:o.id,toPosition:u}],{animate:!1})).submit()}else this.feedback.add(pt.MoveAction.create([{elementId:o.id,toPosition:s}],{animate:!1})).submit();return[]}computeAbsoluteAnchor(e,t,i){let r=this.anchorRegistry.get(pt.PolylineEdgeRouter.KIND,e.anchorKind).getAnchor(e,t,i);if(e.parent!==e.root){const s=(0,pt.findParentByFeature)(e.parent,pt.isBoundsAware);if(s){const a=(0,yK.toAbsoluteBounds)(s);r=pt.Point.add(a,r)}}return r}dispose(){this.feedback.dispose()}}mt.FeedbackEdgeSourceMovingMouseListener=c3e;class d3e extends r3e.DragAwareMouseListener{constructor(e,t){super(),this.changeBoundsManager=e,this.edgeRouterRegistry=t,this.tracker=this.changeBoundsManager.createTracker()}mouseDown(e,t){const i=super.mouseDown(e,t);return t.button===0&&((0,pt.findParentByFeature)(e,Xs.isRoutingHandle)!==void 0?(i.push(FP.create({elementsToActivate:[e.id]})),this.tracker.startTracking()):this.tracker.dispose()),i}draggingMouseMove(e,t){return super.draggingMouseMove(e,t),this.tracker.isTracking()?this.moveRoutingHandles(e,t):[]}moveRoutingHandles(e,t){const i=this.getRoutingHandlesToMove(e),o=this.tracker.moveElements(i,{snap:t,restrict:t});return o.elementMoves.length===0?[]:(this.tracker.updateTrackingPosition(o),[pt.MoveAction.create(o.elementMoves.map(r=>({elementId:r.element.id,toPosition:r.toPosition})),{animate:!1})])}getRoutingHandlesToMove(e){return(0,Xs.getMatchingElements)(e.root.index,(0,pt.typeGuard)(Xs.isRoutingHandle,pt.isSelected)).map(i=>{const o=this.getHandlePosition(i);return o?new bK.MoveableRoutingHandle(i,o):void 0}).filter((0,pt.toTypeGuard)(bK.MoveableRoutingHandle))}getHandlePosition(e){if(this.edgeRouterRegistry){const t=e.parent;if(!(0,Xs.isRoutable)(t))return;const i=this.edgeRouterRegistry.get(t.routerKind),o=i.route(t);return i.getHandlePosition(t,o,e)}}nonDraggingMouseUp(e,t){return this.tracker.stopTracking(),[]}draggingMouseUp(e,t){return this.tracker.isTracking()?(this.dispose(),[]):[]}dispose(){this.tracker.dispose(),super.dispose()}}mt.FeedbackEdgeRouteMovingMouseListener=d3e;function qq(n,e,t){const i=n.root,o=i.index.getById(e);if(!o)return;const r=(0,pt.findParentByFeature)(o,pt.isConnectable);if(!r||!(0,pt.isBoundsAware)(r))return;const s=new h_.FeedbackEdgeEnd(r.id,t);s.id=(0,h_.feedbackEdgeEndId)(i),s.position={x:r.bounds.x,y:r.bounds.y};const a={type:"edge",id:(0,h_.feedbackEdgeId)(i),sourceId:s.id,targetId:r.id,opacity:.3},u=n.modelFactory.createElement(a);(0,Xs.isRoutable)(u)&&(s.feedbackEdge=u,i.add(s),i.add(u))}mt.drawFeedbackEdgeSource=qq;var kb=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},VR=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},n5;Object.defineProperty(Cu,"__esModule",{value:!0});Cu.EdgeEditListener=Cu.EdgeEditTool=void 0;const Ti=z,vm=k,u3e=Kr,br=it,SK=Yt,Av=kt,BE=hb,l3e=_i,$E=Uc,Td=mt;let wu=n5=class extends l3e.BaseEditTool{get id(){return n5.ID}enable(){this.edgeEditListener=new Wq(this),this.feedbackEdgeSourceMovingListener=new Td.FeedbackEdgeSourceMovingMouseListener(this.anchorRegistry,this.feedbackDispatcher),this.feedbackEdgeTargetMovingListener=new Td.FeedbackEdgeTargetMovingMouseListener(this.anchorRegistry,this.feedbackDispatcher),this.feedbackMovingListener=new Td.FeedbackEdgeRouteMovingMouseListener(this.changeBoundsManager,this.edgeRouterRegistry),this.toDisposeOnDisable.push(this.edgeEditListener,this.mouseTool.registerListener(this.edgeEditListener),this.feedbackEdgeSourceMovingListener,this.feedbackEdgeTargetMovingListener,this.feedbackMovingListener,this.selectionService.onSelectionChanged(e=>this.edgeEditListener.selectionChanged(e.root,e.selectedElements)))}registerFeedbackListeners(){this.mouseTool.register(this.feedbackMovingListener),this.mouseTool.register(this.feedbackEdgeSourceMovingListener),this.mouseTool.register(this.feedbackEdgeTargetMovingListener)}deregisterFeedbackListeners(){this.feedbackEdgeSourceMovingListener.dispose(),this.feedbackEdgeTargetMovingListener.dispose(),this.mouseTool.deregister(this.feedbackEdgeSourceMovingListener),this.mouseTool.deregister(this.feedbackEdgeTargetMovingListener),this.mouseTool.deregister(this.feedbackMovingListener)}};Cu.EdgeEditTool=wu;wu.ID="glsp.edge-edit-tool";kb([(0,vm.inject)(SK.SelectionService),VR("design:type",SK.SelectionService)],wu.prototype,"selectionService",void 0);kb([(0,vm.inject)(Ti.AnchorComputerRegistry),VR("design:type",Ti.AnchorComputerRegistry)],wu.prototype,"anchorRegistry",void 0);kb([(0,vm.inject)(Ti.EdgeRouterRegistry),(0,vm.optional)(),VR("design:type",Ti.EdgeRouterRegistry)],wu.prototype,"edgeRouterRegistry",void 0);kb([(0,vm.inject)(Ti.TYPES.IChangeBoundsManager),VR("design:type",Object)],wu.prototype,"changeBoundsManager",void 0);Cu.EdgeEditTool=wu=n5=kb([(0,vm.injectable)()],wu);class Wq extends u3e.DragAwareMouseListener{constructor(e){super(),this.tool=e,this.cursorFeedback=this.tool.createFeedbackEmitter(),this.editFeedback=this.tool.createFeedbackEmitter()}isValidEdge(e){return e!==void 0&&e.id!==(0,$E.feedbackEdgeId)(e.root)&&(0,Ti.isSelected)(e)}setEdgeSelected(e){this.edge=e,(0,Ti.canEditRouting)(e)&&this.editFeedback.add(Td.SwitchRoutingModeAction.create({elementsToActivate:[this.edge.id]}),Td.SwitchRoutingModeAction.create({elementsToDeactivate:[this.edge.id]})),(0,BE.isReconnectable)(e)&&this.editFeedback.add(Td.ShowEdgeReconnectHandlesFeedbackAction.create(this.edge.id),Td.HideEdgeReconnectHandlesFeedbackAction.create()),this.editFeedback.submit()}isEdgeSelected(){return this.edge!==void 0&&(0,Ti.isSelected)(this.edge)}setReconnectHandleSelected(e,t){this.edge&&this.edge.target&&this.edge.source&&(this.editFeedback.dispose(),(0,BE.isSourceRoutingHandle)(e,t)?(this.editFeedback.add((0,br.cursorFeedbackAction)(br.CursorCSS.EDGE_RECONNECT),(0,br.cursorFeedbackAction)()).add(Td.DrawFeedbackEdgeSourceAction.create({elementTypeId:this.edge.type,targetId:this.edge.targetId}),$E.RemoveFeedbackEdgeAction.create()).submit(),this.reconnectMode="NEW_SOURCE"):(0,BE.isTargetRoutingHandle)(e,t)&&(this.editFeedback.add((0,br.cursorFeedbackAction)(br.CursorCSS.EDGE_CREATION_TARGET),(0,br.cursorFeedbackAction)()).add($E.DrawFeedbackEdgeAction.create({elementTypeId:this.edge.type,sourceId:this.edge.sourceId}),$E.RemoveFeedbackEdgeAction.create()).submit(),this.reconnectMode="NEW_TARGET"))}isReconnecting(){return this.reconnectMode!==void 0}isReconnectingNewSource(){return this.reconnectMode==="NEW_SOURCE"}setRoutingHandleSelected(e,t){this.edge&&this.edge.target&&this.edge.source&&(this.routingHandle=t)}requiresReconnect(e,t){return this.edge!==void 0&&(this.edge.sourceId!==e||this.edge.targetId!==t)}setNewConnectable(e){this.newConnectable=e}isReadyToReconnect(){return this.edge&&this.isReconnecting()&&this.newConnectable!==void 0}isReadyToReroute(){return this.routingHandle!==void 0}mouseDown(e,t){const i=super.mouseDown(e,t);if(t.button===0){const o=(0,Ti.findParentByFeature)(e,BE.isReconnectHandle),r=o?void 0:(0,Ti.findParentByFeature)(e,Av.isRoutingHandle),s=(0,Ti.findParentByFeature)(e,Av.isRoutable);this.isEdgeSelected()&&s&&o?this.setReconnectHandleSelected(s,o):this.isEdgeSelected()&&s&&r?this.setRoutingHandleSelected(s,r):this.isValidEdge(s)&&(this.dispose(),this.tool.registerFeedbackListeners(),this.setEdgeSelected(s))}else t.button===2&&this.dispose();return i}draggingMouseMove(e,t){return this.setNewConnectable(void 0),super.draggingMouseMove(e,t)}mouseUp(e,t){const i=super.mouseUp(e,t);if(!this.isReadyToReconnect()&&!this.isReadyToReroute())return i;if(this.edge&&this.newConnectable){const o=this.isReconnectingNewSource()?this.newConnectable.id:this.edge.sourceId,r=this.isReconnectingNewSource()?this.edge.targetId:this.newConnectable.id;this.requiresReconnect(o,r)&&i.push(Ti.ReconnectEdgeOperation.create({edgeElementId:this.edge.id,sourceElementId:o,targetElementId:r})),this.dispose()}else if(this.edge&&this.routingHandle){const o=e.index.getById(this.edge.id);if(o&&(0,Av.isRoutable)(o)){const r=(0,Av.calcElementAndRoutingPoints)(o,this.tool.edgeRouterRegistry);i.push(Ti.ChangeRoutingPointsOperation.create([r])),this.routingHandle=void 0}}return i}mouseOver(e,t){if(this.edge&&this.isReconnecting()){const i=(0,Ti.findParentByFeature)(e,Ti.isConnectable);if(!this.newConnectable||i!==this.newConnectable){if(this.setNewConnectable(i),i&&(this.reconnectMode==="NEW_SOURCE"&&i.canConnect(this.edge,"source")||this.reconnectMode==="NEW_TARGET"&&i.canConnect(this.edge,"target")))return this.cursorFeedback.add((0,br.cursorFeedbackAction)(br.CursorCSS.EDGE_RECONNECT),(0,br.cursorFeedbackAction)()).submit(),[];this.cursorFeedback.add((0,br.cursorFeedbackAction)(br.CursorCSS.OPERATION_NOT_ALLOWED),(0,br.cursorFeedbackAction)()).submit()}}return[]}selectionChanged(e,t){if(this.edge){if(t.indexOf(this.edge.id)>-1||this.isReconnecting())return;for(const i of t.reverse()){const o=e.index.getById(i);if(o){const r=(0,Ti.findParentByFeature)(o,Av.isRoutable);if(this.isValidEdge(r)){this.setEdgeSelected(r);return}}}this.dispose()}}dispose(){this.edge=void 0,this.reconnectMode=void 0,this.newConnectable=void 0,this.routingHandle=void 0,this.cursorFeedback.dispose(),this.editFeedback.dispose(),this.tool.deregisterFeedbackListeners(),super.dispose()}}Cu.EdgeEditListener=Wq;Object.defineProperty($b,"__esModule",{value:!0});$b.edgeEditToolModule=void 0;const sl=z,f3e=Uc,h3e=Cu,kE=mt;$b.edgeEditToolModule=new sl.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,sl.bindAsService)(o,sl.TYPES.IDefaultTool,h3e.EdgeEditTool),(0,sl.configureCommand)(o,kE.ShowEdgeReconnectHandlesFeedbackCommand),(0,sl.configureCommand)(o,kE.HideEdgeReconnectHandlesFeedbackCommand),(0,sl.configureCommand)(o,kE.DrawFeedbackEdgeSourceCommand),(0,sl.configureCommand)(o,kE.SwitchRoutingModeCommand),(0,f3e.configureDanglingFeedbackEdge)(o)},{featureId:Symbol("edgeEditTool")});var Fb={},wc={},A9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Zq=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},i5;Object.defineProperty(wc,"__esModule",{value:!0});wc.MarqueeKeyListener=wc.MarqueeTool=void 0;const p3e=z,R9=k,o5=Yt,m3e=It,g3e=_i,v3e=eo;let Py=i5=class extends g3e.BaseEditTool{get id(){return i5.ID}enable(){this.marqueeKeyListener||(this.marqueeKeyListener=new KP(this.selectionService)),this.toDisposeOnDisable.push(this.keyTool.registerListener(this.marqueeKeyListener))}};wc.MarqueeTool=Py;Py.ID="glsp.marquee-tool";A9([(0,R9.inject)(o5.SelectionService),Zq("design:type",o5.SelectionService)],Py.prototype,"selectionService",void 0);wc.MarqueeTool=Py=i5=A9([(0,R9.injectable)()],Py);let KP=class extends p3e.KeyListener{constructor(e){super(),this.selectionService=e}keyDown(e,t){return t.shiftKey&&!this.selectionService.hasSelectedElements()?[m3e.EnableToolsAction.create([v3e.MarqueeMouseTool.ID])]:[]}};wc.MarqueeKeyListener=KP;wc.MarqueeKeyListener=KP=A9([(0,R9.injectable)(),Zq("design:paramtypes",[o5.SelectionService])],KP);var xb={};Object.defineProperty(xb,"__esModule",{value:!0});xb.MarqueeNode=void 0;const Qq=z;class Xq extends Qq.RectangularNode{}xb.MarqueeNode=Xq;Xq.DEFAULT_FEATURES=[Qq.boundsFeature];var l1={},_3e=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(l1,"__esModule",{value:!0});l1.MarqueeView=void 0;const XT=z,y3e=k;let r5=class extends XT.RectangularNodeView{render(e,t){return(0,XT.svg)("g",null,(0,XT.svg)("rect",{"class-sprotty-node":!0,"class-marquee":!0,x:e.startPoint.x-e.endPoint.x<=0?e.startPoint.x:e.endPoint.x,y:e.startPoint.y-e.endPoint.y<=0?e.startPoint.y:e.endPoint.y,rx:0,ry:0,width:Math.abs(e.startPoint.x-e.endPoint.x),height:Math.abs(e.startPoint.y-e.endPoint.y)}))}};l1.MarqueeView=r5;l1.MarqueeView=r5=_3e([(0,y3e.injectable)()],r5);Object.defineProperty(Fb,"__esModule",{value:!0});Fb.marqueeSelectionToolModule=void 0;const fd=z,b3e=eo,S3e=wc,JT=Ib,E3e=xb,C3e=l1,P3e=rh;Fb.marqueeSelectionToolModule=new fd.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};o.bind(P3e.MarqueeUtil).toSelf().inSingletonScope(),(0,fd.bindAsService)(o,fd.TYPES.IDefaultTool,S3e.MarqueeTool),(0,fd.bindAsService)(o,fd.TYPES.ITool,b3e.MarqueeMouseTool),(0,fd.configureCommand)(o,JT.DrawMarqueeCommand),(0,fd.configureCommand)(o,JT.RemoveMarqueeCommand),(0,fd.configureModelElement)(o,JT.MARQUEE,E3e.MarqueeNode,C3e.MarqueeView)},{featureId:Symbol("marqueeSelectionTool")});var Hb={},zR={};(function(n){var e=f&&f.__decorate||function(u,h,g,y){var S=arguments.length,w=S<3?h:y===null?y=Object.getOwnPropertyDescriptor(h,g):y,P;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(u,h,g,y);else for(var E=u.length-1;E>=0;E--)(P=u[E])&&(w=(S<3?P(w):S>3?P(h,g,w):P(h,g))||w);return S>3&&w&&Object.defineProperty(h,g,w),w},t=f&&f.__metadata||function(u,h){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(u,h)};Object.defineProperty(n,"__esModule",{value:!0}),n.ContainerManager=n.DEFAULT_INSERT_OPTIONS=void 0;const i=z,o=k,r=it,s=Zg;n.DEFAULT_INSERT_OPTIONS={validateLocationInContainer:!1};let a=class{insert(h,g,y,S){var w;const P={...n.DEFAULT_INSERT_OPTIONS,...S},E=this.findContainer(g,h,S==null?void 0:S.evt);let A=this.isCreationAllowed(E,y,S);return A&&(!E||P.validateLocationInContainer)&&(A=(w=S==null?void 0:S.validLocationOverwrite)!==null&&w!==void 0?w:this.changeBoundsManager.hasValidPosition(h,g)),{elementTypeId:y,container:E,location:g,valid:A,options:P}}isCreationAllowed(h,g,y){return!h||h.isContainableElement(g)}findContainer(h,g,y){return(0,i.findChildrenAtPosition)(g.root,h).reverse().find(S=>{var w;return(0,s.isContainable)(S)&&!(!((w=S.cssClasses)===null||w===void 0)&&w.includes(r.CSS_GHOST_ELEMENT))})}addInsertFeedback(h,g,y,S){return g.valid?h.add((0,r.cursorFeedbackAction)(r.CursorCSS.NODE_CREATION),(0,r.cursorFeedbackAction)()):h.add((0,r.cursorFeedbackAction)(r.CursorCSS.OPERATION_NOT_ALLOWED),(0,r.cursorFeedbackAction)(r.CursorCSS.DEFAULT)),h}};n.ContainerManager=a,e([(0,o.inject)(i.TYPES.IChangeBoundsManager),t("design:type",Object)],a.prototype,"changeBoundsManager",void 0),n.ContainerManager=a=e([(0,o.injectable)()],a)})(zR);var oa={},Kb={};Object.defineProperty(Kb,"__esModule",{value:!0});Kb.MouseTrackingElementPositionListener=void 0;const Zh=z,w3e=Kr,EK=it,A3e=Ct,R3e=Pn;class M3e extends w3e.DragAwareMouseListener{constructor(e,t,i="top-left",o){super(),this.elementId=e,this.tool=t,this.cursorPosition=i,this.editorContext=o,this.toDispose=new Zh.DisposableCollection,this.tracker=this.tool.changeBoundsManager.createTracker(),this.moveGhostFeedback=this.tool.createFeedbackEmitter(),this.toDispose.push(this.moveGhostFeedback);const r=o==null?void 0:o.onModelRootChanged(s=>this.modelRootChanged(s));r&&this.toDispose.push(r)}getTrackedElement(e,t){const i=e.root.index.getById(this.elementId);return!i||!(0,Zh.isMoveable)(i)?void 0:i}mouseMove(e,t){super.mouseMove(e,t);const i=this.getTrackedElement(e,t);if(!i)return[];const o=!this.tracker.isTracking();o&&this.initialize(i,e,t);const r=this.tracker.moveElements([i],{snap:t,restrict:t,skipStatic:!o}),s=r.elementMoves[0];return s?(this.moveGhostFeedback.add(Zh.MoveAction.create([{elementId:this.elementId,toPosition:s.toPosition}],{animate:!1}),R3e.MoveFinishedEventAction.create()),this.addMoveFeedback(r,e,t),this.moveGhostFeedback.submit(),this.tracker.updateTrackingPosition(s.moveVector),[]):[]}initialize(e,t,i){this.tracker.startTracking(),e.position=this.initializeElementPosition(e,t,i)}initializeElementPosition(e,t,i){const o=(0,A3e.getAbsolutePosition)(t,i);return this.cursorPosition==="middle"&&(0,Zh.isBoundsAware)(e)?Zh.Point.subtract(o,Zh.Dimension.center(e.bounds)):o}addMoveFeedback(e,t,i){this.moveGhostFeedback.add(EK.ModifyCSSFeedbackAction.create({elements:[this.elementId],remove:[EK.CSS_HIDDEN]})),this.tool.changeBoundsManager.addMoveFeedback(this.moveGhostFeedback,e,t,i)}modelRootChanged(e){this.tracker.stopTracking()}dispose(){this.toDispose.dispose(),super.dispose()}}Kb.MouseTrackingElementPositionListener=M3e;var GR=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},M9=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},s5;Object.defineProperty(oa,"__esModule",{value:!0});oa.NodeCreationToolMouseListener=oa.NodeInsertTrackingListener=oa.NodeCreationTool=void 0;const Vo=z,UR=k,I3e=Kr,p_=it,T3e=It,b3=yo,D3e=Kb,O3e=_c,L3e=_i,j3e=u1;let rf=s5=class extends L3e.BaseCreationTool{constructor(){super(...arguments),this.isTriggerAction=Vo.TriggerNodeCreationAction.is}get id(){return s5.ID}doEnable(){var e;const t=(e=this.triggerAction.ghostElement)!==null&&e!==void 0?e:{template:this.modelFactory.createSchema(this.createInsertIndicator())};this.toDisposeOnDisable.push(this.createGhostElementTracker(t,"middle")),this.toDisposeOnDisable.push(this.createNodeCreationListener(t)),this.toDisposeOnDisable.push(this.createNodeCreationCursorFeedback().submit())}createInsertIndicator(){return new j3e.InsertIndicator}createGhostElementTracker(e,t){const i=new Jq((0,b3.getTemplateElementId)(e.template),this.triggerAction.elementTypeId,this,t,this.editorContext);return new Vo.DisposableCollection(i,this.mouseTool.registerListener(i))}createNodeCreationListener(e){const t=new eW(this.triggerAction,this,e);return new Vo.DisposableCollection(t,this.mouseTool.registerListener(t))}createNodeCreationCursorFeedback(){return this.createFeedbackEmitter().add((0,p_.cursorFeedbackAction)(p_.CursorCSS.NODE_CREATION),(0,p_.cursorFeedbackAction)())}};oa.NodeCreationTool=rf;rf.ID="tool_create_node";GR([(0,UR.inject)(Vo.TYPES.IChangeBoundsManager),M9("design:type",Object)],rf.prototype,"changeBoundsManager",void 0);GR([(0,UR.inject)(Vo.TYPES.IContainerManager),M9("design:type",Object)],rf.prototype,"containerManager",void 0);GR([(0,UR.inject)(Vo.TYPES.IModelFactory),M9("design:type",Object)],rf.prototype,"modelFactory",void 0);oa.NodeCreationTool=rf=s5=GR([(0,UR.injectable)()],rf);class Jq extends D3e.MouseTrackingElementPositionListener{constructor(e,t,i,o="top-left",r){super(e,i,o,r),this.elementTypeId=t,this.tool=i}addMoveFeedback(e,t,i){super.addMoveFeedback(e,t,i);const o=e.elementMoves[0].element,r=e.elementMoves[0].toPosition,s=this.tool.containerManager.insert(o,r,this.elementTypeId,{evt:i});this.tool.containerManager.addInsertFeedback(this.moveGhostFeedback,s,t,i)}}oa.NodeInsertTrackingListener=Jq;class eW extends I3e.DragAwareMouseListener{constructor(e,t,i){super(),this.triggerAction=e,this.tool=t,this.ghostElement=i,this.cursorFeedback=t.createFeedbackEmitter(),this.ghostElementFeedback=t.createFeedbackEmitter(),this.ghostElementId=(0,b3.getTemplateElementId)(i.template),this.createGhostElement(i)}get elementTypeId(){return this.triggerAction.elementTypeId}nonDraggingMouseUp(e,t){const i=[],o=this.getTrackedInsert(e,t);return o.valid&&i.push(this.getCreateOperation(e,t,o)),this.isContinuousMode(e,t)?(this.disposeAllButGhostElement(),i):(o.valid?this.ghostElementFeedback.discard():this.dispose(),i.push(T3e.EnableDefaultToolsAction.create()),i)}isContinuousMode(e,t){return(0,Vo.isCtrlOrCmd)(t)}getCreateOperation(e,t,i){var o;return Vo.CreateNodeOperation.create(this.elementTypeId,{location:i.location,containerId:(o=i.container)===null||o===void 0?void 0:o.id,args:this.getCreateNodeOperationArgs(i,e,t)})}getCreateNodeOperationArgs(e,t,i){let o={...this.triggerAction.args};const r=this.getGhostElement(t,i);if(r){const s=(0,Vo.isBoundsAware)(r)?Vo.Bounds.dimension(r.bounds):Vo.Dimension.ZERO;o={...o,"ghost-x":r.position.x,"ghost-y":r.position.y,"ghost-width":s.width,"ghost-height":s.height}}return o}createGhostElement(e){const t=[e.template];return this.ghostElementFeedback.add(b3.AddTemplateElementsAction.create({templates:t,addClasses:[p_.CSS_HIDDEN,p_.CSS_GHOST_ELEMENT]}),O3e.RemoveTemplateElementsAction.create({templates:t})),this.ghostElementFeedback.submit(),(0,b3.getTemplateElementId)(e.template)}getGhostElement(e,t){const i=e.index.getById(this.ghostElementId);return i&&(0,Vo.isMoveable)(i)?i:void 0}getTrackedInsert(e,t){const i=this.getGhostElement(e,t);return i?this.tool.containerManager.insert(i,i.position,this.elementTypeId,{evt:t}):{elementTypeId:this.elementTypeId,location:Vo.Point.ORIGIN,valid:!1,options:{evt:t}}}disposeAllButGhostElement(){super.dispose()}dispose(){this.ghostElementFeedback.dispose(),this.disposeAllButGhostElement()}}oa.NodeCreationToolMouseListener=eW;var f1={},ls={};Object.defineProperty(ls,"__esModule",{value:!0});ls.CornerRadius=ls.EdgePadding=ls.GArgument=void 0;const Rv=Cg;var wy;(function(n){function e(A){return typeof A=="number"?A:void 0}n.asNumber=e;function t(A){return A.map(e)}n.asNumbers=t;function i(A){return typeof A=="string"?A:void 0}n.asString=i;function o(A){return A.map(i)}n.asStrings=o;function r(A){return typeof A=="boolean"?A:void 0}n.asBoolean=r;function s(A){return A.map(r)}n.asBooleans=s;function a(A,L){return(0,Rv.hasArgs)(A)?A.args[L]:void 0}n.getArgument=a;function u(A,L){return(0,Rv.hasArgs)(A)?e(A.args[L]):void 0}n.getNumber=u;function h(A,L){return(0,Rv.hasArgs)(A)?i(A.args[L]):void 0}n.getString=h;function g(A,L){return(0,Rv.hasArgs)(A)?r(A.args[L]):void 0}n.getBoolean=g;function y(A,...L){if(!(0,Rv.hasArgs)(A))return;const B=[];for(const U of L){const p=A.args[U];p&&B.push(p)}return B}n.getArguments=y;function S(A,...L){const B=y(A,...L);return B?t(B):void 0}n.getNumbers=S;function w(A,...L){const B=y(A,...L);return B?o(B):void 0}n.getStrings=w;function P(A,...L){const B=y(A,...L);return B?s(B):void 0}n.getBooleans=P;function E(A,L){return A.length===L&&A.filter(B=>B===void 0).length===0}n.hasNValues=E})(wy||(ls.GArgument=wy={}));var CK;(function(n){const e="edgePadding";function t(i){return wy.getNumber(i,e)}n.from=t})(CK||(ls.EdgePadding=CK={}));class pa{constructor(e=0,t=e,i=e,o=t){this.topLeft=e,this.topRight=t,this.bottomRight=i,this.bottomLeft=o}static from(e){const t=wy.getNumbers(e,this.KEY_RADIUS_TOP_LEFT,this.KEY_RADIUS_TOP_RIGHT,this.KEY_RADIUS_BOTTOM_RIGHT,this.KEY_RADIUS_BOTTOM_LEFT);if(!(t===void 0||t[0]===void 0))return wy.hasNValues(t,4)?new pa(t[0],t[1],t[2],t[3]):new pa(t[0])}}ls.CornerRadius=pa;pa.NO_RADIUS=new pa(0);pa.KEY_RADIUS_TOP_LEFT="radiusTopLeft";pa.KEY_RADIUS_TOP_RIGHT="radiusTopRight";pa.KEY_RADIUS_BOTTOM_RIGHT="radiusBottomRight";pa.KEY_RADIUS_BOTTOM_LEFT="radiusBottomLeft";var tW=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},N3e=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(f1,"__esModule",{value:!0});f1.InsertIndicatorView=void 0;const Kv=z,a5=k,B3e=ls,$3e=u1;let VP=class{render(e,t){if(t.targetKind==="hidden")return;const i=this.getSize(e),o=(0,Kv.svg)("g",null,(0,Kv.svg)("polyline",{"class-sprotty-node":!0,"class-insert-indicator":!0,points:`0,${-i/2} 0,${i/2}`}),(0,Kv.svg)("polyline",{"class-sprotty-node":!0,"class-insert-indicator":!0,points:`${-i/2},0 ${i/2},0`}));return e.cssClasses.forEach(r=>(0,Kv.setClass)(o,r,!0)),o}getSize(e){var t,i,o;return(o=(t=B3e.GArgument.getNumber(e,$3e.ARG_LENGTH))!==null&&t!==void 0?t:(i=this.grid)===null||i===void 0?void 0:i.x)!==null&&o!==void 0?o:10}};f1.InsertIndicatorView=VP;tW([(0,a5.optional)(),(0,a5.inject)(Kv.TYPES.Grid),N3e("design:type",Object)],VP.prototype,"grid",void 0);f1.InsertIndicatorView=VP=tW([(0,a5.injectable)()],VP);Object.defineProperty(Hb,"__esModule",{value:!0});Hb.nodeCreationToolModule=void 0;const hd=z,k3e=Yg,F3e=zR,PK=u1,wK=oa,x3e=f1;Hb.nodeCreationToolModule=new hd.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,hd.bindAsService)(o,hd.TYPES.IContainerManager,F3e.ContainerManager),(0,hd.bindAsService)(o,hd.TYPES.ITool,wK.NodeCreationTool),(0,hd.configureActionHandler)(o,hd.TriggerNodeCreationAction.KIND,wK.NodeCreationTool),(0,hd.configureModelElement)(o,PK.InsertIndicator.TYPE,PK.InsertIndicator,x3e.InsertIndicatorView)},{featureId:Symbol("nodeCreationTool"),requires:k3e.elementTemplateModule});var Au={},H3e=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Au,"__esModule",{value:!0});Au.toolFocusLossModule=Au.EnableDefaultToolsOnFocusLossHandler=void 0;const AK=z,K3e=k,nW=Ma,V3e=It;let zP=class{handle(e){if(nW.FocusStateChangedAction.is(e)&&!e.hasFocus)return V3e.EnableDefaultToolsAction.create()}};Au.EnableDefaultToolsOnFocusLossHandler=zP;Au.EnableDefaultToolsOnFocusLossHandler=zP=H3e([(0,K3e.injectable)()],zP);Au.toolFocusLossModule=new AK.FeatureModule((n,e,t)=>{(0,AK.configureActionHandler)({bind:n,isBound:t},nW.FocusStateChangedAction.KIND,zP)},{featureId:Symbol("toolFocusLoss ")});var YR={},En={},sf={};Object.defineProperty(sf,"__esModule",{value:!0});sf.collectIssueMarkers=sf.MarkerPredicates=void 0;const eD=z,z3e=Ni;var RK;(function(n){n.ALL=()=>!0,n.ERRORS=t=>e(t,eD.MarkerKind.ERROR),n.WARNINGS=t=>e(t,eD.MarkerKind.WARNING),n.INFOS=t=>e(t,eD.MarkerKind.INFO);function e(t,i){return t.issues.find(o=>o.severity===i)!==void 0}n.hasIssueWithSeverity=e})(RK||(sf.MarkerPredicates=RK={}));function iW(n){const e=[];for(const t of n.children)t instanceof z3e.GIssueMarker&&e.push(t),e.push(...iW(t));return e}sf.collectIssueMarkers=iW;var Ts=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},h1=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(En,"__esModule",{value:!0});En.MarkerNavigatorKeyListener=En.MarkerNavigatorContextMenuItemProvider=En.NavigateToMarkerActionHandler=En.MarkerNavigator=En.LeftToRightTopToBottomComparator=En.GModelElementComparator=En.NavigateToMarkerAction=void 0;const Ui=z,Ds=k,G3e=Pt,GP=Yt,c5=kt,S3=sf;var _m;(function(n){n.KIND="navigateToMarker";function e(i){return Ui.Action.hasKind(i,n.KIND)&&(0,Ui.hasStringProp)(i,"direction")&&(0,Ui.hasArrayProp)(i,"severities")}n.is=e;function t(i){return{kind:n.KIND,direction:"next",severities:Ru.ALL_SEVERITIES,...i}}n.create=t})(_m||(En.NavigateToMarkerAction=_m={}));class Ay{compare(e,t){return 0}}En.GModelElementComparator=Ay;let d5=class{compare(e,t){const i=(0,Ui.findParentByFeature)(e,c5.isSelectableAndBoundsAware),o=(0,Ui.findParentByFeature)(t,c5.isSelectableAndBoundsAware);if(i&&o){if(i.bounds.y!==o.bounds.y)return i.bounds.y-o.bounds.y;if(i.bounds.x!==o.bounds.x)return i.bounds.x-o.bounds.x}return 0}};En.LeftToRightTopToBottomComparator=d5;En.LeftToRightTopToBottomComparator=d5=Ts([(0,Ds.injectable)()],d5);let Ru=class{next(e,t,i=S3.MarkerPredicates.ALL){const o=this.getMarkers(e,i);return t===void 0?o.length>0?o[0]:void 0:o[this.getNextIndex(t,o)%o.length]}previous(e,t,i=S3.MarkerPredicates.ALL){const o=this.getMarkers(e,i);return t===void 0?o.length>0?o[0]:void 0:o[this.getPreviousIndex(t,o)%o.length]}getMarkers(e,t){return(0,S3.collectIssueMarkers)(e).filter(t).sort(this.markerComparator.compare)}getNextIndex(e,t){for(let i=0;i<t.length;i++)if(this.markerComparator.compare(t[i],e)>0)return i;return 0}getPreviousIndex(e,t){for(let i=t.length-1;i>=0;i--)if(this.markerComparator.compare(t[i],e)<0)return i;return t.length-1}};En.MarkerNavigator=Ru;Ru.ALL_SEVERITIES=["error","warning","info"];Ts([(0,Ds.inject)(Ay),h1("design:type",Ay)],Ru.prototype,"markerComparator",void 0);En.MarkerNavigator=Ru=Ts([(0,Ds.injectable)()],Ru);let af=class{handle(e){const t=this.getSelectedElements(e),i=this.getTarget(e,t),o=i?(0,Ui.findParentByFeature)(i,Ui.isSelectable):void 0;if(o){const r=t.map(s=>s.id).filter(s=>s!==o.id);this.actionDispatcher.dispatch(Ui.SelectAction.create({selectedElementsIDs:[o.id],deselectedElementsIDs:r})),this.actionDispatcher.dispatch(Ui.CenterAction.create([o.id]))}}getSelectedElements(e){return e.selectedElementIds&&e.selectedElementIds.length>0?(0,c5.getElements)(this.selectionService.getModelRoot().index,e.selectedElementIds,Ui.isSelectable):this.selectionService.getSelectedElements()}getTarget(e,t){const i=this.selectionService.getModelRoot(),o=t.sort(this.markerComparator.compare).find(Ui.isBoundsAware);return e.direction==="previous"?this.markerNavigator.previous(i,o,r=>this.matchesSeverities(e,r)):this.markerNavigator.next(i,o,r=>this.matchesSeverities(e,r))}matchesSeverities(e,t){return t.issues.find(i=>e.severities.includes(i.severity))!==void 0}};En.NavigateToMarkerActionHandler=af;Ts([(0,Ds.inject)(Ay),h1("design:type",Ay)],af.prototype,"markerComparator",void 0);Ts([(0,Ds.inject)(Ru),h1("design:type",Ru)],af.prototype,"markerNavigator",void 0);Ts([(0,Ds.inject)(GP.SelectionService),h1("design:type",GP.SelectionService)],af.prototype,"selectionService",void 0);Ts([(0,Ds.inject)(Ui.TYPES.IActionDispatcher),h1("design:type",G3e.GLSPActionDispatcher)],af.prototype,"actionDispatcher",void 0);En.NavigateToMarkerActionHandler=af=Ts([(0,Ds.injectable)()],af);let UP=class{getItems(e,t){const i=Array.from(this.selectionService.getSelectedElementIDs()),o=(0,S3.collectIssueMarkers)(e).length>0;return Promise.resolve([{id:"navigate",label:"Go to",group:"navigate",actions:[],children:[{id:"next-marker",label:"Next marker",group:"marker",actions:[_m.create({direction:"next",selectedElementIds:i})],isEnabled:()=>o},{id:"previous-marker",label:"Previous marker",group:"marker",actions:[_m.create({direction:"previous",selectedElementIds:i})],isEnabled:()=>o}]}])}};En.MarkerNavigatorContextMenuItemProvider=UP;Ts([(0,Ds.inject)(GP.SelectionService),h1("design:type",GP.SelectionService)],UP.prototype,"selectionService",void 0);En.MarkerNavigatorContextMenuItemProvider=UP=Ts([(0,Ds.injectable)()],UP);let u5=class extends Ui.KeyListener{keyDown(e,t){return(0,Ui.matchesKeystroke)(t,"Period","ctrl")?[_m.create({direction:"next"})]:(0,Ui.matchesKeystroke)(t,"Comma","ctrl")?[_m.create({direction:"previous"})]:[]}};En.MarkerNavigatorKeyListener=u5;En.MarkerNavigatorKeyListener=u5=Ts([(0,Ds.injectable)()],u5);var Bn={},Yc=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},p1=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},oW=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Bn,"__esModule",{value:!0});Bn.DeleteMarkersCommand=Bn.ApplyMarkersCommand=Bn.ApplyMarkersAction=Bn.SetMarkersActionHandler=Bn.ExternalMarkerManager=Bn.ValidationFeedbackEmitter=void 0;const ma=z,Nr=k,MK=An,rW=Gn,U3e=kt,Ip=Ni;let ym=class{constructor(){this.registeredFeedbackByReason=new Map}registerValidationFeedbackAction(e,t=""){var i,o;const r=(o=(i=this.registeredFeedbackByReason.get(t))===null||i===void 0?void 0:i.dispose())!==null&&o!==void 0?o:this.feedbackActionDispatcher.createEmitter();r.add(e,()=>ma.DeleteMarkersAction.create(e.markers)).submit(),this.registeredFeedbackByReason.set(t,r)}};Bn.ValidationFeedbackEmitter=ym;Yc([(0,Nr.inject)(ma.TYPES.IFeedbackActionDispatcher),p1("design:type",Object)],ym.prototype,"feedbackActionDispatcher",void 0);Bn.ValidationFeedbackEmitter=ym=Yc([(0,Nr.injectable)()],ym);let Ry=class{connect(e){this.actionDispatcher=e}removeMarkers(e){this.actionDispatcher&&this.actionDispatcher.dispatch(ma.DeleteMarkersAction.create(e))}};Bn.ExternalMarkerManager=Ry;Bn.ExternalMarkerManager=Ry=Yc([(0,Nr.injectable)()],Ry);let bm=class{handle(e){const t=e.markers;this.setMarkers(t,e.reason)}async setMarkers(e,t){var i;const o=this.editorContextService.sourceUri;(i=this.externalMarkerManager)===null||i===void 0||i.setMarkers(e,t,o);const r=YP.create(e);this.validationFeedbackEmitter.registerValidationFeedbackAction(r,t)}};Bn.SetMarkersActionHandler=bm;Yc([(0,Nr.inject)(ym),p1("design:type",ym)],bm.prototype,"validationFeedbackEmitter",void 0);Yc([(0,Nr.inject)(Ry),(0,Nr.optional)(),p1("design:type",Ry)],bm.prototype,"externalMarkerManager",void 0);Yc([(0,Nr.inject)(MK.EditorContextService),p1("design:type",MK.EditorContextService)],bm.prototype,"editorContextService",void 0);Bn.SetMarkersActionHandler=bm=Yc([(0,Nr.injectable)()],bm);var YP;(function(n){n.KIND="applyMarkers";function e(i){return ma.Action.hasKind(i,n.KIND)&&(0,ma.hasArrayProp)(i,"markers")}n.is=e;function t(i){return{kind:n.KIND,markers:i}}n.create=t})(YP||(Bn.ApplyMarkersAction=YP={}));let qP=class extends rW.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){return this.action.markers.forEach(t=>{const i=e.root.index.getById(t.elementId);if(i instanceof ma.GParentElement){const o=(0,Ip.getOrCreateGIssueMarker)(i),r=(0,Ip.createGIssue)(t);o.issues.push(r),o instanceof Ip.GIssueMarker&&o.computeProjectionCssClasses(),sW(i,o)}}),e.root}};Bn.ApplyMarkersCommand=qP;qP.KIND=YP.KIND;Bn.ApplyMarkersCommand=qP=Yc([(0,Nr.injectable)(),oW(0,(0,Nr.inject)(ma.TYPES.Action)),p1("design:paramtypes",[Object])],qP);function sW(n,e){const t=(0,Ip.getSeverity)(e);n.cssClasses?(n.cssClasses=n.cssClasses.filter(i=>!i.match("info|warning|error")),n.cssClasses.push(t)):n.cssClasses=[t]}function Y3e(n,e){const t=(0,Ip.getSeverity)(e);(0,U3e.removeCssClasses)(n,[t])}let WP=class extends rW.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){return this.action.markers.forEach(t=>{const i=e.root.index.getById(t.elementId);if(i instanceof ma.GParentElement){const o=(0,Ip.getGIssueMarker)(i);if(o){Y3e(i,o);for(let r=0;r<o.issues.length;++r)o.issues[r].message===t.description&&o.issues.splice(r--,1);o.issues.length===0?i.remove(o):sW(i,o)}}}),e.root}};Bn.DeleteMarkersCommand=WP;WP.KIND=ma.DeleteMarkersAction.KIND;Bn.DeleteMarkersCommand=WP=Yc([(0,Nr.injectable)(),oW(0,(0,Nr.inject)(ma.TYPES.Action)),p1("design:paramtypes",[Object])],WP);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.standaloneMarkerNavigatorModule=n.markerNavigatorModule=n.validationModule=void 0;const e=z,t=En,i=Bn;n.validationModule=new e.FeatureModule((o,r,s)=>{const a={bind:o,isBound:s};(0,e.configureActionHandler)(a,e.SetMarkersAction.KIND,i.SetMarkersActionHandler),(0,e.configureCommand)(a,i.ApplyMarkersCommand),(0,e.configureCommand)(a,i.DeleteMarkersCommand),o(i.ValidationFeedbackEmitter).toSelf().inSingletonScope()},{featureId:Symbol("validation")}),n.markerNavigatorModule=new e.FeatureModule((o,r,s)=>{o(t.GModelElementComparator).to(t.LeftToRightTopToBottomComparator).inSingletonScope(),o(t.MarkerNavigator).toSelf().inSingletonScope(),(0,e.configureActionHandler)({bind:o,isBound:s},t.NavigateToMarkerAction.KIND,t.NavigateToMarkerActionHandler)},{featureId:Symbol("markerNavigator")}),n.standaloneMarkerNavigatorModule=new e.FeatureModule(o=>{(0,e.bindAsService)(o,e.TYPES.IContextMenuProvider,t.MarkerNavigatorContextMenuItemProvider),(0,e.bindAsService)(o,e.TYPES.KeyListener,t.MarkerNavigatorKeyListener)},{featureId:Symbol("standaloneMarkerNavigator"),requires:n.markerNavigatorModule})})(YR);var qR={},qc={};Object.defineProperty(qc,"__esModule",{value:!0});qc.FocusDomAction=void 0;const IK=z;var TK;(function(n){n.KIND="focusDomAction";function e(i){return IK.Action.hasKind(i,n.KIND)&&(0,IK.hasStringProp)(i,"id")}n.is=e;function t(i){return{kind:n.KIND,id:i}}n.create=t})(TK||(qc.FocusDomAction=TK={}));var m1={},q3e=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(m1,"__esModule",{value:!0});m1.GLSPScrollMouseListener=void 0;const W3e=k,Z3e=z,DK=It,Q3e=eo;let l5=class extends Z3e.ScrollMouseListener{constructor(){super(...arguments),this.preventScrolling=!1}handle(e){e.kind===DK.EnableToolsAction.KIND?e.toolIds.includes(Q3e.MarqueeMouseTool.ID)&&(this.preventScrolling=!0):e.kind===DK.EnableDefaultToolsAction.KIND&&(this.preventScrolling=!1)}mouseDown(e,t){return this.preventScrolling?[]:super.mouseDown(e,t)}};m1.GLSPScrollMouseListener=l5;m1.GLSPScrollMouseListener=l5=q3e([(0,W3e.injectable)()],l5);var ga={},X3e=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},J3e=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},eCe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(ga,"__esModule",{value:!0});ga.RepositionCommand=ga.RepositionAction=void 0;const Ko=z,OK=k,tCe=ni,nCe=kt;var f5;(function(n){n.KIND="repositionAction";function e(i){return Ko.Action.hasKind(i,n.KIND)&&(0,Ko.hasArrayProp)(i,"elementIDs")}n.is=e;function t(i){return{kind:n.KIND,elementIDs:i}}n.create=t})(f5||(ga.RepositionAction=f5={}));let ZP=class extends Ko.BoundsAwareViewportCommand{constructor(e){super(!0),this.action=e}boundsInViewport(e,t,i){var o;if(e instanceof Ko.GChildElement&&e.parent!==i)return this.boundsInViewport(e.parent,e.parent.localToParent(t),i);if(e instanceof tCe.GEdge){const r=(0,Ko.getRouteBounds)((o=(0,nCe.calcElementAndRoute)(e).newRoutingPoints)!==null&&o!==void 0?o:[]);return e instanceof Ko.GChildElement&&e.parent!==i?this.boundsInViewport(e.parent,e.parent.localToParent(r),i):r}return t}getElementIds(){return this.action.elementIDs}getNewViewport(e,t){if(Ko.Dimension.isValid(t.canvasBounds)&&(0,Ko.isViewport)(t)){if(this.isFullyVisible(e,t))return;{const i=t.zoom,o=Ko.Bounds.center(e),r=Ko.Dimension.center(t.canvasBounds),s=Ko.Point.subtract(o,r);return{scroll:Ko.Point.map(s,u=>u/i),zoom:i}}}}isFullyVisible(e,t){return e.x>=t.scroll.x&&e.x+e.width<=t.scroll.x+t.canvasBounds.width/t.zoom&&e.y>=t.scroll.y&&e.y+e.height<=t.scroll.y+t.canvasBounds.height/t.zoom}};ga.RepositionCommand=ZP;ZP.KIND=f5.KIND;ga.RepositionCommand=ZP=X3e([(0,OK.injectable)(),eCe(0,(0,OK.inject)(Ko.TYPES.Action)),J3e("design:paramtypes",[Object])],ZP);var g1={},WR=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},I9=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(g1,"__esModule",{value:!0});g1.RestoreViewportHandler=void 0;const LK=z,ZR=k,jK=An,NK=Vc,iCe=It,oCe=qc;let Sm=class{handle(e){(iCe.EnableDefaultToolsAction.is(e)||oCe.FocusDomAction.is(e)&&e.id==="graph")&&this.focusGraph()}get graphSelector(){return`#${CSS.escape(this.domHelper.createUniqueDOMElementId(this.editorContext.modelRoot))}`}async postRequestModel(){await this.waitForElement(this.graphSelector),this.focusGraph()}focusGraph(){var e;if(this.focusTracker.hasFocus){const t=(e=this.focusTracker.diagramElement)===null||e===void 0?void 0:e.querySelector(this.graphSelector);t==null||t.focus()}}waitForElement(e){return new Promise(t=>{if(document.querySelector(e))return t(document.querySelector(e));const i=new MutationObserver(o=>{document.querySelector(e)&&(i.disconnect(),t(document.querySelector(e)))});i.observe(document.body,{childList:!0,subtree:!0})})}};g1.RestoreViewportHandler=Sm;WR([(0,ZR.inject)(LK.TYPES.DOMHelper),I9("design:type",LK.DOMHelper)],Sm.prototype,"domHelper",void 0);WR([(0,ZR.inject)(NK.FocusTracker),I9("design:type",NK.FocusTracker)],Sm.prototype,"focusTracker",void 0);WR([(0,ZR.inject)(jK.EditorContextService),I9("design:type",jK.EditorContextService)],Sm.prototype,"editorContext",void 0);g1.RestoreViewportHandler=Sm=WR([(0,ZR.injectable)()],Sm);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.standaloneViewportModule=n.viewportModule=void 0;const e=z,t=It,i=qc,o=m1,r=Ec,s=ga,a=g1;n.viewportModule=new e.FeatureModule((u,h,g)=>{const y={bind:u,isBound:g};(0,e.configureCommand)(y,e.CenterCommand),(0,e.configureCommand)(y,e.FitToScreenCommand),(0,e.configureCommand)(y,e.GetViewportCommand),(0,e.configureCommand)(y,e.SetViewportCommand),(0,e.configureCommand)(y,s.RepositionCommand),(0,e.configureCommand)(y,r.OriginViewportCommand),(0,e.bindAsService)(y,e.TYPES.MouseListener,e.ZoomMouseListener),(0,e.bindAsService)(y,e.TYPES.MouseListener,o.GLSPScrollMouseListener),(0,e.configureActionHandler)(y,t.EnableToolsAction.KIND,o.GLSPScrollMouseListener),(0,e.configureActionHandler)(y,t.EnableDefaultToolsAction.KIND,o.GLSPScrollMouseListener),(0,e.bindAsService)(y,e.TYPES.IDiagramStartup,a.RestoreViewportHandler),(0,e.configureActionHandler)(y,t.EnableDefaultToolsAction.KIND,a.RestoreViewportHandler),(0,e.configureActionHandler)(y,i.FocusDomAction.KIND,a.RestoreViewportHandler)},{featureId:Symbol("viewport")}),n.standaloneViewportModule=new e.FeatureModule((u,h,g)=>{const y={bind:u,isBound:g};(0,e.bindAsService)(y,e.TYPES.KeyListener,e.CenterKeyboardListener)},{featureId:Symbol("standaloneViewport"),requires:n.viewportModule})})(qR);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.initializeDiagramContainer=n.configureDiagramOptions=n.createDiagramOptionsModule=n.DEFAULT_MODULES=void 0;const e=z,t=ob,i=ab,o=cb,r=db,s=wR,a=lb,u=Yg,h=RR,g=fb,y=pb,S=gb,w=vb,P=_b,E=yb,A=Sb,L=BR,B=Eb,U=Pb,p=wb,b=Ab,v=Tb,R=Nb,D=Bb,j=$b,T=Fb,$=Hb,Q=Au,K=YR,Z=qR;n.DEFAULT_MODULES=[t.defaultModule,e.buttonModule,e.edgeIntersectionModule,e.edgeLayoutModule,e.expandModule,h.exportModule,e.fadeModule,i.boundsModule,o.commandPaletteModule,r.contextMenuModule,a.decorationModule,w.labelEditModule,y.hoverModule,L.selectModule,s.copyPasteModule,Z.viewportModule,S.labelEditUiModule,P.layoutModule,K.markerNavigatorModule,g.typeHintsModule,e.modelSourceModule,B.sourceModelWatcherModule,E.navigationModule,A.routingModule,b.toolPaletteModule,D.edgeCreationToolModule,j.edgeEditToolModule,R.deletionToolModule,u.elementTemplateModule,$.nodeCreationToolModule,v.changeBoundsToolModule,T.marqueeSelectionToolModule,Q.toolFocusLossModule,K.validationModule,e.zorderModule,p.svgMetadataModule,U.statusModule];function H(te,ue){return new e.FeatureModule((Re,ae,ot,Ft)=>M({bind:Re,unbind:ae,isBound:ot,rebind:Ft},te,ue))}n.createDiagramOptionsModule=H;function M(te,ue,Re){(0,e.configureViewerOptions)(te,{baseDiv:ue.clientId,hiddenDiv:ue.clientId+"_hidden",zoomLimits:{min:.1,max:20},...Re}),te.bind(e.TYPES.IDiagramOptions).toConstantValue(ue)}n.configureDiagramOptions=M;function Y(te,...ue){const Re=(0,e.resolveContainerConfiguration)(...n.DEFAULT_MODULES,...ue),ae=Re[0];if(!ae||!(ae instanceof e.FeatureModule&&ae.featureId===t.defaultModule.featureId))throw new Error("Invalid module configuration. The first module to load should be the `defaultModule` (or an equivalent replacement module)");return te.load(...Re),te}n.initializeDiagramContainer=Y})(uq);var QR={},T9={},va={},to={},rCe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},E3;Object.defineProperty(to,"__esModule",{value:!0});to.KeyShortcutUIExtension=to.SetAccessibleKeyShortcutAction=void 0;const aW=z,sCe=k,aCe=ah,cCe=Ms;var h5;(function(n){n.KIND="setAccessibleKeyShortcut";function e(i){return aW.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,token:i.token,keys:i.keys}}n.create=t})(h5||(to.SetAccessibleKeyShortcutAction=h5={}));let QP=E3=class extends cCe.GLSPAbstractUIExtension{constructor(){super(...arguments),this.registrations={}}handle(e){h5.is(e)&&(this.registrations[e.token]=e.keys,this.containerElement&&this.refreshUI())}id(){return E3.ID}containerClass(){return E3.ID}show(e,...t){super.show(e,...t),this.shortcutsContainer.focus()}refreshUI(){this.shortcutsContainer.innerHTML="";const e=Object.values(this.registrations).flatMap(h=>h);e.sort((h,g)=>h.group<g.group?-1:h.group>g.group?1:h.position-g.position);const t=(0,aCe.groupBy)(e,h=>h.group),i=document.createElement("table");i.classList.add("shortcut-table");const o=document.createElement("thead"),r=document.createElement("tbody"),s=document.createElement("tr"),a=document.createElement("th"),u=document.createElement("th");a.classList.add("column-title"),a.innerText="Command",u.innerText="Keybinding",s.appendChild(a),s.appendChild(u),o.appendChild(s);for(const[h,g]of Object.entries(t))r.appendChild(this.createGroupHeader(h)),g.forEach(y=>{r.appendChild(this.createEntry(y))});i.appendChild(o),i.appendChild(r),this.shortcutsContainer.append(i)}createGroupHeader(e){const t=document.createElement("tr"),i=document.createElement("td"),o=document.createElement("strong"),r=document.createElement("td");return o.innerText=e,i.appendChild(o),t.appendChild(i),t.appendChild(r),t}getShortcutHTML(e){const t=document.createElement("span");return t.innerHTML=e.map(i=>`<kbd>${i}</kbd>`).join(" + "),t}createEntry(e){const t=document.createElement("tr"),i=document.createElement("td"),o=document.createElement("td"),r=this.getShortcutHTML(e.shortcuts);return o.innerText=e.description,i.appendChild(r),t.appendChild(o),t.appendChild(i),t}initializeContents(e){this.container=document.createElement("div"),this.container.classList.add("keyboard-shortcuts-menu");const t=document.createElement("h3");t.classList.add("menu-header"),t.innerText="Keyboard Shortcuts",this.container.appendChild(t);const i=document.createElement("button");i.id="key-shortcut-close-btn",i.textContent="x",i.addEventListener("click",()=>{this.hide()}),this.container.appendChild(i),this.shortcutsContainer=document.createElement("div"),this.shortcutsContainer.classList.add("keyboard-shortcuts-container"),this.shortcutsContainer.tabIndex=30,this.shortcutsContainer.addEventListener("keydown",o=>{(o.key==="Escape"||(0,aW.matchesKeystroke)(o,"KeyH","alt"))&&this.hide()}),this.container.appendChild(this.shortcutsContainer),e.appendChild(this.container),e.ariaLabel="Shortcut-Menu",this.refreshUI()}};to.KeyShortcutUIExtension=QP;QP.ID="key-shortcut";to.KeyShortcutUIExtension=QP=E3=rCe([(0,sCe.injectable)()],QP);var Ac={},cW=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},dCe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},p5;Object.defineProperty(Ac,"__esModule",{value:!0});Ac.AccessibleShortcutKeyListener=Ac.AccessibleKeyShortcutTool=void 0;const dW=k,m_=z,uCe=_i,lCe=to;let My=p5=class extends uCe.BaseEditTool{constructor(){super(...arguments),this.shortcutKeyListener=new XR}get id(){return p5.ID}enable(){this.keytool.register(this.shortcutKeyListener)}disable(){this.keytool.deregister(this.shortcutKeyListener)}};Ac.AccessibleKeyShortcutTool=My;My.ID="accessible-key-shortcut-tool";cW([(0,dW.inject)(m_.KeyTool),dCe("design:type",m_.KeyTool)],My.prototype,"keytool",void 0);Ac.AccessibleKeyShortcutTool=My=p5=cW([(0,dW.injectable)()],My);class XR extends m_.KeyListener{constructor(){super(...arguments),this.token=Symbol(XR.name)}keyDown(e,t){return this.matchesActivateShortcutHelpKeystroke(t)?[m_.SetUIExtensionVisibilityAction.create({extensionId:lCe.KeyShortcutUIExtension.ID,visible:!0})]:[]}matchesActivateShortcutHelpKeystroke(e){return(0,m_.matchesKeystroke)(e,"KeyH","alt")}}Ac.AccessibleShortcutKeyListener=XR;var Rc={},Xi={},fCe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},m5;Object.defineProperty(Xi,"__esModule",{value:!0});Xi.SearchAutocompletePalette=Xi.RevealEdgeElementAutocompleteSuggestionProvider=Xi.RevealNodesWithoutNameAutocompleteSuggestionProvider=Xi.RevealNamedElementAutocompleteSuggestionProvider=void 0;const pi=z,hCe=k,BK=ah,Iy=Io,pCe=ib,tD=it,mCe=ga,uW=ni,nD="search-hidden",iD="search-highlighted";class lW{async retrieveSuggestions(e,t){return(0,Iy.toArray)(e.index.all().filter(o=>(0,pi.isNameable)(o))).map(o=>{var r;return{element:o,action:{label:`[${o.type}] ${(r=(0,pi.name)(o))!==null&&r!==void 0?r:"<no-name>"}`,actions:this.getActions(o),icon:(0,pi.codiconCSSString)("eye")}}})}getActions(e){return[pi.SelectAction.create({selectedElementsIDs:[e.id]}),pi.CenterAction.create([e.id],{retainZoom:!0})]}}Xi.RevealNamedElementAutocompleteSuggestionProvider=lW;class fW{async retrieveSuggestions(e,t){return(0,Iy.toArray)(e.index.all().filter(o=>!(0,pi.isNameable)(o)&&o instanceof pi.GNode)).map(o=>({element:o,action:{label:`[${o.type}]`,actions:this.getActions(o),icon:(0,pi.codiconCSSString)("symbol-namespace")}}))}getActions(e){return[pi.SelectAction.create({selectedElementsIDs:[e.id]}),pi.CenterAction.create([e.id],{retainZoom:!0})]}}Xi.RevealNodesWithoutNameAutocompleteSuggestionProvider=fW;class hW{async retrieveSuggestions(e,t){return(0,Iy.toArray)(e.index.all().filter(o=>o instanceof uW.GEdge)).map(o=>({element:o,action:{label:`[${o.type}]  ${this.getEdgeLabel(e,o)}`,actions:this.getActions(o),icon:(0,pi.codiconCSSString)("arrow-both")}}))}getActions(e){return[pi.SelectAction.create({selectedElementsIDs:[e.id]}),pi.CenterAction.create([e.sourceId,e.targetId])]}getEdgeLabel(e,t){var i,o;let r="",s="";const a=e.index.getById(t.sourceId),u=e.index.getById(t.targetId);return a!==void 0&&(r=(i=(0,pi.name)(a))!==null&&i!==void 0?i:a.type),u!==void 0&&(s=(o=(0,pi.name)(u))!==null&&o!==void 0?o:u.type),r+" -> "+s}}Xi.RevealEdgeElementAutocompleteSuggestionProvider=hW;let XP=m5=class extends pCe.BaseAutocompletePalette{constructor(){super(...arguments),this.cachedSuggestions=[]}id(){return m5.ID}initializeContents(e){super.initializeContents(e),this.autocompleteWidget.inputField.placeholder="Search for elements",e.setAttribute("aria-label","Search Field")}getSuggestionProviders(e,t){return[new lW,new hW,new fW]}async retrieveSuggestions(e,t){const i=this.getSuggestionProviders(e,t),o=(await Promise.all(i.map(r=>r.retrieveSuggestions(e,t)))).flat(1);return this.cachedSuggestions=o,o.map(r=>r.action)}async visibleSuggestionsChanged(e,t){await this.applyCSS(this.getHiddenElements(e,this.getSuggestionsFromLabeledActions(t)),nD),await this.deleteCSS(this.getSuggestionsFromLabeledActions(t).map(i=>i.element),nD)}async selectedSuggestionChanged(e,t){if(await this.deleteAllCSS(e,iD),t!==void 0){const i=this.getSuggestionsFromLabeledActions([t]),o=[];i.map(r=>o.push(mCe.RepositionAction.create([r.element.id]))),this.actionDispatcher.dispatchAll(o),await this.applyCSS(i.map(r=>r.element),iD)}}show(e,...t){this.actionDispatcher.dispatch(pi.SelectAllAction.create(!1)),super.show(e,...t)}hide(){this.root!==void 0&&(this.deleteAllCSS(this.root,nD),this.deleteAllCSS(this.root,iD),this.autocompleteWidget.inputField.value=""),super.hide()}applyCSS(e,t){const i=e.map(o=>(0,tD.applyCssClasses)(o,t));return this.actionDispatcher.dispatchAll(i)}deleteCSS(e,t){const i=e.map(o=>(0,tD.deleteCssClasses)(o,t));return this.actionDispatcher.dispatchAll(i)}deleteAllCSS(e,t){const i=(0,Iy.toArray)(e.index.all().map(o=>(0,tD.deleteCssClasses)(o,t)));return this.actionDispatcher.dispatchAll(i)}getSuggestionsFromLabeledActions(e){return this.cachedSuggestions.filter(t=>e.find(i=>(0,BK.isEqual)(i,t.action)))}getHiddenSuggestionsFromLabeledActions(e){return this.cachedSuggestions.filter(t=>!e.find(i=>(0,BK.isEqual)(i,t.action)))}getHiddenElements(e,t){return(0,Iy.toArray)(e.index.all().filter(i=>i instanceof pi.GNode||i instanceof uW.GEdge).filter(i=>t.find(o=>o.element.id===i.id)===void 0))}};Xi.SearchAutocompletePalette=XP;XP.ID="search-autocomplete-palette";Xi.SearchAutocompletePalette=XP=m5=fCe([(0,hCe.injectable)()],XP);var D9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},pW=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},g5;Object.defineProperty(Rc,"__esModule",{value:!0});Rc.SearchAutocompletePaletteKeyListener=Rc.SearchAutocompletePaletteTool=void 0;const O9=k,gCe=qt,Ty=z,vCe=Pt,_Ce=to,$K=Xi;let Em=g5=class{constructor(){this.keyListener=new mW(this)}get id(){return g5.ID}enable(){this.keyTool.register(this.keyListener),this.keyListener.registerShortcutKey()}disable(){this.keyTool.deregister(this.keyListener)}};Rc.SearchAutocompletePaletteTool=Em;Em.ID="glsp.search-autocomplete-palette-tool";D9([(0,O9.inject)(Ty.TYPES.IActionDispatcher),pW("design:type",vCe.GLSPActionDispatcher)],Em.prototype,"actionDispatcher",void 0);D9([(0,O9.inject)(Ty.KeyTool),pW("design:type",Ty.KeyTool)],Em.prototype,"keyTool",void 0);Rc.SearchAutocompletePaletteTool=Em=g5=D9([(0,O9.injectable)()],Em);class mW extends Ty.KeyListener{constructor(e){super(),this.tool=e,this.token=$K.SearchAutocompletePalette.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(_Ce.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["CTRL","F"],description:"Activate search for elements",group:"Search",position:0}]}))}keyDown(e,t){return this.matchesSearchActivateKeystroke(t)?[Ty.SetUIExtensionVisibilityAction.create({extensionId:$K.SearchAutocompletePalette.ID,visible:!0})]:[]}matchesSearchActivateKeystroke(e){return(0,gCe.matchesKeystroke)(e,"KeyF","ctrl")}}Rc.SearchAutocompletePaletteKeyListener=mW;const yCe={default_navigation_mode_activated:"Navigation On: Use arrow keys to select preceding (←) or succeding (→) elements. Use the up (↑) and down (↓) arrows to navigate paths. Press 'N' to exit.",default_navigation_mode_deactivated:"Navigation Off: Press 'N' for default navigation, 'ALT+N' for position based navigation.",local_navigation_mode_activated:"Position based Nav On: Navigate nearest elements using arrow keys: (↑) for above, (↓) for below, (←) for previous, (→) for next element. Press 'ALT+N' to exit.",local_navigation_mode_deactivated:"Position based Nav Off: Press 'N' for default navigation, 'ALT+N' for position based navigation."},bCe={focus_on:"Currently focused: ",focus_off:"Currently no element is focused."},SCe={resize_mode_activated:"Resize On: Use plus(+) and minus(-) to resize, 'CTRL'+'0' for default size. Press 'ESC' to exit.",resize_mode_deactivated:"Resize Off: Press 'ALT'+'A' for resize mode."},ECe={zoom_in_grid:"Select a digit from 1-9 to zoom in on the respective box."},CCe={marqueeTool:"Currently marquee tool is only usable with mouse."},Vb={navigation:yCe,focus:bCe,resize:SCe,grid:ECe,tool_palette:CCe};var ar={};Object.defineProperty(ar,"__esModule",{value:!0});ar.ShowToastMessageAction=ar.HideToastAction=void 0;const gW=z;var kK;(function(n){n.KIND="hideToastMessageAction";function e(i){return gW.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,options:i}}n.create=t})(kK||(ar.HideToastAction=kK={}));var FK;(function(n){n.KIND="showToastMessageAction",n.TIMEOUT=2e3;function e(o){return gW.Action.hasKind(o,n.KIND)}n.is=e;function t(o){var r,s;return{kind:n.KIND,options:{...o,position:(r=o.position)!==null&&r!==void 0?r:"center",id:(s=o.id)!==null&&s!==void 0?s:Symbol("toast id")}}}n.create=t;function i(o){var r,s;return{kind:n.KIND,options:{timeout:n.TIMEOUT,...o,position:(r=o.position)!==null&&r!==void 0?r:"center",id:(s=o.id)!==null&&s!==void 0?s:Symbol("toast id")}}}n.createWithTimeout=i})(FK||(ar.ShowToastMessageAction=FK={}));var zb=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},JR=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},v5;Object.defineProperty(va,"__esModule",{value:!0});va.ElementNavigatorKeyListener=va.ElementNavigatorTool=void 0;const is=z,Gb=k,PCe=Io,al=qt,wCe=Pt,Qh=It,ACe=ga,RCe=to,xK=Ac,HK=Rc,Xh=Vb,Jh=ar,MCe=ni;let _a=v5=class{constructor(){this.isEditTool=!1,this.elementNavigatorKeyListener=new Fs(this)}get id(){return v5.ID}enable(){this.keytool.register(this.elementNavigatorKeyListener),this.elementNavigatorKeyListener.registerShortcutKey()}disable(){this.keytool.deregister(this.elementNavigatorKeyListener)}};va.ElementNavigatorTool=_a;_a.ID="glsp.diagram-navigation";zb([(0,Gb.inject)(is.KeyTool),JR("design:type",is.KeyTool)],_a.prototype,"keytool",void 0);zb([(0,Gb.inject)(is.TYPES.IElementNavigator),JR("design:type",Object)],_a.prototype,"elementNavigator",void 0);zb([(0,Gb.inject)(is.TYPES.ILocalElementNavigator),JR("design:type",Object)],_a.prototype,"localElementNavigator",void 0);zb([(0,Gb.inject)(is.TYPES.IActionDispatcher),JR("design:type",wCe.GLSPActionDispatcher)],_a.prototype,"actionDispatcher",void 0);va.ElementNavigatorTool=_a=v5=zb([(0,Gb.injectable)()],_a);var Mi;(function(n){n.POSITION="position",n.DEFAULT="default",n.NONE="none"})(Mi||(Mi={}));class Fs extends is.KeyListener{constructor(e){super(),this.tool=e,this.mode=Mi.NONE,this.token=Fs.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(RCe.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["N"],description:"Activate default navigation",group:"Navigation",position:0},{shortcuts:["ALT","N"],description:"Activate position based navigation",group:"Navigation",position:1},{shortcuts:["⬅  ⬆  ➡  ⬇"],description:"Navigate by relation or neighbors according to navigation mode",group:"Navigation",position:2}]}))}keyDown(e,t){return this.resetOnEscape(t,e),this.getSelectedElements(e.root).length>0?(this.triggerPositionNavigationOnEvent(t,e)||this.triggerDefaultNavigationOnEvent(t,e),this.navigate(e,t)):(this.resetPositionNavigationOnEvent(t,e),this.resetDefaultNavigationOnEvent(t,e),[])}resetOnEscape(e,t){var i,o;this.mode!==Mi.NONE&&this.matchesDeactivateNavigationMode(e)&&((o=(i=this.navigator)===null||i===void 0?void 0:i.clean)===null||o===void 0||o.call(i,t.root),this.clean(),this.mode===Mi.POSITION?this.tool.actionDispatcher.dispatchAll([Qh.EnableDefaultToolsAction.create(),Jh.ShowToastMessageAction.createWithTimeout({id:Symbol.for(Fs.name),message:Xh.navigation.local_navigation_mode_deactivated})]):this.mode===Mi.DEFAULT&&this.tool.actionDispatcher.dispatchAll([Qh.EnableDefaultToolsAction.create(),Jh.ShowToastMessageAction.createWithTimeout({id:Symbol.for(Fs.name),message:Xh.navigation.default_navigation_mode_deactivated})]),this.mode=Mi.NONE)}triggerPositionNavigationOnEvent(e,t){return this.matchesActivatePositionNavigation(e)?(this.mode!==Mi.POSITION?(this.clean(),this.tool.actionDispatcher.dispatchAll([Qh.EnableToolsAction.create([_a.ID,HK.SearchAutocompletePaletteTool.ID,xK.AccessibleKeyShortcutTool.ID]),Jh.ShowToastMessageAction.create({id:Symbol.for(Fs.name),message:Xh.navigation.local_navigation_mode_activated})]),this.navigator=this.tool.elementNavigator,this.mode=Mi.POSITION):this.resetPositionNavigationOnEvent(e,t),!0):!1}resetPositionNavigationOnEvent(e,t){var i,o;this.mode===Mi.POSITION&&this.matchesActivatePositionNavigation(e)&&((o=(i=this.navigator)===null||i===void 0?void 0:i.clean)===null||o===void 0||o.call(i,t.root),this.clean(),this.mode=Mi.NONE,this.tool.actionDispatcher.dispatchAll([Qh.EnableDefaultToolsAction.create(),Jh.ShowToastMessageAction.createWithTimeout({id:Symbol.for(Fs.name),message:Xh.navigation.local_navigation_mode_deactivated})]))}triggerDefaultNavigationOnEvent(e,t){return this.matchesActivateDefaultNavigation(e)?(this.mode!==Mi.DEFAULT?(this.clean(),this.tool.actionDispatcher.dispatchAll([Qh.EnableToolsAction.create([_a.ID,HK.SearchAutocompletePaletteTool.ID,xK.AccessibleKeyShortcutTool.ID]),Jh.ShowToastMessageAction.create({id:Symbol.for(Fs.name),message:Xh.navigation.default_navigation_mode_activated})]),this.navigator=this.tool.localElementNavigator,this.mode=Mi.DEFAULT):this.resetDefaultNavigationOnEvent(e,t),!0):!1}resetDefaultNavigationOnEvent(e,t){var i,o;this.mode===Mi.DEFAULT&&this.matchesActivateDefaultNavigation(e)&&((o=(i=this.navigator)===null||i===void 0?void 0:i.clean)===null||o===void 0||o.call(i,t.root),this.clean(),this.mode=Mi.NONE,this.tool.actionDispatcher.dispatchAll([Qh.EnableDefaultToolsAction.create(),Jh.ShowToastMessageAction.createWithTimeout({id:Symbol.for(Fs.name),message:Xh.navigation.default_navigation_mode_deactivated})]))}navigate(e,t){var i,o,r,s;const a=this.getSelectedElements(e.root),u=a.length>0?a[0]:void 0;if(this.mode!==Mi.NONE&&this.navigator!==void 0&&u!==void 0&&(0,is.isBoundsAware)(u)){(o=(i=this.navigator).clean)===null||o===void 0||o.call(i,u.root,u,this.previousNode);const h=this.navigateOnEvent(t,this.navigator,u);h!==void 0&&((s=(r=this.navigator).process)===null||s===void 0||s.call(r,u.root,u,h,this.previousNode));const g=h?(0,is.findParentByFeature)(h,is.isSelectable):void 0;if(g){u instanceof MCe.GEdge||(this.previousNode=u);const y=a.map(S=>S.id).filter(S=>S!==g.id);return[is.SelectAction.create({selectedElementsIDs:[g.id],deselectedElementsIDs:y}),ACe.RepositionAction.create([g.id])]}}return[]}navigateOnEvent(e,t,i){var o,r;if(this.matchesNavigatePrevious(e))return t.previous(i.root,i);if(this.matchesNavigateNext(e))return t.next(i.root,i);if(this.matchesNavigateUp(e))return(o=t.up)===null||o===void 0?void 0:o.call(t,i.root,i,this.previousNode);if(this.matchesNavigateDown(e))return(r=t.down)===null||r===void 0?void 0:r.call(t,i.root,i,this.previousNode)}clean(){this.previousNode=void 0,this.navigator=void 0}getSelectedElements(e){return(0,PCe.toArray)(e.index.all().filter(t=>(0,is.isSelected)(t)))}matchesDeactivateNavigationMode(e){return(0,al.matchesKeystroke)(e,"Escape")}matchesActivateDefaultNavigation(e){return(0,al.matchesKeystroke)(e,"KeyN")}matchesActivatePositionNavigation(e){return(0,al.matchesKeystroke)(e,"KeyN","alt")}matchesNavigatePrevious(e){return(0,al.matchesKeystroke)(e,"ArrowLeft")}matchesNavigateNext(e){return(0,al.matchesKeystroke)(e,"ArrowRight")}matchesNavigateUp(e){return(0,al.matchesKeystroke)(e,"ArrowUp")}matchesNavigateDown(e){return(0,al.matchesKeystroke)(e,"ArrowDown")}}va.ElementNavigatorKeyListener=Fs;var v1={},L9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},vW=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(v1,"__esModule",{value:!0});v1.LocalElementNavigator=void 0;const Dy=z,JP=k,ICe=Pt,KK=it,Mv=ni;let Oy=class{constructor(){this.navigableElementCSS="navigable-element"}previous(e,t,i,o){return this.getPreviousElement(t,o)}next(e,t,i,o){return this.getNextElement(t,o)}up(e,t,i,o){return this.getIterable(t,i,o)}down(e,t,i,o){return this.getIterable(t,i,o)}process(e,t,i,o,r){let s=[];i instanceof Mv.GEdge&&(t instanceof Mv.GEdge?s=this.getIterables(i,t.source===i.source?t.source:t.target,r):s=this.getIterables(i,t,r)),s.filter(a=>a.id!==i.id).forEach(a=>this.actionDispatcher.dispatch((0,KK.applyCssClasses)(a,this.navigableElementCSS)))}clean(e,t,i){e.index.all().forEach(o=>this.actionDispatcher.dispatch((0,KK.deleteCssClasses)(o,this.navigableElementCSS)))}getIterables(e,t,i=()=>!0){var o,r;const s=[];return e instanceof Mv.GEdge&&(e.target===t?(o=e.target)===null||o===void 0||o.incomingEdges.forEach(a=>s.push(a)):(r=e.source)===null||r===void 0||r.outgoingEdges.forEach(a=>s.push(a))),s.filter(i)}getIterable(e,t,i=()=>!0){return this.getIterables(e,t,i).filter(o=>o.id!==e.id)[0]}getNextElement(e,t=()=>!0){const i=[];if(e instanceof Dy.GConnectableElement)e.outgoingEdges.forEach(o=>i.push(o));else if(e instanceof Mv.GEdge){const o=e.target;i.push(o)}return i.filter(t)[0]}getPreviousElement(e,t=()=>!0){const i=[];if(e instanceof Dy.GConnectableElement)e.incomingEdges.forEach(o=>i.push(o));else if(e instanceof Mv.GEdge){const o=e.source;i.push(o)}return i.filter(t)[0]}};v1.LocalElementNavigator=Oy;L9([(0,JP.inject)(Dy.EdgeRouterRegistry),(0,JP.optional)(),vW("design:type",Dy.EdgeRouterRegistry)],Oy.prototype,"edgeRouterRegistry",void 0);L9([(0,JP.inject)(Dy.TYPES.IActionDispatcher),vW("design:type",ICe.GLSPActionDispatcher)],Oy.prototype,"actionDispatcher",void 0);v1.LocalElementNavigator=Oy=L9([(0,JP.injectable)()],Oy);var _1={},_W=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},TCe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(_1,"__esModule",{value:!0});_1.PositionNavigator=void 0;const yW=k,DCe=Io,Vv=z,OCe=Pt;let ew=class{previous(e,t,i,o){return this.getNearestElement(e,t,r=>this.bounds(e,r).x<this.bounds(e,t).x)}next(e,t,i,o){return this.getNearestElement(e,t,r=>this.bounds(e,r).x>this.bounds(e,t).x)}up(e,t,i,o){return this.getNearestElement(e,t,r=>this.bounds(e,r).y<this.bounds(e,t).y)}down(e,t,i,o){return this.getNearestElement(e,t,r=>this.bounds(e,r).y>this.bounds(e,t).y)}getNearestElement(e,t,i){const o=this.boundElements(e).filter(i);return this.sortByDistance(e,t,o)[0]}sortByDistance(e,t,i){const o=(r,s)=>{const a=s.x-r.x,u=s.y-r.y;return Math.sqrt(a*a+u*u)};return i.sort((r,s)=>o(this.bounds(e,r),this.bounds(e,t))-o(this.bounds(e,s),this.bounds(e,t)))}boundElements(e){return(0,DCe.toArray)(e.index.all().filter(t=>t instanceof Vv.GNode&&(0,Vv.isSelectable)(t)&&(0,Vv.isBoundsAware)(t)))}bounds(e,t){return this.boundsInViewport(t,t.bounds,e)}boundsInViewport(e,t,i){return e instanceof Vv.GChildElement&&e.parent!==i?this.boundsInViewport(e.parent,e.parent.localToParent(t),i):t}};_1.PositionNavigator=ew;_W([(0,yW.inject)(Vv.TYPES.IActionDispatcher),TCe("design:type",OCe.GLSPActionDispatcher)],ew.prototype,"actionDispatcher",void 0);_1.PositionNavigator=ew=_W([(0,yW.injectable)()],ew);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.glspElementNavigationModule=n.configureElementNavigationTool=n.elementNavigationModule=void 0;const e=z,t=va,i=v1,o=_1;n.elementNavigationModule=new e.FeatureModule((s,a,u,h)=>{r({bind:s,unbind:a,isBound:u,rebind:h})},{featureId:Symbol("elementNavigation")}),n.glspElementNavigationModule=n.elementNavigationModule;function r(s){(0,e.bindAsService)(s,e.TYPES.IDefaultTool,t.ElementNavigatorTool),(0,e.bindAsService)(s,e.TYPES.IElementNavigator,o.PositionNavigator),(0,e.bindAsService)(s,e.TYPES.ILocalElementNavigator,i.LocalElementNavigator)}n.configureElementNavigationTool=r})(T9);var j9={},y1={},N9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},bW=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},C3;Object.defineProperty(y1,"__esModule",{value:!0});y1.FocusTrackerTool=void 0;const B9=k,SW=z,LCe=Pt,jCe=Vb,NCe=ar;let Cm=C3=class{constructor(){this.isEditTool=!1,this.focusInFunction=e=>this.focusIn(e),this.focusOutFunction=e=>this.focusOut(e),this.registered=!1}get id(){return C3.ID}enable(){this.registered||(document.addEventListener("focusin",this.focusInFunction),document.addEventListener("focusout",this.focusOutFunction)),this.registered=!0}disable(){}async focusOut(e){await this.showToast("Focus not set")}async focusIn(e){let t;const i=e.target;if(i instanceof HTMLElement){const o=this.parentWithAriaLabel(i),r=this.handleTextNode(i);i.ariaLabel!==null?t=this.handleAriaLabel(i):o===void 0&&r!==void 0?t=r:o!==void 0&&r===void 0?t=`Focus is in ${o.ariaLabel}`:o!==void 0&&r!==void 0&&(t=`${o.ariaLabel} -> ${r}`)}await this.showToast(t)}handleTextNode(e){const t=Array.prototype.filter.call(e.childNodes,i=>i.nodeType===Node.TEXT_NODE).map(i=>i.textContent).join("");if(t.trim().length!==0)return t}handleAriaLabel(e){return e.ariaLabel===null?void 0:e.ariaLabel}showToast(e){return this.actionDispatcher.dispatchAll([NCe.ShowToastMessageAction.create({id:Symbol.for(C3.ID),message:`${jCe.focus.focus_on} ${e??"unknown"}`,position:"left"})])}parentWithAriaLabel(e){let t=e.parentElement;for(;t!==null&&t!==document.body&&t!==document.getElementById(this.viewerOptions.baseDiv)&&t.ariaLabel===null;)t=t.parentElement;if(!(t===document.getElementById(this.viewerOptions.baseDiv)||t===document.body))return t??void 0}};y1.FocusTrackerTool=Cm;Cm.ID="glsp.focus-tracker";N9([(0,B9.inject)(SW.TYPES.IActionDispatcher),bW("design:type",LCe.GLSPActionDispatcher)],Cm.prototype,"actionDispatcher",void 0);N9([(0,B9.inject)(SW.TYPES.ViewerOptions),bW("design:type",Object)],Cm.prototype,"viewerOptions",void 0);y1.FocusTrackerTool=Cm=C3=N9([(0,B9.injectable)()],Cm);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.glspFocusTrackerModule=n.configureFocusTrackerTool=n.focusTrackerModule=void 0;const e=z,t=y1;n.focusTrackerModule=new e.FeatureModule((o,r,s,a)=>{i({bind:o,unbind:r,isBound:s,rebind:a})},{featureId:Symbol("focusTracker")}),n.glspFocusTrackerModule=n.focusTrackerModule;function i(o){(0,e.bindAsService)(o,e.TYPES.IDefaultTool,t.FocusTrackerTool)}n.configureFocusTrackerTool=i})(j9);var $9={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.glspShortcutHelpModule=n.configureShortcutHelpTool=n.shortcutHelpModule=void 0;const e=z,t=to,i=Ac;n.shortcutHelpModule=new e.FeatureModule((r,s,a,u)=>{o({bind:r,unbind:s,isBound:a,rebind:u})},{featureId:Symbol("shortcutHelp")}),n.glspShortcutHelpModule=n.shortcutHelpModule;function o(r){(0,e.bindAsService)(r,e.TYPES.IDefaultTool,i.AccessibleKeyShortcutTool),(0,e.bindAsService)(r,e.TYPES.IUIExtension,t.KeyShortcutUIExtension),(0,e.configureActionHandler)(r,t.SetAccessibleKeyShortcutAction.KIND,t.KeyShortcutUIExtension)}n.configureShortcutHelpTool=o})($9);var cf={},b1={};Object.defineProperty(b1,"__esModule",{value:!0});b1.SetEdgeTargetSelectionAction=void 0;const oD=z;var VK;(function(n){n.KIND="setEdgeTargetSelectionAction";function e(i){return oD.Action.hasKind(i,n.KIND)&&(0,oD.hasStringProp)(i,"elementId")&&(0,oD.hasObjectProp)(i,"context")}n.is=e;function t(i,o){return{kind:n.KIND,elementId:i,context:o}}n.create=t})(VK||(b1.SetEdgeTargetSelectionAction=VK={}));var tr={},EW=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(tr,"__esModule",{value:!0});tr.PossibleEdgeTargetAutocompleteSuggestionProvider=tr.EdgeAutocompletePalette=tr.EdgeAutocompletePaletteMetadata=void 0;const CW=k,Tp=z,BCe=It,$Ce=Io,kCe=Xi,FCe=b1,xCe=uu,HCe=ni;var tw;(function(n){n.ID="edge-autocomplete-palette"})(tw||(tr.EdgeAutocompletePaletteMetadata=tw={}));let _5=class extends kCe.SearchAutocompletePalette{constructor(){super(...arguments),this.targetSuggestionProvider=new nw}id(){return tw.ID}handle(e){Tp.TriggerEdgeCreationAction.is(e)&&(this.context={trigger:e,role:"source"},this.targetSuggestionProvider.setContext(e,this.context))}onBeforeShow(e,t,...i){var o;super.onBeforeShow(e,t,...i),this.autocompleteWidget.inputField.placeholder=`Search for ${(o=this.context)===null||o===void 0?void 0:o.role} elements`}getSuggestionProviders(e,t){return[this.targetSuggestionProvider]}reload(){const e=this.context;this.hide(),this.context=e,this.actionDispatcher.dispatch(Tp.SetUIExtensionVisibilityAction.create({extensionId:tw.ID,visible:!0}))}executeSuggestion(e){var t,i,o,r;const s=(0,xCe.toActionArray)(e)[0];((t=this.context)===null||t===void 0?void 0:t.role)==="source"?(this.context.sourceId=s.elementId,this.context.role="target",this.reload()):((i=this.context)===null||i===void 0?void 0:i.role)==="target"&&(this.context.targetId=s.elementId),((o=this.context)===null||o===void 0?void 0:o.sourceId)!==void 0&&((r=this.context)===null||r===void 0?void 0:r.targetId)!==void 0&&(this.actionDispatcher.dispatchAll([Tp.CreateEdgeOperation.create({elementTypeId:this.context.trigger.elementTypeId,sourceElementId:this.context.sourceId,targetElementId:this.context.targetId,args:this.context.trigger.args}),BCe.EnableDefaultToolsAction.create()]),this.hide())}autocompleteHide(e){e!=="submission"&&this.hide()}};tr.EdgeAutocompletePalette=_5;tr.EdgeAutocompletePalette=_5=EW([(0,CW.injectable)()],_5);let nw=class{setContext(e,t){this.proxyEdge=new HCe.GEdge,this.proxyEdge.type=e.elementTypeId,this.context=t}isAllowedSource(e,t){return e!==void 0&&this.proxyEdge!==void 0&&(0,Tp.isConnectable)(e)&&e.canConnect(this.proxyEdge,t)}async retrieveSuggestions(e,t){const i=this.context;return this.context===void 0?[]:(0,$Ce.toArray)(e.index.all().filter(r=>this.isAllowedSource(r,i.role))).map(r=>{var s;return{element:r,action:{label:`[${r.type}] ${(s=(0,Tp.name)(r))!==null&&s!==void 0?s:"<no-name>"}`,actions:[FCe.SetEdgeTargetSelectionAction.create(r.id,i.role)],icon:(0,Tp.codiconCSSString)("arrow-both")}}})}};tr.PossibleEdgeTargetAutocompleteSuggestionProvider=nw;tr.PossibleEdgeTargetAutocompleteSuggestionProvider=nw=EW([(0,CW.injectable)()],nw);var Mu={},PW=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},KCe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},y5;Object.defineProperty(Mu,"__esModule",{value:!0});Mu.EdgeAutocompletePaletteKeyListener=Mu.EdgeAutocompletePaletteTool=void 0;const wW=k,iw=z,VCe=qt,zCe=tr;let Ly=y5=class{constructor(){this.keyListener=new AW}get id(){return y5.ID}enable(){this.keyTool.register(this.keyListener)}disable(){this.keyTool.deregister(this.keyListener)}};Mu.EdgeAutocompletePaletteTool=Ly;Ly.ID="glsp.edge-autocomplete-palette-tool";PW([(0,wW.inject)(iw.KeyTool),KCe("design:type",iw.KeyTool)],Ly.prototype,"keyTool",void 0);Mu.EdgeAutocompletePaletteTool=Ly=y5=PW([(0,wW.injectable)()],Ly);class AW extends iw.KeyListener{keyDown(e,t){return(0,VCe.matchesKeystroke)(t,"Escape")?[iw.SetUIExtensionVisibilityAction.create({extensionId:zCe.EdgeAutocompletePaletteMetadata.ID,visible:!1,contextElementsId:[]})]:[]}}Mu.EdgeAutocompletePaletteKeyListener=AW;var S1={},Br={};Object.defineProperty(Br,"__esModule",{value:!0});Br.KeyboardNodeGridMetadata=Br.KeyboardGridMetadata=void 0;var zK;(function(n){n.ID="keyboard-grid",n.TAB_INDEX=15})(zK||(Br.KeyboardGridMetadata=zK={}));var GK;(function(n){n.ID="keyboard-node-grid"})(GK||(Br.KeyboardNodeGridMetadata=GK={}));var Wc={};Object.defineProperty(Wc,"__esModule",{value:!0});Wc.KeyboardPointerMetadata=void 0;var UK;(function(n){n.ID="keyboard-pointer",n.CRICLE_HEIGHT=16,n.CIRCLE_WIDTH=16,n.TAB_INDEX=10})(UK||(Wc.KeyboardPointerMetadata=UK={}));var ch={},GCe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(ch,"__esModule",{value:!0});ch.KeyboardToolPalette=void 0;const cl=z,UCe=k,dl=qt,rD=It,Kn=Tn,YCe=mi,qCe=eo,WCe=qc,ZCe=tr,QCe=va,XCe=Br,JCe=Vb,ePe=ar,tPe="search",nPe="tools",YK="chevron-right",iPe="500px",RW=["Digit1","Numpad1"],MW=["Digit2","Numpad2"],IW=["Digit3","Numpad3"],TW=["Digit4","Numpad4"],DW=["Digit5","Numpad5"],sD="accessibility-show-shortcuts",Iv=["KeyA","KeyB","KeyC","KeyD","KeyE","KeyF","KeyG","KeyH","KeyI","KeyJ","KeyK","KeyL","KeyM","KeyN","KeyO","KeyP","KeyQ","KeyR","KeyS","KeyT","KeyU","KeyV","KeyX","KeyY","KeyZ"],aD=[RW,MW,IW,TW,DW];let b5=class extends Kn.ToolPalette{constructor(){super(...arguments),this.keyboardIndexButtonMapping=new Map,this.headerToolsButtonMapping=new Map}get interactablePaletteItems(){return this.paletteItems.sort(Kn.compare).map(e=>{var t,i;return(i=(t=e.children)===null||t===void 0?void 0:t.sort(Kn.compare))!==null&&i!==void 0?i:[e]}).reduce((e,t)=>e.concat(t),[])}initializeContents(e){this.containerElement.setAttribute("aria-label","Tool Palette"),this.containerElement.tabIndex=20,this.containerElement.classList.add("accessibility-tool-palette"),this.createHeader(),this.createBody(),this.lastActiveButton=this.defaultToolsButton,this.containerElement.onkeyup=t=>{this.clearToolOnEscape(t),this.isShortcutsVisible()&&(this.selectItemOnCharacter(t),this.triggerHeaderToolsByKey(t))}}handle(e){if(Kn.EnableToolPaletteAction.is(e)){const t=cl.RequestContextActions.create({contextId:Kn.ToolPalette.ID,editorContext:{selectedElementIds:[]}});this.actionDispatcher.requestUntil(t).then(i=>{cl.SetContextActions.is(i)&&(this.paletteItems=i.actions.map(o=>o),this.actionDispatcher.dispatchAll([cl.SetUIExtensionVisibilityAction.create({extensionId:Kn.ToolPalette.ID,visible:!this.editorContext.isReadonly})]))})}else WCe.FocusDomAction.is(e)&&e.id===Kn.ToolPalette.ID?(this.containerElement.contains(document.activeElement)?this.toggleShortcutVisibility():this.showShortcuts(),this.containerElement.focus()):super.handle(e)}addMinimizePaletteButton(){const e=document.getElementById(this.options.baseDiv),t=document.createElement("div");if(t.classList.add("minimize-palette-button"),this.containerElement.classList.add("collapsible-palette"),e){const i=e.insertBefore(t,e.firstChild),o=(0,Kn.createIcon)(YK);this.updateMinimizePaletteButtonTooltip(t),o.onclick=r=>{this.isPaletteMaximized()?(this.containerElement.style.overflow="hidden",this.containerElement.style.maxHeight="0px"):(this.containerElement.style.overflow="visible",this.containerElement.style.maxHeight=iPe),this.updateMinimizePaletteButtonTooltip(t),(0,Kn.changeCodiconClass)(o,nPe),(0,Kn.changeCodiconClass)(o,YK)},i.appendChild(o)}}createBody(){const e=document.createElement("div");e.classList.add("palette-body");const t=21;let i=0;if(this.keyboardIndexButtonMapping.clear(),this.paletteItems.sort(Kn.compare).forEach(o=>{if(o.children){const r=(0,Kn.createToolGroup)(o);o.children.sort(Kn.compare).forEach(s=>{const a=this.createKeyboardToolButton(s,t,i);r.appendChild(a),this.keyboardIndexButtonMapping.set(i,a),i++}),e.appendChild(r)}else{const r=this.createKeyboardToolButton(o,t,i);e.appendChild(r),this.keyboardIndexButtonMapping.set(i,r),i++}}),this.paletteItems.length===0){const o=document.createElement("div");o.innerText="No results found.",o.classList.add("tool-button"),e.appendChild(o)}this.bodyDiv&&this.containerElement.removeChild(this.bodyDiv),this.containerElement.appendChild(e),this.bodyDiv=e}createHeaderTools(){this.headerToolsButtonMapping.clear();let e=0;const t=document.createElement("div");t.classList.add("header-tools"),this.defaultToolsButton=this.createDefaultToolButton(),this.headerToolsButtonMapping.set(e++,this.defaultToolsButton),t.appendChild(this.defaultToolsButton),this.deleteToolButton=this.createMouseDeleteToolButton(),this.headerToolsButtonMapping.set(e++,this.deleteToolButton),t.appendChild(this.deleteToolButton),this.marqueeToolButton=this.createMarqueeToolButton(),this.headerToolsButtonMapping.set(e++,this.marqueeToolButton),t.appendChild(this.marqueeToolButton),this.validateToolButton=this.createValidateButton(),this.headerToolsButtonMapping.set(e++,this.validateToolButton),t.appendChild(this.validateToolButton);const i=this.createResetViewportButton();if(this.headerToolsButtonMapping.set(e++,i),t.appendChild(i),this.gridManager){const o=this.createToggleGridButton();this.headerToolsButtonMapping.set(e++,o),t.appendChild(o)}if(this.debugManager){const o=this.createToggleDebugButton();this.headerToolsButtonMapping.set(e++,o),t.appendChild(o)}return this.searchToolButton=this.createSearchButton(),this.headerToolsButtonMapping.set(e++,this.searchToolButton),t.appendChild(this.searchToolButton),t}createDefaultToolButton(){const e=(0,Kn.createIcon)("inspect");return e.id="btn_default_tools",e.title="Enable selection tool",e.onclick=this.onClickStaticToolButton(e),e.appendChild(this.createKeyboardShotcut(RW[0])),e}createMouseDeleteToolButton(){const e=(0,Kn.createIcon)("chrome-close");return e.title="Enable deletion tool",e.onclick=this.onClickStaticToolButton(e,YCe.MouseDeleteTool.ID),e.appendChild(this.createKeyboardShotcut(MW[0])),e}createMarqueeToolButton(){const e=(0,Kn.createIcon)("screen-full");e.title="Enable marquee tool";const t=ePe.ShowToastMessageAction.createWithTimeout({id:Symbol.for(QCe.ElementNavigatorKeyListener.name),message:JCe.tool_palette.marqueeTool});return e.onclick=this.onClickStaticToolButton(e,qCe.MarqueeMouseTool.ID,t),e.appendChild(this.createKeyboardShotcut(IW[0])),e}createValidateButton(){const e=(0,Kn.createIcon)("pass");return e.title="Validate model",e.onclick=t=>{const i=[this.modelRootId];this.actionDispatcher.dispatch(cl.RequestMarkersAction.create(i))},e.appendChild(this.createKeyboardShotcut(TW[0])),e}onClickStaticToolButton(e,t,i){return o=>{if(!this.editorContext.isReadonly){const r=t?rD.EnableToolsAction.create([t]):rD.EnableDefaultToolsAction.create();i?this.actionDispatcher.dispatchAll([r,i]):this.actionDispatcher.dispatchAll([r]),this.changeActiveButton(e),e.focus()}}}createSearchButton(){const e=(0,Kn.createIcon)(tPe);return e.onclick=t=>{const i=document.getElementById(this.containerElement.id+"_search_field");i&&(i.style.display==="none"?(i.style.display="",i.focus()):i.style.display="none")},e.classList.add("search-icon"),e.title="Filter palette entries",e.appendChild(this.createKeyboardShotcut(DW[0])),e}createHeaderSearchField(){const e=document.createElement("input");return e.classList.add("search-input"),e.tabIndex=21,e.id=this.containerElement.id+"_search_field",e.type="text",e.placeholder="Search...",e.style.display="none",e.onkeyup=t=>{this.requestFilterUpdate(this.searchField.value),t.stopPropagation(),e.value===""?this.focusToolPaletteOnEscape(t):this.clearOnEscape(t)},e}focusToolPaletteOnEscape(e){(0,dl.matchesKeystroke)(e,"Escape")&&this.containerElement.focus()}createKeyboardShotcut(e){const t=document.createElement("div");t.classList.add("key-shortcut");let i=e.toString();return e.includes("Key")?i=e.toString().substring(3):e.includes("Digit")&&(i=e.toString().substring(5)),t.innerHTML=i,t}createKeyboardToolButton(e,t,i){const o=document.createElement("div");return i<Iv.length&&o.appendChild(this.createKeyboardShotcut(Iv[i])),o.tabIndex=t,o.classList.add("tool-button"),e.icon&&o.appendChild((0,Kn.createIcon)(e.icon)),o.insertAdjacentText("beforeend",e.label),o.onclick=this.onClickCreateToolButton(o,e),o.onkeydown=r=>{this.clickToolOnEnter(r,o,e),this.clearToolOnEscape(r),(0,dl.matchesKeystroke)(r,"ArrowDown")?i+1>this.keyboardIndexButtonMapping.size-1?this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(0)):this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(i+1)):(0,dl.matchesKeystroke)(r,"ArrowUp")&&(i-1<0?this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(this.keyboardIndexButtonMapping.size-1)):this.selectItemViaArrowKey(this.keyboardIndexButtonMapping.get(i-1)))},o}clickToolOnEnter(e,t,i){(0,dl.matchesKeystroke)(e,"Enter")&&(this.editorContext.isReadonly||(this.actionDispatcher.dispatchAll(i.actions),this.changeActiveButton(t),this.selectItemOnCharacter(e)))}selectItemOnCharacter(e){var t;let i;const o=this.interactablePaletteItems,r=o.length<Iv.length?o.length:Iv.length;for(let s=0;s<r;s++){const a=Iv[s];if((0,dl.matchesKeystroke)(e,a)){i=s;break}}i!==void 0&&(o[i].actions.some(s=>s.kind===cl.TriggerNodeCreationAction.KIND)?this.actionDispatcher.dispatchAll([...o[i].actions,cl.SetUIExtensionVisibilityAction.create({extensionId:XCe.KeyboardNodeGridMetadata.ID,visible:!0,contextElementsId:[]})]):this.actionDispatcher.dispatchAll([...o[i].actions,cl.SetUIExtensionVisibilityAction.create({extensionId:ZCe.EdgeAutocompletePaletteMetadata.ID,visible:!0,contextElementsId:[]})]),this.changeActiveButton(this.keyboardIndexButtonMapping.get(i)),(t=this.keyboardIndexButtonMapping.get(i))===null||t===void 0||t.focus())}triggerHeaderToolsByKey(e){var t;let i;for(let o=0;o<aD.length;o++)for(let r=0;r<aD[o].length;r++){const s=aD[o][r];if((0,dl.matchesKeystroke)(e,s)){e.stopPropagation(),e.preventDefault(),i=o;break}}i!==void 0&&((t=this.headerToolsButtonMapping.get(i))===null||t===void 0||t.click())}selectItemViaArrowKey(e){e!==void 0&&(this.changeActiveButton(e),e==null||e.focus())}clearToolOnEscape(e){(0,dl.matchesKeystroke)(e,"Escape")&&(e.target instanceof HTMLElement&&e.target.blur(),this.actionDispatcher.dispatch(rD.EnableDefaultToolsAction.create()))}toggleShortcutVisibility(){this.isShortcutsVisible()?this.hideShortcuts():this.showShortcuts()}isShortcutsVisible(){return this.containerElement.classList.contains(sD)}showShortcuts(){this.containerElement.classList.add(sD)}hideShortcuts(){this.containerElement.classList.remove(sD)}};ch.KeyboardToolPalette=b5;ch.KeyboardToolPalette=b5=GCe([(0,UCe.injectable)()],b5);var OW=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},oPe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},S5;Object.defineProperty(S1,"__esModule",{value:!0});S1.GlobalKeyListenerTool=void 0;const LW=k,cD=z,dD=qt,rPe=Tn,qK=qc,WK=Br,sPe=Wc,ZK=to,QK=Pt,aPe=ch;let jy=S5=class{constructor(){this.isEditTool=!1,this.alreadyRegistered=!1}get id(){return S5.ID}enable(){this.alreadyRegistered||(this.alreadyRegistered=!0,document.addEventListener("keyup",this.trigger.bind(this)),this.registerShortcutKey())}disable(){}registerShortcutKey(){this.actionDispatcher.onceModelInitialized().then(()=>{this.actionDispatcher.dispatchAll([ZK.SetAccessibleKeyShortcutAction.create({token:aPe.KeyboardToolPalette.name,keys:[{shortcuts:["ALT","P"],description:"Focus on tool palette",group:"Tool-Palette",position:0}]}),ZK.SetAccessibleKeyShortcutAction.create({token:"Graph",keys:[{shortcuts:["ALT","G"],description:"Focus on graph",group:"Graph",position:0}]})])})}trigger(e){this.actionDispatcher.dispatchAll(this.handleKeyEvent(e))}handleKeyEvent(e){return this.matchesSetFocusOnToolPalette(e)?[qK.FocusDomAction.create(rPe.ToolPalette.ID)]:this.matchesSetFocusOnDiagram(e)?[qK.FocusDomAction.create("graph")]:this.matchesReleaseFocusFromToolPalette(e)?[cD.SetUIExtensionVisibilityAction.create({extensionId:sPe.KeyboardPointerMetadata.ID,visible:!1,contextElementsId:[]}),cD.SetUIExtensionVisibilityAction.create({extensionId:WK.KeyboardGridMetadata.ID,visible:!1,contextElementsId:[]}),cD.SetUIExtensionVisibilityAction.create({extensionId:WK.KeyboardNodeGridMetadata.ID,visible:!1,contextElementsId:[]})]:[]}matchesSetFocusOnToolPalette(e){return(0,dD.matchesKeystroke)(e,"KeyP","alt")}matchesSetFocusOnDiagram(e){return(0,dD.matchesKeystroke)(e,"KeyG","alt")}matchesReleaseFocusFromToolPalette(e){return(0,dD.matchesKeystroke)(e,"Escape")}};S1.GlobalKeyListenerTool=jy;jy.ID="glsp.global-key-listener";OW([(0,LW.inject)(QK.GLSPActionDispatcher),oPe("design:type",QK.GLSPActionDispatcher)],jy.prototype,"actionDispatcher",void 0);S1.GlobalKeyListenerTool=jy=S5=OW([(0,LW.injectable)()],jy);var nr={};Object.defineProperty(nr,"__esModule",{value:!0});nr.KeyboardGridKeyboardEventAction=nr.KeyboardGridCellSelectedAction=nr.EnableKeyboardGridAction=void 0;const Pm=z;var XK;(function(n){n.KIND="enableKeyboardGrid";function e(i){return Pm.Action.hasKind(i,n.KIND)&&(0,Pm.hasObjectProp)(i,"options")}n.is=e;function t(i){return{kind:n.KIND,options:i}}n.create=t})(XK||(nr.EnableKeyboardGridAction=XK={}));var JK;(function(n){n.KIND="keyboardGridCellSelectedAction";function e(i){return Pm.Action.hasKind(i,n.KIND)&&(0,Pm.hasObjectProp)(i,"options")}n.is=e;function t(i){return{kind:n.KIND,options:i}}n.create=t})(JK||(nr.KeyboardGridCellSelectedAction=JK={}));var eV;(function(n){n.KIND="keyboardGridKeyboardEvent";function e(i){return Pm.Action.hasKind(i,n.KIND)&&(0,Pm.hasObjectProp)(i,"options")}n.is=e;function t(i){return{kind:n.KIND,options:i}}n.create=t})(eV||(nr.KeyboardGridKeyboardEventAction=eV={}));var dh={},jW=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},cPe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(dh,"__esModule",{value:!0});dh.KeyboardGrid=void 0;const E5=z,NW=k,uD=qt,dPe=Ms,lD=nr,FE=Br;let ow=class extends dPe.GLSPAbstractUIExtension{constructor(){super(...arguments),this.triggerActions=[]}id(){return FE.KeyboardGridMetadata.ID}containerClass(){return FE.KeyboardGridMetadata.ID}handle(e){lD.EnableKeyboardGridAction.is(e)&&(this.triggerActions=e.options.triggerActions,this.originId=e.options.originId,this.actionDispatcher.dispatch(E5.SetUIExtensionVisibilityAction.create({extensionId:FE.KeyboardGridMetadata.ID,visible:!0})))}initializeContents(e){e.tabIndex=FE.KeyboardGridMetadata.TAB_INDEX,e.classList.add("grid-container");for(let t=1;t<=9;t++){const i=document.createElement("div"),o=document.createElement("div");o.classList.add("grid-item"),o.id=`keyboard-grid-item-${t}`,i.classList.add("grid-item-number"),i.innerHTML=t.toString(),o.appendChild(i),e.appendChild(o)}this.containerElement.onkeydown=t=>{this.onKeyDown(t)}}onKeyDown(e){this.activateCellIfDigitEvent(e),this.hideIfEscapeEvent(e),this.actionDispatcher.dispatch(lD.KeyboardGridKeyboardEventAction.create({originId:this.originId,event:e}))}setContainerVisible(e){this.containerElement&&(e?(this.containerElement.style.visibility="visible",this.containerElement.style.opacity="0.7"):(this.containerElement.style.visibility="hidden",this.containerElement.style.opacity="0"))}show(e,...t){super.show(e,...t),this.containerElement.focus()}hideIfEscapeEvent(e){this.matchesDeactivateGrid(e)&&this.hide()}activateCellIfDigitEvent(e){let t;for(let i=1;i<=9;i++)if(this.matchesGridBoxAtIndex(e,i)){t=i;break}if(t!==void 0){const i=this.centerPositionOfCell(t);this.dispatchActionsForCell(t,i)}}dispatchActionsForCell(e,t){this.actionDispatcher.dispatchAll([...this.triggerActions,lD.KeyboardGridCellSelectedAction.create({originId:this.originId,cellId:e.toString(),centerCellPosition:t})])}centerPositionOfCell(e){let t=0,i=0;const o=document.getElementById(`keyboard-grid-item-${e}`);if(o!==null){const r=this.getCenterOfCell(o);t=r[0],i=r[1]}return{x:t,y:i}}matchesDeactivateGrid(e){return(0,uD.matchesKeystroke)(e,"Escape")}matchesGridBoxAtIndex(e,t){return(0,uD.matchesKeystroke)(e,"Digit"+t)||(0,uD.matchesKeystroke)(e,"Numpad"+t)}getOffset(e){let t=0,i=0;for(;e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)t+=e.offsetLeft-e.scrollLeft,i+=e.offsetTop-e.scrollTop,e=e.offsetParent;return{top:i,left:t}}getCenterOfCell(e){const t=this.getOffset(e).left,i=this.getOffset(e).top,o=e.offsetWidth,r=e.offsetHeight,s=o/2,a=r/2;return[t+s,i+a]}};dh.KeyboardGrid=ow;jW([(0,NW.inject)(E5.TYPES.IActionDispatcher),cPe("design:type",E5.ActionDispatcher)],ow.prototype,"actionDispatcher",void 0);dh.KeyboardGrid=ow=jW([(0,NW.injectable)()],ow);var qo={},uPe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(qo,"__esModule",{value:!0});qo.GridRevealNamedElementSuggestionProvider=qo.GridRevealEdgeSuggestionProvider=qo.GridSearchPalette=qo.GridSearchPaletteMetadata=void 0;const BW=z,lPe=k,k9=Xi,$W=Br;var C5;(function(n){n.ID="grid-search-palette"})(C5||(qo.GridSearchPaletteMetadata=C5={}));let P5=class extends k9.SearchAutocompletePalette{id(){return C5.ID}getSuggestionProviders(e,t){return[new FW,new kW]}};qo.GridSearchPalette=P5;qo.GridSearchPalette=P5=uPe([(0,lPe.injectable)()],P5);class kW extends k9.RevealEdgeElementAutocompleteSuggestionProvider{getActions(e){return[...super.getActions(e),BW.SetUIExtensionVisibilityAction.create({extensionId:$W.KeyboardGridMetadata.ID,visible:!0})]}}qo.GridRevealEdgeSuggestionProvider=kW;class FW extends k9.RevealNamedElementAutocompleteSuggestionProvider{getActions(e){return[...super.getActions(e),BW.SetUIExtensionVisibilityAction.create({extensionId:$W.KeyboardGridMetadata.ID,visible:!0})]}}qo.GridRevealNamedElementSuggestionProvider=FW;var E1={},uh={},C1={};Object.defineProperty(C1,"__esModule",{value:!0});C1.SetKeyboardPointerRenderPositionAction=void 0;const fD=z;var tV;(function(n){n.KIND="setKeyboardPointerRenderPositionAction";function e(i){return fD.Action.hasKind(i,n.KIND)&&(0,fD.hasNumberProp)(i,"x")&&(0,fD.hasNumberProp)(i,"y")}n.is=e;function t(i,o){return{kind:n.KIND,x:i,y:o}}n.create=t})(tV||(C1.SetKeyboardPointerRenderPositionAction=tV={}));var Ub={};Object.defineProperty(Ub,"__esModule",{value:!0});Ub.KeyboardPointerKeyboardListener=void 0;const xE=z,ul=qt,fPe=Br,hPe=Wc,pPe=It,mPe=it;class gPe{get position(){return this.keyboardPointer.getPosition}constructor(e,t){this.keyboardPointer=e,this.actionDispatcher=t}keyDown(e){this.moveIfArrows(e),this.createIfEnterEvent(e),this.hideIfEscapeEvent(e)}moveIfArrows(e){this.matchesMovePointerDown(e)?(this.position.renderPosition=this.position.calcRelativeRenderPosition(0,10),this.keyboardPointer.render()):this.matchesMovePointerUp(e)?(this.position.renderPosition=this.position.calcRelativeRenderPosition(0,-10),this.keyboardPointer.render()):this.matchesMovePointerRight(e)?(this.position.renderPosition=this.position.calcRelativeRenderPosition(10,0),this.keyboardPointer.render()):this.matchesMovePointerLeft(e)&&(this.position.renderPosition=this.position.calcRelativeRenderPosition(-10,0),this.keyboardPointer.render())}createIfEnterEvent(e){const t=this.keyboardPointer.triggerAction.elementTypeId,{container:i,status:o}=this.position.containableParentAtDiagramPosition(t);if(i!==void 0&&o===mPe.CursorCSS.NODE_CREATION){if(this.matchesConfirmPointerPosition(e)){const r=i.id,s=this.position.diagramPosition;this.actionDispatcher.dispatchAll([xE.SetUIExtensionVisibilityAction.create({extensionId:hPe.KeyboardPointerMetadata.ID,visible:!1,contextElementsId:[]}),xE.SetUIExtensionVisibilityAction.create({extensionId:fPe.KeyboardNodeGridMetadata.ID,visible:!1,contextElementsId:[]}),xE.CreateNodeOperation.create(t,{location:s,containerId:r,args:this.keyboardPointer.triggerAction.args}),pPe.EnableDefaultToolsAction.create()])}else if(this.matchesConfirmPointerPositionAndStayInMode(e)){const r=i.id,s=this.position.diagramPosition;this.actionDispatcher.dispatch(xE.CreateNodeOperation.create(t,{location:s,containerId:r,args:this.keyboardPointer.triggerAction.args}))}}}hideIfEscapeEvent(e){this.matchesDeactivatePointer(e)&&this.keyboardPointer.hide()}matchesDeactivatePointer(e){return(0,ul.matchesKeystroke)(e,"Escape")}matchesConfirmPointerPosition(e){return(0,ul.matchesKeystroke)(e,"Enter")}matchesConfirmPointerPositionAndStayInMode(e){return(0,ul.matchesKeystroke)(e,"Enter","ctrl")}matchesMovePointerLeft(e){return(0,ul.matchesKeystroke)(e,"ArrowLeft")}matchesMovePointerRight(e){return(0,ul.matchesKeystroke)(e,"ArrowRight")}matchesMovePointerUp(e){return(0,ul.matchesKeystroke)(e,"ArrowUp")}matchesMovePointerDown(e){return(0,ul.matchesKeystroke)(e,"ArrowDown")}}Ub.KeyboardPointerKeyboardListener=gPe;var Yb={};Object.defineProperty(Yb,"__esModule",{value:!0});Yb.KeyboardPointerPosition=void 0;const nV=z,iV=it,vPe=Ct,_Pe=Zg,oV=Wc;class yPe{constructor(e){this.keyboardPointer=e,this.renderPosition={x:20,y:20}}get centerizedRenderPosition(){return{x:this.renderPosition.x+oV.KeyboardPointerMetadata.CIRCLE_WIDTH/2,y:this.renderPosition.y+oV.KeyboardPointerMetadata.CRICLE_HEIGHT/2}}get diagramPosition(){return(0,vPe.getAbsolutePositionByPoint)(this.keyboardPointer.editorContextService.modelRoot,this.centerizedRenderPosition)}childrenAtDiagramPosition(){const e=this.diagramPosition;return[this.keyboardPointer.editorContextService.modelRoot,...(0,nV.findChildrenAtPosition)(this.keyboardPointer.editorContextService.modelRoot,e)]}containableParentAtDiagramPosition(e){const t=this.childrenAtDiagramPosition();return this.containableParentOf(t.reverse()[0],e)}calcRelativeRenderPosition(e,t){return{x:this.renderPosition.x+e,y:this.renderPosition.y+t}}containableParentOf(e,t){const i=(0,nV.findParentByFeature)(e,_Pe.isContainable);return{container:i,status:this.keyboardPointer.containerManager.isCreationAllowed(i,t)?iV.CursorCSS.NODE_CREATION:iV.CursorCSS.OPERATION_NOT_ALLOWED}}}Yb.KeyboardPointerPosition=yPe;var F9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},x9=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},bPe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(uh,"__esModule",{value:!0});uh.KeyboardPointer=void 0;const H9=z,rw=k,rV=An,sV=it,SPe=Ms,EPe=zR,CPe=nr,PPe=C1,Tv=Wc,wPe=Ub,APe=Yb;let Ny=class extends SPe.GLSPAbstractUIExtension{constructor(e){super(),this.actionDispatcher=e,this._triggerAction={elementTypeId:"task:automated",kind:"triggerNodeCreation"},this.position=new APe.KeyboardPointerPosition(this),this.keyListener=new wPe.KeyboardPointerKeyboardListener(this,e)}get triggerAction(){return this._triggerAction}get isVisible(){var e;return((e=this.containerElement)===null||e===void 0?void 0:e.style.visibility)==="visible"}get getPosition(){return this.position}get getKeyListener(){return this.keyListener}id(){return Tv.KeyboardPointerMetadata.ID}containerClass(){return Tv.KeyboardPointerMetadata.ID}initializeContents(e){e.style.position="absolute",e.style.height=`${Tv.KeyboardPointerMetadata.CRICLE_HEIGHT}px`,e.style.width=`${Tv.KeyboardPointerMetadata.CIRCLE_WIDTH}px`,e.style.borderRadius="100%"}onBeforeShow(e,t,...i){this.render()}handle(e){H9.TriggerNodeCreationAction.is(e)?this._triggerAction=e:PPe.SetKeyboardPointerRenderPositionAction.is(e)?(this.position.renderPosition={x:e.x,y:e.y},this.render()):CPe.KeyboardGridCellSelectedAction.is(e)&&e.options.originId===Tv.KeyboardPointerMetadata.ID&&(this.position.renderPosition=e.options.centerCellPosition,this.render())}render(){if(this.containerElement!==void 0){const{x:e,y:t}=this.position.renderPosition;this.containerElement.style.left=`${e}px`,this.containerElement.style.top=`${t}px`;const{status:i}=this.position.containableParentAtDiagramPosition(this._triggerAction.elementTypeId);switch(this.containerElement.style.borderStyle="solid",this.containerElement.style.borderWidth="thick",i){case sV.CursorCSS.NODE_CREATION:{this.containerElement.style.borderColor="green";break}case sV.CursorCSS.OPERATION_NOT_ALLOWED:{this.containerElement.style.borderColor="red";break}}}}};uh.KeyboardPointer=Ny;F9([(0,rw.inject)(rV.EditorContextService),x9("design:type",rV.EditorContextService)],Ny.prototype,"editorContextService",void 0);F9([(0,rw.inject)(H9.TYPES.IContainerManager),x9("design:type",EPe.ContainerManager)],Ny.prototype,"containerManager",void 0);uh.KeyboardPointer=Ny=F9([(0,rw.injectable)(),bPe(0,(0,rw.inject)(H9.TYPES.IActionDispatcher)),x9("design:paramtypes",[Object])],Ny);var xW=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},RPe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(E1,"__esModule",{value:!0});E1.KeyboardNodeGrid=void 0;const HW=k,aV=z,MPe=qt,cV=uh,dV=Wc,IPe=qo,TPe=dh,DPe=Br;let sw=class extends TPe.KeyboardGrid{constructor(){super(...arguments),this.triggerActions=[aV.SetUIExtensionVisibilityAction.create({extensionId:dV.KeyboardPointerMetadata.ID,visible:!0})],this.originId=dV.KeyboardPointerMetadata.ID}id(){return DPe.KeyboardNodeGridMetadata.ID}handle(e){}onKeyDown(e){super.onKeyDown(e),this.showSearchOnEvent(e),this.keyboardPointer.isVisible&&this.keyboardPointer.getKeyListener.keyDown(e)}showSearchOnEvent(e){(0,MPe.matchesKeystroke)(e,"KeyF","ctrl")&&(e.preventDefault(),this.actionDispatcher.dispatch(aV.SetUIExtensionVisibilityAction.create({extensionId:IPe.GridSearchPaletteMetadata.ID,visible:!0})),this.hide())}};E1.KeyboardNodeGrid=sw;xW([(0,HW.inject)(cV.KeyboardPointer),RPe("design:type",cV.KeyboardPointer)],sw.prototype,"keyboardPointer",void 0);E1.KeyboardNodeGrid=sw=xW([(0,HW.injectable)()],sw);Object.defineProperty(cf,"__esModule",{value:!0});cf.configureKeyboardControlTools=cf.keyboardControlModule=void 0;const ln=z,OPe=b1,hD=tr,LPe=Mu,jPe=S1,uV=nr,lV=dh,NPe=qo,BPe=E1,$Pe=C1,HE=uh;cf.keyboardControlModule=new ln.FeatureModule((n,e,t,i)=>{KW({bind:n,unbind:e,isBound:t,rebind:i})},{featureId:Symbol("keyboardControl")});function KW(n){(0,ln.bindAsService)(n,ln.TYPES.IDefaultTool,jPe.GlobalKeyListenerTool),(0,ln.bindAsService)(n,ln.TYPES.IUIExtension,HE.KeyboardPointer),(0,ln.bindAsService)(n,ln.TYPES.IUIExtension,lV.KeyboardGrid),(0,ln.bindAsService)(n,ln.TYPES.IUIExtension,BPe.KeyboardNodeGrid),(0,ln.configureActionHandler)(n,ln.TriggerNodeCreationAction.KIND,HE.KeyboardPointer),(0,ln.configureActionHandler)(n,$Pe.SetKeyboardPointerRenderPositionAction.KIND,HE.KeyboardPointer),(0,ln.bindAsService)(n,ln.TYPES.IUIExtension,hD.EdgeAutocompletePalette),(0,ln.bindAsService)(n,ln.TYPES.IDefaultTool,LPe.EdgeAutocompletePaletteTool),(0,ln.configureActionHandler)(n,uV.EnableKeyboardGridAction.KIND,lV.KeyboardGrid),(0,ln.configureActionHandler)(n,uV.KeyboardGridCellSelectedAction.KIND,HE.KeyboardPointer),(0,ln.configureActionHandler)(n,ln.TriggerEdgeCreationAction.KIND,hD.EdgeAutocompletePalette),(0,ln.configureActionHandler)(n,OPe.SetEdgeTargetSelectionAction.KIND,hD.EdgeAutocompletePalette),(0,ln.bindAsService)(n,ln.TYPES.IUIExtension,NPe.GridSearchPalette)}cf.configureKeyboardControlTools=KW;var df={};Object.defineProperty(df,"__esModule",{value:!0});df.configureKeyboardToolPaletteTool=df.keyboardToolPaletteModule=void 0;const Xr=z,kPe=It,FPe=Tn,xPe=qc,ll=ch;df.keyboardToolPaletteModule=new Xr.FeatureModule((n,e,t,i)=>{VW({bind:n,unbind:e,isBound:t,rebind:i})},{featureId:Symbol("keyboardToolPalette")});function VW(n){(0,Xr.bindAsService)(n,Xr.TYPES.IUIExtension,ll.KeyboardToolPalette),n.bind(Xr.TYPES.IDiagramStartup).toService(ll.KeyboardToolPalette),(0,Xr.configureActionHandler)(n,kPe.EnableDefaultToolsAction.KIND,ll.KeyboardToolPalette),(0,Xr.configureActionHandler)(n,xPe.FocusDomAction.KIND,ll.KeyboardToolPalette),(0,Xr.configureActionHandler)(n,FPe.EnableToolPaletteAction.KIND,ll.KeyboardToolPalette),(0,Xr.configureActionHandler)(n,Xr.UpdateModelAction.KIND,ll.KeyboardToolPalette),(0,Xr.configureActionHandler)(n,Xr.SetModelAction.KIND,ll.KeyboardToolPalette)}df.configureKeyboardToolPaletteTool=VW;var uf={},bo={},Ta=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},ra=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(bo,"__esModule",{value:!0});bo.MoveElementHandler=bo.MoveViewportHandler=bo.MoveElementAction=bo.MoveViewportAction=void 0;const ji=z,$r=k,HPe=ah,aw=An,fV=kt,KPe=yn,VPe=Ct;var cw;(function(n){n.KIND="moveViewportAction";function e(i){return ji.Action.hasKind(i,n.KIND)}n.is=e;function t(i,o){return{kind:n.KIND,moveX:i,moveY:o}}n.create=t})(cw||(bo.MoveViewportAction=cw={}));var w5;(function(n){n.KIND="moveElementAction";function e(i){return ji.Action.hasKind(i,n.KIND)}n.is=e;function t(i,o,r,s=!0){return{kind:n.KIND,elementIds:i,moveX:o,moveY:r,snap:s}}n.create=t})(w5||(bo.MoveElementAction=w5={}));let By=class{handle(e){cw.is(e)&&this.handleMoveViewport(e)}handleMoveViewport(e){const t=(0,ji.findParentByFeature)(this.editorContextService.modelRoot,ji.isViewport);t&&this.dispatcher.dispatch(this.moveViewport(t,e.moveX,e.moveY))}moveViewport(e,t,i){const o={scroll:{x:e.scroll.x+t,y:e.scroll.y+i},zoom:e.zoom};return ji.SetViewportAction.create(e.id,o,{animate:!1})}};bo.MoveViewportHandler=By;Ta([(0,$r.inject)(aw.EditorContextService),ra("design:type",aw.EditorContextService)],By.prototype,"editorContextService",void 0);Ta([(0,$r.inject)(ji.TYPES.IActionDispatcher),ra("design:type",Object)],By.prototype,"dispatcher",void 0);bo.MoveViewportHandler=By=Ta([(0,$r.injectable)()],By);let Mc=class{init(){this.moveFeedback=this.feedbackDispatcher.createEmitter()}handle(e){w5.is(e)&&this.handleMoveElement(e)}handleMoveElement(e){const t=this.editorContextService.modelRoot,i=(0,ji.findParentByFeature)(t,ji.isViewport);if(!i)return;const o=[],r=[],s=(0,fV.getElements)(t.index,e.elementIds,fV.isSelectableAndBoundsAware);for(const u of s){const h=this.getTargetBounds(u,e);r.push({elementId:u.id,fromPosition:{x:u.bounds.x,y:u.bounds.y},toPosition:h}),(0,VPe.outsideOfViewport)(h,i)&&o.push(cw.create(e.moveX,e.moveY))}this.dispatcher.dispatchAll(o);const a=ji.MoveAction.create(r,{animate:!1});this.moveFeedback.add(a).submit(),this.scheduleChangeBounds(this.toElementAndBounds(r))}getTargetBounds(e,t){let i=ji.Point.add(e.bounds,{x:t.moveX,y:t.moveY});return this.snapper&&t.snap&&(i=this.snapper.snap(i,e)),(0,KPe.isValidMove)(e,i,this.movementRestrictor)||(i={x:e.bounds.x,y:e.bounds.y}),i}scheduleChangeBounds(e){var t;(t=this.debouncedChangeBounds)===null||t===void 0||t.cancel(),this.debouncedChangeBounds=(0,HPe.debounce)(()=>{this.moveFeedback.dispose(),this.dispatcher.dispatchAll([ji.ChangeBoundsOperation.create(e)]),this.debouncedChangeBounds=void 0},300),this.debouncedChangeBounds()}toElementAndBounds(e){const t=[];for(const i of e){const o=this.editorContextService.modelRoot.index.getById(i.elementId);o&&(0,ji.isBoundsAware)(o)&&t.push({elementId:i.elementId,newSize:{height:o.bounds.height,width:o.bounds.width},newPosition:{x:i.toPosition.x,y:i.toPosition.y}})}return t}};bo.MoveElementHandler=Mc;Ta([(0,$r.inject)(aw.EditorContextService),ra("design:type",aw.EditorContextService)],Mc.prototype,"editorContextService",void 0);Ta([(0,$r.inject)(ji.TYPES.IActionDispatcher),ra("design:type",Object)],Mc.prototype,"dispatcher",void 0);Ta([(0,$r.inject)(ji.TYPES.IFeedbackActionDispatcher),ra("design:type",Object)],Mc.prototype,"feedbackDispatcher",void 0);Ta([(0,$r.inject)(ji.TYPES.ISnapper),(0,$r.optional)(),ra("design:type",Object)],Mc.prototype,"snapper",void 0);Ta([(0,$r.inject)(ji.TYPES.IMovementRestrictor),(0,$r.optional)(),ra("design:type",Object)],Mc.prototype,"movementRestrictor",void 0);Ta([(0,$r.postConstruct)(),ra("design:type",Function),ra("design:paramtypes",[]),ra("design:returntype",void 0)],Mc.prototype,"init",null);bo.MoveElementHandler=Mc=Ta([(0,$r.injectable)()],Mc);var So={},P1=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},eM=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(So,"__esModule",{value:!0});So.ZoomElementHandler=So.ZoomViewportHandler=So.ZoomElementAction=So.ZoomViewportAction=void 0;const w1=k,zW=ah,zo=z,dw=An,hV=kt;var A5;(function(n){n.KIND="zoomViewportAction";function e(i){return zo.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,zoomFactor:i}}n.create=t})(A5||(So.ZoomViewportAction=A5={}));var R5;(function(n){n.KIND="zoomElementAction";function e(i){return zo.Action.hasKind(i,n.KIND)}n.is=e;function t(i,o){return{kind:n.KIND,elementIds:i,zoomFactor:o}}n.create=t})(R5||(So.ZoomElementAction=R5={}));let lf=class{constructor(){this.throttledHandleViewportZoom=(0,zW.throttle)(e=>this.handleZoomViewport(e),150)}handle(e){A5.is(e)&&this.throttledHandleViewportZoom(e)}handleZoomViewport(e){const t=(0,zo.findParentByFeature)(this.editorContextService.modelRoot,zo.isViewport);t&&this.dispatcher.dispatch(this.setNewZoomFactor(t,e.zoomFactor))}setNewZoomFactor(e,t){const i=e.zoom*t,o={scroll:e.scroll,zoom:i};return zo.SetViewportAction.create(e.id,o,{animate:!0})}};So.ZoomViewportHandler=lf;lf.defaultZoomInFactor=1.1;lf.defaultZoomOutFactor=.9;P1([(0,w1.inject)(dw.EditorContextService),eM("design:type",dw.EditorContextService)],lf.prototype,"editorContextService",void 0);P1([(0,w1.inject)(zo.TYPES.IActionDispatcher),eM("design:type",Object)],lf.prototype,"dispatcher",void 0);So.ZoomViewportHandler=lf=P1([(0,w1.injectable)()],lf);let $y=class{constructor(){this.throttledHandleElementZoom=(0,zW.throttle)(e=>this.handleZoomElement(e),150)}handle(e){R5.is(e)&&this.throttledHandleElementZoom(e)}handleZoomElement(e){const t=(0,zo.findParentByFeature)(this.editorContextService.modelRoot,zo.isViewport);if(!t)return;const i=(0,hV.getElements)(this.editorContextService.modelRoot.index,e.elementIds,hV.isSelectableAndBoundsAware),o=this.getCenter(t,i);this.dispatcher.dispatch(this.setNewZoomFactor(t,e.zoomFactor,o))}getCenter(e,t){const o=t.map(r=>this.boundsInViewport(e,r,r.bounds)).reduce((r,s)=>zo.Bounds.combine(r,s));return zo.Bounds.center(o)}boundsInViewport(e,t,i){return t instanceof zo.GChildElement&&t.parent!==e?this.boundsInViewport(e,t.parent,t.parent.localToParent(i)):i}setNewZoomFactor(e,t,i){const o=e.zoom*t,r={scroll:{x:i.x-.5*e.canvasBounds.width/o,y:i.y-.5*e.canvasBounds.height/o},zoom:o};return zo.SetViewportAction.create(e.id,r,{animate:!0})}};So.ZoomElementHandler=$y;P1([(0,w1.inject)(dw.EditorContextService),eM("design:type",dw.EditorContextService)],$y.prototype,"editorContextService",void 0);P1([(0,w1.inject)(zo.TYPES.IActionDispatcher),eM("design:type",Object)],$y.prototype,"dispatcher",void 0);So.ZoomElementHandler=$y=P1([(0,w1.injectable)()],$y);Object.defineProperty(uf,"__esModule",{value:!0});uf.configureMoveZoom=uf.moveZoomModule=void 0;const zv=z,ep=bo,tp=So;uf.moveZoomModule=new zv.FeatureModule((n,e,t,i)=>{GW({bind:n,unbind:e,isBound:t,rebind:i})},{featureId:Symbol("moveZoom")});function GW(n){n.bind(ep.MoveViewportHandler).toSelf().inSingletonScope(),n.bind(ep.MoveElementHandler).toSelf().inSingletonScope(),n.bind(tp.ZoomViewportHandler).toSelf().inSingletonScope(),n.bind(tp.ZoomElementHandler).toSelf().inSingletonScope(),(0,zv.configureActionHandler)(n,ep.MoveViewportAction.KIND,ep.MoveViewportHandler),(0,zv.configureActionHandler)(n,ep.MoveElementAction.KIND,ep.MoveElementHandler),(0,zv.configureActionHandler)(n,tp.ZoomViewportAction.KIND,tp.ZoomViewportHandler),(0,zv.configureActionHandler)(n,tp.ZoomElementAction.KIND,tp.ZoomElementHandler)}uf.configureMoveZoom=GW;var ff={},fs={},A1=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Ud=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},pV=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}},P3;Object.defineProperty(fs,"__esModule",{value:!0});fs.ResizeElementHandler=fs.ResizeElementAction=fs.ResizeType=void 0;const hf=z,rc=k,zPe=ah,mV=An,pD=kt,KE=yn;var g_;(function(n){n[n.Increase=0]="Increase",n[n.Decrease=1]="Decrease",n[n.MinSize=2]="MinSize"})(g_||(fs.ResizeType=g_={}));var M5;(function(n){n.KIND="resizeElementAction";function e(i){return hf.Action.hasKind(i,n.KIND)}n.is=e;function t(i,o){return{kind:n.KIND,elementIds:i,resizeType:o}}n.create=t})(M5||(fs.ResizeElementAction=M5={}));let ya=P3=class{constructor(e){this.snapper=e,this.grid={x:P3.defaultResizeX,y:P3.defaultResizeY},this.isEditMode=!1}init(){this.resizeFeedback=this.feedbackDispatcher.createEmitter()}handle(e){M5.is(e)&&this.handleResizeElement(e)}handleResizeElement(e){var t;const i=(0,pD.getElements)(this.editorContextService.modelRoot.index,e.elementIds,pD.isSelectableAndBoundsAware),o=this.computeElementAndBounds(i,e);this.resizeFeedback.add(hf.SetBoundsAction.create(o)).submit(),(t=this.debouncedChangeBounds)===null||t===void 0||t.cancel(),this.debouncedChangeBounds=(0,zPe.debounce)(()=>{this.resizeFeedback.dispose(),this.dispatcher.dispatchAll([hf.ChangeBoundsOperation.create(o)]),this.debouncedChangeBounds=void 0},300),this.debouncedChangeBounds()}computeElementAndBounds(e,t){const i=[];return e.forEach(o=>{const{x:r,y:s,width:a,height:u}=o.bounds;let h=0,g=0;if(t.resizeType===g_.Decrease?(h=a-this.grid.x,g=u-this.grid.y):t.resizeType===g_.Increase?(h=a+this.grid.x,g=u+this.grid.y):t.resizeType===g_.MinSize&&(h=(0,KE.minWidth)(o),g=(0,KE.minHeight)(o)),this.isValidBoundChange(o,{x:r,y:s},{width:h,height:g})){const y={id:o.id,bounds:{x:r,y:s,width:h,height:g}};i.push((0,pD.toElementAndBounds)(y))}}),i}isValidBoundChange(e,t,i){return(0,KE.isValidSize)(e,i)&&(0,KE.isValidMove)(e,t)}};fs.ResizeElementHandler=ya;ya.defaultResizeX=20;ya.defaultResizeY=20;A1([(0,rc.inject)(mV.EditorContextService),Ud("design:type",mV.EditorContextService)],ya.prototype,"editorContextService",void 0);A1([(0,rc.inject)(hf.TYPES.IActionDispatcher),Ud("design:type",Object)],ya.prototype,"dispatcher",void 0);A1([(0,rc.inject)(hf.TYPES.IFeedbackActionDispatcher),Ud("design:type",Object)],ya.prototype,"feedbackDispatcher",void 0);A1([(0,rc.inject)(hf.TYPES.Grid),(0,rc.optional)(),Ud("design:type",Object)],ya.prototype,"grid",void 0);A1([(0,rc.postConstruct)(),Ud("design:type",Function),Ud("design:paramtypes",[]),Ud("design:returntype",void 0)],ya.prototype,"init",null);fs.ResizeElementHandler=ya=P3=A1([(0,rc.injectable)(),pV(0,(0,rc.inject)(hf.TYPES.ISnapper)),pV(0,(0,rc.optional)()),Ud("design:paramtypes",[Object])],ya);var Ic={},lh=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},R1=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},I5,Gv;Object.defineProperty(Ic,"__esModule",{value:!0});Ic.ResizeKeyListener=Ic.ResizeKeyTool=void 0;const Tc=k,fl=qt,wm=z,GPe=Pt,gV=Yt,vV=It,UPe=to,_V=Vb,yV=ar,np=fs;let Es=I5=class{constructor(){this.isEditTool=!0,this.resizeKeyListener=new uw(this)}get id(){return I5.ID}enable(){this.keytool.register(this.resizeKeyListener),this.resizeKeyListener.registerShortcutKey()}disable(){this.keytool.deregister(this.resizeKeyListener)}};Ic.ResizeKeyTool=Es;Es.ID="glsp.resize-key-tool";lh([(0,Tc.inject)(wm.KeyTool),R1("design:type",wm.KeyTool)],Es.prototype,"keytool",void 0);lh([(0,Tc.inject)(wm.TYPES.IMovementRestrictor),(0,Tc.optional)(),R1("design:type",Object)],Es.prototype,"movementRestrictor",void 0);lh([(0,Tc.inject)(wm.TYPES.ISnapper),(0,Tc.optional)(),R1("design:type",Object)],Es.prototype,"snapper",void 0);lh([(0,Tc.inject)(wm.TYPES.IActionDispatcher),R1("design:type",GPe.GLSPActionDispatcher)],Es.prototype,"actionDispatcher",void 0);lh([(0,Tc.inject)(gV.SelectionService),R1("design:type",gV.SelectionService)],Es.prototype,"selectionService",void 0);Ic.ResizeKeyTool=Es=I5=lh([(0,Tc.injectable)()],Es);let uw=Gv=class extends wm.KeyListener{constructor(e){super(),this.tool=e,this.isEditMode=!1,this.token=Gv.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(UPe.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["ALT","A"],description:"Activate resize mode for selected element",group:"Resize",position:0},{shortcuts:["+"],description:"Increase size of element",group:"Resize",position:1},{shortcuts:["-"],description:"Increase size of element",group:"Resize",position:2},{shortcuts:["CTRL","0"],description:"Set element size to default",group:"Resize",position:3}]}))}keyDown(e,t){const i=[],o=this.tool.selectionService.getSelectedElementIDs();return this.isEditMode&&this.matchesDeactivateResizeModeKeystroke(t)&&(this.isEditMode=!1,this.tool.actionDispatcher.dispatch(yV.ShowToastMessageAction.createWithTimeout({id:Symbol.for(Gv.name),message:_V.resize.resize_mode_deactivated})),i.push(vV.EnableDefaultToolsAction.create())),o.length>0&&(!this.isEditMode&&this.matchesActivateResizeModeKeystroke(t)&&(this.isEditMode=!0,this.tool.actionDispatcher.dispatch(yV.ShowToastMessageAction.create({id:Symbol.for(Gv.name),message:_V.resize.resize_mode_activated})),i.push(vV.EnableToolsAction.create([Es.ID]))),this.isEditMode&&(this.matchesIncreaseSizeKeystroke(t)?i.push(np.ResizeElementAction.create(o,np.ResizeType.Increase)):this.matchesDecreaseSizeKeystroke(t)?i.push(np.ResizeElementAction.create(o,np.ResizeType.Decrease)):this.matchesMinSizeKeystroke(t)&&i.push(np.ResizeElementAction.create(o,np.ResizeType.MinSize)))),i}matchesIncreaseSizeKeystroke(e){return e.key==="+"||(0,fl.matchesKeystroke)(e,"NumpadAdd")}matchesActivateResizeModeKeystroke(e){return(0,fl.matchesKeystroke)(e,"KeyA","alt")}matchesDeactivateResizeModeKeystroke(e){return(0,fl.matchesKeystroke)(e,"Escape")}matchesMinSizeKeystroke(e){return(0,fl.matchesKeystroke)(e,"Digit0","ctrl")||(0,fl.matchesKeystroke)(e,"Numpad0","ctrl")}matchesDecreaseSizeKeystroke(e){return(0,fl.matchesKeystroke)(e,"Minus")||(0,fl.matchesKeystroke)(e,"NumpadSubtract")}};Ic.ResizeKeyListener=uw;Ic.ResizeKeyListener=uw=Gv=lh([(0,Tc.injectable)(),R1("design:paramtypes",[Es])],uw);Object.defineProperty(ff,"__esModule",{value:!0});ff.configureResizeTools=ff.resizeKeyModule=void 0;const w3=z,mD=fs,YPe=Ic;ff.resizeKeyModule=new w3.FeatureModule((n,e,t,i)=>{UW({bind:n,unbind:e,isBound:t,rebind:i})},{featureId:Symbol("resizeKey")});function UW(n){n.bind(mD.ResizeElementHandler).toSelf().inSingletonScope(),(0,w3.configureActionHandler)(n,mD.ResizeElementAction.KIND,mD.ResizeElementHandler),(0,w3.bindAsService)(n,w3.TYPES.IDefaultTool,YPe.ResizeKeyTool)}ff.configureResizeTools=UW;var pf={};Object.defineProperty(pf,"__esModule",{value:!0});pf.configureSearchPaletteModule=pf.searchPaletteModule=void 0;const Uv=z,qPe=Xi,WPe=Rc;pf.searchPaletteModule=new Uv.FeatureModule((n,e,t,i)=>{YW({bind:n,isBound:t,rebind:i})},{featureId:Symbol("searchPalette")});function YW(n){(0,Uv.bindAsService)(n,Uv.TYPES.IUIExtension,qPe.SearchAutocompletePalette),(0,Uv.bindAsService)(n,Uv.TYPES.IDefaultTool,WPe.SearchAutocompletePaletteTool)}pf.configureSearchPaletteModule=YW;var K9={},M1={},V9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},qW=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},A3;Object.defineProperty(M1,"__esModule",{value:!0});M1.Toast=void 0;const ZPe=z,z9=k,QPe=Pt,bV=An,XPe=Ms,SV=ar;let Am=A3=class extends XPe.GLSPAbstractUIExtension{constructor(){super(...arguments),this.messages={}}id(){return A3.ID}containerClass(){return A3.ID}initializeContents(e){this.render()}handle(e){SV.ShowToastMessageAction.is(e)?(this.messages[e.options.id]=e.options,this.render(),e.options.timeout&&setTimeout(()=>{this.delete(e.options.id)},e.options.timeout)):SV.HideToastAction.is(e)&&(e.options.timeout?setTimeout(()=>{this.delete(e.options.id)},e.options.timeout):this.delete(e.options.id))}render(){this.containerElement!==void 0&&(this.containerElement.innerHTML="",this.values(this.messages).forEach(e=>{this.containerElement.appendChild(this.createToastMessage(e))}))}delete(e){delete this.messages[e],this.render()}createToastMessage(e){const t=document.createElement("div");t.classList.add("toast-cell",`toast-column-${e.position}`);const i=document.createElement("div");i.classList.add("toast-container");const o=document.createElement("span");return o.textContent=e.message,i.appendChild(o),t.appendChild(i),t}preInitialize(){this.show(this.editorContext.modelRoot)}values(e){return Object.getOwnPropertySymbols(e).map(t=>e[t])}};M1.Toast=Am;Am.ID="toast";V9([(0,z9.inject)(ZPe.TYPES.IActionDispatcher),qW("design:type",QPe.GLSPActionDispatcher)],Am.prototype,"actionDispatcher",void 0);V9([(0,z9.inject)(bV.EditorContextService),qW("design:type",bV.EditorContextService)],Am.prototype,"editorContext",void 0);M1.Toast=Am=A3=V9([(0,z9.injectable)()],Am);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.glspToastModule=n.configureToastTool=n.toastModule=void 0;const e=z,t=ar,i=M1;n.toastModule=new e.FeatureModule((r,s,a,u)=>{o({bind:r,unbind:s,isBound:a,rebind:u})},{featureId:Symbol("toast")}),n.glspToastModule=n.toastModule;function o(r){(0,e.bindAsService)(r,e.TYPES.IUIExtension,i.Toast),r.bind(e.TYPES.IDiagramStartup).toService(i.Toast),(0,e.configureActionHandler)(r,t.ShowToastMessageAction.KIND,i.Toast),(0,e.configureActionHandler)(r,t.HideToastAction.KIND,i.Toast)}n.configureToastTool=o})(K9);var mf={},Iu={},G9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},WW=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},T5;Object.defineProperty(Iu,"__esModule",{value:!0});Iu.DeselectKeyListener=Iu.DeselectKeyTool=void 0;const wl=z,U9=k,JPe=Io,ewe=qt,twe=mt;let Rm=T5=class{constructor(){this.isEditTool=!0,this.deselectKeyListener=new ZW}get id(){return T5.ID}enable(){this.keytool.register(this.deselectKeyListener)}disable(){this.keytool.deregister(this.deselectKeyListener)}};Iu.DeselectKeyTool=Rm;Rm.ID="glsp.deselect-key-tool";G9([(0,U9.inject)(wl.KeyTool),WW("design:type",wl.KeyTool)],Rm.prototype,"keytool",void 0);G9([(0,U9.inject)(wl.TYPES.IToolManager),WW("design:type",Object)],Rm.prototype,"toolManager",void 0);Iu.DeselectKeyTool=Rm=T5=G9([(0,U9.injectable)()],Rm);class ZW extends wl.KeyListener{keyDown(e,t){if(this.matchesDeselectKeystroke(t)){const i=(0,JPe.toArray)(e.root.index.all().filter(s=>(0,wl.isSelectable)(s)&&s.selected)),o=[];i.length>0&&o.push(wl.SelectAction.create({deselectedElementsIDs:i.map(s=>s.id)}));const r=i.filter(s=>s instanceof wl.GRoutableElement).map(s=>s.id);return r.length>0&&o.push(twe.SwitchRoutingModeAction.create({elementsToDeactivate:r})),o}return[]}matchesDeselectKeystroke(e){return(0,ewe.matchesKeystroke)(e,"Escape")}}Iu.DeselectKeyListener=ZW;var Tu={},fh=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},I1=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},D5;Object.defineProperty(Tu,"__esModule",{value:!0});Tu.MoveKeyListener=Tu.MovementKeyTool=void 0;const gf=z,Dc=k,pd=qt,nwe=Pt,EV=Yt,iwe=to,md=bo;let ba=D5=class{constructor(){this.isEditTool=!0}get id(){return D5.ID}enable(){this.movementKeyListener||(this.movementKeyListener=new Yd(this,this.grid)),this.keytool.register(this.movementKeyListener),this.movementKeyListener.registerShortcutKey()}disable(){this.keytool.deregister(this.movementKeyListener)}};Tu.MovementKeyTool=ba;ba.ID="glsp.movement-key-tool";fh([(0,Dc.inject)(gf.KeyTool),I1("design:type",gf.KeyTool)],ba.prototype,"keytool",void 0);fh([(0,Dc.inject)(EV.SelectionService),I1("design:type",EV.SelectionService)],ba.prototype,"selectionService",void 0);fh([(0,Dc.inject)(gf.TYPES.ISnapper),(0,Dc.optional)(),I1("design:type",Object)],ba.prototype,"snapper",void 0);fh([(0,Dc.inject)(gf.TYPES.IActionDispatcher),I1("design:type",nwe.GLSPActionDispatcher)],ba.prototype,"actionDispatcher",void 0);fh([(0,Dc.inject)(gf.TYPES.Grid),(0,Dc.optional)(),I1("design:type",Object)],ba.prototype,"grid",void 0);fh([(0,Dc.inject)(gf.TYPES.IChangeBoundsManager),I1("design:type",Object)],ba.prototype,"changeBoundsManager",void 0);Tu.MovementKeyTool=ba=D5=fh([(0,Dc.injectable)()],ba);class Yd extends gf.KeyListener{constructor(e,t={x:Yd.defaultMoveX,y:Yd.defaultMoveY}){super(),this.tool=e,this.grid=t,this.token=Yd.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(iwe.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["⬅  ⬆  ➡  ⬇"],description:"Move element or viewport",group:"Move",position:0}]}))}keyDown(e,t){const i=this.tool.selectionService.getSelectedElementIDs(),o=this.tool.changeBoundsManager.usePositionSnap(t),r=o?this.grid.x:1,s=o?this.grid.y:1;if(i.length>0){if(this.matchesMoveUpKeystroke(t))return[md.MoveElementAction.create(i,0,-s,o)];if(this.matchesMoveDownKeystroke(t))return[md.MoveElementAction.create(i,0,s,o)];if(this.matchesMoveRightKeystroke(t))return[md.MoveElementAction.create(i,r,0,o)];if(this.matchesMoveLeftKeystroke(t))return[md.MoveElementAction.create(i,-r,0,o)]}else{if(this.matchesMoveUpKeystroke(t))return[md.MoveViewportAction.create(0,-s)];if(this.matchesMoveDownKeystroke(t))return[md.MoveViewportAction.create(0,s)];if(this.matchesMoveRightKeystroke(t))return[md.MoveViewportAction.create(r,0)];if(this.matchesMoveLeftKeystroke(t))return[md.MoveViewportAction.create(-r,0)]}return[]}matchesMoveUpKeystroke(e){const t=this.tool.changeBoundsManager.unsnapModifier();return(0,pd.matchesKeystroke)(e,"ArrowUp")||!!t&&(0,pd.matchesKeystroke)(e,"ArrowUp",t)}matchesMoveDownKeystroke(e){const t=this.tool.changeBoundsManager.unsnapModifier();return(0,pd.matchesKeystroke)(e,"ArrowDown")||!!t&&(0,pd.matchesKeystroke)(e,"ArrowDown",t)}matchesMoveRightKeystroke(e){const t=this.tool.changeBoundsManager.unsnapModifier();return(0,pd.matchesKeystroke)(e,"ArrowRight")||!!t&&(0,pd.matchesKeystroke)(e,"ArrowRight",t)}matchesMoveLeftKeystroke(e){const t=this.tool.changeBoundsManager.unsnapModifier();return(0,pd.matchesKeystroke)(e,"ArrowLeft")||!!t&&(0,pd.matchesKeystroke)(e,"ArrowLeft",t)}}Tu.MoveKeyListener=Yd;Yd.defaultMoveX=20;Yd.defaultMoveY=20;var Du={},qb=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},tM=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Yv;Object.defineProperty(Du,"__esModule",{value:!0});Du.ZoomKeyListener=Du.ZoomKeyTool=void 0;const Wb=k,El=qt,qd=z,owe=Pt,CV=Yt,rwe=to,VE=So,O5=nr,swe=Ct,PV=An,QW=ar,XW=va,awe=Vb;let Oc=Yv=class{constructor(){this.isEditTool=!1,this.zoomKeyListener=new wr(this)}get id(){return Yv.ID}enable(){this.keytool.register(this.zoomKeyListener),this.zoomKeyListener.registerShortcutKey()}disable(){this.keytool.deregister(this.zoomKeyListener)}handle(e){if((0,qd.isViewport)(this.editorContextService.modelRoot)){let t;O5.KeyboardGridCellSelectedAction.is(e)&&e.options.originId===Yv.ID?t=this.zoomKeyListener.setNewZoomFactor(this.editorContextService.modelRoot,wr.defaultZoomInFactor,(0,swe.getAbsolutePositionByPoint)(this.editorContextService.modelRoot,e.options.centerCellPosition)):O5.KeyboardGridKeyboardEventAction.is(e)&&e.options.originId===Yv.ID&&((0,El.matchesKeystroke)(e.options.event,"Minus")?t=this.zoomKeyListener.setNewZoomFactor(this.editorContextService.modelRoot,wr.defaultZoomOutFactor):(0,El.matchesKeystroke)(e.options.event,"Digit0","ctrl")&&(t=qd.CenterAction.create([]))),t&&this.actionDispatcher.dispatchAll([t,QW.HideToastAction.create({id:Symbol.for(XW.ElementNavigatorKeyListener.name)})])}}};Du.ZoomKeyTool=Oc;Oc.ID="glsp.zoom-key-tool";qb([(0,Wb.inject)(qd.KeyTool),tM("design:type",qd.KeyTool)],Oc.prototype,"keytool",void 0);qb([(0,Wb.inject)(qd.TYPES.IActionDispatcher),tM("design:type",owe.GLSPActionDispatcher)],Oc.prototype,"actionDispatcher",void 0);qb([(0,Wb.inject)(CV.SelectionService),tM("design:type",CV.SelectionService)],Oc.prototype,"selectionService",void 0);qb([(0,Wb.inject)(PV.EditorContextService),tM("design:type",PV.EditorContextService)],Oc.prototype,"editorContextService",void 0);Du.ZoomKeyTool=Oc=Yv=qb([(0,Wb.injectable)()],Oc);class wr extends qd.KeyListener{constructor(e){super(),this.tool=e,this.token=wr.name}registerShortcutKey(){this.tool.actionDispatcher.dispatchOnceModelInitialized(rwe.SetAccessibleKeyShortcutAction.create({token:this.token,keys:[{shortcuts:["+"],description:"Zoom in to element or viewport",group:"Zoom",position:0},{shortcuts:["-"],description:"Zoom out to element or viewport",group:"Zoom",position:1},{shortcuts:["CTRL","0"],description:"Reset zoom to default",group:"Zoom",position:2},{shortcuts:["CTRL","+"],description:"Zoom in via Grid",group:"Zoom",position:3}]}))}setNewZoomFactor(e,t,i){let o;const r=e.zoom*t;return i?o={scroll:{x:i.x-.5*e.canvasBounds.width/r,y:i.y-.5*e.canvasBounds.height/r},zoom:r}:o={scroll:e.scroll,zoom:r},qd.SetViewportAction.create(e.id,o,{animate:!0})}keyDown(e,t){const i=this.tool.selectionService.getSelectedElementIDs();return this.matchesZoomViaGrid(t)?[O5.EnableKeyboardGridAction.create({originId:Oc.ID,triggerActions:[]}),QW.ShowToastMessageAction.createWithTimeout({id:Symbol.for(XW.ElementNavigatorKeyListener.name),message:awe.grid.zoom_in_grid})]:this.matchesZoomOutKeystroke(t)?i.length>0?[VE.ZoomElementAction.create(i,wr.defaultZoomOutFactor)]:[VE.ZoomViewportAction.create(wr.defaultZoomOutFactor)]:this.matchesZoomInKeystroke(t)?i.length>0?[VE.ZoomElementAction.create(i,wr.defaultZoomInFactor)]:[VE.ZoomViewportAction.create(wr.defaultZoomInFactor)]:this.matchesMinZoomLevelKeystroke(t)?[qd.CenterAction.create(i)]:[]}matchesZoomInKeystroke(e){return e.key==="+"||(0,El.matchesKeystroke)(e,"NumpadAdd")}matchesZoomViaGrid(e){return e.key==="+"&&e.ctrlKey}matchesMinZoomLevelKeystroke(e){return(0,El.matchesKeystroke)(e,"Digit0","ctrl")||(0,El.matchesKeystroke)(e,"Numpad0","ctrl")}matchesZoomOutKeystroke(e){return(0,El.matchesKeystroke)(e,"Minus")||(0,El.matchesKeystroke)(e,"NumpadSubtract")}}Du.ZoomKeyListener=wr;wr.defaultZoomInFactor=1.1;wr.defaultZoomOutFactor=.9;Object.defineProperty(mf,"__esModule",{value:!0});mf.configureViewKeyTools=mf.viewKeyToolsModule=void 0;const Ua=z,wV=nr,cwe=Iu,dwe=Tu,gD=Du;mf.viewKeyToolsModule=new Ua.FeatureModule((n,e,t,i)=>{JW({bind:n,isBound:t,rebind:i})},{featureId:Symbol("viewKeyTools")});function JW(n){(0,Ua.bindAsService)(n,Ua.TYPES.IDefaultTool,dwe.MovementKeyTool),(0,Ua.bindAsService)(n,Ua.TYPES.IDefaultTool,gD.ZoomKeyTool),(0,Ua.configureActionHandler)(n,wV.KeyboardGridCellSelectedAction.KIND,gD.ZoomKeyTool),(0,Ua.configureActionHandler)(n,wV.KeyboardGridKeyboardEventAction.KIND,gD.ZoomKeyTool),(0,Ua.bindAsService)(n,Ua.TYPES.IDefaultTool,cwe.DeselectKeyTool)}mf.configureViewKeyTools=JW;Object.defineProperty(QR,"__esModule",{value:!0});QR.accessibilityModule=void 0;const uwe=z,lwe=T9,fwe=j9,hwe=$9,pwe=cf,mwe=df,gwe=uf,vwe=ff,_we=pf,ywe=K9,bwe=mf;QR.accessibilityModule=new uwe.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,vwe.configureResizeTools)(o),(0,bwe.configureViewKeyTools)(o),(0,gwe.configureMoveZoom)(o),(0,_we.configureSearchPaletteModule)(o),(0,hwe.configureShortcutHelpTool)(o),(0,mwe.configureKeyboardToolPaletteTool)(o),(0,pwe.configureKeyboardControlTools)(o),(0,lwe.configureElementNavigationTool)(o),(0,fwe.configureFocusTrackerTool)(o),(0,ywe.configureToastTool)(o)},{featureId:Symbol("accessibility")});var eZ={};Object.defineProperty(eZ,"__esModule",{value:!0});var tZ={};Object.defineProperty(tZ,"__esModule",{value:!0});var Zb={},nZ=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Swe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Zb,"__esModule",{value:!0});Zb.LeftToRightTopToBottomElementNavigator=void 0;const lw=z,L5=k,Ewe=Io,hl=kt,AV=ni;let fw=class{previous(e,t,i,o=()=>!0){const r=this.getElements(e,o);return t===void 0?r.length>0?r[0]:void 0:r[this.getPreviousIndex(t,r)%r.length]}next(e,t,i,o=()=>!0){const r=this.getElements(e,o);return t===void 0?r.length>0?r[0]:void 0:r[this.getNextIndex(t,r)%r.length]}getElements(e,t){return(0,Ewe.toArray)(e.index.all().filter(o=>(0,hl.isSelectableAndBoundsAware)(o))).sort((o,r)=>this.compare(o,r)).filter(t)}getNextIndex(e,t){for(let i=0;i<t.length;i++)if(this.compare(t[i],e)>0)return i;return 0}getPreviousIndex(e,t){for(let i=t.length-1;i>=0;i--)if(this.compare(t[i],e)<0)return i;return t.length-1}compare(e,t){var i,o;let r,s;e instanceof AV.GEdge&&(0,hl.isRoutable)(e)&&(r=(i=(0,hl.calcElementAndRoute)(e,this.edgeRouterRegistry).newRoutingPoints)===null||i===void 0?void 0:i[0]),t instanceof AV.GEdge&&(0,hl.isRoutable)(t)&&(s=(o=(0,hl.calcElementAndRoute)(t,this.edgeRouterRegistry).newRoutingPoints)===null||o===void 0?void 0:o[0]);const a=(0,lw.findParentByFeature)(e,hl.isSelectableAndBoundsAware),u=(0,lw.findParentByFeature)(t,hl.isSelectableAndBoundsAware);if(r===void 0&&a&&(r=a.bounds),s===void 0&&u&&(s=u.bounds),r&&s){if(r.y!==s.y)return r.y-s.y;if(r.x!==s.x)return r.x-s.x}return 0}};Zb.LeftToRightTopToBottomElementNavigator=fw;nZ([(0,L5.inject)(lw.EdgeRouterRegistry),(0,L5.optional)(),Swe("design:type",lw.EdgeRouterRegistry)],fw.prototype,"edgeRouterRegistry",void 0);Zb.LeftToRightTopToBottomElementNavigator=fw=nZ([(0,L5.injectable)()],fw);var nM={},vf={};Object.defineProperty(vf,"__esModule",{value:!0});vf.isMouseEvent=vf.createElementFromHTML=void 0;const vD=z;function Cwe(n){const e=document.createElement("template");n=n.trim(),e.innerHTML=n;const t=e.content.firstChild;if(t&&t instanceof HTMLElement)return t}vf.createElementFromHTML=Cwe;function Pwe(n){return vD.AnyObject.is(n)&&(0,vD.hasNumberProp)(n,"pageX")&&(0,vD.hasNumberProp)(n,"pageY")}vf.isMouseEvent=Pwe;var _f={};Object.defineProperty(_f,"__esModule",{value:!0});_f.unsnapModifier=_f.useSnap=void 0;function wwe(n){return!n.shiftKey}_f.useSnap=wwe;function Awe(){return"shift"}_f.unsnapModifier=Awe;Object.defineProperty(nM,"__esModule",{value:!0});nM.PointPositionUpdater=void 0;const zE=z,Rwe=kt,RV=vf,Mwe=th,MV=eh,Iwe=_f;class Twe{constructor(e,t){this.positionDelta={x:0,y:0},this.positionSnapper=e instanceof MV.PositionSnapper?e:new MV.PositionSnapper(e,t)}updateLastDragPosition(e){this.lastDragPosition=(0,RV.isMouseEvent)(e)?{x:e.pageX,y:e.pageY}:e}isLastDragPositionUndefined(){return this.lastDragPosition===void 0}resetPosition(){this.lastDragPosition=void 0,this.positionDelta={x:0,y:0}}updatePosition(e,t,i,o){if(!this.lastDragPosition)return;const r=(0,RV.isMouseEvent)(t)?{x:t.pageX,y:t.pageY}:t,s=typeof i=="boolean"?i:(0,Iwe.useSnap)(t),a=typeof i!="boolean"?i:o,u=(0,Rwe.calculateDeltaBetweenPoints)(r,this.lastDragPosition,e);if(this.lastDragPosition=r,zE.Point.equals(u,zE.Point.ORIGIN))return;this.positionDelta.x+=u.x,this.positionDelta.y+=u.y;const h=a??(0,Mwe.getDirectionOf)(this.positionDelta),g=this.positionSnapper.snapDelta(this.positionDelta,e,s,h);if(!zE.Point.equals(g,zE.Point.ORIGIN))return this.positionDelta.x-=g.x,this.positionDelta.y-=g.y,g}}nM.PointPositionUpdater=Twe;var Qb={},iZ=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Dwe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Qb,"__esModule",{value:!0});Qb.DeleteElementContextMenuItemProvider=void 0;const oZ=k,rZ=z;let hw=class{async getItems(e,t){const i=await this.editorContextServiceProvider();return[this.createDeleteMenuItem(i)]}createDeleteMenuItem(e){return{id:"delete",label:"Delete",sortString:"d",group:"edit",actions:[rZ.DeleteElementOperation.create(e.selectedElements.map(t=>t.id))],isEnabled:()=>!e.isReadonly&&e.selectedElements.length>0}}};Qb.DeleteElementContextMenuItemProvider=hw;iZ([(0,oZ.inject)(rZ.TYPES.IEditorContextServiceProvider),Dwe("design:type",Function)],hw.prototype,"editorContextServiceProvider",void 0);Qb.DeleteElementContextMenuItemProvider=hw=iZ([(0,oZ.injectable)()],hw);var Wn={},Y9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Owe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(Wn,"__esModule",{value:!0});Wn.isNative=Wn.supportsPaste=Wn.supportsCut=Wn.supportsCopy=Wn.CopyPasteContextMenuItemProvider=Wn.InvokeCopyPasteActionHandler=Wn.InvokeCopyPasteAction=void 0;const q9=k,Mm=z;var v_;(function(n){n.KIND="invokeCopyPaste";function e(i){return Mm.Action.hasKind(i,n.KIND)&&(0,Mm.hasStringProp)(i,"command")}n.is=e;function t(i){return{kind:n.KIND,command:i}}n.create=t})(v_||(Wn.InvokeCopyPasteAction=v_={}));let pw=class{handle(e){switch(e.command){case"copy":sZ()?document.execCommand("copy"):this.notifyUserToUseShortcut("copy");break;case"paste":cZ()?document.execCommand("paste"):this.notifyUserToUseShortcut("paste");break;case"cut":aZ()?document.execCommand("cut"):this.notifyUserToUseShortcut("cut");break}}notifyUserToUseShortcut(e){const t=`Please use the browser's ${e} command or shortcut.`,i=1e4,o="WARNING";this.dispatcher.dispatchAll([Mm.StatusAction.create(t,{severity:o,timeout:i}),Mm.MessageAction.create(t,{severity:o})])}};Wn.InvokeCopyPasteActionHandler=pw;Y9([(0,q9.inject)(Mm.TYPES.IActionDispatcher),Owe("design:type",Object)],pw.prototype,"dispatcher",void 0);Wn.InvokeCopyPasteActionHandler=pw=Y9([(0,q9.injectable)()],pw);let j5=class{getItems(e,t){const i=Array.from(e.index.all().filter(Mm.isSelected)).length>0;return Promise.resolve([this.createCopyMenuItem(i),this.createCutMenuItem(i),this.createPasteMenuItem()])}createPasteMenuItem(){return{id:"paste",label:"Paste",group:"copy-paste",actions:[v_.create("paste")],isEnabled:()=>!0}}createCutMenuItem(e){return{id:"cut",label:"Cut",group:"copy-paste",actions:[v_.create("cut")],isEnabled:()=>e}}createCopyMenuItem(e){return{id:"copy",label:"Copy",group:"copy-paste",actions:[v_.create("copy")],isEnabled:()=>e}}};Wn.CopyPasteContextMenuItemProvider=j5;Wn.CopyPasteContextMenuItemProvider=j5=Y9([(0,q9.injectable)()],j5);function sZ(){return iM()||document.queryCommandSupported("copy")}Wn.supportsCopy=sZ;function aZ(){return iM()||document.queryCommandSupported("cut")}Wn.supportsCut=aZ;function cZ(){const n=Lwe().indexOf("Chrome")>=0;return iM()||!n&&document.queryCommandSupported("paste")}Wn.supportsPaste=cZ;function iM(){return typeof window.process<"u"}Wn.isNative=iM;function Lwe(){return typeof navigator<"u"?navigator.userAgent:""}var W9={};(function(n){var e=f&&f.__decorate||function(a,u,h,g){var y=arguments.length,S=y<3?u:g===null?g=Object.getOwnPropertyDescriptor(u,h):g,w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(a,u,h,g);else for(var P=a.length-1;P>=0;P--)(w=a[P])&&(S=(y<3?w(S):y>3?w(u,h,S):w(u,h))||S);return y>3&&S&&Object.defineProperty(u,h,S),S},t=f&&f.__metadata||function(a,u){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,u)};Object.defineProperty(n,"__esModule",{value:!0}),n.DebugBoundsDecorator=n.CSS_DEBUG_BOUNDS=void 0;const i=z,o=k,r=ni;n.CSS_DEBUG_BOUNDS="debug-bounds";let s=class{decorate(u,h){var g;return!((g=this.debugManager)===null||g===void 0)&&g.isDebugEnabled&&((0,i.isSizeable)(h)&&this.shouldDecorateSizeable(h)&&this.decorateSizeable(u,h),h instanceof r.GGraph&&this.shouldDecorateGraph(h)&&this.decorateGraph(u,h)),u}postUpdate(){}get decorationSize(){return 5}shouldDecorateGraph(u){return!0}decorateGraph(u,h){var g,y,S;(0,i.setClass)(u,n.CSS_DEBUG_BOUNDS,!0);const w=(g=u.children)===null||g===void 0?void 0:g.find(E=>typeof E!="string"&&E.sel==="svg"),P=(y=w==null?void 0:w.children)===null||y===void 0?void 0:y.find(E=>typeof E!="string"&&E.sel==="g");(S=P==null?void 0:P.children)===null||S===void 0||S.push(this.renderOrigin(h))}renderOrigin(u){return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-origin":!0,points:`0,${this.decorationSize} 0,0  ${this.decorationSize},0`},(0,i.svg)("title",null,"Origin = x: 0, y: 0"))}shouldDecorateSizeable(u){return!(0,i.isDecoration)(u)}decorateSizeable(u,h){var g,y,S,w,P;(0,i.setClass)(u,n.CSS_DEBUG_BOUNDS,!0),(g=u.children)===null||g===void 0||g.push(this.renderTopLeftCorner(h)),(y=u.children)===null||y===void 0||y.push(this.renderTopRightCorner(h)),(S=u.children)===null||S===void 0||S.push(this.renderBottomLeftCorner(h)),(w=u.children)===null||w===void 0||w.push(this.renderBottomRightCorner(h)),(P=u.children)===null||P===void 0||P.push(this.renderCenter(h))}renderTopLeftCorner(u){const h=i.Bounds.position(u.bounds),g=i.Bounds.topLeft(u.bounds),y=i.Point.subtract(g,h);return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-top-left":!0,points:`${y.x},${y.y+this.decorationSize} ${y.x},${y.y} ${y.x+this.decorationSize},${y.y}`},(0,i.svg)("title",null,"Top Left = x: ",g.x,", y: ",g.y))}renderTopRightCorner(u){const h=i.Bounds.position(u.bounds),g=i.Bounds.topRight(u.bounds),y=i.Point.subtract(g,h);return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-top-right":!0,points:`${y.x-this.decorationSize},${y.y} ${y.x},${y.y} ${y.x},${y.y+this.decorationSize}`},(0,i.svg)("title",null,"Top Right = x: ",g.x,", y: ",g.y))}renderBottomLeftCorner(u){const h=i.Bounds.position(u.bounds),g=i.Bounds.bottomLeft(u.bounds),y=i.Point.subtract(g,h);return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-bottom-left":!0,points:`${y.x},${y.y-this.decorationSize} ${y.x},${y.y} ${y.x+this.decorationSize},${y.y}`},(0,i.svg)("title",null,"Bottom Left = x: ",g.x,", y: ",g.y))}renderBottomRightCorner(u){const h=i.Bounds.position(u.bounds),g=i.Bounds.bottomRight(u.bounds),y=i.Point.subtract(g,h);return(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-bottom-right":!0,points:`${y.x-this.decorationSize},${y.y} ${y.x},${y.y} ${y.x},${y.y-this.decorationSize}`},(0,i.svg)("title",null,"Bottom Right = x: ",g.x,", y: ",g.y))}renderCenter(u){const h=u.bounds,g=i.Bounds.position(h),y=i.Bounds.center(h),S=i.Point.subtract(y,g);return(0,i.svg)("g",null,(0,i.svg)("title",null,"Center = x: ",y.x,", y: ",y.y,"\rBounds = x: ",h.x,", y: ",h.y,", width: ",h.width,", height: ",h.height),(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-center":!0,points:`${S.x-this.decorationSize/2},${S.y-this.decorationSize/2} ${S.x+this.decorationSize/2},${S.y+this.decorationSize/2}`}),(0,i.svg)("polyline",{"class-debug-bounds-decoration":!0,"class-debug-bounds-center":!0,points:`${S.x+this.decorationSize/2},${S.y-this.decorationSize/2} ${S.x-this.decorationSize/2},${S.y+this.decorationSize/2}`}))}};n.DebugBoundsDecorator=s,e([(0,o.inject)(i.TYPES.IDebugManager),(0,o.optional)(),t("design:type",Object)],s.prototype,"debugManager",void 0),n.DebugBoundsDecorator=s=e([(0,o.injectable)()],s)})(W9);var T1={},Lc={},jwe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Nwe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Bwe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Lc,"__esModule",{value:!0});Lc.EnableDebugModeCommand=Lc.EnableDebugModeAction=void 0;const N5=z,IV=k,$we=Gn,TV=kt;var ky;(function(n){n.KIND="enableDebugMode",n.CSS_ROOT_CLASS="debug-mode";function e(i){return N5.Action.hasKind(i,n.KIND)&&(0,N5.hasBooleanProp)(i,"enable")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(ky||(Lc.EnableDebugModeAction=ky={}));let mw=class extends $we.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){return this.setDebugMode(e.root,this.action.enable)}setDebugMode(e,t){return t?(0,TV.addCssClasses)(e,[ky.CSS_ROOT_CLASS]):(0,TV.removeCssClasses)(e,[ky.CSS_ROOT_CLASS]),e}};Lc.EnableDebugModeCommand=mw;mw.KIND=ky.KIND;Lc.EnableDebugModeCommand=mw=jwe([(0,IV.injectable)(),Bwe(0,(0,IV.inject)(N5.TYPES.Action)),Nwe("design:paramtypes",[Object])],mw);var Z9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},R3=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(T1,"__esModule",{value:!0});T1.DebugManager=void 0;const kwe=z,Q9=k,DV=Lc;let Fy=class{constructor(){this._debugEnabled=!1}get isDebugEnabled(){return this._debugEnabled}init(){this.debugFeedback=this.feedbackDispatcher.createEmitter()}handle(e){this.setDebugEnabled(e.enable)}setDebugEnabled(e){this._debugEnabled&&!e?(this._debugEnabled=!1,this.debugFeedback.dispose()):!this._debugEnabled&&e&&(this._debugEnabled=!0,this.debugFeedback.add(DV.EnableDebugModeAction.create({enable:!0}),DV.EnableDebugModeAction.create({enable:!1})).submit())}toggleDebugEnabled(){this.setDebugEnabled(!this._debugEnabled)}};T1.DebugManager=Fy;Z9([(0,Q9.inject)(kwe.TYPES.IFeedbackActionDispatcher),R3("design:type",Object)],Fy.prototype,"feedbackDispatcher",void 0);Z9([(0,Q9.postConstruct)(),R3("design:type",Function),R3("design:paramtypes",[]),R3("design:returntype",void 0)],Fy.prototype,"init",null);T1.DebugManager=Fy=Z9([(0,Q9.injectable)()],Fy);var oM={};Object.defineProperty(oM,"__esModule",{value:!0});oM.debugModule=void 0;const pl=z,Fwe=W9,OV=T1,LV=Lc;oM.debugModule=new pl.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,pl.configureCommand)(o,LV.EnableDebugModeCommand),(0,pl.bindAsService)(o,pl.TYPES.IDebugManager,OV.DebugManager),(0,pl.configureActionHandler)(o,LV.EnableDebugModeAction.KIND,OV.DebugManager),(0,pl.bindAsService)(o,pl.TYPES.IVNodePostprocessor,Fwe.DebugBoundsDecorator)},{featureId:Symbol("debug")});var dZ={};Object.defineProperty(dZ,"__esModule",{value:!0});var D1={},jc={},xwe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Hwe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Kwe=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(jc,"__esModule",{value:!0});jc.ShowGridCommand=jc.ShowGridAction=void 0;const B5=z,jV=k,Vwe=Gn,NV=kt;var xy;(function(n){n.KIND="showGrid",n.CSS_ROOT_CLASS="grid-background";function e(i){return B5.Action.hasKind(i,n.KIND)&&(0,B5.hasBooleanProp)(i,"show")}n.is=e;function t(i){return{kind:Hy.KIND,...i}}n.create=t})(xy||(jc.ShowGridAction=xy={}));let Hy=class extends Vwe.FeedbackCommand{constructor(e){super(),this.action=e}execute(e){return this.setGrid(e.root,this.action.show)}setGrid(e,t){return t?(0,NV.addCssClasses)(e,[xy.CSS_ROOT_CLASS]):(0,NV.removeCssClasses)(e,[xy.CSS_ROOT_CLASS]),e}};jc.ShowGridCommand=Hy;Hy.KIND=xy.KIND;jc.ShowGridCommand=Hy=xwe([(0,jV.injectable)(),Kwe(0,(0,jV.inject)(B5.TYPES.Action)),Hwe("design:paramtypes",[Object])],Hy);var rM=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},__=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(D1,"__esModule",{value:!0});D1.GridManager=void 0;const uZ=z,sM=k,BV=jc;let Im=class{constructor(){this._gridVisible=!1}get isGridVisible(){return this._gridVisible}init(){this.gridFeedback=this.feedbackDispatcher.createEmitter()}handle(e){this.setGridVisible(e.show)}setGridVisible(e){this._gridVisible&&!e?(this._gridVisible=!1,this.gridFeedback.dispose()):!this._gridVisible&&e&&(this._gridVisible=!0,this.gridFeedback.add(BV.ShowGridAction.create({show:!0}),BV.ShowGridAction.create({show:!1})).submit())}toggleGridVisible(){this.setGridVisible(!this._gridVisible)}};D1.GridManager=Im;rM([(0,sM.inject)(uZ.TYPES.IFeedbackActionDispatcher),__("design:type",Object)],Im.prototype,"feedbackDispatcher",void 0);rM([(0,sM.inject)(uZ.TYPES.Grid),__("design:type",Object)],Im.prototype,"grid",void 0);rM([(0,sM.postConstruct)(),__("design:type",Function),__("design:paramtypes",[]),__("design:returntype",void 0)],Im.prototype,"init",null);D1.GridManager=Im=rM([(0,sM.injectable)()],Im);var aM={},Nc={},lZ=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},fZ=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},gw=f&&f.__param||function(n,e){return function(t,i){e(t,i,n)}};Object.defineProperty(Nc,"__esModule",{value:!0});Nc.GLSPCenterGridSnapper=Nc.GridSnapper=void 0;const cM=z,Dp=k;let $5=class{constructor(e={x:10,y:10}){this.grid=e}snap(e,t){return cM.Point.snapToGrid(e,this.grid)}};Nc.GridSnapper=$5;Nc.GridSnapper=$5=lZ([(0,Dp.injectable)(),gw(0,(0,Dp.optional)()),gw(0,(0,Dp.inject)(cM.TYPES.Grid)),fZ("design:paramtypes",[Object])],$5);let k5=class extends cM.CenterGridSnapper{constructor(e={x:10,y:10}){super(),this.grid=e}get gridX(){return this.grid.x}get gridY(){return this.grid.y}};Nc.GLSPCenterGridSnapper=k5;Nc.GLSPCenterGridSnapper=k5=lZ([(0,Dp.injectable)(),gw(0,(0,Dp.optional)()),gw(0,(0,Dp.inject)(cM.TYPES.Grid)),fZ("design:paramtypes",[Object])],k5);Object.defineProperty(aM,"__esModule",{value:!0});aM.gridModule=void 0;const ml=z,$V=D1,kV=jc,zwe=Nc;aM.gridModule=new ml.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};n(ml.TYPES.Grid).toConstantValue({x:10,y:10}),(0,ml.configureCommand)(o,kV.ShowGridCommand),(0,ml.bindAsService)(o,ml.TYPES.IGridManager,$V.GridManager),(0,ml.configureActionHandler)(o,kV.ShowGridAction.KIND,$V.GridManager),n(ml.TYPES.ISnapper).to(zwe.GridSnapper)},{featureId:Symbol("grid")});var O1={};Object.defineProperty(O1,"__esModule",{value:!0});O1.GridProperty=void 0;var FV;(function(n){n.GRID_BACKGROUND_X="--grid-background-x",n.GRID_BACKGROUND_Y="--grid-background-y",n.GRID_BACKGROUND_WIDTH="--grid-background-width",n.GRID_BACKGROUND_HEIGHT="--grid-background-height",n.GRID_BACKGROUND_ZOOM="--grid-background-zoom",n.GRID_COLOR="--grid-color"})(FV||(O1.GridProperty=FV={}));var dM={};(function(n){var e=f&&f.__decorate||function(b,v,R,D){var j=arguments.length,T=j<3?v:D===null?D=Object.getOwnPropertyDescriptor(v,R):D,$;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")T=Reflect.decorate(b,v,R,D);else for(var Q=b.length-1;Q>=0;Q--)($=b[Q])&&(T=(j<3?$(T):j>3?$(v,R,T):$(v,R))||T);return j>3&&T&&Object.defineProperty(v,R,T),T},t=f&&f.__metadata||function(b,v){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(b,v)},i=f&&f.__param||function(b,v){return function(R,D){v(R,D,b)}};Object.defineProperty(n,"__esModule",{value:!0}),n.boundsInViewport=n.removeSelectionBounds=n.removeHelperLines=n.RemoveHelperLinesFeedbackCommand=n.RemoveHelperLinesFeedbackAction=n.DrawHelperLinesFeedbackCommand=n.DrawHelperLinesFeedbackAction=n.DEFAULT_DEBUG=n.DEFAULT_ALIGNABLE_ELEMENT_FILTER=n.DEFAULT_EPSILON=n.DEFAULT_VIEWPORT_LINES=n.DEFAULT_ELEMENT_LINES=n.ALL_VIEWPORT_LINE_TYPES=n.ALL_ELEMENT_LINE_TYPES=n.isTopLevelBoundsAwareElement=void 0;const o=z,r=k,s=ah,a=Gn,u=kt,h=Ct,g=Uc,y=th,S=b=>(0,u.findTopLevelElementByFeature)(b,o.isBoundsAware,o.isViewport)===b;n.isTopLevelBoundsAwareElement=S,n.ALL_ELEMENT_LINE_TYPES=Object.values(y.HelperLineType),n.ALL_VIEWPORT_LINE_TYPES=[y.HelperLineType.Center,y.HelperLineType.Middle],n.DEFAULT_ELEMENT_LINES=n.ALL_ELEMENT_LINE_TYPES,n.DEFAULT_VIEWPORT_LINES=n.ALL_VIEWPORT_LINE_TYPES,n.DEFAULT_EPSILON=1;const w=b=>(0,u.isVisibleOnCanvas)(b)&&!(0,u.isRoutable)(b)&&!(b instanceof o.GLabel)&&b.id!==(0,g.feedbackEdgeId)(b.root)&&b.id!==(0,g.feedbackEdgeEndId)(b.root)&&!(0,o.isDecoration)(b);n.DEFAULT_ALIGNABLE_ELEMENT_FILTER=w,n.DEFAULT_DEBUG=!1;var P;(function(b){b.KIND="drawHelperLines";function v(R){return{kind:b.KIND,...R}}b.create=v})(P||(n.DrawHelperLinesFeedbackAction=P={}));let E=class extends a.FeedbackCommand{constructor(v,R){var D,j,T,$,Q;super(),this.logger=R,this.elementIds=v.elementIds,this.elementLines=(D=v.elementLines)!==null&&D!==void 0?D:n.DEFAULT_ELEMENT_LINES,this.viewportLines=(j=v.viewportLines)!==null&&j!==void 0?j:n.DEFAULT_VIEWPORT_LINES,this.alignmentEpsilon=(T=v.alignmentEpsilon)!==null&&T!==void 0?T:n.DEFAULT_EPSILON,this.alignableElementFilter=($=v.alignmentElementFilter)!==null&&$!==void 0?$:n.DEFAULT_ALIGNABLE_ELEMENT_FILTER,this.isAlignableElementPredicate=this.isAlignableElement.bind(this),this.debug=(Q=v.debug)!==null&&Q!==void 0?Q:n.DEFAULT_DEBUG}execute(v){B(v.root),U(v.root);const R=(0,u.getMatchingElements)(v.root.index,this.isAlignableElementPredicate);this.log("All alignable elements: ",R);const[D,j]=(0,s.partition)(R,Q=>this.elementIds.includes(Q.id));if(this.log("Split alignable elements into reference elements and other elements: ",D,j),D.length===0)return this.log("--> No helper lines as we do not have any reference elements."),v.root;const T=this.calcReferenceBounds(D);this.log("Bounds encompasing all reference elements: ",T);const $=this.calcHelperLines(j,T,v);return D.length>1&&(v.root.add(new y.SelectionBounds(T)),this.log("Render selection bounds for more than one reference element:",T)),$.forEach(Q=>v.root.add(Q)),$.length>0?this.log(`--> Add ${$.length} helper lines to root:`,$):this.log("--> Add no helper lines to root."),v.root}isAlignableElement(v){return(0,o.isBoundsAware)(v)&&this.alignableElementFilter(v,this.elementIds)}calcReferenceBounds(v){return v.map(R=>this.calcBounds(R)).reduce(o.Bounds.combine,o.Bounds.EMPTY)}calcBounds(v){return(0,h.toAbsoluteBounds)(v)}calcHelperLines(v,R,D){const j=[],T=(0,o.findParentByFeature)(D.root,o.isViewport);return T&&j.push(...this.calcHelperLinesForViewport(T,R,this.viewportLines)),v.flatMap($=>this.calcHelperLinesForElement($,R,this.elementLines)).forEach($=>j.push($)),j}calcHelperLinesForViewport(v,R,D){const j=[];this.log("Find helperlines for viewport:",v);const T=(0,h.getViewportBounds)(v,v.canvasBounds);return D.includes(y.HelperLineType.Center)&&this.isAligned(o.Bounds.centerX,T,R,2)&&(j.push(new y.HelperLine(o.Bounds.topCenter(T),o.Bounds.bottomCenter(T),y.HelperLineType.Center)),this.log("- Reference bounds center align with viewport.",T)),D.includes(y.HelperLineType.Middle)&&this.isAligned(o.Bounds.middle,T,R,2)&&(j.push(new y.HelperLine(o.Bounds.middleLeft(T),o.Bounds.middleRight(T),y.HelperLineType.Middle)),this.log("- Reference bounds middle align with viewport.",T)),j.length>0&&this.log(`--> Add ${j.length} helperlines for viewport:`,j),j}calcHelperLinesForElement(v,R,D){return this.log("Find helperlines for element:",v),this.calcHelperLinesForBounds(this.calcBounds(v),R,D)}calcHelperLinesForBounds(v,R,D){const j=[];if(D.includes(y.HelperLineType.Left)&&this.isAligned(o.Bounds.left,v,R,this.alignmentEpsilon)){const[T,$]=o.Bounds.sortBy(o.Bounds.top,v,R);j.push(new y.HelperLine(o.Bounds.bottomLeft($),o.Bounds.topLeft(T),y.HelperLineType.Left)),this.log("- Reference bounds left align with element",v)}if(D.includes(y.HelperLineType.Center)&&this.isAligned(o.Bounds.centerX,v,R,this.alignmentEpsilon)){const[T,$]=o.Bounds.sortBy(o.Bounds.top,v,R);j.push(new y.HelperLine(o.Bounds.topCenter(T),o.Bounds.bottomCenter($),y.HelperLineType.Center)),this.log("- Reference bounds center align with element",v)}if(D.includes(y.HelperLineType.Right)&&this.isAligned(o.Bounds.right,v,R,this.alignmentEpsilon)){const[T,$]=o.Bounds.sortBy(o.Bounds.top,v,R);j.push(new y.HelperLine(o.Bounds.bottomRight($),o.Bounds.topRight(T),y.HelperLineType.Right)),this.log("- Reference bounds right align with element",v)}if(D.includes(y.HelperLineType.Bottom)&&this.isAligned(o.Bounds.bottom,v,R,this.alignmentEpsilon)){const[T,$]=o.Bounds.sortBy(o.Bounds.left,v,R);j.push(new y.HelperLine(o.Bounds.bottomLeft(T),o.Bounds.bottomRight($),y.HelperLineType.Bottom)),this.log("- Reference bounds bottom align with element",v)}if(D.includes(y.HelperLineType.Middle)&&this.isAligned(o.Bounds.centerY,v,R,this.alignmentEpsilon)){const[T,$]=o.Bounds.sortBy(o.Bounds.left,v,R);j.push(new y.HelperLine(o.Bounds.middleLeft(T),o.Bounds.middleRight($),y.HelperLineType.Middle)),this.log("- Reference bounds middle align with element",v)}if(D.includes(y.HelperLineType.Top)&&this.isAligned(o.Bounds.top,v,R,this.alignmentEpsilon)){const[T,$]=o.Bounds.sortBy(o.Bounds.left,v,R);j.push(new y.HelperLine(o.Bounds.topLeft(T),o.Bounds.topRight($),y.HelperLineType.Top)),this.log("- Reference bounds top align with element",v)}return D.includes(y.HelperLineType.LeftRight)&&this.isMatch(o.Bounds.left(v),o.Bounds.right(R),this.alignmentEpsilon)&&(o.Bounds.isAbove(R,v)?(j.push(new y.HelperLine(o.Bounds.bottomLeft(v),o.Bounds.topRight(R),y.HelperLineType.RightLeft)),this.log("- Reference bounds right aligns with element left",v)):(j.push(new y.HelperLine(o.Bounds.topLeft(v),o.Bounds.bottomRight(R),y.HelperLineType.RightLeft)),this.log("- Reference bounds right aligns with element left",v))),D.includes(y.HelperLineType.LeftRight)&&this.isMatch(o.Bounds.right(v),o.Bounds.left(R),this.alignmentEpsilon)&&(o.Bounds.isAbove(R,v)?(j.push(new y.HelperLine(o.Bounds.bottomRight(v),o.Bounds.topLeft(R),y.HelperLineType.LeftRight)),this.log("- Reference bounds left aligns with element right",v)):(j.push(new y.HelperLine(o.Bounds.topRight(v),o.Bounds.bottomLeft(R),y.HelperLineType.LeftRight)),this.log("- Reference bounds left aligns with element right",v))),D.includes(y.HelperLineType.TopBottom)&&this.isMatch(o.Bounds.top(v),o.Bounds.bottom(R),this.alignmentEpsilon)&&(o.Bounds.isBefore(R,v)?(j.push(new y.HelperLine(o.Bounds.topRight(v),o.Bounds.bottomLeft(R),y.HelperLineType.BottomTop)),this.log("- Reference bounds bottom aligns with element top",v)):(j.push(new y.HelperLine(o.Bounds.topLeft(v),o.Bounds.bottomRight(R),y.HelperLineType.BottomTop)),this.log("- Reference bounds bottom aligns with element top",v))),D.includes(y.HelperLineType.TopBottom)&&this.isMatch(o.Bounds.bottom(v),o.Bounds.top(R),this.alignmentEpsilon)&&(o.Bounds.isBefore(R,v)?(j.push(new y.HelperLine(o.Bounds.bottomRight(v),o.Bounds.topLeft(R),y.HelperLineType.TopBottom)),this.log("- Reference bounds top aligns with element bottom",v)):(j.push(new y.HelperLine(o.Bounds.bottomLeft(v),o.Bounds.topRight(R),y.HelperLineType.TopBottom)),this.log("- Reference bounds top aligns with element bottom",v))),j.length>0&&this.log(`--> Add ${j.length} helperlines for element:`,j),j}isAligned(v,R,D,j){return this.isMatch(v(R),v(D),j)}isMatch(v,R,D){return(0,o.equalUpTo)(v,R,D)}log(v,...R){this.debug&&this.logger.log(this,v,R)}};n.DrawHelperLinesFeedbackCommand=E,E.KIND=P.KIND,n.DrawHelperLinesFeedbackCommand=E=e([(0,r.injectable)(),i(0,(0,r.inject)(o.TYPES.Action)),i(1,(0,r.inject)(o.TYPES.ILogger)),t("design:paramtypes",[Object,Object])],E);var A;(function(b){b.KIND="removeHelperLines";function v(R={}){return{kind:b.KIND,...R}}b.create=v})(A||(n.RemoveHelperLinesFeedbackAction=A={}));let L=class extends a.FeedbackCommand{constructor(v){super(),this.action=v}execute(v){return B(v.root),U(v.root),v.root}};n.RemoveHelperLinesFeedbackCommand=L,L.KIND=A.KIND,n.RemoveHelperLinesFeedbackCommand=L=e([(0,r.injectable)(),i(0,(0,r.inject)(o.TYPES.Action)),t("design:paramtypes",[Object])],L);function B(b){(0,u.forEachElement)(b.index,y.isHelperLine,v=>b.remove(v))}n.removeHelperLines=B;function U(b){(0,u.forEachElement)(b.index,y.isSelectionBounds,v=>b.remove(v))}n.removeSelectionBounds=U;function p(b,v){return b instanceof o.GChildElement&&!(0,o.isViewport)(b.parent)?p(b.parent,b.parent.localToParent(v)):v}n.boundsInViewport=p})(dM);var hZ={};Object.defineProperty(hZ,"__esModule",{value:!0});var X9={};(function(n){var e=f&&f.__decorate||function(S,w,P,E){var A=arguments.length,L=A<3?w:E===null?E=Object.getOwnPropertyDescriptor(w,P):E,B;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")L=Reflect.decorate(S,w,P,E);else for(var U=S.length-1;U>=0;U--)(B=S[U])&&(L=(A<3?B(L):A>3?B(w,P,L):B(w,P))||L);return A>3&&L&&Object.defineProperty(w,P,L),L},t=f&&f.__metadata||function(S,w){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(S,w)};Object.defineProperty(n,"__esModule",{value:!0}),n.HelperLineManager=n.DEFAULT_HELPER_LINE_OPTIONS=n.DEFAULT_MOVE_DELTA=void 0;const i=z,o=k,r=Yt,s=Ss,a=io,u=Pn,h=dM,g=th;n.DEFAULT_MOVE_DELTA={x:1,y:1},n.DEFAULT_HELPER_LINE_OPTIONS={elementLines:h.DEFAULT_ELEMENT_LINES,viewportLines:h.DEFAULT_VIEWPORT_LINES,alignmentEpsilon:h.DEFAULT_EPSILON,alignmentElementFilter:h.DEFAULT_ALIGNABLE_ELEMENT_FILTER,minimumMoveDelta:n.DEFAULT_MOVE_DELTA,debug:h.DEFAULT_DEBUG};let y=class{init(){this.feedback=this.feedbackDispatcher.createEmitter();const w={};this.grid&&(w.alignmentEpsilon=0,w.minimumMoveDelta=i.Point.multiplyScalar(this.grid,2)),this.options={...n.DEFAULT_HELPER_LINE_OPTIONS,...w,...this.userOptions},this.selectionService.onSelectionChanged(P=>this.selectionChanged(P.root,P.selectedElements,P.deselectedElements))}handle(w){u.MoveInitializedEventAction.is(w)?this.handleMoveInitializedAction(w):i.MoveAction.is(w)?this.handleMoveAction(w):u.MoveFinishedEventAction.is(w)?this.handleMoveFinishedAction(w):(i.SetBoundsAction.is(w)||s.SetBoundsFeedbackAction.is(w))&&this.handleSetBoundsAction(w)}handleMoveInitializedAction(w){this.submitHelperLineFeedback()}handleMoveFinishedAction(w){this.feedback.dispose()}handleMoveAction(w){w.finished?this.feedback.dispose():this.submitHelperLineFeedback(w.moves.map(P=>P.elementId))}submitHelperLineFeedback(w=this.selectionService.getSelectedElementIDs()){const P=this.createHelperLineFeedback(w);this.feedback.add(P,[h.RemoveHelperLinesFeedbackAction.create()]).submit()}createHelperLineFeedback(w){return h.DrawHelperLinesFeedbackAction.create({elementIds:w,...this.options})}handleSetBoundsAction(w){this.submitHelperLineFeedback(w.bounds.map(P=>P.elementId))}selectionChanged(w,P,E){this.feedback.dispose()}getMinimumMoveDelta(w,P,E){if(!P)return 0;const A=this.options.minimumMoveDelta;return E===g.Direction.Left||E===g.Direction.Right?A.x:A.y}getMinimumMoveVector(w,P,E){if(!P)return;const A=this.getHelperLineState(w);if(A.helperLines.length===0)return;const L={...i.Vector.ZERO},B=w instanceof a.GResizeHandle?a.ResizeHandleLocation.direction(w.location):[g.Direction.Left,g.Direction.Right,g.Direction.Up,g.Direction.Down];return(A.types.left||A.types.center)&&E.includes(g.Direction.Left)&&B.includes(g.Direction.Left)?L.x=this.getMinimumMoveDelta(w,P,g.Direction.Left):(A.types.right||A.types.center)&&E.includes(g.Direction.Right)&&B.includes(g.Direction.Right)&&(L.x=this.getMinimumMoveDelta(w,P,g.Direction.Right)),(A.types.top||A.types.middle)&&E.includes(g.Direction.Up)&&B.includes(g.Direction.Up)?L.y=this.getMinimumMoveDelta(w,P,g.Direction.Up):(A.types.bottom||A.types.middle)&&E.includes(g.Direction.Down)&&B.includes(g.Direction.Down)&&(L.y=this.getMinimumMoveDelta(w,P,g.Direction.Down)),i.Vector.isZero(L)?void 0:L}getHelperLineState(w){const P=w.root.children.filter(g.isHelperLine)||[],E={left:!1,right:!1,top:!1,bottom:!1,center:!1,middle:!1};for(const A of P)switch(A.lineType){case g.HelperLineType.Left:case g.HelperLineType.LeftRight:E.left=!0;break;case g.HelperLineType.Right:case g.HelperLineType.RightLeft:E.right=!0;break;case g.HelperLineType.Top:case g.HelperLineType.TopBottom:E.top=!0;break;case g.HelperLineType.Bottom:case g.HelperLineType.BottomTop:E.bottom=!0;break;case g.HelperLineType.Center:E.center=!0;break;case g.HelperLineType.Middle:E.middle=!0;break}return{helperLines:P,types:E}}};n.HelperLineManager=y,e([(0,o.inject)(i.TYPES.IFeedbackActionDispatcher),t("design:type",Object)],y.prototype,"feedbackDispatcher",void 0),e([(0,o.inject)(r.SelectionService),t("design:type",r.SelectionService)],y.prototype,"selectionService",void 0),e([(0,o.optional)(),(0,o.inject)(i.TYPES.IHelperLineOptions),t("design:type",Object)],y.prototype,"userOptions",void 0),e([(0,o.optional)(),(0,o.inject)(i.TYPES.Grid),t("design:type",Object)],y.prototype,"grid",void 0),e([(0,o.postConstruct)(),t("design:type",Function),t("design:paramtypes",[]),t("design:returntype",void 0)],y.prototype,"init",null),n.HelperLineManager=y=e([(0,o.injectable)()],y)})(X9);var uM={},Bc={},pZ=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Bc,"__esModule",{value:!0});Bc.SelectionBoundsView=Bc.HelperLineView=void 0;const Op=z,mZ=k;let F5=class extends Op.ShapeView{render(e,t){return(0,Op.svg)("g",null,(0,Op.svg)("line",{"data-alignment":e.lineType,x1:e.startPoint.x,y1:e.startPoint.y,x2:e.endPoint.x,y2:e.endPoint.y,"class-helper-line":!0}))}};Bc.HelperLineView=F5;Bc.HelperLineView=F5=pZ([(0,mZ.injectable)()],F5);let x5=class extends Op.ShapeView{render(e,t,i){if(this.isVisible(e,t))return(0,Op.svg)("g",null,(0,Op.svg)("rect",{"class-selection-bounds":!0,x:0,y:0,width:Math.max(e.size.width,0),height:Math.max(e.size.height,0)}))}};Bc.SelectionBoundsView=x5;Bc.SelectionBoundsView=x5=pZ([(0,mZ.injectable)()],x5);Object.defineProperty(uM,"__esModule",{value:!0});uM.helperLineModule=void 0;const Vn=z,Gwe=Ss,xV=Pn,HV=dM,Uwe=X9,GE=th,KV=Bc;uM.helperLineModule=new Vn.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};(0,Vn.configureModelElement)(o,GE.HELPER_LINE,GE.HelperLine,KV.HelperLineView),(0,Vn.configureModelElement)(o,GE.SELECTION_BOUNDS,GE.SelectionBounds,KV.SelectionBoundsView),(0,Vn.configureCommand)(o,HV.DrawHelperLinesFeedbackCommand),(0,Vn.configureCommand)(o,HV.RemoveHelperLinesFeedbackCommand),(0,Vn.bindAsService)(n,Vn.TYPES.IHelperLineManager,Uwe.HelperLineManager),(0,Vn.configureActionHandler)(o,Vn.SetBoundsAction.KIND,Vn.TYPES.IHelperLineManager),(0,Vn.configureActionHandler)(o,Gwe.SetBoundsFeedbackAction.KIND,Vn.TYPES.IHelperLineManager),(0,Vn.configureActionHandler)(o,Vn.MoveAction.KIND,Vn.TYPES.IHelperLineManager),(0,Vn.configureActionHandler)(o,xV.MoveInitializedEventAction.KIND,Vn.TYPES.IHelperLineManager),(0,Vn.configureActionHandler)(o,xV.MoveFinishedEventAction.KIND,Vn.TYPES.IHelperLineManager)},{featureId:Symbol("helperLine")});var Xb={};Object.defineProperty(Xb,"__esModule",{value:!0});Xb.SaveModelKeyboardListener=void 0;const _D=z;class Ywe extends _D.KeyListener{keyDown(e,t){return(0,_D.matchesKeystroke)(t,"KeyS","ctrlCmd")?[_D.SaveModelAction.create()]:[]}}Xb.SaveModelKeyboardListener=Ywe;var Jb={};Object.defineProperty(Jb,"__esModule",{value:!0});Jb.saveModule=void 0;const yD=z,qwe=Xb;Jb.saveModule=new yD.FeatureModule(n=>{(0,yD.bindAsService)(n,yD.TYPES.KeyListener,qwe.SaveModelKeyboardListener)},{featureId:Symbol("save")});var eS={};Object.defineProperty(eS,"__esModule",{value:!0});eS.GLSPUndoRedoKeyListener=void 0;const gl=z;class Wwe extends gl.KeyListener{keyDown(e,t){return(0,gl.matchesKeystroke)(t,"KeyZ","ctrlCmd")?[gl.UndoAction.create()]:(0,gl.matchesKeystroke)(t,"KeyZ","ctrlCmd","shift")||!(0,gl.isMac)()&&(0,gl.matchesKeystroke)(t,"KeyY","ctrlCmd")?[gl.RedoAction.create()]:[]}}eS.GLSPUndoRedoKeyListener=Wwe;var tS={};Object.defineProperty(tS,"__esModule",{value:!0});tS.undoRedoModule=void 0;const bD=z,Zwe=eS;tS.undoRedoModule=new bD.FeatureModule((n,e,t,i)=>{(0,bD.bindAsService)(n,bD.TYPES.KeyListener,Zwe.GLSPUndoRedoKeyListener)},{featureId:Symbol("undoRedo")});var gZ={};(function(n){var e=f&&f.__createBinding||(Object.create?function(i,o,r,s){s===void 0&&(s=r);var a=Object.getOwnPropertyDescriptor(o,r);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,s,a)}:function(i,o,r,s){s===void 0&&(s=r),i[s]=o[r]}),t=f&&f.__exportStar||function(i,o){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(o,r)&&e(o,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),t(z,n)})(gZ);var vZ={};(function(n){var e=f&&f.__decorate||function(P,E,A,L){var B=arguments.length,U=B<3?E:L===null?L=Object.getOwnPropertyDescriptor(E,A):L,p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")U=Reflect.decorate(P,E,A,L);else for(var b=P.length-1;b>=0;b--)(p=P[b])&&(U=(B<3?p(U):B>3?p(E,A,U):p(E,A))||U);return B>3&&U&&Object.defineProperty(E,A,U),U},t=f&&f.__metadata||function(P,E){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(P,E)};Object.defineProperty(n,"__esModule",{value:!0}),n.STANDALONE_MODULE_CONFIG=n.STANDALONE_MODULES=n.LayoutKeyListener=n.FallbackActionHandler=n.standaloneDefaultModule=void 0;const i=z,o=k,r=wR,s=RR,a=Jb,u=BR,h=tS,g=YR,y=qR;n.standaloneDefaultModule=new i.FeatureModule((P,E,A,L)=>{const B={bind:P,unbind:E,isBound:A,rebind:L};P(S).toSelf().inSingletonScope(),(0,i.configureActionHandler)(B,i.MessageAction.KIND,S),(0,i.configureActionHandler)(B,i.StartProgressAction.KIND,S),(0,i.configureActionHandler)(B,i.UpdateProgressAction.KIND,S),(0,i.configureActionHandler)(B,i.EndProgressAction.KIND,S),(0,i.bindAsService)(B,i.TYPES.KeyListener,w)},{featureId:Symbol("standaloneDefault")});let S=class{handle(E){this.logger.log(this,"Unhandled action received:",E)}};n.FallbackActionHandler=S,e([(0,o.inject)(i.TYPES.ILogger),t("design:type",Object)],S.prototype,"logger",void 0),n.FallbackActionHandler=S=e([(0,o.injectable)()],S);let w=class extends i.KeyListener{keyDown(E,A){return(0,i.matchesKeystroke)(A,"KeyL","ctrlCmd","shift")?[i.LayoutOperation.create()]:[]}};n.LayoutKeyListener=w,n.LayoutKeyListener=w=e([(0,o.injectable)()],w),n.STANDALONE_MODULES=[y.standaloneViewportModule,r.standaloneCopyPasteModule,g.standaloneMarkerNavigatorModule,u.standaloneSelectModule,s.standaloneExportModule,n.standaloneDefaultModule,a.saveModule,h.undoRedoModule],n.STANDALONE_MODULE_CONFIG={add:[...n.STANDALONE_MODULES]}})(vZ);var Ke={};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.isAfter=Ke.isBefore=Ke.isBelow=Ke.isAbove=Ke.compareFunction=Ke.sortBy=Ke.bottomRight=Ke.bottomCenter=Ke.bottomLeft=Ke.middleRight=Ke.middleCenter=Ke.middleLeft=Ke.topRight=Ke.topCenter=Ke.topLeft=Ke.bottom=Ke.middle=Ke.top=Ke.right=Ke.center=Ke.left=void 0;const Fn=z;Ke.left=Fn.Bounds.left;Ke.center=Fn.Bounds.center;Ke.right=Fn.Bounds.right;Ke.top=Fn.Bounds.top;Ke.middle=Fn.Bounds.middle;Ke.bottom=Fn.Bounds.bottom;Ke.topLeft=Fn.Bounds.topLeft;Ke.topCenter=Fn.Bounds.topCenter;Ke.topRight=Fn.Bounds.topRight;Ke.middleLeft=Fn.Bounds.middleLeft;Ke.middleCenter=Fn.Bounds.middleCenter;Ke.middleRight=Fn.Bounds.middleRight;Ke.bottomLeft=Fn.Bounds.bottomLeft;Ke.bottomCenter=Fn.Bounds.bottomCenter;Ke.bottomRight=Fn.Bounds.bottomRight;Ke.sortBy=Fn.Bounds.sortBy;const Qwe=n=>(e,t)=>n(e)-n(t);Ke.compareFunction=Qwe;Ke.isAbove=Fn.Bounds.isAbove;Ke.isBelow=Fn.Bounds.isBelow;Ke.isBefore=Fn.Bounds.isBefore;Ke.isAfter=Fn.Bounds.isAfter;var Tm={},L1={},Xwe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(L1,"__esModule",{value:!0});L1.GEdgeView=void 0;const UE=z,Jwe=k,eAe=ls;let H5=class extends UE.PolylineEdgeView{render(e,t){const o=this.edgeRouterRegistry.get(e.routerKind).route(e);return o.length===0?this.renderDanglingEdge("Cannot compute route",e,t):(0,UE.svg)("g",{"class-sprotty-edge":!0,"class-mouseover":e.hoverFeedback,...this.additionalClasses(e,t)},this.renderLine(e,o,t),this.renderAdditionals(e,o,t),t.renderChildren(e,{route:o}))}additionalClasses(e,t){return{}}renderLine(e,t,i){return(0,UE.svg)("path",{d:this.createPathForSegments(t)})}renderAdditionals(e,t,i){const o=eAe.EdgePadding.from(e);return o?[this.renderMouseHandle(t,o)]:[]}renderMouseHandle(e,t){return(0,UE.svg)("path",{"class-mouse-handle":!0,d:this.createPathForSegments(e),"style-stroke-width":t*2,"style-stroke":"transparent","style-stroke-dasharray":"none","style-stroke-dashoffset":"0"})}createPathForSegments(e){const t=e[0];let i=`M ${t.x},${t.y}`;for(let o=1;o<e.length;o++){const r=e[o];i+=` L ${r.x},${r.y}`}return i}};L1.GEdgeView=H5;L1.GEdgeView=H5=Xwe([(0,Jwe.injectable)()],H5);var j1={},_Z=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},tAe=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(j1,"__esModule",{value:!0});j1.GGraphView=void 0;const up=z,K5=k,Dv=O1;let vw=class extends up.SGraphView{render(e,t){const i=super.render(e,t);return i.data&&(i.data.style={...i.data.style,...this.getGridStyle(e,t)}),i}getGridStyle(e,t){if(t.targetKind==="hidden"||!this.gridManager)return{};const i=this.getBackgroundBounds(e,t,this.gridManager);return{[Dv.GridProperty.GRID_BACKGROUND_X]:i.x+"px",[Dv.GridProperty.GRID_BACKGROUND_Y]:i.y+"px",[Dv.GridProperty.GRID_BACKGROUND_WIDTH]:i.width+"px",[Dv.GridProperty.GRID_BACKGROUND_HEIGHT]:i.height+"px",[Dv.GridProperty.GRID_BACKGROUND_ZOOM]:e.zoom+""}}getBackgroundBounds(e,t,i){const o=up.Point.multiplyScalar(up.Point.subtract(i.grid,e.scroll),e.zoom),r=up.Dimension.fromPoint(up.Point.multiplyScalar(i.grid,e.zoom));return{...o,...r}}};j1.GGraphView=vw;_Z([(0,K5.inject)(up.TYPES.IGridManager),(0,K5.optional)(),tAe("design:type",Object)],vw.prototype,"gridManager",void 0);j1.GGraphView=vw=_Z([(0,K5.injectable)()],vw);var N1={},nAe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(N1,"__esModule",{value:!0});N1.GIssueMarkerView=void 0;const vl=z,iAe=k;let V5=class extends vl.IssueMarkerView{render(e,t){const i=super.getMaxSeverity(e),o=(0,vl.svg)("g",{"class-sprotty-issue":!0},(0,vl.svg)("g",null,this.getGlspIssueMarkerBackground(i),(0,vl.svg)("path",{d:this.getGlspIssueMarkerPath(i)})));return(0,vl.setClass)(o,"sprotty-"+i,!0),o}getGlspIssueMarkerBackground(e){switch(e){case"warning":return(0,vl.svg)("polygon",{"class-sprotty-issue-background":!0,points:"8 2, 15.9 14.9, 0.2 14.9"});case"error":case"info":return(0,vl.svg)("circle",{"class-sprotty-issue-background":!0,r:this.radius,cx:this.radius,cy:this.radius})}}get radius(){return 8}getGlspIssueMarkerPath(e){switch(e){case"error":return"m 8.8527788,0.00699568 c 1.8523692,0.115773 3.5889642,1.04195762 4.8624692,2.31546152 1.505048,1.620823 2.31546,3.5889653 2.31546,5.9044268 0,1.852369 -0.694637,3.588965 -1.852367,5.094015 -1.157733,1.389277 -2.778554,2.431235 -4.6309235,2.778554 C 7.6950478,16.446772 5.8426784,16.215226 4.2218552,15.289042 2.6010319,14.362857 1.3275281,12.97358 0.63288942,11.236984 -0.06174907,9.5003878 -0.17752216,7.5322456 0.4013433,5.7956494 0.98020876,3.9432802 2.0221665,2.4382302 3.6429898,1.3962725 5.14804,0.35431486 7.0004094,-0.10877742 8.8527788,0.00699568 Z M 9.4316445,14.941722 c 1.5050505,-0.347319 2.8943275,-1.15773 3.9362845,-2.431234 0.926185,-1.273504 1.50505,-2.778554 1.389277,-4.3993771 0,-1.8523692 -0.69464,-3.7047384 -1.968142,-4.9782422 C 11.631331,1.9751379 10.242054,1.2804995 8.6212324,1.1647264 7.1161824,1.0489533 5.4953592,1.3962725 4.2218552,2.3224572 2.9483511,3.2486418 2.0221665,4.5221456 1.5590742,6.1429686 c -0.4630923,1.50505 -0.4630923,3.1258731 0.2315462,4.6309234 0.6946384,1.50505 1.7365963,2.66278 3.1258734,3.473192 1.3892769,0.810411 3.0101002,1.041958 4.5151507,0.694638 z M 8.042367,7.5322456 10.82092,4.6379187 11.631331,5.4483302 8.8527788,8.3426571 11.631331,11.236984 10.82092,12.047395 8.042367,9.1530686 5.2638128,12.047395 4.4534013,11.236984 7.2319555,8.3426571 4.4534013,5.4483302 5.2638128,4.6379187 Z";case"warning":return"M 7.5587159,0.61312771 H 8.565869 L 16.050847,14.644601 15.54727,15.491525 H 0.55442396 L 0.05084746,14.644601 Z M 8.0622924,2.0780776 1.5157974,14.347033 H 14.585897 Z M 8.7776,13.202541 V 12.058049 H 7.3469848 v 1.144492 z M 7.3469848,10.913557 V 6.3355883 H 8.7776 v 4.5779687 z";case"info":return"M 8.7624795,0.01729008 A 7.8878137,7.8878137 0 0 1 13.625085,2.3592747 8.1894066,8.1894066 0 0 1 14.158672,13.251418 7.9458123,7.9458123 0 0 1 4.2061071,15.26977 8.1198082,8.1198082 0 0 1 0.58699265,11.209866 8.259005,8.259005 0 0 1 0.32019895,5.7463948 8.1198082,8.1198082 0 0 1 3.533323,1.3500986 7.8878137,7.8878137 0 0 1 8.7624795,0.01729008 Z M 9.3099868,14.921778 A 6.8322386,6.8322386 0 0 0 13.265493,12.520635 7.0410337,7.0410337 0 0 0 12.801504,3.1712556 6.7510406,6.7510406 0 0 0 4.1829077,2.3128758 7.029434,7.029434 0 0 0 4.762894,14.248994 6.7394408,6.7394408 0 0 0 9.3099868,14.921778 Z M 7.3786322,5.7811939 H 8.8285979 V 4.6212213 H 7.3786322 Z M 8.8285979,6.9411665 V 11.581057 H 7.3786322 V 6.9411665 Z"}}};N1.GIssueMarkerView=V5;N1.GIssueMarkerView=V5=nAe([(0,iAe.injectable)()],V5);var Ou={},yf={};Object.defineProperty(yf,"__esModule",{value:!0});yf.scaledRadius=yf.RoundedCornerWrapper=void 0;class oAe{constructor(e,t){this.element=e,this.cornerRadius=t}get size(){return this.element.size}get topLeftCorner(){return this._topLeftCorner||(this._topLeftCorner={radiusX:Ya(this.cornerRadius.topLeft,this.element.size.width/2),radiusY:Ya(this.cornerRadius.topLeft,this.element.size.height/2)}),this._topLeftCorner}get topRightCorner(){return this._topRightCorner||(this._topRightCorner={radiusX:Ya(this.cornerRadius.topRight,this.element.size.width/2),radiusY:Ya(this.cornerRadius.topRight,this.element.size.height/2)}),this._topRightCorner}get bottomRightCorner(){return this._bottomRightCorner||(this._bottomRightCorner={radiusX:Ya(this.cornerRadius.bottomRight,this.element.size.width/2),radiusY:Ya(this.cornerRadius.bottomRight,this.element.size.height/2)}),this._bottomRightCorner}get bottomLeftCorner(){return this._bottomLeftCorner||(this._bottomLeftCorner={radiusX:Ya(this.cornerRadius.bottomLeft,this.element.size.width/2),radiusY:Ya(this.cornerRadius.bottomLeft,this.element.size.height/2)}),this._bottomLeftCorner}}yf.RoundedCornerWrapper=oAe;function Ya(n,e){return n<=e?n:n*(e/n)}yf.scaledRadius=Ya;var rAe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(Ou,"__esModule",{value:!0});Ou.toClipPathId=Ou.RoundedCornerNodeView=void 0;const gd=z,sAe=k,aAe=ls,cAe=yf;let z5=class extends gd.RectangularNodeView{render(e,t){const i=aAe.CornerRadius.from(e);if(!i)return this.renderWithoutRadius(e,t);const o=new cAe.RoundedCornerWrapper(e,i);return(0,gd.svg)("g",{"class-node":!0},(0,gd.svg)("defs",null,(0,gd.svg)("clipPath",{id:yZ(e)},(0,gd.svg)("path",{d:this.renderPath(o,t,this.getClipPathInsets()||0)}))),this.renderPathNode(o,t),t.renderChildren(e))}renderWithoutRadius(e,t){return super.render(e,t)}getClipPathInsets(){return 2}renderPathNode(e,t){return(0,gd.svg)("path",{d:this.renderPath(e,t,0),"class-sprotty-node":e.element instanceof gd.GNode,"class-sprotty-port":e.element instanceof gd.GPort,"class-mouseover":e.element.hoverFeedback,"class-selected":e.element.selected,...this.additionalClasses(e.element,t)})}additionalClasses(e,t){return{}}renderPath(e,t,i){const o=Math.max(0,e.size.width-e.cornerRadius.topLeft-e.cornerRadius.topRight),r=Math.max(0,e.size.height-e.cornerRadius.topRight-e.cornerRadius.bottomRight),s=Math.max(0,e.size.width-e.cornerRadius.bottomLeft-e.cornerRadius.bottomRight);return`M${0+i},${0+e.topLeftCorner.radiusY}q0,${-(e.topLeftCorner.radiusY-i)} ${e.topLeftCorner.radiusX-i},${-(e.topLeftCorner.radiusY-i)}h${o}q${e.topRightCorner.radiusX-i},0 ${e.topRightCorner.radiusX-i},${e.topRightCorner.radiusY-i}v${r}q0,${e.bottomRightCorner.radiusY-i} ${-(e.bottomRightCorner.radiusX-i)},${e.bottomRightCorner.radiusY-i}h${-s}q${-(e.bottomLeftCorner.radiusX-i)},0 ${-(e.bottomLeftCorner.radiusX-i)},${-(e.bottomLeftCorner.radiusY-i)}z `}};Ou.RoundedCornerNodeView=z5;Ou.RoundedCornerNodeView=z5=rAe([(0,sAe.injectable)()],z5);function yZ(n){return`${n.id}_clip_path`}Ou.toClipPathId=yZ;Object.defineProperty(Tm,"__esModule",{value:!0});Tm.configureDefaultModelElements=Tm.baseViewModule=void 0;const ye=z,dAe=Ni,VV=ni,uAe=L1,lAe=j1,fAe=N1,hAe=Ou;Tm.baseViewModule=new ye.FeatureModule((n,e,t,i)=>{bZ({bind:n,unbind:e,isBound:t,rebind:i})},{featureId:Symbol("baseView")});function bZ(n){(0,ye.configureModelElement)(n,ye.DefaultTypes.HTML,ye.GHtmlRoot,ye.HtmlRootView),(0,ye.configureModelElement)(n,ye.DefaultTypes.FOREIGN_OBJECT,ye.GForeignObjectElement,ye.ForeignObjectView,{disable:[ye.selectFeature,ye.moveFeature]}),(0,ye.configureModelElement)(n,ye.DefaultTypes.PRE_RENDERED,ye.GPreRenderedElement,ye.PreRenderedView),(0,ye.configureModelElement)(n,ye.DefaultTypes.SHAPE_PRE_RENDERED,ye.GShapedPreRenderedElement,ye.PreRenderedView),(0,ye.configureModelElement)(n,ye.DefaultTypes.SVG,ye.GViewportRootElement,ye.SvgViewportView),(0,ye.configureModelElement)(n,ye.DefaultTypes.GRAPH,VV.GGraph,lAe.GGraphView),(0,ye.configureModelElement)(n,ye.DefaultTypes.NODE,ye.GNode,hAe.RoundedCornerNodeView),(0,ye.configureModelElement)(n,ye.DefaultTypes.COMPARTMENT,ye.GCompartment,ye.GCompartmentView),(0,ye.configureModelElement)(n,ye.DefaultTypes.COMPARTMENT_HEADER,ye.GCompartment,ye.GCompartmentView),(0,ye.configureModelElement)(n,ye.DefaultTypes.EDGE,VV.GEdge,uAe.GEdgeView),(0,ye.configureModelElement)(n,ye.DefaultTypes.PORT,ye.GPort,ye.RectangularNodeView),(0,ye.configureModelElement)(n,ye.DefaultTypes.ROUTING_POINT,ye.GRoutingHandle,ye.GRoutingHandleView),(0,ye.configureModelElement)(n,ye.DefaultTypes.VOLATILE_ROUTING_POINT,ye.GRoutingHandle,ye.GRoutingHandleView),(0,ye.configureModelElement)(n,ye.DefaultTypes.LABEL,ye.GLabel,ye.GLabelView),(0,ye.configureModelElement)(n,ye.DefaultTypes.BUTTON_EXPAND,ye.GButton,ye.ExpandButtonView),(0,ye.configureModelElement)(n,ye.DefaultTypes.ISSUE_MARKER,dAe.GIssueMarker,fAe.GIssueMarkerView),(0,ye.configureModelElement)(n,ye.DefaultTypes.NODE_CIRCLE,ye.CircularNode,ye.CircularNodeView),(0,ye.configureModelElement)(n,ye.DefaultTypes.NODE_DIAMOND,ye.DiamondNode,ye.DiamondNodeView),(0,ye.configureModelElement)(n,ye.DefaultTypes.NODE_RECTANGLE,ye.RectangularNode,ye.RectangularNodeView)}Tm.configureDefaultModelElements=bZ;var nS={},pAe=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};Object.defineProperty(nS,"__esModule",{value:!0});nS.StructureCompartmentView=void 0;const SD=z,mAe=k;let G5=class extends SD.ShapeView{render(e,t){if(this.isVisible(e,t))return(0,SD.svg)("g",null,(0,SD.svg)("rect",{"class-sprotty-comp":!0,x:"0",y:"0",width:e.size.width,height:e.size.height}),t.renderChildren(e))}};nS.StructureCompartmentView=G5;nS.StructureCompartmentView=G5=pAe([(0,mAe.injectable)()],G5);var iS={},J9=f&&f.__decorate||function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},SZ=f&&f.__metadata||function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};Object.defineProperty(iS,"__esModule",{value:!0});iS.GLSPProjectionView=void 0;const ho=z,_w=k,zV=ig,Ov=O1;let Ky=class extends ho.ProjectedViewportView{render(e,t,i){const o=(0,ho.html)("div",{"class-sprotty-graph":!1,style:{width:"100%",height:"100%"}},this.renderSvg(e,t,i),this.renderProjections(e,t,i));return(0,ho.setAttr)(o,"tabindex",1),(0,ho.setAttr)(o,"aria-label","Diagram"),o}renderSvg(e,t,i){const o=this.edgeRouterRegistry.routeAllChildren(e),r=`scale(${e.zoom}) translate(${-e.scroll.x},${-e.scroll.y})`,s="http://www.w3.org/2000/svg";return(0,zV.h)("svg",{ns:s,style:{height:"100%",...this.getGridStyle(e,t)},class:{"sprotty-graph":!0}},(0,zV.h)("g",{ns:s,attrs:{transform:r}},t.renderChildren(e,{edgeRouting:o})))}getGridStyle(e,t){if(t.targetKind==="hidden"||!this.gridManager)return{};const i=this.getBackgroundBounds(e,t,this.gridManager);return{[Ov.GridProperty.GRID_BACKGROUND_X]:i.x+"px",[Ov.GridProperty.GRID_BACKGROUND_Y]:i.y+"px",[Ov.GridProperty.GRID_BACKGROUND_WIDTH]:i.width+"px",[Ov.GridProperty.GRID_BACKGROUND_HEIGHT]:i.height+"px",[Ov.GridProperty.GRID_BACKGROUND_ZOOM]:e.zoom+""}}getBackgroundBounds(e,t,i){const o=ho.Point.multiplyScalar(ho.Point.subtract(i.grid,e.scroll),e.zoom),r=ho.Dimension.fromPoint(ho.Point.multiplyScalar(i.grid,e.zoom));return{...o,...r}}renderProjectionBar(e,t,i,o){const r=super.renderProjectionBar(e,t,i,o);return(0,ho.setClass)(r,"bordered-projection-bar",!0),r}renderViewport(e,t){let i,o;t.orientation==="horizontal"?(i=e.canvasBounds.width,o=(e.scroll.x-t.modelBounds.x)*t.factor):(i=e.canvasBounds.height,o=(e.scroll.y-t.modelBounds.y)*t.factor);let r=i*t.zoomedFactor;o<0?(r+=o,o=0):o>i&&(o=i),r<0?r=0:o+r>i&&(r=i-o),Math.abs(r-i)<1&&(r=0);const s=t.orientation==="horizontal"?{left:`${o}px`,width:`${r}px`}:{top:`${o}px`,height:`${r}px`};return(0,ho.html)("div",{"class-sprotty-viewport":r!==0,"class-projection-scroll-bar":!0,style:s})}renderProjection(e,t,i){const o=super.renderProjection(e,t,i);(0,ho.setClass)(o,"glsp-projection",!0);const r=o.data.style;return r.left?r.height="60%":r.width="60%",o}};iS.GLSPProjectionView=Ky;J9([(0,_w.inject)(ho.EdgeRouterRegistry),SZ("design:type",ho.EdgeRouterRegistry)],Ky.prototype,"edgeRouterRegistry",void 0);J9([(0,_w.inject)(ho.TYPES.IGridManager),(0,_w.optional)(),SZ("design:type",Object)],Ky.prototype,"gridManager",void 0);iS.GLSPProjectionView=Ky=J9([(0,_w.injectable)()],Ky);(function(n){var e=f&&f.__createBinding||(Object.create?function(i,o,r,s){s===void 0&&(s=r);var a=Object.getOwnPropertyDescriptor(o,r);(!a||("get"in a?!o.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return o[r]}}),Object.defineProperty(i,s,a)}:function(i,o,r,s){s===void 0&&(s=r),i[s]=o[r]}),t=f&&f.__exportStar||function(i,o){for(var r in i)r!=="default"&&!Object.prototype.hasOwnProperty.call(o,r)&&e(o,i,r)};Object.defineProperty(n,"__esModule",{value:!0}),t(Pt,n),t(Qf,n),t(Cg,n),t(nb,n),t(uu,n),t(ZY,n),t(ib,n),t(Wl,n),t(Pg,n),t(ob,n),t(Kr,n),t(An,n),t(it,n),t(gc,n),t(wg,n),t(Gn,n),t(rb,n),t(Ag,n),t(Rg,n),t(Ma,n),t(Vc,n),t(lu,n),t(Ro,n),t(ys,n),t(Tg,n),t(Dg,n),t(Is,n),t(Og,n),t(Yt,n),t(It,n),t(Dr,n),t(Ms,n),t(Ng,n),t(Xf,n),t(Jf,n),t(Bg,n),t(uq,n),t(QR,n),t(qc,n),t(b1,n),t(eZ,n),t(tr,n),t(Mu,n),t(va,n),t(T9,n),t(tZ,n),t(Zb,n),t(v1,n),t(_1,n),t(j9,n),t(y1,n),t(S1,n),t(to,n),t(Ac,n),t($9,n),t(nr,n),t(Br,n),t(dh,n),t(qo,n),t(E1,n),t(C1,n),t(Wc,n),t(uh,n),t(Ub,n),t(cf,n),t(Yb,n),t(ch,n),t(df,n),t(bo,n),t(uf,n),t(So,n),t(fs,n),t(ff,n),t(Ic,n),t(Xi,n),t(pf,n),t(Rc,n),t(ar,n),t(K9,n),t(M1,n),t(Iu,n),t(Tu,n),t(mf,n),t(Du,n),t(ab,n),t($g,n),t(hu,n),t(kg,n),t(Ia,n),t(pu,n),t(Mo,n),t(Ss,n),t(Fg,n),t(io,n),t(Mr,n),t(nM,n),t(eh,n),t(_f,n),t(nf,n),t(xg,n),t(cb,n),t(Hg,n),t(mu,n),t(db,n),t(Qb,n),t(Kg,n),t(gu,n),t(Wn,n),t(vc,n),t(wR,n),t(Gg,n),t(W9,n),t(T1,n),t(Lc,n),t(oM,n),t(lb,n),t(Ug,n),t(yo,n),t(Yg,n),t(Kb,n),t(_c,n),t(RR,n),t(qg,n),t(Wg,n),t(dZ,n),t(D1,n),t(jc,n),t(aM,n),t(Nc,n),t(O1,n),t(dM,n),t(hZ,n),t(X9,n),t(uM,n),t(th,n),t(Bc,n),t(Zg,n),t(ds,n),t(fb,n),t(Xg,n),t(pb,n),t(t1,n),t(gb,n),t(n1,n),t(us,n),t(vb,n),t(on,n),t(_b,n),t(ia,n),t(yb,n),t(oh,n),t(hb,n),t(Qi,n),t(Sb,n),t(Xb,n),t(Jb,n),t(s1,n),t(BR,n),t(a1,n),t(Sc,n),t(Eb,n),t(Pb,n),t(c1,n),t(d1,n),t(wb,n),t(Tn,n),t(Ab,n),t(_i,n),t($R,n),t(bu,n),t(Pn,n),t(Tb,n),t(Lb,n),t(kR,n),t(Pc,n),t(mi,n),t(Nb,n),t(Uc,n),t(Bb,n),t(yc,n),t(e1,n),t(Jg,n),t($b,n),t(Cu,n),t(mt,n),t(rh,n),t(eo,n),t(Fb,n),t(wc,n),t(Ib,n),t(xb,n),t(l1,n),t(zR,n),t(u1,n),t(Hb,n),t(oa,n),t(f1,n),t(Au,n),t(eS,n),t(tS,n),t(Ni,n),t(En,n),t(Bn,n),t(YR,n),t(m1,n),t(Ec,n),t(ga,n),t(g1,n),t(qR,n),t(ni,n),t(gZ,n),t(vZ,n),t(ls,n),t(Ke,n),t(kt,n),t(vf,n),t(yn,n),t(sf,n),t(Ct,n),t(Tm,n),t(nS,n),t(L1,n),t(j1,n),t(iS,n),t(N1,n),t(yf,n),t(Ou,n)})(m);var yw;(function(n){n.KIND="elementAnimate";function e(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasArrayProp(i,"elementIds")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(yw||(yw={}));var U5;(function(n){n.KIND="autoAlign";function e(t){return{kind:n.KIND,isOperation:!0,...t}}n.create=e})(U5||(U5={}));var Vy;(function(n){n.KIND="attachBoundary";function e(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasStringProp(i,"elementId")&&ct.hasStringProp(i,"eventKind")}n.is=e;function t(i){return{kind:n.KIND,isOperation:!0,...i}}n.create=t})(Vy||(Vy={}));var Y5;(function(n){n.KIND="setBreakpoint";function e(t){return{kind:n.KIND,...t}}n.create=e})(Y5||(Y5={}));var q5;(function(n){n.KIND="toggleBreakpoint";function e(t){return{kind:n.KIND,...t}}n.create=e})(q5||(q5={}));var bw;(function(n){n.KIND="showBreakpoints";function e(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasArrayProp(i,"elementBreakpoints")&&ct.hasBooleanProp(i,"globalDisabled")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(bw||(bw={}));var zy;(function(n){n.KIND="changeColor";function e(o){return i(o)}n.changeColor=e;function t(o){return i(o)}n.deleteColor=t;function i(o){return{kind:n.KIND,isOperation:!0,...o}}n.create=i})(zy||(zy={}));var Sw;(function(n){n.KIND="updateColorPalette";function e(t){return ct.Action.hasKind(t,n.KIND)}n.is=e})(Sw||(Sw={}));var W5;(function(n){n.KIND="straightenEdge";function e(t){return{kind:n.KIND,isOperation:!0,...t}}n.create=e})(W5||(W5={}));var Z5;(function(n){n.KIND="autoBendEdge";function e(t){return{kind:n.KIND,isOperation:!0,...t}}n.create=e})(Z5||(Z5={}));var Gy;(function(n){n.KIND="toggleCustomIcons";function e(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasBooleanProp(i,"showCustomIcons")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(Gy||(Gy={}));var Ew;(function(n){n.KIND="openDataClassEditor";function e(){return{kind:n.KIND}}n.create=e;function t(i){return ct.Action.hasKind(i,n.KIND)}n.is=t})(Ew||(Ew={}));var Q5;(function(n){n.KIND="openDecoratorBrowser";function e(t){return{kind:n.KIND,elementId:t}}n.create=e})(Q5||(Q5={}));var Cw;(function(n){n.KIND="setExecutedElements";function e(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasArrayProp(i,"elementExecutions")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(Cw||(Cw={}));var Pw;(function(n){n.KIND="elementStopped";function e(i){return ct.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(Pw||(Pw={}));var Uy;(function(n){n.KIND="openFormEditor";function e(i){return{kind:n.KIND,...i}}n.create=e;function t(i){return ct.Action.hasKind(i,n.KIND)}n.is=t})(Uy||(Uy={}));var X5;(function(n){n.KIND="goToSource";function e(t){return{kind:n.KIND,elementId:t}}n.create=e})(X5||(X5={}));var bf;(function(n){n.KIND="jumpInto";function e(i){return{kind:n.KIND,...i}}n.create=e;function t(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasStringProp(i,"elementId")}n.is=t})(bf||(bf={}));var J5;(function(n){function e(t,i={}){return{kind:ct.UpdateModelAction.KIND,newRoot:t,...i}}n.create=e})(J5||(J5={}));var GV;(function(n){n.KIND="openQuickOutline";function e(){return{kind:n.KIND}}n.create=e})(GV||(GV={}));var Sa;(function(n){n.KIND="updatePaletteItems";function e(){return{kind:n.KIND}}n.create=e;function t(i){return ct.Action.hasKind(i,n.KIND)}n.is=t})(Sa||(Sa={}));var eL;(function(n){n.KIND="startProcess";function e(i,o){return{kind:n.KIND,elementId:i,processStartUri:o}}n.create=e;function t(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasStringProp(i,"elementId")&&ct.hasStringProp(i,"processStartUri")}n.is=t})(eL||(eL={}));var tL;(function(n){n.KIND="searchProcessCallers";function e(t){return{kind:n.KIND,elementId:t}}n.create=e})(tL||(tL={}));var Dm;(function(n){n.KIND="switchTheme";function e(i){return ct.Action.hasKind(i,n.KIND)&&ct.hasStringProp(i,"theme")}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(Dm||(Dm={}));var nL;(function(n){n.KIND="changeActivityType";function e(t){return{kind:n.KIND,isOperation:!0,...t}}n.create=e})(nL||(nL={}));var Yy;(function(n){n.KIND="enableViewport";function e(i){return ct.Action.hasKind(i,n.KIND)}n.is=e;function t(){return{kind:n.KIND}}n.create=t})(Yy||(Yy={}));var ww;(function(n){n.KIND="originViewport";function e(t={}){return{kind:n.KIND,animate:!0,...t}}n.create=e})(ww||(ww={}));var qy;(function(n){n.KIND="moveIntoViewport";function e(t){return{kind:n.KIND,animate:!0,retainZoom:!1,...t}}n.create=e})(qy||(qy={}));var Om;(function(n){n.KIND="ivyViewportZoom";function e(i){return ct.Action.hasKind(i,n.KIND)}n.is=e;function t(i){return{kind:n.KIND,...i}}n.create=t})(Om||(Om={}));var iL;(function(n){n.KIND="wrapToSub";function e(t){return{kind:n.KIND,isOperation:!0,...t}}n.create=e})(iL||(iL={}));var oL;(function(n){n.KIND="unwrapSub";function e(t){return{kind:n.KIND,isOperation:!0,...t}}n.create=e})(oL||(oL={}));const lM=Symbol("animateFeature");function UV(n){return n.hasFeature(lM)}var gAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},vAe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},_Ae=function(n,e){return function(t,i){e(t,i,n)}},lp,Aw;(function(n){function e(t){return{kind:Rw.KIND,...t}}n.create=e})(Aw||(Aw={}));var Od;let Rw=(Od=class extends m.Command{constructor(t){super();x(this,"action");x(this,"animated",[]);x(this,"deanimated",[]);this.action=t}execute(t){var o;const i=t.root;return this.action.animatedIDs.forEach(r=>{const s=i.index.getById(r);s instanceof m.GChildElement&&UV(s)&&this.animated.push(s)}),(o=this.action.deAnimatedIDs)==null||o.forEach(r=>{const s=i.index.getById(r);s instanceof m.GChildElement&&UV(s)&&this.deanimated.push(s)}),this.redo(t)}undo(t){for(const i of this.animated)m.removeCssClasses(i,lp.CSS_CLASS);for(const i of this.deanimated)m.addCssClasses(i,lp.CSS_CLASS);return t.root}redo(t){for(const i of this.deanimated)m.removeCssClasses(i,lp.CSS_CLASS);for(const i of this.animated)m.addCssClasses(i,lp.CSS_CLASS);return t.root}},lp=Od,x(Od,"KIND","elementAnimateFeedback"),x(Od,"CSS_CLASS","animate"),Od);Rw=lp=gAe([le(),_Ae(0,be(m.TYPES.Action)),vAe("design:paramtypes",[Object])],Rw);var e4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},EZ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Lm=class{constructor(){x(this,"animateElementIDs",new Set);x(this,"feedbackDispatcher");x(this,"actionDispatcher")}handle(e){if(yw.is(e))for(const t of e.elementIds){this.animateElementIDs.add(t);const i=Aw.create({animatedIDs:[...this.animateElementIDs]});this.feedbackDispatcher.registerFeedback(this,[i]),this.actionDispatcher.dispatch(qy.create({elementIds:[t]})),setTimeout(()=>{this.animateElementIDs.delete(t),this.feedbackDispatcher.registerFeedback(this,[Aw.create({animatedIDs:[...this.animateElementIDs],deAnimatedIDs:[t]})]),this.animateElementIDs.size===0&&this.feedbackDispatcher.deregisterFeedback(this,[])},2e3)}}};e4([be(m.TYPES.IFeedbackActionDispatcher),EZ("design:type",Object)],Lm.prototype,"feedbackDispatcher",void 0);e4([be(m.TYPES.IActionDispatcher),EZ("design:type",Object)],Lm.prototype,"actionDispatcher",void 0);Lm=e4([le()],Lm);const yAe=new m.FeatureModule((n,e,t)=>{n(Lm).toSelf().inSingletonScope(),m.configureActionHandler({bind:n,isBound:t},yw.KIND,Lm),m.configureCommand({bind:n,isBound:t},Rw)}),Ve={QuickActionProvider:Symbol.for("QuickActionProvider"),ToolBarButtonProvider:Symbol.for("ToolBarButtonProvider"),ToolBar:Symbol.for("ToolBar"),ColorPalette:Symbol.for("ColorPalette"),ActivityTypesPalette:Symbol.for("ActivityTypesPalette"),IvyViewerOptions:Symbol.for("IvyViewerOptions")};var N;(function(n){n.ActivitiesGroup="activities-group",n.AlignHorizontal="align-horizontal",n.AlignVertical="align-vertical",n.AlternativeGateways="alternative-gateways",n.Annotation="annotation",n.ArrowRight="arrow-right",n.ArrowUpRight="arrow-up-right",n.ArrowsMaximize="arrows-maximize",n.Attribute="attribute",n.AutoAlign="auto-align",n.Bend="bend",n.Bpmn="bpmn",n.Bug="bug",n.CalendarTime="calendar-time",n.CallOutline="call-outline",n.Call="call",n.Caution="caution",n.Center="center",n.ChangeType="change-type",n.Check="check",n.Checklist="checklist",n.Chevron="chevron",n.ClockOutline="clock-outline",n.Clock="clock",n.Close="close",n.Cms="cms",n.ColorDrop="color-drop",n.Comment="comment",n.Connector="connector",n.CustomImage="custom-image",n.DarkMode="dark-mode",n.DataClass="data-class",n.DatabaseLink="database-link",n.DatabaseOutline="database-outline",n.Database="database",n.DeviceMobile="device-mobile",n.DeviceTablet="device-tablet",n.DialogLayout="dialog-layout",n.Dots="dots",n.Download="download",n.DragDrop="drag-drop",n.Duplicate="duplicate",n.EMailOutline="e-mail-outline",n.EMail="e-mail",n.EditDots="edit-dots",n.Edit="edit",n.EndPageOutline="end-page-outline",n.EndPage="end-page",n.ErrorEnd="error-end",n.ErrorStart="error-start",n.ErrorXMark="error-x-mark",n.Error="error",n.EventStartOutline="event-start-outline",n.EventStart="event-start",n.ExitEndOutline="exit-end-outline",n.ExitEnd="exit-end",n.Extension="extension",n.Eye="eye",n.FileImport="file-import",n.File="file",n.FitToScreen="fit-to-screen",n.FolderOpen="folder-open",n.Folders="folders",n.Function="function",n.GatewaysGroup="gateways-group",n.GoToSource="go-to-source",n.GridDots="grid-dots",n.Help="help",n.Helplines="helplines",n.Home="home",n.InfoCircle="info-circle",n.InitStartOutline="init-start-outline",n.InitStart="init-start",n.Ivy="ivy",n.JoinGateways="join-gateways",n.JoinTasksGateways="join-tasks-gateways",n.JumpOut="jump-out",n.Label="label",n.LaneSwimlanes="lane-swimlanes",n.LayoutSidebarRightCollapse="layout-sidebar-right-collapse",n.LetterD="letter-d",n.ListSearch="list-search",n.List="list",n.ManualOutline="manual-outline",n.Manual="manual",n.Market="market",n.MethodStartOutline="method-start-outline",n.MethodStart="method-start",n.MultiSelection="multi-selection",n.NoteOutline="note-outline",n.Note="note",n.PasswordUser="password-user",n.Password="password",n.PenEdit="pen-edit",n.Persistence="persistence",n.Play="play",n.Plus="plus",n.PoolSwimlanes="pool-swimlanes",n.ProcessEnd="process-end",n.Process="process",n.ProgramOutline="program-outline",n.Quote="quote",n.ReceiveOutline="receive-outline",n.Receive="receive",n.Reconnect="reconnect",n.Redo="redo",n.RestClientOutline="rest-client-outline",n.RestClient="rest-client",n.RuleOutline="rule-outline",n.Rule="rule",n.ScriptFileOutline="script-file-outline",n.Script="script",n.Search="search",n.SelectionTool="selection-tool",n.Selector="selector",n.SendOutline="send-outline",n.Send="send",n.SettingsCog="settings-cog",n.SettingsOutline="settings-outline",n.Settings="settings",n.Spinner="spinner",n.Sql="sql",n.StartProgramOutline="start-program-outline",n.StartProgram="start-program",n.StartSignalOutline="start-signal-outline",n.StartSignal="start-signal",n.Start="start",n.Straighten="straighten",n.SubActivitiesDashed="sub-activities-dashed",n.SubActivities="sub-activities",n.SubEndOutline="sub-end-outline",n.SubEnd="sub-end",n.SubManualOutline="sub-manual-outline",n.SubReceiveOutline="sub-receive-outline",n.SubRuleOutline="sub-rule-outline",n.SubScriptOutline="sub-script-outline",n.SubSendOutline="sub-send-outline",n.SubStartOutline="sub-start-outline",n.SubStart="sub-start",n.SubUserOutline="sub-user-outline",n.SubWebService="sub-web-service",n.TaskDoubleOutline="task-double-outline",n.TaskOutline="task-outline",n.Task="task",n.TasksGateways="tasks-gateways",n.Toggle="toggle",n.Tool="tool",n.Trash="trash",n.TriggerOutline="trigger-outline",n.Trigger="trigger",n.Undo="undo",n.Unwrap="unwrap",n.Upload="upload",n.UserDialogOutline="user-dialog-outline",n.UserDialog="user-dialog",n.UserOutline="user-outline",n.UserTaskOutline="user-task-outline",n.UserTask="user-task",n.User="user",n.Users="users",n.WebService="web-service",n.WindowMinimize="window-minimize",n.WrapToSubprocess="wrap-to-subprocess",n.WsStartOutline="ws-start-outline",n.WsStart="ws-start"})(N||(N={}));N.ActivitiesGroup+"",N.AlignHorizontal+"",N.AlignVertical+"",N.AlternativeGateways+"",N.Annotation+"",N.ArrowRight+"",N.ArrowUpRight+"",N.ArrowsMaximize+"",N.Attribute+"",N.AutoAlign+"",N.Bend+"",N.Bpmn+"",N.Bug+"",N.CalendarTime+"",N.CallOutline+"",N.Call+"",N.Caution+"",N.Center+"",N.ChangeType+"",N.Check+"",N.Checklist+"",N.Chevron+"",N.ClockOutline+"",N.Clock+"",N.Close+"",N.Cms+"",N.ColorDrop+"",N.Comment+"",N.Connector+"",N.CustomImage+"",N.DarkMode+"",N.DataClass+"",N.DatabaseLink+"",N.DatabaseOutline+"",N.Database+"",N.DeviceMobile+"",N.DeviceTablet+"",N.DialogLayout+"",N.Dots+"",N.Download+"",N.DragDrop+"",N.Duplicate+"",N.EMailOutline+"",N.EMail+"",N.EditDots+"",N.Edit+"",N.EndPageOutline+"",N.EndPage+"",N.ErrorEnd+"",N.ErrorStart+"",N.ErrorXMark+"",N.Error+"",N.EventStartOutline+"",N.EventStart+"",N.ExitEndOutline+"",N.ExitEnd+"",N.Extension+"",N.Eye+"",N.FileImport+"",N.File+"",N.FitToScreen+"",N.FolderOpen+"",N.Folders+"",N.Function+"",N.GatewaysGroup+"",N.GoToSource+"",N.GridDots+"",N.Help+"",N.Helplines+"",N.Home+"",N.InfoCircle+"",N.InitStartOutline+"",N.InitStart+"",N.Ivy+"",N.JoinGateways+"",N.JoinTasksGateways+"",N.JumpOut+"",N.Label+"",N.LaneSwimlanes+"",N.LayoutSidebarRightCollapse+"",N.LetterD+"",N.ListSearch+"",N.List+"",N.ManualOutline+"",N.Manual+"",N.Market+"",N.MethodStartOutline+"",N.MethodStart+"",N.MultiSelection+"",N.NoteOutline+"",N.Note+"",N.PasswordUser+"",N.Password+"",N.PenEdit+"",N.Persistence+"",N.Play+"",N.Plus+"",N.PoolSwimlanes+"",N.ProcessEnd+"",N.Process+"",N.ProgramOutline+"",N.Quote+"",N.ReceiveOutline+"",N.Receive+"",N.Reconnect+"",N.Redo+"",N.RestClientOutline+"",N.RestClient+"",N.RuleOutline+"",N.Rule+"",N.ScriptFileOutline+"",N.Script+"",N.Search+"",N.SelectionTool+"",N.Selector+"",N.SendOutline+"",N.Send+"",N.SettingsCog+"",N.SettingsOutline+"",N.Settings+"",N.Spinner+"",N.Sql+"",N.StartProgramOutline+"",N.StartProgram+"",N.StartSignalOutline+"",N.StartSignal+"",N.Start+"",N.Straighten+"",N.SubActivitiesDashed+"",N.SubActivities+"",N.SubEndOutline+"",N.SubEnd+"",N.SubManualOutline+"",N.SubReceiveOutline+"",N.SubRuleOutline+"",N.SubScriptOutline+"",N.SubSendOutline+"",N.SubStartOutline+"",N.SubStart+"",N.SubUserOutline+"",N.SubWebService+"",N.TaskDoubleOutline+"",N.TaskOutline+"",N.Task+"",N.TasksGateways+"",N.Toggle+"",N.Tool+"",N.Trash+"",N.TriggerOutline+"",N.Trigger+"",N.Undo+"",N.Unwrap+"",N.Upload+"",N.UserDialogOutline+"",N.UserDialog+"",N.UserOutline+"",N.UserTaskOutline+"",N.UserTask+"",N.User+"",N.Users+"",N.WebService+"",N.WindowMinimize+"",N.WrapToSubprocess+"",N.WsStartOutline+"",N.WsStart+"";var fM=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let Un=class{multiQuickAction(e){}};Un=fM([le()],Un);let rL=class{singleQuickAction(e){}};rL=fM([le()],rL);let sL=class{singleQuickAction(e){if(m.isDeletable(e))return this.quickAction([e.id])}multiQuickAction(e){const t=e.filter(i=>m.isDeletable(i)).map(i=>i.id);if(t.length>0)return this.quickAction(t)}quickAction(e){return{icon:N.Trash,title:"Delete",location:"Left",sorting:"A",action:m.DeleteElementOperation.create(e)}}};sL=fM([le()],sL);let aL=class extends rL{multiQuickAction(e){const t=e.map(i=>i.id);if(t.length>0)return{icon:N.AutoAlign,title:"Auto Align (A)",location:"Middle",sorting:"Y",action:U5.create({elementIds:t}),shortcut:"KeyA"}}};aL=fM([le()],aL);const Mw=Symbol("multipleOutgoingEdgesFeature");function bAe(n){return n.hasFeature(Mw)}var t4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},SAe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},cL,Al;let Lp=(Al=class extends m.BaseCreationTool{constructor(){super(...arguments);x(this,"anchorRegistry");x(this,"isTriggerAction",jm.is);x(this,"creationToolMouseListener");x(this,"feedbackEndMovingMouseListener")}get id(){return cL.ID}doEnable(){this.creationToolMouseListener=new EAe(this.triggerAction,this),this.feedbackEndMovingMouseListener=new m.FeedbackEdgeEndMovingMouseListener(this.anchorRegistry,this.feedbackDispatcher),this.toDisposeOnDisable.push(this.mouseTool.registerListener(this.creationToolMouseListener)),this.toDisposeOnDisable.push(this.mouseTool.registerListener(this.feedbackEndMovingMouseListener)),this.toDisposeOnDisable.push(this.registerFeedback([m.cursorFeedbackAction(m.CursorCSS.OPERATION_NOT_ALLOWED)],this,[m.RemoveFeedbackEdgeAction.create(),m.cursorFeedbackAction()]))}},cL=Al,x(Al,"ID","quick-action-edge-creation-tool"),Al);t4([be(m.AnchorComputerRegistry),SAe("design:type",m.AnchorComputerRegistry)],Lp.prototype,"anchorRegistry",void 0);Lp=cL=t4([le()],Lp);class EAe extends m.DragAwareMouseListener{constructor(t,i){super();x(this,"triggerAction");x(this,"tool");x(this,"source");x(this,"target");x(this,"currentTarget");x(this,"allowedTarget",!1);x(this,"proxyEdge");this.triggerAction=t,this.tool=i,this.proxyEdge=new m.GEdge,this.proxyEdge.type=t.elementTypeId,this.proxyEdge.sourceId=t.sourceId,this.source=this.triggerAction.sourceId,this.tool.registerFeedback([m.DrawFeedbackEdgeAction.create({elementTypeId:this.triggerAction.elementTypeId,sourceId:this.source})])}reinitialize(){this.source=void 0,this.target=void 0,this.currentTarget=void 0,this.allowedTarget=!1,this.tool.registerFeedback([m.RemoveFeedbackEdgeAction.create()])}nonDraggingMouseUp(t,i){const o=[];return i.button===0?(this.currentTarget&&(this.target=this.currentTarget.id),this.source&&this.target&&(o.push(this.edgeOperation(this.source,this.target)),m.isCtrlOrCmd(i)?this.reinitialize():o.push(m.EnableDefaultToolsAction.create()))):i.button===2&&o.push(m.EnableDefaultToolsAction.create()),o}edgeOperation(t,i){return this.triggerAction.reconnect&&this.triggerAction.edgeId?m.ReconnectEdgeOperation.create({edgeElementId:this.triggerAction.edgeId,sourceElementId:t,targetElementId:i,args:this.triggerAction.args}):m.CreateEdgeOperation.create({elementTypeId:this.triggerAction.elementTypeId,sourceElementId:t,targetElementId:i,args:this.triggerAction.args})}isSourceSelected(){return this.source!==void 0}isTargetSelected(){return this.target!==void 0}mouseOver(t,i){const o=m.findParentByFeature(t,m.isConnectable);return o!==this.currentTarget?(this.currentTarget=o,this.currentTarget&&(this.isSourceSelected()?this.isTargetSelected()||(this.allowedTarget=this.isAllowedTarget(o)):this.allowedTarget=this.isAllowedSource(o),this.allowedTarget)?[this.isSourceSelected()?m.cursorFeedbackAction(m.CursorCSS.EDGE_CREATION_TARGET):m.cursorFeedbackAction(m.CursorCSS.EDGE_CREATION_SOURCE)]:[m.cursorFeedbackAction(m.CursorCSS.OPERATION_NOT_ALLOWED)]):[]}isAllowedSource(t){return t!==void 0&&m.isConnectable(t)&&t.canConnect(this.proxyEdge,"source")}isAllowedTarget(t){return t!==void 0&&m.isConnectable(t)&&t.canConnect(this.proxyEdge,"target")}}var jm;(function(n){n.KIND="quickActionTriggerEdgeCreation";function e(i){return m.Action.hasKind(i,n.KIND)&&m.hasStringProp(i,"elementTypeId")&&m.hasStringProp(i,"sourceId")}n.is=e;function t(i,o,r={}){return{kind:n.KIND,elementTypeId:i,sourceId:o,...r}}n.create=t})(jm||(jm={}));let dL=class extends Un{singleQuickAction(e){const t=new m.GEdge;if(t.type="edge",e instanceof m.GNode&&e.canConnect(t,"source")&&(Array.from(e.outgoingEdges).length===0||bAe(e)))return{icon:N.Connector,title:"Connect",location:"Right",sorting:"Z",action:jm.create("edge",e.id)}}};dL=t4([le()],dL);var n4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let uL=class extends Un{singleQuickAction(e){if(e instanceof m.GEdge)return{icon:N.Straighten,title:"Straighten (S)",location:"Middle",sorting:"A",action:W5.create({elementId:e.id}),letQuickActionsOpen:!0,shortcut:"KeyS"}}};uL=n4([le()],uL);let lL=class extends Un{singleQuickAction(e){if(e instanceof m.GEdge)return{icon:N.Bend,title:"Bend (B)",location:"Middle",sorting:"B",action:Z5.create({elementId:e.id}),letQuickActionsOpen:!0,shortcut:"KeyB"}}};lL=n4([le()],lL);let fL=class extends Un{singleQuickAction(e){if(e instanceof m.GEdge)return{icon:N.Reconnect,title:"Reconnect (R)",location:"Right",sorting:"A",action:jm.create(e.type,e.sourceId,{edgeId:e.id,reconnect:!0}),letQuickActionsOpen:!0,shortcut:"KeyR"}}};fL=n4([le()],fL);const CZ=new m.FeatureModule(n=>{n(Ve.QuickActionProvider).to(uL),n(Ve.QuickActionProvider).to(lL),n(Ve.QuickActionProvider).to(fL)}),PZ=Symbol("unwrapFeature"),hM=Symbol("wrapFeature"),y_=Symbol("singleWrapFeature");function wZ(n){return n.hasFeature(PZ)}function CAe(n){return n.hasFeature(hM)}function PAe(n){return n.hasFeature(y_)}const i4=Symbol("errorBoundaryFeature");function wAe(n){return n.hasFeature(i4)}const AZ=Symbol("signalBoundaryFeature");function AAe(n){return n.hasFeature(AZ)}const oS=Symbol("breakpointFeature");function hL(n){return n.hasFeature(oS)}const Hw=class Hw extends m.GChildElement{constructor(t="",i=!1,o=!1,r=Hw.TYPE,s=!1){super();x(this,"condition");x(this,"disabled");x(this,"globalDisabled");x(this,"type");x(this,"hoverFeedback");this.condition=t,this.disabled=i,this.globalDisabled=o,this.type=r,this.hoverFeedback=s}hasFeature(t){return t===m.hoverFeedbackFeature||t===m.selectFeature}mouseUp(t){return[]}};x(Hw,"TYPE","breakpoint-handle");let Nm=Hw;function RAe(n,e,t,i){pL(n),n.add(new Nm(e,t,i))}function pL(n){n.removeAll(e=>e instanceof Nm)}const rS=Symbol("executionFeature");function Iw(n){return n.hasFeature(rS)}const B1=Symbol("quickActionFeature");function RZ(n){return m.isBoundsAware(n)&&m.isSelectable(n)&&n instanceof m.GParentElement&&n.hasFeature(B1)}var We;(function(n){n.DEFAULT="event:start",n.START=n.DEFAULT+":requestStart",n.START_ERROR=n.DEFAULT+":errorStartEvent",n.START_SIGNAL=n.DEFAULT+":signalStartEvent",n.START_PROGRAM=n.DEFAULT+":programStart",n.START_SUB=n.DEFAULT+":callSubStart",n.START_WS=n.DEFAULT+":webserviceStart",n.START_HD=n.DEFAULT+":htmlDialogStart",n.START_HD_METHOD=n.DEFAULT+":htmlDialogMethodStart",n.START_HD_EVENT=n.DEFAULT+":htmlDialogEventStart",n.START_EMBEDDED=n.DEFAULT+":embeddedStart",n.START_THIRD_PARTY=n.DEFAULT+":thirdPartyProgramStart"})(We||(We={}));var bn;(function(n){n.DEFAULT="event:end",n.END=n.DEFAULT+":taskEnd",n.END_ERROR=n.DEFAULT+":errorEnd",n.END_PAGE=n.DEFAULT+":taskEndPage",n.END_SUB=n.DEFAULT+":callSubEnd",n.END_WS=n.DEFAULT+":webserviceEnd",n.END_HD=n.DEFAULT+":htmlDialogEnd",n.END_HD_EXIT=n.DEFAULT+":htmlDialogExit",n.END_EMBEDDED=n.DEFAULT+":embeddedEnd"})(bn||(bn={}));var ir;(function(n){n.DEFAULT="event:intermediate",n.INTERMEDIATE_TASK=n.DEFAULT+":taskSwitchEvent",n.INTERMEDIATE_WAIT=n.DEFAULT+":waitEvent",n.INTERMEDIATE_THIRD_PARTY=n.DEFAULT+":thirdPartyWaitEvent"})(ir||(ir={}));var Ea;(function(n){n.DEFAULT="event:boundary",n.BOUNDARY_ERROR=n.DEFAULT+":errorBoundaryEvent",n.BOUNDARY_SIGNAL=n.DEFAULT+":signalBoundaryEvent"})(Ea||(Ea={}));var Eo;(function(n){n.DEFAULT="gateway",n.TASK=n.DEFAULT+":taskSwitchGateway",n.JOIN=n.DEFAULT+":join",n.SPLIT=n.DEFAULT+":split",n.ALTERNATIVE=n.DEFAULT+":alternative"})(Eo||(Eo={}));var ge;(function(n){n.DEFAULT="activity",n.GENERIC=n.DEFAULT+":genericActivity",n.COMMENT=n.DEFAULT+":processAnnotation",n.SCRIPT=n.DEFAULT+":script",n.HD=n.DEFAULT+":dialogCall",n.USER=n.DEFAULT+":userTask",n.SOAP=n.DEFAULT+":webServiceCall",n.REST=n.DEFAULT+":restClientCall",n.DB=n.DEFAULT+":database",n.EMAIL=n.DEFAULT+":eMail",n.SUB_PROCESS=n.DEFAULT+":subProcessCall",n.EMBEDDED_PROCESS=n.DEFAULT+":embeddedProcessElement",n.TRIGGER=n.DEFAULT+":triggerCall",n.PROGRAM=n.DEFAULT+":programInterface",n.BPMN_GENERIC=n.DEFAULT+":genericBpmnElement",n.BPMN_USER=n.DEFAULT+":userBpmnElement",n.BPMN_MANUAL=n.DEFAULT+":manualBpmnElement",n.BPMN_SCRIPT=n.DEFAULT+":scriptBpmnElement",n.BPMN_RECEIVE=n.DEFAULT+":receiveBpmnElement",n.BPMN_RULE=n.DEFAULT+":ruleBpmnElement",n.BPMN_SEND=n.DEFAULT+":sendBpmnElement",n.BPMN_SERVICE=n.DEFAULT+":serviceBpmnElement",n.THIRD_PARTY=n.DEFAULT+":thirdPartyProgramInterface",n.THIRD_PARTY_RULE=n.THIRD_PARTY+":RuleActivity",n.LABEL=n.DEFAULT+"-label"})(ge||(ge={}));var sa;(function(n){n.DEFAULT="lanes",n.LANE=n.DEFAULT+":lane",n.POOL=n.DEFAULT+":pool",n.LABEL=n.DEFAULT+":label"})(sa||(sa={}));var jp;(function(n){n.DEFAULT="edge",n.ASSOCIATION=n.DEFAULT+":association",n.LABEL=n.DEFAULT+":label"})(jp||(jp={}));var Wy;(function(n){n.DEFAULT="label"})(Wy||(Wy={}));const yp=class yp extends m.RectangularNode{constructor(){super(...arguments);x(this,"args")}get resizeLocations(){return[m.ResizeHandleLocation.Top,m.ResizeHandleLocation.Bottom]}get editableLabel(){return sS(this,sa.LABEL)}get color(){var t;return((t=this.args)==null?void 0:t.color)??""}isFirstChild(){return this.parent instanceof yp?this.parent.embeddedLanes().indexOf(this)===0:!1}isLastChild(){if(this.parent instanceof yp){const t=this.parent.embeddedLanes();return t.indexOf(this)===t.length-1}return!1}embeddedLanes(){return this.children.filter(t=>t instanceof yp).map(t=>t)}canConnect(t,i){return!1}};x(yp,"DEFAULT_FEATURES",[m.boundsFeature,m.layoutContainerFeature,m.fadeFeature,m.nameFeature,m.withEditLabelFeature,m.selectFeature,B1,m.deletableFeature,m.resizeFeature]);let Ca=yp;class Bm extends m.RectangularNode{constructor(){super(...arguments);x(this,"name","");x(this,"duration");x(this,"taskType");x(this,"reference");x(this,"executionCount");x(this,"args")}get editableLabel(){return sS(this,ge.LABEL)}get customIcon(){var t;return((t=this.args)==null?void 0:t.customIconUri)??this.type}get color(){var t;return((t=this.args)==null?void 0:t.color)??""}get labelBounds(){return{x:-this.bounds.width/2+3,y:0,width:this.bounds.width-6,height:this.bounds.height}}}x(Bm,"DEFAULT_FEATURES",[m.connectableFeature,m.deletableFeature,m.selectFeature,m.boundsFeature,m.resizeFeature,B1,lM,m.moveFeature,m.layoutContainerFeature,m.fadeFeature,m.hoverFeedbackFeature,m.popupFeature,m.nameFeature,m.withEditLabelFeature,m.openFeature,oS,i4,rS,hM,y_]);class MAe extends Bm{get labelBounds(){return{...super.labelBounds,y:0,height:this.bounds.height}}}class Np extends m.CircularNode{constructor(){super(...arguments);x(this,"args");x(this,"executionCount")}get customIcon(){var t;return((t=this.args)==null?void 0:t.customIconUri)??this.type}get color(){var t;return((t=this.args)==null?void 0:t.color)??""}get editableLabel(){return sS(this,Wy.DEFAULT)}}x(Np,"DEFAULT_FEATURES",[m.connectableFeature,m.deletableFeature,m.selectFeature,m.boundsFeature,lM,m.moveFeature,m.layoutContainerFeature,m.fadeFeature,m.hoverFeedbackFeature,m.popupFeature,m.openFeature,oS,B1,m.withEditLabelFeature,rS,hM]);class IAe extends Np{canConnect(e,t){return super.canConnect(e,t)&&t==="target"}}class b_ extends Np{canConnect(e,t){return super.canConnect(e,t)&&(t==="source"||this.typeOf(e.sourceId)===ge.COMMENT)}typeOf(e){var t;if(e)return(t=this.index.getById(e))==null?void 0:t.type}}class MZ extends m.DiamondNode{constructor(){super(...arguments);x(this,"args");x(this,"executionCount");x(this,"size",{width:32,height:32})}get customIcon(){var t;return((t=this.args)==null?void 0:t.customIconUri)??this.type}get color(){var t;return((t=this.args)==null?void 0:t.color)??""}get editableLabel(){return sS(this,Wy.DEFAULT)}}x(MZ,"DEFAULT_FEATURES",[m.connectableFeature,m.deletableFeature,m.selectFeature,m.boundsFeature,lM,m.moveFeature,m.layoutContainerFeature,m.fadeFeature,m.hoverFeedbackFeature,m.popupFeature,m.openFeature,oS,B1,m.withEditLabelFeature,rS,hM,Mw]);class $m extends m.GEdge{constructor(){super(...arguments);x(this,"executionCount")}get color(){var t;return(t=this.args)==null?void 0:t.color}get bounds(){return this.routingPoints.reduce((t,i)=>m.Bounds.combine(t,{x:i.x,y:i.y,width:0,height:0}),this.centerBounds())}centerBounds(){var o,r;const t=m.Bounds.center(((o=this.source)==null?void 0:o.bounds)||m.Bounds.EMPTY),i=m.Bounds.center(((r=this.target)==null?void 0:r.bounds)||m.Bounds.EMPTY);return m.Bounds.translate(m.Bounds.EMPTY,m.centerOfLine(t,i))}get editableLabel(){return sS(this,jp.LABEL)}}x($m,"DEFAULT_FEATURES",[m.editFeature,m.reconnectFeature,m.deletableFeature,m.selectFeature,m.fadeFeature,m.hoverFeedbackFeature,m.popupFeature,m.withEditLabelFeature,rS,B1]);class Hu extends m.GLabel{constructor(){super(...arguments);x(this,"isMultiLine",!0)}get editControlDimension(){return{width:Math.max(this.bounds.width+25,144),height:Math.max(this.bounds.height,44)}}get editControlPositionCorrection(){return{x:-2,y:-3}}get labelBounds(){const t=this.font(),i=this.text.split(`
`),o=Math.max(...i.map(s=>this.textWidth(s,t))),r=14*i.length;return{x:-o/2,y:0,width:o,height:r}}textWidth(t,i){const o=document.createElement("canvas");if("getContext"in o){const r=o.getContext("2d");if(r)return r.font=i,r.measureText(t).width}return this.bounds.width}font(t=document.body){const i=this.cssStyle(t,"font-weight"),o="14px",r=this.cssStyle(t,"font-family");return`${i} ${o} ${r}`}cssStyle(t,i){return window.getComputedStyle(t,void 0).getPropertyValue(i)}}x(Hu,"DEFAULT_FEATURES",[m.fadeFeature,m.editLabelFeature]);class pM extends Hu{get labelBounds(){return{...super.labelBounds,y:-super.labelBounds.height/2}}}class IZ extends Hu{get editControlDimension(){return{width:Math.min(this.bounds.height+25,144),height:Math.max(this.bounds.width,44)}}}class TAe extends Hu{constructor(){super(...arguments);x(this,"isMultiLine",!0)}get editControlDimension(){return m.isBoundsAware(this.parent)?{width:this.parent.bounds.width,height:this.parent.bounds.height}:{width:this.bounds.width,height:this.bounds.height}}get editControlPositionCorrection(){return m.Point.ORIGIN}get labelBounds(){return this.parent instanceof Bm?this.parent.labelBounds:{x:-this.bounds.width/2,y:18,width:this.bounds.width,height:this.bounds.height-18}}}function sS(n,e){const t=n.children.find(i=>i.type===e);if(t&&m.isEditableLabel(t))return t}var DAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},M3,Rl;let mL=(Rl=class extends m.DecorationPlacer{getPosition(e){if(e instanceof m.GChildElement&&m.isSizeable(e.parent)){const t=-M3.DECORATOR_RADIUS*2,i=e.parent.bounds.height-M3.DECORATOR_RADIUS*2;return e.parent instanceof Bm?{x:t-6,y:i-4}:{x:t-4,y:i}}return m.Point.ORIGIN}},M3=Rl,x(Rl,"DECORATOR_RADIUS",6),Rl);mL=M3=DAe([le()],mL);const OAe=new m.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};m.bindAsService(i,m.TYPES.IVNodePostprocessor,mL)},{featureId:m.decorationModule.featureId}),I3=Symbol("jumpFeature");function LAe(n){return n.hasFeature(I3)}function TZ(n){return m.isBoundsAware(n)&&m.isSelectable(n)&&n instanceof Ca}var jAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let gL=class{constructor(){x(this,"cssClasses",["movement-not-allowed"])}validate(e,t){if(TZ(e)||!t)return!0;if(!m.isBoundsAwareMoveable(e))return!1;const i=this.parentLocation(e,m.Point.ORIGIN);return i.x+t.x>=0&&i.y+t.y>=0}parentLocation(e,t){if(e instanceof m.GChildElement){const i=e.parent;if(m.isBoundsAware(i))return this.parentLocation(i,{x:t.x+i.bounds.x,y:t.y+i.bounds.y})}return t}};gL=jAe([le()],gL);const ED={createElement:m.svg};function o4(n,e){if(n.executionCount)return ED.createElement("g",null,ED.createElement("rect",{"class-execution-badge":!0,rx:"7",ry:"7",x:e-11,y:-7,width:22,height:14}),ED.createElement("text",{"class-execution-text":!0,x:e,dy:".4em"},n.executionCount))}var NAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let kr=class{constructor(){x(this,"showCustomIcons",!0)}handle(e){if(Gy.is(e))return this.showCustomIcons=e.showCustomIcons,J5.create()}get isShowCustomIcons(){return this.showCustomIcons}set setShowCustomIcons(e){this.showCustomIcons=e}};kr=NAe([le()],kr);var tc;(function(n){n[n.SI=0]="SI",n[n.IMG=1]="IMG",n[n.NO=2]="NO"})(tc||(tc={}));const BAe={res:"",style:tc.NO};var $e;(function(n){n.SIGNAL_EVENT="M10.5 3.5C10.3328 3.5 10.1767 3.58355 10.084 3.72265L2.08398 15.7227C1.98169 15.8761 1.97215 16.0734 2.05916 16.2359C2.14617 16.3985 2.3156 16.5 2.5 16.5L18.5 16.5C18.6844 16.5 18.8538 16.3985 18.9408 16.2359C19.0278 16.0733 19.0183 15.8761 18.916 15.7226L10.916 3.72265C10.8233 3.58355 10.6672 3.5 10.5 3.5ZM17.5657 15.5L3.43426 15.5L10.5 4.90139L17.5657 15.5Z",n.PROGRAM="M11.1712 3.2767C11.4432 3.32408 11.6254 3.58304 11.578 3.85508L9.40725 16.3165C9.35986 16.5886 9.1009 16.7707 8.82886 16.7233C8.55681 16.6759 8.37469 16.417 8.42208 16.1449L10.5928 3.68347C10.6402 3.41143 10.8991 3.22931 11.1712 3.2767ZM5.88773 5.62629C6.09413 5.80975 6.11272 6.12579 5.92926 6.33218L2.66898 9.99999L5.92926 13.6678C6.11272 13.8742 6.09413 14.1902 5.88773 14.3737C5.68134 14.5572 5.36531 14.5386 5.18185 14.3322L1.6263 10.3322C1.4579 10.1427 1.4579 9.85725 1.6263 9.66781L5.18185 5.66781C5.36531 5.46142 5.68134 5.44283 5.88773 5.62629ZM14.1122 5.62629C14.3186 5.44283 14.6347 5.46142 14.8181 5.66781L18.3737 9.66781C18.5421 9.85725 18.5421 10.1427 18.3737 10.3322L14.8181 14.3322C14.6347 14.5386 14.3186 14.5572 14.1122 14.3737C13.9058 14.1902 13.8873 13.8742 14.0707 13.6678L17.331 9.99999L14.0707 6.33218C13.8873 6.12579 13.9058 5.80975 14.1122 5.62629Z",n.ERROR_EVENT="M11.1799 1.5119C11.4087 1.56273 11.5714 1.76564 11.5714 1.99999V7.72221H14.5C14.671 7.72221 14.8301 7.80955 14.9218 7.95377C15.0136 8.098 15.0253 8.27911 14.9529 8.43398L10.3815 18.2118C10.2823 18.424 10.0489 18.5389 9.82011 18.4881C9.59134 18.4372 9.42857 18.2343 9.42857 18V12.2778H6.5C6.32905 12.2778 6.16995 12.1904 6.07817 12.0462C5.98639 11.902 5.97466 11.7209 6.04706 11.566L10.6185 1.78822C10.7177 1.57593 10.9511 1.46106 11.1799 1.5119ZM7.28572 11.2778H9.92857C10.2047 11.2778 10.4286 11.5016 10.4286 11.7778V15.75L13.7143 8.72221H11.0714C10.7953 8.72221 10.5714 8.49835 10.5714 8.22221V4.24999L7.28572 11.2778Z",n.SUB_START="M3.85303 2C3.85303 1.72386 4.07688 1.5 4.35303 1.5H9.00009C9.82851 1.5 10.5001 2.17157 10.5001 3V16.7929L15.2936 11.9994C15.4889 11.8041 15.8054 11.8041 16.0007 11.9994C16.196 12.1947 16.196 12.5112 16.0007 12.7065L10.3536 18.3536C10.2599 18.4473 10.1327 18.5 10.0001 18.5C9.86748 18.5 9.7403 18.4473 9.64653 18.3536L3.99947 12.7065C3.80421 12.5112 3.80421 12.1946 3.99947 11.9994C4.19474 11.8041 4.51132 11.8041 4.70658 11.9994L9.50009 16.7929V3C9.50009 2.72386 9.27623 2.5 9.00009 2.5H4.35303C4.07688 2.5 3.85303 2.27614 3.85303 2Z",n.WS_EVENT="M10.58 1.52C10.51 1.5 10.43 1.49 10.35 1.51C10.23 1.51 10.11 1.51 9.99 1.51C9.87 1.51 9.75 1.51 9.63 1.51C9.55 1.5 9.48 1.51 9.4 1.52C4.99 1.82 1.5 5.5 1.5 10C1.5 14.5 4.99 18.18 9.42 18.48C9.49 18.5 9.57 18.51 9.65 18.49C9.77 18.49 9.89 18.49 10.01 18.49C10.13 18.49 10.25 18.49 10.37 18.49C10.45 18.5 10.52 18.49 10.6 18.48C15.02 18.18 18.52 14.5 18.52 10C18.52 5.5 15.01 1.82 10.58 1.52ZM16.8 6.83H12.91C12.61 5.37 12.09 3.95 11.38 2.62C13.79 3.07 15.79 4.67 16.8 6.83ZM12.24 10C12.24 10.73 12.19 11.45 12.08 12.17H7.93C7.82 11.46 7.77 10.73 7.77 10C7.77 9.27 7.82 8.55 7.93 7.83H12.08C12.19 8.54 12.24 9.27 12.24 10ZM9.83 2.5C9.88 2.5 9.94 2.5 10 2.5C10.06 2.5 10.11 2.5 10.17 2.5C10.98 3.85 11.56 5.31 11.89 6.83H8.11C8.45 5.31 9.03 3.85 9.83 2.5ZM8.61 2.63C7.9 3.95 7.39 5.37 7.08 6.84H3.2C4.21 4.68 6.21 3.08 8.61 2.63ZM2.5 10C2.5 9.25 2.61 8.52 2.82 7.83H6.92C6.82 8.55 6.77 9.27 6.77 10C6.77 10.73 6.82 11.45 6.92 12.17H2.82C2.61 11.48 2.5 10.76 2.5 10ZM3.2 13.17H7.09C7.39 14.63 7.91 16.05 8.62 17.38C6.21 16.93 4.21 15.33 3.2 13.17ZM10.17 17.5C10.12 17.5 10.06 17.5 10 17.5C9.94 17.5 9.89 17.5 9.83 17.5C9.02 16.15 8.44 14.69 8.11 13.17H11.89C11.55 14.69 10.97 16.15 10.17 17.5ZM11.39 17.37C12.1 16.05 12.61 14.63 12.92 13.16H16.81C15.8 15.32 13.8 16.92 11.39 17.37ZM13.09 12.16C13.19 11.44 13.24 10.72 13.24 9.99C13.24 9.26 13.19 8.54 13.09 7.82H17.19C17.4 8.51 17.51 9.23 17.51 9.99C17.51 10.75 17.4 11.47 17.19 12.16H13.09Z",n.INIT_START="M12.3132 4.31313C12.5085 4.11787 12.825 4.11787 13.0203 4.31313L18.3536 9.64647C18.4474 9.74024 18.5001 9.86741 18.5001 10C18.5001 10.1326 18.4474 10.2598 18.3536 10.3536L13.0203 15.6869C12.825 15.8822 12.5085 15.8822 12.3132 15.6869C12.1179 15.4916 12.1179 15.1751 12.3132 14.9798L16.793 10.5L2 10.5C1.72386 10.5 1.5 10.2761 1.5 9.99998C1.5 9.72384 1.72386 9.49998 2 9.49998L16.793 9.50002L12.3132 5.02024C12.1179 4.82498 12.1179 4.5084 12.3132 4.31313Z",n.METHOD_START="M1.50004 3C1.50004 2.17157 2.17161 1.5 3.00004 1.5H17C17.8285 1.5 18.5 2.17157 18.5 3V17C18.5 17.8284 17.8285 18.5 17 18.5H3.00004C2.17161 18.5 1.50004 17.8284 1.50004 17V14C1.50004 13.7239 1.7239 13.5 2.00004 13.5C2.27618 13.5 2.50004 13.7239 2.50004 14V17C2.50004 17.2761 2.7239 17.5 3.00004 17.5H17C17.2762 17.5 17.5 17.2761 17.5 17V3C17.5 2.72386 17.2762 2.5 17 2.5H3.00004C2.7239 2.5 2.50004 2.72386 2.50004 3V6C2.50004 6.27614 2.27618 6.5 2.00004 6.5C1.7239 6.5 1.50004 6.27614 1.50004 6V3ZM8.75769 6.09112C8.95296 5.89586 9.26954 5.89586 9.4648 6.09112L13.0204 9.64668C13.2156 9.84194 13.2156 10.1585 13.0204 10.3538L9.4648 13.9093C9.26954 14.1046 8.95296 14.1046 8.75769 13.9093C8.56243 13.7141 8.56243 13.3975 8.75769 13.2022L11.4597 10.5002L2 10.5002C1.72386 10.5002 1.5 10.2764 1.5 10.0002C1.5 9.72407 1.72386 9.50021 2 9.50021L11.4597 9.50023L8.75769 6.79823C8.56243 6.60297 8.56243 6.28638 8.75769 6.09112Z",n.EVENT_START="M17.61 1.5H3.39C2.62 1.5 2 2.12 2 2.89V11.78C2 12.55 2.62 13.17 3.39 13.17H7.33V17.5H6.05C5.77 17.5 5.55 17.72 5.55 18C5.55 18.28 5.77 18.5 6.05 18.5H14.94C15.22 18.5 15.44 18.28 15.44 18C15.44 17.72 15.22 17.5 14.94 17.5H13.66V13.17H17.6C18.37 13.17 18.99 12.55 18.99 11.78V2.89C18.99 2.12 18.37 1.5 17.6 1.5H17.61ZM12.67 17.5H8.33V13.17H12.66V17.5H12.67ZM18 11.78C18 11.99 17.83 12.17 17.61 12.17H3.39C3.18 12.17 3 12 3 11.78V2.89C3 2.68 3.17 2.5 3.39 2.5H17.61C17.82 2.5 18 2.67 18 2.89V11.78Z",n.TASK="M1.5 4C1.5 3.72386 1.72386 3.5 2 3.5H18C18.2761 3.5 18.5 3.72386 18.5 4C18.5 4.27614 18.2761 4.5 18 4.5H2C1.72386 4.5 1.5 4.27614 1.5 4Z M1.5 10C1.5 9.72386 1.72386 9.5 2 9.5H18C18.2761 9.5 18.5 9.72386 18.5 10C18.5 10.2761 18.2761 10.5 18 10.5H2C1.72386 10.5 1.5 10.2761 1.5 10Z M1.5 16C1.5 15.7239 1.72386 15.5 2 15.5H18C18.2761 15.5 18.5 15.7239 18.5 16C18.5 16.2761 18.2761 16.5 18 16.5H2C1.72386 16.5 1.5 16.2761 1.5 16Z",n.WAIT="M10 2.5C5.85786 2.5 2.5 5.85786 2.5 10C2.5 14.1421 5.85786 17.5 10 17.5C14.1421 17.5 17.5 14.1421 17.5 10C17.5 5.85786 14.1421 2.5 10 2.5ZM1.5 10C1.5 5.30558 5.30558 1.5 10 1.5C14.6944 1.5 18.5 5.30558 18.5 10C18.5 14.6944 14.6944 18.5 10 18.5C5.30558 18.5 1.5 14.6944 1.5 10ZM10 6.64282C10.2761 6.64282 10.5 6.86668 10.5 7.14282V9.79286L12.3536 11.6465C12.5488 11.8417 12.5488 12.1583 12.3535 12.3536C12.1583 12.5488 11.8417 12.5488 11.6464 12.3535L9.64644 10.3535C9.55268 10.2597 9.5 10.1326 9.5 9.99996V7.14282C9.5 6.86668 9.72386 6.64282 10 6.64282Z",n.END_PAGE="M17 1.25H3C2.03 1.25 1.25 2.03 1.25 3V17C1.25 17.97 2.03 18.75 3 18.75H17C17.97 18.75 18.75 17.97 18.75 17V3C18.75 2.03 17.97 1.25 17 1.25ZM2.75 3C2.75 2.86 2.86 2.75 3 2.75H6.58V6.58H2.75V3ZM17.25 17C17.25 17.14 17.14 17.25 17 17.25H3C2.86 17.25 2.75 17.14 2.75 17V8.08H17.25V17ZM17.25 6.58H8.08V2.75H17C17.14 2.75 17.25 2.86 17.25 3V6.58Z",n.SUB_END="M10.5001 1.5C10.6327 1.5 10.7599 1.55268 10.8536 1.64645L16.5007 7.29351C16.696 7.48877 16.696 7.80535 16.5007 8.00061C16.3054 8.19588 15.9889 8.19588 15.7936 8.00061L11.0001 3.20711L11.0001 17C11.0001 17.2761 11.2239 17.5 11.5001 17.5H16.1471C16.4233 17.5 16.6471 17.7239 16.6471 18C16.6471 18.2761 16.4233 18.5 16.1471 18.5H11.5001C10.6717 18.5 10.0001 17.8284 10.0001 17L10.0001 3.20711L5.20658 8.00061C5.01132 8.19587 4.69474 8.19587 4.49947 8.00061C4.30421 7.80535 4.30421 7.48877 4.49947 7.29351L10.1465 1.64645C10.2403 1.55268 10.3675 1.5 10.5001 1.5Z",n.EXIT_END="M3.5 2.5C3.22386 2.5 3 2.72386 3 3L3 17C3 17.2761 3.22386 17.5 3.5 17.5L17.5 17.5C17.7761 17.5 18 17.2761 18 17V12.6667C18 12.3905 18.2239 12.1667 18.5 12.1667C18.7761 12.1667 19 12.3905 19 12.6667V17C19 17.8284 18.3284 18.5 17.5 18.5L3.5 18.5C2.67157 18.5 2 17.8284 2 17L2 3C2 2.17157 2.67158 1.5 3.5 1.5L7.83334 1.5C8.10948 1.5 8.33334 1.72386 8.33334 2C8.33334 2.27614 8.10948 2.5 7.83334 2.5L3.5 2.5ZM12.6667 2C12.6667 1.72386 12.8906 1.5 13.1667 1.5H18.4999C18.7761 1.5 18.9999 1.72385 18.9999 1.99999L19.0001 7.33332C19.0001 7.60946 18.7762 7.83332 18.5001 7.83333C18.224 7.83334 18.0001 7.60949 18.0001 7.33335L18 3.20707L8.18681 13.0202C7.99155 13.2155 7.67496 13.2155 7.4797 13.0202C7.28444 12.825 7.28444 12.5084 7.4797 12.3131L17.2928 2.5H13.1667C12.8906 2.5 12.6667 2.27614 12.6667 2Z",n.ALTERNATIVE="M1.64645 1.64645C1.84171 1.45118 2.15829 1.45118 2.35355 1.64645L10 9.29289L17.6464 1.64646C17.8417 1.4512 18.1583 1.4512 18.3535 1.64646C18.5488 1.84173 18.5488 2.15831 18.3535 2.35357L10.7071 10L18.3535 17.6464C18.5488 17.8417 18.5488 18.1583 18.3535 18.3535C18.1583 18.5488 17.8417 18.5488 17.6464 18.3535L10 10.7071L2.35355 18.3536C2.15829 18.5488 1.84171 18.5488 1.64645 18.3536C1.45118 18.1583 1.45118 17.8417 1.64645 17.6464L9.29289 10L1.64645 2.35355C1.45118 2.15829 1.45118 1.84171 1.64645 1.64645Z",n.SPLIT="M10.0001 1.5C10.2762 1.5 10.5001 1.72386 10.5001 2V9.49999H18C18.2761 9.49999 18.5 9.72385 18.5 9.99999C18.5 10.2761 18.2761 10.5 18 10.5H10.5001V18C10.5001 18.2761 10.2762 18.5 10.0001 18.5C9.72395 18.5 9.5001 18.2761 9.5001 18V10.5H2C1.72386 10.5 1.5 10.2761 1.5 9.99999C1.5 9.72385 1.72386 9.49999 2 9.49999H9.5001V2C9.5001 1.72386 9.72395 1.5 10.0001 1.5Z",n.JOIN="M9.9998 1.5C10.2759 1.5 10.4998 1.72386 10.4998 2V9.49999H18C18.2761 9.49999 18.5 9.72385 18.5 9.99999C18.5 10.2761 18.2761 10.5 18 10.5H10.4998V18C10.4998 18.2761 10.2759 18.5 9.9998 18.5C9.72366 18.5 9.4998 18.2761 9.4998 18V10.5H2C1.72386 10.5 1.5 10.2761 1.5 9.99999C1.5 9.72385 1.72386 9.49999 2 9.49999H9.4998V2C9.4998 1.72386 9.72366 1.5 9.9998 1.5Z",n.TASKS="M10 2.5C5.85786 2.5 2.5 5.85786 2.5 10C2.5 14.1421 5.85786 17.5 10 17.5C14.1421 17.5 17.5 14.1421 17.5 10C17.5 5.85786 14.1421 2.5 10 2.5ZM1.5 10C1.5 5.30558 5.30558 1.5 10 1.5C14.6944 1.5 18.5 5.30558 18.5 10C18.5 14.6944 14.6944 18.5 10 18.5C5.30558 18.5 1.5 14.6944 1.5 10ZM9.99976 6.9857C10.2759 6.9857 10.4998 7.20956 10.4998 7.4857V9.5H12.5143C12.7904 9.5 13.0143 9.72386 13.0143 10C13.0143 10.2761 12.7904 10.5 12.5143 10.5H10.4998V12.5144C10.4998 12.7905 10.2759 13.0144 9.99976 13.0144C9.72361 13.0144 9.49976 12.7905 9.49976 12.5144V10.5H7.4856C7.20945 10.5 6.9856 10.2761 6.9856 10C6.9856 9.72386 7.20945 9.5 7.4856 9.5H9.49976V7.4857C9.49976 7.20956 9.72361 6.9857 9.99976 6.9857Z",n.USER_TASK="M1.5 5.90298C1.5 5.62684 1.72386 5.40298 2 5.40298H10.3056C10.5817 5.40298 10.8056 5.62684 10.8056 5.90298C10.8056 6.17913 10.5817 6.40298 10.3056 6.40298H2C1.72386 6.40298 1.5 6.17913 1.5 5.90298ZM15.4787 6.40298C14.9595 6.40298 14.5387 6.82384 14.5387 7.34298C14.5387 7.86213 14.9595 8.28298 15.4787 8.28298C15.9978 8.28298 16.4187 7.86213 16.4187 7.34298C16.4187 6.82384 15.9978 6.40298 15.4787 6.40298ZM13.5387 7.34298C13.5387 6.27155 14.4072 5.40298 15.4787 5.40298C16.5501 5.40298 17.4187 6.27155 17.4187 7.34298C17.4187 8.41442 16.5501 9.28298 15.4787 9.28298C14.4072 9.28298 13.5387 8.41442 13.5387 7.34298ZM1.5 9.99993C1.5 9.72379 1.72386 9.49993 2 9.49993H10.3056C10.5817 9.49993 10.8056 9.72379 10.8056 9.99993C10.8056 10.2761 10.5817 10.4999 10.3056 10.4999H2C1.72386 10.4999 1.5 10.2761 1.5 9.99993ZM14.6383 12.0756C14.3252 12.0756 14.0248 12.2 13.8034 12.4215C13.5819 12.6429 13.4575 12.9432 13.4575 13.2564V14.0968C13.4575 14.373 13.2337 14.5968 12.9575 14.5968C12.6814 14.5968 12.4575 14.373 12.4575 14.0968V13.2564C12.4575 12.678 12.6873 12.1233 13.0963 11.7144C13.5052 11.3054 14.0599 11.0756 14.6383 11.0756H16.3191C16.8975 11.0756 17.4522 11.3054 17.8612 11.7144C18.2702 12.1233 18.4999 12.678 18.4999 13.2564V14.0968C18.4999 14.373 18.2761 14.5968 17.9999 14.5968C17.7238 14.5968 17.4999 14.373 17.4999 14.0968V13.2564C17.4999 12.9432 17.3755 12.6429 17.1541 12.4215C16.9326 12.2 16.6323 12.0756 16.3191 12.0756H14.6383ZM1.5 14.097C1.5 13.8209 1.72386 13.597 2 13.597H8.03415C8.31029 13.597 8.53415 13.8209 8.53415 14.097C8.53415 14.3731 8.31029 14.597 8.03415 14.597H2C1.72386 14.597 1.5 14.3731 1.5 14.097Z",n.USER_DIALOG="M10 11.23C10.94 11.23 11.7 10.47 11.7 9.53C11.7 8.59 10.94 7.83 10 7.83C9.06 7.83 8.3 8.59 8.3 9.53C8.3 10.47 9.06 11.23 10 11.23ZM10 8.83C10.39 8.83 10.7 9.14 10.7 9.53C10.7 9.92 10.39 10.23 10 10.23C9.61 10.23 9.3 9.92 9.3 9.53C9.3 9.14 9.61 8.83 10 8.83Z M16.86 1.5H3.14C2.2 1.5 1.5 2.31 1.5 3.23V5.66C1.5 5.66 1.5 5.68 1.5 5.69C1.5 5.7 1.5 5.71 1.5 5.72V16.77C1.5 17.69 2.2 18.5 3.14 18.5H16.86C17.8 18.5 18.5 17.69 18.5 16.77V3.23C18.5 2.31 17.8 1.5 16.86 1.5ZM17.5 16.77C17.5 17.21 17.18 17.5 16.86 17.5H3.14C2.82 17.5 2.5 17.21 2.5 16.77V6.19H17.5V16.77ZM17.5 5.19H2.5V3.23C2.5 2.79 2.82 2.5 3.14 2.5H16.86C17.18 2.5 17.5 2.79 17.5 3.23V5.19Z M7.9 15.66C8.18 15.66 8.4 15.44 8.4 15.16V14.46C8.4 14.22 8.49 13.99 8.66 13.82C8.83 13.65 9.06 13.56 9.3 13.56H10.7C10.94 13.56 11.17 13.65 11.34 13.82C11.51 13.99 11.6 14.22 11.6 14.46V15.16C11.6 15.44 11.82 15.66 12.1 15.66C12.38 15.66 12.6 15.44 12.6 15.16V14.46C12.6 13.96 12.4 13.47 12.04 13.12C11.68 12.76 11.2 12.56 10.7 12.56H9.3C8.8 12.56 8.31 12.76 7.96 13.12C7.6 13.48 7.4 13.96 7.4 14.46V15.16C7.4 15.44 7.62 15.66 7.9 15.66Z",n.SCRIPT="M8.45003 10.44C8.20003 10.32 7.90003 10.42 7.78003 10.66L6.89003 12.44C6.82003 12.58 6.82003 12.75 6.89003 12.89L7.78003 14.67C7.90003 14.92 8.20003 15.02 8.45003 14.89C8.70003 14.76 8.80003 14.47 8.67003 14.22L7.89003 12.67L8.67003 11.12C8.79003 10.87 8.69003 10.57 8.45003 10.45V10.44Z M11.56 10.44C11.31 10.56 11.21 10.86 11.34 11.11L12.12 12.66L11.34 14.21C11.22 14.46 11.32 14.76 11.56 14.88C11.8 15 12.11 14.9 12.23 14.66L13.12 12.88C13.19 12.74 13.19 12.57 13.12 12.43L12.23 10.65C12.11 10.4 11.81 10.3 11.56 10.43V10.44Z M16.58 6.09L12.13 1.65C12.04 1.56 11.91 1.5 11.78 1.5H5.56003C4.95003 1.5 4.37003 1.74 3.95003 2.17C3.52003 2.6 3.28003 3.18 3.28003 3.78V16.22C3.28003 16.82 3.52003 17.4 3.95003 17.83C4.38003 18.26 4.96003 18.5 5.56003 18.5H14.45C15.05 18.5 15.63 18.26 16.06 17.83C16.49 17.4 16.73 16.82 16.73 16.22V6.44C16.73 6.31 16.68 6.18 16.58 6.09ZM12.28 3.21L15.02 5.95H12.67C12.57 5.95 12.47 5.91 12.4 5.84C12.33 5.77 12.29 5.67 12.29 5.56V3.21H12.28ZM15.72 16.23C15.72 16.57 15.59 16.89 15.35 17.13C15.11 17.37 14.79 17.5 14.45 17.5H5.56003C5.22003 17.5 4.90003 17.37 4.66003 17.13C4.42003 16.89 4.29003 16.57 4.29003 16.23V3.78C4.29003 3.44 4.42003 3.12 4.66003 2.88C4.90003 2.64 5.22003 2.51 5.56003 2.51H11.28V5.57C11.28 5.94 11.43 6.29 11.69 6.55C11.95 6.81 12.3 6.96 12.67 6.96H15.73V16.22L15.72 16.23Z",n.TRIGGER="M18.46 9.81C18.43 9.75 18.4 9.69 18.35 9.65L14.22 5.52C14.02 5.32 13.71 5.32 13.51 5.52C13.31 5.72 13.31 6.03 13.51 6.23L16.79 9.50999H7.68C7.4 9.50999 7.18 9.72999 7.18 10.01C7.18 10.29 7.4 10.51 7.68 10.51H16.79L13.51 13.79C13.31 13.99 13.31 14.3 13.51 14.5C13.71 14.7 14.02 14.7 14.22 14.5L18.35 10.37C18.35 10.37 18.43 10.27 18.46 10.21C18.51 10.09 18.51 9.95 18.46 9.83V9.81Z M2.77 8.72C2.07 8.72 1.5 9.29 1.5 9.99C1.5 10.69 2.07 11.26 2.77 11.26C3.47 11.26 4.04 10.69 4.04 9.99C4.04 9.29 3.47 8.72 2.77 8.72Z",n.DATABASE="M2.93817 4.02139C2.59033 4.29551 2.5 4.51734 2.5 4.66667C2.5 4.81599 2.59033 5.03782 2.93817 5.31195C3.28037 5.58163 3.80652 5.84636 4.50126 6.07794C5.88551 6.53936 7.82965 6.83333 10 6.83333C12.1704 6.83333 14.1145 6.53936 15.4987 6.07794C16.1935 5.84636 16.7196 5.58163 17.0618 5.31195C17.4097 5.03782 17.5 4.81599 17.5 4.66667C17.5 4.51734 17.4097 4.29551 17.0618 4.02139C16.7196 3.7517 16.1935 3.48697 15.4987 3.25539C14.1145 2.79397 12.1704 2.5 10 2.5C7.82965 2.5 5.88551 2.79397 4.50126 3.25539C3.80652 3.48697 3.28037 3.7517 2.93817 4.02139ZM17.5 6.2309C17.0526 6.54124 16.4751 6.80657 15.815 7.02663C14.3038 7.53035 12.2479 7.83333 10 7.83333C7.75208 7.83333 5.69621 7.53035 4.18503 7.02663C3.52486 6.80657 2.94736 6.54124 2.5 6.2309V9.99999C2.5 10.1399 2.58304 10.3578 2.92244 10.6309C3.25721 10.9004 3.78199 11.1715 4.50126 11.4113C5.93651 11.8897 7.91486 12.1667 10 12.1667C12.0851 12.1667 14.0635 11.8897 15.4987 11.4113C16.218 11.1715 16.7428 10.9004 17.0776 10.6309C17.417 10.3578 17.5 10.1399 17.5 9.99999V6.2309ZM17.5 11.5628C17.0592 11.8694 16.4867 12.136 15.815 12.36C14.2496 12.8817 12.1583 13.1667 10 13.1667C7.84168 13.1667 5.75037 12.8817 4.18503 12.36C3.51327 12.136 2.94081 11.8694 2.5 11.5628V15.3333C2.5 15.4732 2.58304 15.6912 2.92244 15.9643C3.25721 16.2337 3.78199 16.5049 4.50126 16.7446C5.93651 17.223 7.91486 17.5 10 17.5C12.0851 17.5 14.0635 17.223 15.4987 16.7446C16.218 16.5049 16.7428 16.2337 17.0776 15.9643C17.417 15.6912 17.5 15.4732 17.5 15.3333V11.5628ZM18.5 15.3333C18.5 15.9007 18.1616 16.3755 17.7045 16.7434C17.2428 17.1149 16.596 17.433 15.815 17.6933C14.2496 18.2151 12.1583 18.5 10 18.5C7.84168 18.5 5.75037 18.2151 4.18503 17.6933C3.40401 17.433 2.75722 17.1149 2.29549 16.7434C1.83838 16.3755 1.5 15.9007 1.5 15.3333V4.66667C1.5 4.07961 1.85738 3.59992 2.31919 3.23597C2.78664 2.86759 3.43206 2.5577 4.18503 2.30671C5.69621 1.80298 7.75208 1.5 10 1.5C12.2479 1.5 14.3038 1.80298 15.815 2.30671C16.5679 2.5577 17.2134 2.86759 17.6808 3.23597C18.1426 3.59992 18.5 4.07961 18.5 4.66667V15.3333Z",n.WEB_SERVICE="M10.58 1.51999C10.51 1.49999 10.43 1.48999 10.35 1.50999C10.23 1.50999 10.11 1.50999 9.99 1.50999C9.87 1.50999 9.75 1.50999 9.63 1.50999C9.55 1.49999 9.48 1.50999 9.4 1.51999C4.99 1.81999 1.5 5.49999 1.5 9.99999C1.5 14.5 4.99 18.18 9.42 18.48C9.49 18.5 9.57 18.51 9.65 18.49C9.77 18.49 9.89 18.49 10.01 18.49C10.13 18.49 10.25 18.49 10.37 18.49C10.45 18.5 10.52 18.49 10.6 18.48C15.02 18.18 18.52 14.5 18.52 9.99999C18.52 5.49999 15.01 1.81999 10.58 1.51999ZM16.8 6.82999H12.91C12.61 5.36999 12.09 3.94999 11.38 2.61999C13.79 3.06999 15.79 4.66999 16.8 6.82999ZM12.24 9.99999C12.24 10.73 12.19 11.45 12.08 12.17H7.93C7.82 11.46 7.77 10.73 7.77 9.99999C7.77 9.26999 7.82 8.54999 7.93 7.82999H12.08C12.19 8.53999 12.24 9.26999 12.24 9.99999ZM9.83 2.49999C9.88 2.49999 9.94 2.49999 10 2.49999C10.06 2.49999 10.11 2.49999 10.17 2.49999C10.98 3.84999 11.56 5.30999 11.89 6.82999H8.11C8.45 5.30999 9.03 3.84999 9.83 2.49999ZM8.61 2.62999C7.9 3.94999 7.39 5.36999 7.08 6.83999H3.2C4.21 4.67999 6.21 3.07999 8.61 2.62999ZM2.5 9.99999C2.5 9.24999 2.61 8.51999 2.82 7.82999H6.92C6.82 8.54999 6.77 9.26999 6.77 9.99999C6.77 10.73 6.82 11.45 6.92 12.17H2.82C2.61 11.48 2.5 10.76 2.5 9.99999ZM3.2 13.17H7.09C7.39 14.63 7.91 16.05 8.62 17.38C6.21 16.93 4.21 15.33 3.2 13.17ZM10.17 17.5C10.12 17.5 10.06 17.5 10 17.5C9.94 17.5 9.89 17.5 9.83 17.5C9.02 16.15 8.44 14.69 8.11 13.17H11.89C11.55 14.69 10.97 16.15 10.17 17.5ZM11.39 17.37C12.1 16.05 12.61 14.63 12.92 13.16H16.81C15.8 15.32 13.8 16.92 11.39 17.37ZM13.09 12.16C13.19 11.44 13.24 10.72 13.24 9.98999C13.24 9.25999 13.19 8.53999 13.09 7.81999H17.19C17.4 8.50999 17.51 9.22999 17.51 9.98999C17.51 10.75 17.4 11.47 17.19 12.16H13.09Z",n.RULE="M16.8549 1.505H3.14488C2.24488 1.505 1.50488 2.245 1.50488 3.145V16.855C1.50488 17.765 2.24488 18.495 3.14488 18.495H6.52488C6.52488 18.495 6.55488 18.495 6.57488 18.495C6.59488 18.495 6.60488 18.495 6.62488 18.495H16.8549C17.7649 18.495 18.4949 17.755 18.4949 16.855V3.145C18.4949 2.235 17.7549 1.505 16.8549 1.505V1.505ZM6.07488 17.505H3.14488C2.79488 17.505 2.50488 17.215 2.50488 16.865V12.795H6.07488V17.505V17.505ZM6.07488 11.795H2.50488V7.07501H6.07488V11.785V11.795ZM17.5049 16.865C17.5049 17.225 17.2149 17.505 16.8649 17.505H7.07488V12.795H17.5049V16.865ZM17.5049 11.795H7.07488V7.07501H17.5049V11.785V11.795ZM17.5049 6.085H2.50488V3.145C2.50488 2.795 2.79488 2.505 3.14488 2.505H16.8549C17.2049 2.505 17.4949 2.795 17.4949 3.145V6.07501L17.5049 6.085Z",n.REST_CLIENT="M4.34348 14.9871C4.64515 14.7032 5.11981 14.7177 5.40365 15.0193L5.41334 15.0296C5.69718 15.3313 5.68273 15.806 5.38106 16.0898C5.07939 16.3737 4.60473 16.3592 4.32089 16.0575L4.3112 16.0472C4.02736 15.7456 4.04181 15.2709 4.34348 14.9871Z M8.61204 12.0005C7.67503 11.0046 6.38087 10.4217 5.01413 10.3799C4.73812 10.3714 4.52121 10.1408 4.52966 9.86482C4.53811 9.5888 4.76871 9.3719 5.04472 9.38034C6.67649 9.43028 8.22163 10.1263 9.34034 11.3152C10.459 12.5042 11.0597 14.0888 11.0103 15.7206C11.0019 15.9966 10.7714 16.2136 10.4954 16.2053C10.2194 16.1969 10.0024 15.9664 10.0107 15.6903C10.0522 14.3236 9.54904 12.9964 8.61204 12.0005Z M12.7334 8.12283C11.7602 7.08858 10.5929 6.25613 9.29809 5.67303C8.00324 5.08992 6.60622 4.76757 5.18679 4.72438C4.91077 4.71598 4.69383 4.48542 4.70222 4.20941C4.71062 3.93339 4.94118 3.71645 5.2172 3.72485C6.76789 3.77203 8.29411 4.12418 9.7087 4.76122C11.1233 5.39825 12.3986 6.30767 13.4617 7.43757C14.5248 8.56746 15.3549 9.8957 15.9047 11.3464C16.4545 12.7972 16.7131 14.342 16.6659 15.8927C16.6575 16.1687 16.4269 16.3856 16.1509 16.3772C15.8749 16.3688 15.6579 16.1382 15.6663 15.8622C15.7096 14.4428 15.4729 13.0287 14.9696 11.7008C14.4664 10.3729 13.7065 9.15708 12.7334 8.12283Z",n.EMAIL="M2.52467 5.30441L10 10.288L17.4753 5.30441C17.3586 4.71897 16.842 4.27777 16.2222 4.27777H3.77778C3.15804 4.27777 2.64135 4.71897 2.52467 5.30441ZM17.5 6.48981L10.2774 11.3049C10.1094 11.4169 9.8906 11.4169 9.72265 11.3049L2.5 6.48981V14.4444C2.5 15.1501 3.07208 15.7222 3.77778 15.7222H16.2222C16.9279 15.7222 17.5 15.1501 17.5 14.4444V6.48981ZM1.5 5.55555C1.5 4.29757 2.5198 3.27777 3.77778 3.27777H16.2222C17.4802 3.27777 18.5 4.29757 18.5 5.55555V14.4444C18.5 15.7024 17.4802 16.7222 16.2222 16.7222H3.77778C2.5198 16.7222 1.5 15.7024 1.5 14.4444V5.55555Z",n.USER="M10.0001 3.21796C8.46359 3.21796 7.21802 4.46353 7.21802 6.00001C7.21802 7.5365 8.46359 8.78207 10.0001 8.78207C11.5366 8.78207 12.7821 7.5365 12.7821 6.00001C12.7821 4.46353 11.5366 3.21796 10.0001 3.21796ZM6.21802 6.00001C6.21802 3.91124 7.9113 2.21796 10.0001 2.21796C12.0888 2.21796 13.7821 3.91124 13.7821 6.00001C13.7821 8.08878 12.0888 9.78207 10.0001 9.78207C7.9113 9.78207 6.21802 8.08878 6.21802 6.00001ZM8.35896 12.859C7.62111 12.859 6.91349 13.1521 6.39175 13.6739C5.87001 14.1956 5.5769 14.9032 5.5769 15.6411V17.2821C5.5769 17.5582 5.35305 17.7821 5.0769 17.7821C4.80076 17.7821 4.5769 17.5582 4.5769 17.2821V15.6411C4.5769 14.638 4.97537 13.676 5.68464 12.9667C6.39392 12.2575 7.3559 11.859 8.35896 11.859H11.641C12.6441 11.859 13.6061 12.2575 14.3153 12.9667C15.0246 13.676 15.4231 14.638 15.4231 15.6411V17.2821C15.4231 17.5582 15.1992 17.7821 14.9231 17.7821C14.6469 17.7821 14.4231 17.5582 14.4231 17.2821V15.6411C14.4231 14.9032 14.13 14.1956 13.6082 13.6739C13.0865 13.1521 12.3789 12.859 11.641 12.859H8.35896Z",n.MANUAL="M18.37 9.94187C18.28 9.73187 18.16 9.55187 18 9.39187C17.84 9.23187 17.66 9.11187 17.45 9.02187C17.24 8.93187 17.02 8.89187 16.8 8.89187H16.75C16.85 8.67187 16.91 8.44187 16.91 8.19187C16.91 7.74187 16.73 7.31187 16.41 6.99187C16.09 6.67187 15.66 6.49187 15.21 6.49187H10.42L10.74 6.17187C11.05 5.86187 11.25 5.44187 11.31 5.00187C11.36 4.56187 11.27 4.11187 11.04 3.73187C10.81 3.35187 10.45 3.07187 10.02 2.96187C9.58 2.85187 9.13 2.91187 8.74 3.13187C6.03 4.65187 4.52 5.52187 4.13 5.77187L3.89 5.93187C3.16 6.41187 2.55 7.07187 2.14 7.84187C1.76 8.54187 1.54 9.32187 1.5 10.1219C1.5 10.1419 1.5 10.1719 1.5 10.1919V11.7919C1.5 13.2119 2.05 14.5419 3.05 15.5419C4.05 16.5419 5.38 17.0919 6.8 17.0919H13.6C14.05 17.0919 14.49 16.9119 14.8 16.5919C15.11 16.2719 15.3 15.8419 15.3 15.3919C15.3 15.1519 15.24 14.9119 15.14 14.6919H15.2C15.65 14.6919 16.08 14.5119 16.4 14.1919C16.72 13.8719 16.9 13.4419 16.9 12.9919C16.9 12.7419 16.84 12.5119 16.75 12.2919H16.8C17.02 12.2919 17.24 12.2519 17.45 12.1619C17.66 12.0719 17.84 11.9519 18 11.7919C18.16 11.6319 18.28 11.4519 18.37 11.2419C18.45 11.0319 18.5 10.8119 18.5 10.5919C18.5 10.3719 18.46 10.1519 18.37 9.94187ZM17.45 10.8619C17.41 10.9419 17.36 11.0219 17.3 11.0919C17.24 11.1619 17.16 11.2119 17.07 11.2419C16.99 11.2819 16.9 11.2919 16.8 11.2919H15.21C15.21 11.2919 15.21 11.2919 15.2 11.2919H10C9.72 11.2919 9.5 11.5119 9.5 11.7919C9.5 12.0719 9.72 12.2919 10 12.2919H15.21C15.39 12.2919 15.57 12.3619 15.7 12.4919C15.83 12.6219 15.91 12.8019 15.91 12.9919C15.91 13.1819 15.84 13.3619 15.71 13.4919C15.58 13.6219 15.4 13.7019 15.21 13.7019H10.01C9.73 13.7019 9.51 13.9219 9.51 14.2019C9.51 14.4819 9.73 14.7019 10.01 14.7019H13.61C13.79 14.7019 13.97 14.7819 14.11 14.9119C14.24 15.0419 14.31 15.2219 14.31 15.4019C14.31 15.5819 14.24 15.7619 14.1 15.9019C13.97 16.0319 13.79 16.1119 13.6 16.1119H6.8C5.65 16.1119 4.57 15.6619 3.76 14.8519C2.95 14.0419 2.5 12.9619 2.5 11.8119V10.3819C2.5 9.67187 2.68 8.96187 3.01 8.34187C3.35 7.72187 3.84 7.18187 4.43 6.79187L4.67 6.63187C5.04 6.39187 6.57 5.51187 9.22 4.02187C9.38 3.93187 9.57 3.91187 9.74 3.95187C9.92 4.00187 10.07 4.11187 10.16 4.27187C10.27 4.46187 10.32 4.68187 10.29 4.90187C10.26 5.12187 10.16 5.33187 10.01 5.48187L8.83 6.66187C8.83 6.66187 8.75 6.76187 8.72 6.82187C8.67 6.94187 8.67 7.08187 8.72 7.20187C8.77 7.32187 8.87 7.42187 8.99 7.47187C9.05 7.50187 9.12 7.51187 9.18 7.51187H15.18C15.37 7.51187 15.54 7.58187 15.68 7.71187C15.81 7.84187 15.89 8.02187 15.89 8.21187C15.89 8.40187 15.81 8.57187 15.68 8.70187C15.55 8.83187 15.37 8.91187 15.18 8.91187H9.98C9.7 8.91187 9.48 9.13187 9.48 9.41187C9.48 9.69187 9.7 9.91187 9.98 9.91187H16.78C16.87 9.91187 16.96 9.93187 17.05 9.96187C17.14 10.0019 17.21 10.0519 17.28 10.1119C17.35 10.1819 17.4 10.2519 17.43 10.3419C17.47 10.4319 17.48 10.5219 17.48 10.6119C17.48 10.7019 17.46 10.7919 17.43 10.8819L17.45 10.8619Z",n.SERVICE="M11.975 3.05291C11.4727 0.982614 8.5279 0.982526 8.02544 3.05265C7.86008 3.73266 7.08472 4.05496 6.48482 3.69022C4.66486 2.58252 2.5832 4.66517 3.69139 6.48425C3.77602 6.62304 3.82677 6.78001 3.83933 6.94207C3.8519 7.10414 3.82602 7.26688 3.7638 7.41705C3.70158 7.56723 3.60479 7.70059 3.48129 7.80628C3.35779 7.91198 3.21108 7.98702 3.0531 8.02529C0.982807 8.52754 0.982579 11.4724 3.05269 11.9749C3.21053 12.0132 3.35709 12.0883 3.48045 12.194C3.60381 12.2997 3.70049 12.433 3.76263 12.5831C3.82478 12.7332 3.85063 12.8958 3.8381 13.0577C3.82556 13.2197 3.77499 13.3764 3.69049 13.5151C2.58244 15.3352 4.66514 17.4171 6.48431 16.3089C6.6231 16.2243 6.78006 16.1735 6.94213 16.161C7.10419 16.1484 7.26693 16.1743 7.41711 16.2365C7.56728 16.2987 7.70064 16.3955 7.80634 16.519C7.91203 16.6425 7.98707 16.7892 8.02535 16.9472C8.52759 19.0175 11.4724 19.0177 11.9749 16.9476C12.0133 16.7898 12.0884 16.6432 12.1941 16.5199C12.2997 16.3965 12.433 16.2998 12.5831 16.2377C12.7332 16.1755 12.8958 16.1497 13.0578 16.1622C13.2197 16.1747 13.3765 16.2253 13.5152 16.3098C15.3352 17.4179 17.4172 15.3352 16.309 13.516C16.2243 13.3772 16.1736 13.2202 16.161 13.0582C16.1485 12.8961 16.1743 12.7334 16.2365 12.5832C16.2988 12.433 16.3956 12.2997 16.5191 12.194C16.6426 12.0883 16.7893 12.0132 16.9473 11.9749C19.0175 11.4727 19.0175 8.52779 16.9474 8.02533C16.7897 7.98692 16.6432 7.91186 16.5199 7.80624C16.3965 7.70055 16.2999 7.56725 16.2377 7.41717C16.1756 7.26709 16.1497 7.10446 16.1623 6.94251C16.1748 6.78055 16.2254 6.62375 16.3099 6.48502C17.418 4.665 15.3351 2.5832 13.5159 3.69144C13.3771 3.77606 13.2203 3.82671 13.0582 3.83928C12.8962 3.85184 12.7334 3.82597 12.5832 3.76375C12.4331 3.70153 12.2997 3.60473 12.194 3.48124C12.0883 3.35774 12.0132 3.21089 11.975 3.05291ZM8.99719 3.28867C9.25225 2.23732 10.748 2.23727 11.0031 3.28853C11.0785 3.59947 11.2262 3.88837 11.4343 4.13145C11.6423 4.37457 11.9049 4.56512 12.2005 4.6876C12.4961 4.81008 12.8165 4.86102 13.1355 4.83629C13.4545 4.81156 13.7631 4.71187 14.0363 4.54535C14.9603 3.98248 16.0188 5.04014 15.4558 5.965C15.2895 6.23808 15.1899 6.54655 15.1652 6.86533C15.1406 7.18415 15.1915 7.5043 15.3138 7.79975C15.4361 8.09519 15.6265 8.35761 15.8693 8.56565C16.1121 8.7737 16.4006 8.92151 16.7114 8.99707C17.7627 9.25213 17.763 10.7479 16.7118 11.0031C16.4008 11.0784 16.1119 11.2262 15.8688 11.4342C15.6257 11.6423 15.4352 11.9048 15.3127 12.2004C15.1902 12.4961 15.1393 12.8164 15.164 13.1355C15.1887 13.4545 15.2885 13.7632 15.455 14.0364C16.0177 14.9603 14.9601 16.0187 14.0353 15.4557C13.7622 15.2894 13.4538 15.1899 13.135 15.1652C12.9888 15.1539 12.8423 15.1584 12.698 15.1785C12.5277 15.2022 12.3605 15.2475 12.2006 15.3137C12.0404 15.3801 11.89 15.4663 11.7526 15.5701C11.6366 15.6578 11.5299 15.758 11.4346 15.8692C11.2266 16.1121 11.0788 16.4006 11.0032 16.7113C10.7482 17.7627 9.25235 17.7628 8.99719 16.7116C8.92183 16.4006 8.77412 16.1119 8.56609 15.8688C8.35802 15.6257 8.09549 15.4351 7.79986 15.3126C7.50423 15.1902 7.18387 15.1392 6.86483 15.164C6.54579 15.1887 6.2371 15.2884 5.96389 15.455C5.03998 16.0176 3.98155 14.9601 4.54459 14.0352C4.7109 13.7622 4.81044 13.4537 4.83511 13.1349C4.85979 12.8161 4.80889 12.4959 4.68656 12.2005C4.56422 11.9051 4.3739 11.6426 4.13105 11.4346C3.88821 11.2265 3.59944 11.0787 3.28872 11.0031C2.23737 10.7481 2.23746 9.2523 3.28872 8.99714C3.59966 8.92178 3.88842 8.77407 4.13151 8.56603C4.37462 8.35797 4.56517 8.09544 4.68765 7.79981C4.81013 7.50418 4.86108 7.18381 4.83634 6.86477C4.81161 6.5458 4.71193 6.23717 4.5454 5.96399C3.98253 5.04005 5.04044 3.98162 5.96531 4.54469C7.14319 5.26084 8.67189 4.62643 8.99719 3.28867ZM6.83352 10C6.83352 8.25114 8.25128 6.83337 10.0002 6.83337C11.7491 6.83337 13.1669 8.25114 13.1669 10C13.1669 11.7489 11.7491 13.1667 10.0002 13.1667C8.25128 13.1667 6.83352 11.7489 6.83352 10ZM10.0002 7.83337C8.80357 7.83337 7.83352 8.80342 7.83352 10C7.83352 11.1967 8.80357 12.1667 10.0002 12.1667C11.1968 12.1667 12.1669 11.1967 12.1669 10C12.1669 8.80342 11.1968 7.83337 10.0002 7.83337Z",n.SEND="M15.69 11.865C15.49 11.665 15.18 11.665 14.98 11.865C14.78 12.065 14.78 12.375 14.98 12.575L16.79 14.385H12.66C12.38 14.385 12.16 14.605 12.16 14.885C12.16 15.165 12.38 15.385 12.66 15.385H16.79L14.98 17.195C14.78 17.395 14.78 17.705 14.98 17.905C15.18 18.105 15.49 18.105 15.69 17.905L18.36 15.235C18.56 15.035 18.56 14.725 18.36 14.525L15.69 11.855V11.865Z M17.83 2.61501C17.4 2.18501 16.82 1.94501 16.22 1.94501H3.78C3.17 1.94501 2.59 2.18501 2.17 2.61501C1.75 3.04501 1.5 3.62501 1.5 4.22501V13.115C1.5 13.715 1.74 14.295 2.17 14.725C2.6 15.155 3.18 15.395 3.78 15.395H10C10.28 15.395 10.5 15.175 10.5 14.895C10.5 14.615 10.28 14.395 10 14.395H3.78C3.44 14.395 3.12 14.265 2.88 14.025C2.64 13.785 2.51 13.465 2.51 13.125V5.15501L9.73 9.97501C9.9 10.085 10.12 10.085 10.28 9.97501L17.5 5.15501V10.885C17.5 11.165 17.72 11.385 18 11.385C18.28 11.385 18.5 11.165 18.5 10.885V4.22501C18.5 3.62501 18.26 3.04501 17.83 2.61501ZM10 8.95501L2.52 3.97501C2.57 3.72501 2.69 3.50501 2.87 3.32501C3.11 3.08501 3.43 2.95501 3.77 2.95501H16.22C16.56 2.95501 16.88 3.08501 17.12 3.32501C17.3 3.50501 17.42 3.73501 17.47 3.97501L9.99 8.95501H10Z",n.RECEIVE="M17.83 2.61501C17.4 2.18501 16.82 1.94501 16.22 1.94501H3.78C3.17 1.94501 2.59 2.18501 2.17 2.61501C1.74 3.04501 1.5 3.62501 1.5 4.22501V13.115C1.5 13.715 1.74 14.295 2.17 14.725C2.6 15.155 3.18 15.395 3.78 15.395H10C10.28 15.395 10.5 15.175 10.5 14.895C10.5 14.615 10.28 14.395 10 14.395H3.78C3.44 14.395 3.12 14.265 2.88 14.025C2.64 13.785 2.51 13.465 2.51 13.125V5.15501L9.73 9.97501C9.9 10.085 10.12 10.085 10.28 9.97501L17.5 5.15501V10.885C17.5 11.165 17.72 11.385 18 11.385C18.28 11.385 18.5 11.165 18.5 10.885V4.22501C18.5 3.62501 18.26 3.04501 17.83 2.61501ZM10 8.95501L2.52 3.97501C2.57 3.72501 2.69 3.50501 2.87 3.32501C3.11 3.08501 3.43 2.95501 3.77 2.95501H16.22C16.56 2.95501 16.88 3.08501 17.12 3.32501C17.3 3.50501 17.42 3.73501 17.47 3.97501L9.99 8.95501H10Z M18 14.385H13.87L15.68 12.575C15.88 12.375 15.88 12.065 15.68 11.865C15.48 11.665 15.17 11.665 14.97 11.865L12.3 14.535C12.21 14.625 12.15 14.755 12.15 14.885C12.15 15.015 12.2 15.145 12.3 15.235L14.97 17.905C15.17 18.105 15.48 18.105 15.68 17.905C15.88 17.705 15.88 17.395 15.68 17.195L13.87 15.385H18C18.28 15.385 18.5 15.165 18.5 14.885C18.5 14.605 18.28 14.385 18 14.385Z",n.ANGLE_DOWN="m 14.374468,7.8998791 c 0.182994,0.2068134 0.163691,0.5228707 -0.04311,0.7058045 l -4.008014,3.5465644 c -0.189819,0.167972 -0.475268,0.167328 -0.664388,-0.0015 L 5.6669878,8.586132 C 5.4610018,8.4022667 5.4431148,8.0861255 5.6270808,7.8801401 5.8110458,7.6741547 6.127087,7.6563679 6.333072,7.8402331 l 3.660444,3.2685679 3.675158,-3.2520147 c 0.206803,-0.1829338 0.522801,-0.1637207 0.705794,0.043093 z",n.NOTE="M7.34003 7.83H8.23003C8.51003 7.83 8.73003 7.61 8.73003 7.33C8.73003 7.05 8.51003 6.83 8.23003 6.83H7.34003C7.06003 6.83 6.84003 7.05 6.84003 7.33C6.84003 7.61 7.06003 7.83 7.34003 7.83Z M12.67 13.94H7.34003C7.06003 13.94 6.84003 14.16 6.84003 14.44C6.84003 14.72 7.06003 14.94 7.34003 14.94H12.67C12.95 14.94 13.17 14.72 13.17 14.44C13.17 14.16 12.95 13.94 12.67 13.94Z M16.58 6.09L12.13 1.65C12.04 1.56 11.91 1.5 11.78 1.5H5.56003C4.95003 1.5 4.37003 1.74 3.95003 2.17C3.52003 2.6 3.28003 3.18 3.28003 3.78V16.22C3.28003 16.82 3.52003 17.4 3.95003 17.83C4.38003 18.26 4.96003 18.5 5.56003 18.5H14.45C15.05 18.5 15.63 18.26 16.06 17.83C16.49 17.4 16.73 16.82 16.73 16.22V6.44C16.73 6.31 16.68 6.18 16.58 6.09ZM12.28 3.21L15.02 5.95H12.67C12.57 5.95 12.47 5.91 12.4 5.84C12.33 5.77 12.29 5.67 12.29 5.56V3.21H12.28ZM15.72 16.23C15.72 16.57 15.59 16.89 15.35 17.13C15.11 17.37 14.79 17.5 14.45 17.5H5.56003C5.22003 17.5 4.90003 17.37 4.66003 17.13C4.42003 16.89 4.29003 16.57 4.29003 16.23V3.78C4.29003 3.44 4.42003 3.12 4.66003 2.88C4.90003 2.64 5.22003 2.51 5.56003 2.51H11.28V5.57C11.28 5.94 11.43 6.29 11.69 6.55C11.95 6.81 12.3 6.96 12.67 6.96H15.73V16.22L15.72 16.23Z M7.34003 10.39C7.06003 10.39 6.84003 10.61 6.84003 10.89C6.84003 11.17 7.06003 11.39 7.34003 11.39H12.67C12.95 11.39 13.17 11.17 13.17 10.89C13.17 10.61 12.95 10.39 12.67 10.39H7.34003Z",n.PUZZLE="M10.0038 1.95906C10.2954 1.66743 10.6921 1.5 11.1104 1.5C11.5287 1.5 11.9254 1.66742 12.2171 1.95906L13.7162 3.45817C13.8335 3.57549 13.885 3.74336 13.8536 3.90628C13.8222 4.06919 13.7121 4.20594 13.5596 4.2713C13.2336 4.411 12.9448 4.62539 12.7205 4.90144C12.497 5.17656 12.3457 5.50614 12.2757 5.85649C12.2066 6.20173 12.2238 6.5584 12.3276 6.8985C12.4309 7.23723 12.6216 7.5501 12.8707 7.7992C13.1262 8.05472 13.4318 8.23875 13.7714 8.34237L13.7737 8.34307C14.1043 8.44568 14.4672 8.4635 14.8134 8.39426L14.815 8.39395C15.1696 8.32419 15.492 8.17403 15.7685 7.94942L15.7734 7.94542L15.7734 7.94545C16.0446 7.73076 16.2576 7.44522 16.3974 7.11325C16.462 6.95982 16.5987 6.84861 16.7621 6.81661C16.9255 6.78461 17.094 6.83601 17.2118 6.95373L18.7109 8.45284C19.0025 8.74447 19.1699 9.1412 19.1699 9.5595C19.1699 9.97781 19.0025 10.3745 18.7109 10.6662L17.0386 12.3384C17.2914 12.4259 17.5334 12.5455 17.7592 12.6948C18.2824 13.0408 18.6896 13.5321 18.9272 14.1175C19.163 14.6987 19.2215 15.3297 19.1041 15.9414L19.1029 15.9479L19.1029 15.9479C18.977 16.5605 18.675 17.1241 18.2366 17.5632C17.7971 18.0105 17.2313 18.3146 16.6146 18.4336C15.9951 18.5602 15.3632 18.4909 14.7874 18.2573L14.7851 18.2563C14.2114 18.0201 13.7131 17.6153 13.3659 17.0909C13.2152 16.8666 13.0952 16.6236 13.0076 16.3695L11.3361 18.0409C11.0445 18.3326 10.6477 18.5 10.2294 18.5C9.81112 18.5 9.41439 18.3326 9.12276 18.0409L7.62365 16.5418C7.50633 16.4245 7.45485 16.2566 7.48623 16.0937C7.5176 15.9308 7.62775 15.7941 7.78024 15.7287C8.10622 15.589 8.39505 15.3746 8.61934 15.0986C8.84288 14.8234 8.99411 14.4939 9.06418 14.1435C9.13323 13.7983 9.11605 13.4416 9.01229 13.1015C8.90895 12.7628 8.71822 12.4499 8.46912 12.2008C8.2136 11.9453 7.90806 11.7613 7.56842 11.6576L7.56613 11.6569C7.2355 11.5543 6.87262 11.5365 6.52642 11.6057L6.52487 11.606C6.17024 11.6758 5.84781 11.826 5.57136 12.0506L5.56644 12.0546L5.56642 12.0545C5.29523 12.2692 5.08224 12.5548 4.94246 12.8867C4.87786 13.0402 4.74113 13.1514 4.57776 13.1834C4.41439 13.2154 4.24581 13.164 4.12809 13.0463L2.62898 11.5472C2.33735 11.2555 2.16992 10.8588 2.16992 10.4405C2.16992 10.0222 2.33735 9.62547 2.62898 9.33384L4.30121 7.6616C4.04847 7.57405 3.80643 7.45448 3.58063 7.30516C3.05746 6.95919 2.65022 6.46794 2.41265 5.8825C2.17681 5.30131 2.11838 4.67035 2.23571 4.05858L2.23695 4.05211L2.23699 4.05212C2.36289 3.43944 2.66489 2.87586 3.10332 2.43676C3.5428 1.98951 4.10854 1.68537 4.72526 1.56641C5.3447 1.43982 5.97665 1.50909 6.55242 1.74273L6.55479 1.74369L6.55479 1.7437C7.12851 1.97994 7.62681 2.38473 7.97407 2.90917C8.12465 3.13352 8.24467 3.37645 8.33229 3.63053L10.0038 1.95906ZM11.1104 2.5C10.9603 2.5 10.8171 2.55993 10.7109 2.66616L8.35918 5.01785C8.21618 5.16085 8.00112 5.20363 7.81428 5.12624C7.62744 5.04885 7.50562 4.86653 7.50562 4.6643C7.50562 4.2364 7.37809 3.81511 7.14305 3.46542L7.14095 3.4623L7.14096 3.4623C6.90591 3.10684 6.56669 2.83033 6.17521 2.66886C5.77186 2.50544 5.33973 2.46104 4.92331 2.54661L4.91686 2.54793L4.91685 2.54789C4.49831 2.62816 4.11387 2.83465 3.81546 3.1388L3.81212 3.1422L3.81211 3.14219C3.51331 3.44099 3.30468 3.82759 3.21719 4.25017C3.13641 4.67467 3.17765 5.10823 3.33927 5.50648C3.49957 5.90151 3.77439 6.23441 4.13222 6.47104C4.49242 6.70924 4.90834 6.8357 5.33422 6.8357C5.53645 6.8357 5.71877 6.95752 5.79616 7.14436C5.87355 7.3312 5.83077 7.54626 5.68777 7.68926L3.33609 10.0409C3.22985 10.1472 3.16992 10.2904 3.16992 10.4405C3.16992 10.5906 3.22985 10.7338 3.33609 10.8401L4.37025 11.8742C4.53173 11.6498 4.72342 11.4469 4.94325 11.2725C5.34832 10.944 5.82074 10.7254 6.33185 10.6249C6.83737 10.524 7.36868 10.5488 7.86138 10.7015C8.35965 10.8537 8.80681 11.1243 9.17623 11.4937C9.53814 11.8556 9.81633 12.3101 9.96876 12.8097C10.1208 13.308 10.1462 13.8323 10.0448 14.3396C9.94432 14.8418 9.72609 15.3222 9.39546 15.7292C9.21887 15.9465 9.01598 16.1367 8.79349 16.2975L9.82987 17.3338C9.93611 17.4401 10.0793 17.5 10.2294 17.5C10.3795 17.5 10.5227 17.4401 10.629 17.3338L12.9807 14.9821C13.1237 14.8391 13.3387 14.7964 13.5256 14.8738C13.7124 14.9512 13.8342 15.1335 13.8342 15.3357C13.8342 15.7636 13.9618 16.1849 14.1968 16.5346L14.1989 16.5377L14.1989 16.5377C14.434 16.8932 14.7732 17.1697 15.1647 17.3312C15.568 17.4946 16.0001 17.539 16.4165 17.4534L16.423 17.4521L16.423 17.4521C16.8415 17.3718 17.226 17.1653 17.5244 16.8612L17.5277 16.8578L17.5277 16.8578C17.8265 16.559 18.0352 16.1724 18.1227 15.7498C18.2034 15.3253 18.1622 14.8918 18.0006 14.4935C17.8403 14.0985 17.5655 13.7656 17.2076 13.529C16.8474 13.2908 16.4315 13.1643 16.0056 13.1643C15.8034 13.1643 15.6211 13.0425 15.5437 12.8556C15.4663 12.6688 15.5091 12.4537 15.6521 12.3107L18.0038 9.95906C18.11 9.85282 18.1699 9.70958 18.1699 9.5595C18.1699 9.40943 18.11 9.26618 18.0038 9.15995L16.9696 8.12579C16.8081 8.35015 16.6164 8.55311 16.3966 8.72752C15.9916 9.05598 15.5191 9.2746 15.008 9.37514C14.5025 9.47598 13.9712 9.45118 13.4785 9.29849C12.9802 9.14627 12.533 8.87572 12.1636 8.50631C11.8017 8.14439 11.5235 7.68994 11.3711 7.19031C11.2191 6.69204 11.1936 6.16772 11.2951 5.66038C11.3955 5.15816 11.6138 4.67779 11.9444 4.27085C12.121 4.05351 12.3239 3.86328 12.5464 3.70255L11.51 2.66616C11.4037 2.55993 11.2605 2.5 11.1104 2.5Z"})($e||($e={}));const $Ae=new Map([[We.START_SIGNAL,$e.SIGNAL_EVENT],[We.START_PROGRAM,$e.PROGRAM],[We.START_THIRD_PARTY,$e.PUZZLE],[We.START_ERROR,$e.ERROR_EVENT],[We.START_SUB,$e.SUB_START],[We.START_WS,$e.WS_EVENT],[We.START_HD,$e.INIT_START],[We.START_HD_METHOD,$e.METHOD_START],[We.START_HD_EVENT,$e.EVENT_START],[ir.INTERMEDIATE_TASK,$e.TASK],[ir.INTERMEDIATE_WAIT,$e.WAIT],[ir.INTERMEDIATE_THIRD_PARTY,$e.PUZZLE],[Ea.BOUNDARY_ERROR,$e.ERROR_EVENT],[Ea.BOUNDARY_SIGNAL,$e.SIGNAL_EVENT],[bn.END_PAGE,$e.END_PAGE],[bn.END_ERROR,$e.ERROR_EVENT],[bn.END_SUB,$e.SUB_END],[bn.END_WS,$e.WS_EVENT],[bn.END_HD_EXIT,$e.EXIT_END],[Eo.ALTERNATIVE,$e.ALTERNATIVE],[Eo.SPLIT,$e.SPLIT],[Eo.JOIN,$e.JOIN],[Eo.TASK,$e.TASKS],[ge.USER,$e.USER_TASK],[ge.HD,$e.USER_DIALOG],[ge.SCRIPT,$e.SCRIPT],[ge.TRIGGER,$e.TRIGGER],[ge.DB,$e.DATABASE],[ge.SOAP,$e.WEB_SERVICE],[ge.REST,$e.REST_CLIENT],[ge.EMAIL,$e.EMAIL],[ge.THIRD_PARTY,$e.PUZZLE],[ge.THIRD_PARTY_RULE,$e.RULE],[ge.PROGRAM,$e.PROGRAM],[ge.BPMN_USER,$e.USER],[ge.BPMN_MANUAL,$e.MANUAL],[ge.BPMN_SCRIPT,$e.SCRIPT],[ge.BPMN_SERVICE,$e.SERVICE],[ge.BPMN_RULE,$e.RULE],[ge.BPMN_SEND,$e.SEND],[ge.BPMN_RECEIVE,$e.RECEIVE]]),kAe=new Map([["std:Compensation",$e.ANGLE_DOWN],["std:Cancel",$e.ALTERNATIVE],["std:Escalation",$e.TRIGGER],["std:Timer",$e.WAIT],["std:Message",$e.EMAIL],["std:Conditional",$e.NOTE]]),FAe=n=>{if(n.includes("/faces/javax.faces.resource"))return{res:n,style:tc.IMG};if(n.startsWith("ext:"))return{res:$e.PUZZLE,style:tc.SI};const e=$Ae.get(n);if(e)return{res:e,style:tc.SI};const t=kAe.get(n);return t?{res:t,style:tc.SI}:BAe},S_={createElement:m.svg},xAe=[ge.USER,ge.SCRIPT,ge.HD,ge.TRIGGER,ge.SUB_PROCESS];function HAe(n,e){const t={height:20,width:20,x:10,y:n.bounds.height/2-10},i=OZ(e,t,!1,"");if(i)return S_.createElement("g",{"class-activity-icon":!0,"data-actitiy-type":KAe(n.type)},S_.createElement("rect",{height:30,width:30,x:5,y:n.bounds.height/2-15}),i)}const KAe=n=>n.endsWith("BpmnElement")?"bpmn":xAe.includes(n)?"workflow":"interface";function DZ(n,e,t){const i={height:14,width:18,x:e-9,y:e-7};return OZ(n,i,!0,t)}function OZ(n,e,t,i){const o=FAe(n);if(o.style===tc.SI)return S_.createElement("svg",{"class-sprotty-icon-svg":!0,viewBox:"0 0 20 20",height:e.height,width:e.width,x:e.x,y:e.y},S_.createElement("path",{style:{fill:i},d:o.res}));if(o.style===tc.IMG){const r=HU(`<img src="${o.res}"></img>`);return S_.createElement("foreignObject",{requiredFeatures:"http://www.w3.org/TR/SVG11/feature#Extensibility",height:e.height,width:e.width,x:e.x,y:e.y,"class-sprotty-icon":!0,"class-icon-small":t},r)}}var r4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},VAe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};const _p={createElement:m.svg};let km=class extends m.RectangularNodeView{constructor(){super(...arguments);x(this,"customIconHandler")}render(t,i){var r;if(!this.isVisible(t,i))return;const o=this.getRoundedCornerRadius(t);return _p.createElement("g",null,_p.createElement("rect",{attrs:{[m.ATTR_BBOX_ELEMENT]:!0},"class-sprotty-node":!0,"class-mouseover":t.hoverFeedback,"class-selected":t.selected,x:0,y:0,rx:o,ry:o,width:t.bounds.width,height:t.bounds.height,style:{stroke:t.color}}),i.renderChildren(t),HAe(t,(r=this.customIconHandler)!=null&&r.isShowCustomIcons?t.customIcon:t.type),this.getNodeDecorator(t),o4(t,t.bounds.width))}getNodeDecorator(t){}getRoundedCornerRadius(t){return 5}};r4([be(kr),Wm(),VAe("design:type",kr)],km.prototype,"customIconHandler",void 0);km=r4([le()],km);let vL=class extends km{getNodeDecorator(e){return _p.createElement("svg",{x:e.bounds.width/2-6,y:e.bounds.height-12-1,height:12,width:12},_p.createElement("rect",{"class-sprotty-node":!0,"class-sprotty-task-node":!0,x:1,y:1,rx:2,ry:2,width:10,height:10}),_p.createElement("line",{"class-sprotty-node-decorator":!0,x1:6,y1:3,x2:6,y2:9}),_p.createElement("line",{"class-sprotty-node-decorator":!0,x1:3,y1:6,x2:9,y2:6}))}};vL=r4([le()],vL);var s4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},zAe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};const T3={createElement:m.svg};let Fm=class extends m.CircularNodeView{constructor(){super(...arguments);x(this,"customIconHandler")}render(t,i){var r;const o=this.getRadius(t);return T3.createElement("g",null,m.hiddenBoundingRect(t,i),T3.createElement("circle",{"class-sprotty-node":!0,"class-mouseover":t.hoverFeedback,"class-selected":t.selected,r:o,cx:o,cy:o,style:{stroke:t.color}}),this.getEventDecorator(o),DZ((r=this.customIconHandler)!=null&&r.isShowCustomIcons?t.customIcon:t.type,o,t.color),i.renderChildren(t),o4(t,2*o))}getEventDecorator(t){return T3.createElement("g",null)}};s4([be(kr),Wm(),zAe("design:type",kr)],Fm.prototype,"customIconHandler",void 0);Fm=s4([le()],Fm);let Cl=class extends Fm{getEventDecorator(e){return T3.createElement("circle",{"class-sprotty-node":!0,"class-sprotty-task-node":!0,r:e-3,cx:e,cy:e})}};Cl=s4([le()],Cl);var LZ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},GAe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};const YV={createElement:m.svg};let Tw=class extends m.DiamondNodeView{constructor(){super(...arguments);x(this,"customIconHandler")}render(t,i){var a;const o=new m.Diamond({height:Math.max(t.size.height,0),width:Math.max(t.size.width,0),x:0,y:0}),r=`${this.svgStr(o.topPoint)} ${this.svgStr(o.rightPoint)} ${this.svgStr(o.bottomPoint)} ${this.svgStr(o.leftPoint)}`,s=this.getRadius(t);return YV.createElement("g",null,m.hiddenBoundingRect(t,i),YV.createElement("polygon",{"class-sprotty-node":!0,"class-mouseover":t.hoverFeedback,"class-selected":t.selected,points:r,style:{stroke:t.color}}),DZ((a=this.customIconHandler)!=null&&a.isShowCustomIcons?t.customIcon:t.type,s,t.color),i.renderChildren(t),o4(t,Math.max(t.size.width,0)))}getRadius(t){const i=Math.min(t.size.width,t.size.height);return i>0?i/2:0}svgStr(t){return`${t.x},${t.y}`}};LZ([be(kr),Wm(),GAe("design:type",kr)],Tw.prototype,"customIconHandler",void 0);Tw=LZ([le()],Tw);var UAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let _L=class extends m.GLSPProjectionView{getBackgroundBounds(e,t,i){const o=super.getBackgroundBounds(e,t,i);return o.height=o.height*2,o.width=o.width*2,o}renderSvg(e,t,i){const o=this.edgeRouterRegistry.routeAllChildren(e),r=`scale(${e.zoom}) translate(${-e.scroll.x},${-e.scroll.y})`,s="http://www.w3.org/2000/svg";return Hs("svg",{ns:s,style:{height:"100%",...this.getGridStyle(e,t)},class:{"sprotty-graph":!0}},Hs("g",{ns:s,attrs:{transform:r}},[...t.renderChildren(e,{edgeRouting:o}),this.renderNegativeArea(e)]))}renderNegativeArea(e){if(m.isViewport(e.root)){const t=m.getModelBounds(e.root);return Hs("g",{class:{"negative-area-group":!0}},[Hs("rect",{attrs:{x:t.x,y:t.y,width:t.width,height:-t.y},class:{"negative-area":!0}}),Hs("rect",{attrs:{x:t.x,y:0,width:-t.x,height:t.height},class:{"negative-area":!0}})])}return Hs("g",{},[])}};_L=UAe([le()],_L);var a4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};const Dd={createElement:m.svg};let Dw=class extends m.RectangularNodeView{render(e,t){if(this.isEmbeddedLane(e)){const i=e.isFirstChild()?4:0,o=e.isLastChild()?4:0,r=t.targetKind==="hidden"?0:1,s=`M0,0
      h${Math.max(e.size.width-i,0)}
      q${i},0 ${i},${i}
      v${Math.max(e.size.height-r-i-o,0)}
      q0,${o} -${o},${o}
      h-${Math.max(e.size.width-o,0)}
      z`;return Dd.createElement("g",null,Dd.createElement("path",{"class-sprotty-node":!0,"class-selected":e.selected,d:s,style:this.laneStyle(e)}),t.renderChildren(e))}return Dd.createElement("g",null,Dd.createElement("rect",{"class-sprotty-node":!0,"class-selected":e.selected,x:"0",y:"0",rx:"4px",ry:"4px",width:Math.max(e.size.width,0),height:Math.max(e.size.height-1,0),style:this.laneStyle(e)}),this.getDecoratorLine(e),t.renderChildren(e))}isEmbeddedLane(e){return e.parent instanceof Ca}getDecoratorLine(e){return Dd.createElement("g",null)}laneStyle(e){return e.color?{"--lane-color":e.color}:{}}};Dw=a4([le()],Dw);let yL=class extends Dw{getDecoratorLine(e){const t=this.getPoolLaneSpace(e),i=e.size.height-1,o=`M${t},0 v${i} h-${t-4} q-4,0 -4,-4 v-${i-8} q0,-4 4,-4 z`;return Dd.createElement("path",{"class-sprotty-node":!0,"class-pool-label-rect":!0,d:o})}laneStyle(e){return{}}getPoolLaneSpace(e){let t=24;return m.hasArgs(e)&&e.args&&(t=m.GArgument.getNumber(e,"poolLabelSpace")??24),t-1}};yL=a4([le()],yL);let bL=class extends m.GLabelView{render(e,t){const i=`rotate(270) translate(-${e.bounds.height/2} ${e.bounds.width/2})`;return Dd.createElement("text",{"class-sprotty-label":!0,transform:i},e.text.split(`
`).map((o,r)=>Dd.createElement("tspan",{dy:r===0?0:"1.2em",x:0,style:o?{}:{visibility:"hidden"}},o||".")))}};bL=a4([le()],bL);function YAe(n){return n.replace(/[\\"&'\\/<>\n]/g,function(e){return{'"':"&quot;","&":"&amp;","'":"&#39;","/":"&#47;","<":"&lt;",">":"&gt;","\n":"<br/>"}[e]??""})}var mM=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};const Bd={createElement:m.svg};let E_=class{render(e,t){const i=YAe(e.text),o=e.labelBounds,r=HU(`<div style="height: ${o.height}px;">${i}</div>`);return Bd.createElement("g",null,Bd.createElement("foreignObject",{requiredFeatures:"http://www.w3.org/TR/SVG11/feature#Extensibility",height:o.height,width:o.width,x:o.x,y:o.y,z:10,"class-sprotty-label":!0,"class-node-child-label":e.parent.type.startsWith(ge.DEFAULT)},r),t.renderChildren(e))}};E_=mM([le()],E_);let SL=class extends m.PolylineEdgeViewWithGapsOnIntersections{renderLine(e,t,i){const o=super.renderLine(e,t,i,void 0);return o.data&&(o.data.style={stroke:e.color}),o}renderAdditionals(e,t,i){const o=super.renderAdditionals(e,t,i),r=this.edgePadding(e),s=r?[this.renderMouseHandle(t,r)]:[],a=t[t.length-2],u=t[t.length-1],h=Bd.createElement("path",{"class-sprotty-edge":!0,"class-arrow":!0,d:"M 0,0.3 L 6,-3.5 M 0,-0.3 L 6,3.5",transform:`rotate(${m.toDegrees(m.angleOfPoint({x:a.x-u.x,y:a.y-u.y}))} ${u.x} ${u.y}) translate(${u.x} ${u.y})`,style:{stroke:e.color,fill:e.color}});return o.push(...s,h),o}edgePadding(e){if(e.args)return m.EdgePadding.from(e)}renderMouseHandle(e,t){return Bd.createElement("path",{"class-mouse-handle":!0,d:this.createPathForSegments(e),"style-stroke-width":t*2,"style-stroke":"transparent","style-stroke-dasharray":"none","style-stroke-dashoffset":"0"})}createPathForSegments(e){const t=e[0];let i=`M ${t.x},${t.y}`;for(let o=1;o<e.length;o++){const r=e[o];i+=` L ${r.x},${r.y}`}return i}intersectionPath(e,t,i,o){try{return super.intersectionPath(e,t,i,o)}catch{return""}}};SL=mM([le()],SL);let EL=class extends m.GEdgeView{renderLine(e,t,i){const o=super.renderLine(e,t,i);return o.data&&(o.data.style={stroke:e.color}),o}renderAdditionals(e,t,i){if(m.hasArgs(e)&&e.args){const o=m.EdgePadding.from(e);return o?[this.renderMouseHandle(t,o)]:[]}return[]}};EL=mM([le()],EL);let CL=class extends m.GResizeHandleView{render(e,t){if(t.targetKind==="hidden")return;const i=e.parent;if(!TZ(i))return super.render(e,t);const o=this.getLaneHandlePosition(e,i);return o!==void 0?this.renderLandeResizeHandle(e,o):Bd.createElement("g",null)}renderLandeResizeHandle(e,t){const i=Bd.createElement("svg",{"class-lane-resize-handle":!0,"class-mouseover":e.hoverFeedback,x:t.x-20,y:t.y-10,width:40,height:20},Bd.createElement("rect",{x:0,y:0,height:20,width:40,"class-lane-resize-mouse-handle":!0}),Bd.createElement("line",{x1:0,y1:10,x2:40,y2:10}),";");return m.setAttr(i,"data-kind",e.location),i}getLaneHandlePosition(e,t){return e.isNResize()?{x:m.Dimension.center(t.bounds).x,y:5}:e.isSResize()?{x:m.Dimension.center(t.bounds).x,y:m.Bounds.dimension(t.bounds).height-5}:super.getPosition(e)}};CL=mM([le()],CL);var qAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};const Lv={createElement:m.svg};let PL=class extends m.GIssueMarkerView{render(e){const t=super.getMaxSeverity(e),i=Lv.createElement("g",{"class-sprotty-issue":!0},Lv.createElement("g",null,this.getGlspIssueMarkerBackground(t),Lv.createElement("path",{d:this.getGlspIssueMarkerPath(t)})));return m.setClass(i,"sprotty-"+t,!0),i}getGlspIssueMarkerBackground(e){switch(e){case"warning":return Lv.createElement("polygon",{"class-sprotty-issue-background":!0,points:"8 0, 12 12, 0 12"});case"error":case"info":return Lv.createElement("circle",{"class-sprotty-issue-background":!0,r:this.radius,cx:this.radius,cy:this.radius})}}get radius(){return 6}getGlspIssueMarkerPath(e){switch(e){case"error":return"M8 2.5C4.96243 2.5 2.5 4.96243 2.5 8C2.5 11.0376 4.96243 13.5 8 13.5C11.0376 13.5 13.5 11.0376 13.5 8C13.5 4.96243 11.0376 2.5 8 2.5ZM1.5 8C1.5 4.41015 4.41015 1.5 8 1.5C11.5899 1.5 14.5 4.41015 14.5 8C14.5 11.5899 11.5899 14.5 8 14.5C4.41015 14.5 1.5 11.5899 1.5 8Z M6.31311 6.3131C6.50838 6.11784 6.82496 6.11784 7.02022 6.3131L8 7.29288L8.97978 6.3131C9.17504 6.11784 9.49162 6.11784 9.68689 6.3131C9.88215 6.50837 9.88215 6.82495 9.68689 7.02021L8.70711 7.99999L9.68689 8.97977C9.88215 9.17503 9.88215 9.49161 9.68689 9.68688C9.49162 9.88214 9.17504 9.88214 8.97978 9.68688L8 8.7071L7.02022 9.68688C6.82496 9.88214 6.50838 9.88214 6.31311 9.68688C6.11785 9.49161 6.11785 9.17503 6.31311 8.97977L7.29289 7.99999L6.31311 7.02021C6.11785 6.82495 6.11785 6.50837 6.31311 6.3131Z";case"warning":return"M8.00706 6.52274C8.2832 6.52274 8.50706 6.7466 8.50706 7.02274V9.50001C8.50706 9.77615 8.2832 10 8.00706 10C7.73091 10 7.50706 9.77615 7.50706 9.50001V7.02274C7.50706 6.7466 7.73091 6.52274 8.00706 6.52274ZM8.00706 10.5243C8.2832 10.5243 8.50706 10.7482 8.50706 11.0243V11.031C8.50706 11.3071 8.2832 11.531 8.00706 11.531C7.73091 11.531 7.50706 11.3071 7.50706 11.031V11.0243C7.50706 10.7482 7.73091 10.5243 8.00706 10.5243Z M7.06898 2.75412C7.35117 2.58775 7.67277 2.5 8.00035 2.5C8.32793 2.5 8.64953 2.58775 8.93172 2.75412C9.21237 2.91958 9.44384 3.1568 9.60237 3.44136L14.3352 11.6072C14.347 11.6275 14.3573 11.6487 14.3662 11.6704C14.4784 11.9478 14.521 12.2484 14.4904 12.5461C14.4597 12.8437 14.3567 13.1293 14.1903 13.378C14.0239 13.6266 13.7992 13.8308 13.5358 13.9727C13.2724 14.1146 12.9782 14.1899 12.679 14.192L12.6755 14.192H3.33854C3.32627 14.192 3.31411 14.1916 3.30207 14.1907C3.28148 14.1922 3.26058 14.1924 3.23943 14.1913C2.9473 14.1763 2.663 14.0915 2.41028 13.9442C2.15756 13.7969 1.94375 13.5913 1.7867 13.3445C1.62965 13.0977 1.53392 12.8169 1.5075 12.5256C1.48107 12.2342 1.52473 11.9408 1.63481 11.6698C1.64356 11.6482 1.6538 11.6273 1.66546 11.6072L6.39833 3.44136C6.55686 3.1568 6.78833 2.91958 7.06898 2.75412ZM3.30172 13.1933C3.31388 13.1924 3.32616 13.192 3.33854 13.192H12.6736C12.8091 13.1908 12.9422 13.1566 13.0616 13.0923C13.1813 13.0278 13.2835 12.935 13.3592 12.8219C13.4348 12.7088 13.4817 12.5789 13.4956 12.4436C13.5085 12.3186 13.4929 12.1925 13.4503 12.0746L8.72989 3.93021C8.65777 3.79988 8.55216 3.6912 8.42385 3.61555C8.29553 3.5399 8.1493 3.5 8.00035 3.5C7.8514 3.5 7.70517 3.5399 7.57686 3.61555C7.44855 3.6912 7.34284 3.79983 7.27073 3.93017L7.26591 3.93888L2.55022 12.0749C2.50836 12.19 2.49232 12.313 2.50341 12.4352C2.51542 12.5677 2.55895 12.6954 2.63036 12.8076C2.70177 12.9198 2.79899 13.0133 2.9139 13.0803C3.02881 13.1473 3.15808 13.1858 3.29092 13.1927C3.29453 13.1928 3.29813 13.1931 3.30172 13.1933Z";case"info":return"M 6.5719 0.013 A 5.9159 5.9159 90 0 1 10.2188 1.7695 A 6.1421 6.1421 90 0 1 10.619 9.9386 A 5.9594 5.9594 90 0 1 3.1546 11.4523 A 6.0899 6.0899 90 0 1 0.4402 8.4074 A 6.1943 6.1943 90 0 1 0.2401 4.3098 A 6.0899 6.0899 90 0 1 2.65 1.0126 A 5.9159 5.9159 90 0 1 6.5719 0.013 Z M 6.9825 11.1913 A 5.1242 5.1242 90 0 0 9.9491 9.3905 A 5.2808 5.2808 90 0 0 9.6011 2.3784 A 5.0633 5.0633 90 0 0 3.1372 1.7347 A 5.2721 5.2721 90 0 0 3.5722 10.6867 A 5.0546 5.0546 90 0 0 6.9825 11.1913 Z M 5.534 4.3359 H 6.6214 V 3.4659 H 5.534 Z M 6.6214 5.2059 V 8.6858 H 5.534 V 5.2059 Z"}}};PL=qAe([le()],PL);const wL=Symbol("goToFormFeature");function WAe(n){return n.hasFeature(wL)}const D3=Symbol("goToSourceFeature");function ZAe(n){return n.hasFeature(D3)}const QAe=new m.FeatureModule((n,e,t,i)=>{i(m.TYPES.ILogger).to(m.ConsoleLogger).inSingletonScope(),i(m.TYPES.LogLevel).toConstantValue(m.LogLevel.warn),n(m.TYPES.IContextMenuItemProvider).to(m.DeleteElementContextMenuItemProvider),n(m.TYPES.IMovementRestrictor).to(gL);const o={bind:n,unbind:e,isBound:t,rebind:i};m.overrideModelElement(o,m.DefaultTypes.GRAPH,m.GGraph,_L),m.overrideModelElement(o,m.DefaultTypes.ISSUE_MARKER,m.GIssueMarker,PL),r(We.START),r(We.START_ERROR),r(We.START_SIGNAL),r(We.START_PROGRAM,{enable:[D3]}),r(We.START_SUB),r(We.START_WS),r(We.START_HD),r(We.START_HD_METHOD),r(We.START_HD_EVENT),r(We.START_EMBEDDED),r(We.START_THIRD_PARTY),s(bn.END),s(bn.END_ERROR),s(bn.END_PAGE),s(bn.END_SUB),s(bn.END_WS),s(bn.END_HD),s(bn.END_HD_EXIT),s(bn.END_EMBEDDED),m.configureModelElement(o,ir.INTERMEDIATE_TASK,Np,Cl),m.configureModelElement(o,ir.INTERMEDIATE_WAIT,Np,Cl,{enable:[D3]}),m.configureModelElement(o,ir.INTERMEDIATE_THIRD_PARTY,Np,Cl),m.configureModelElement(o,Ea.BOUNDARY_ERROR,b_,Cl),m.configureModelElement(o,Ea.BOUNDARY_SIGNAL,b_,Cl),a(Eo.TASK),a(Eo.JOIN,{disable:[Mw]}),a(Eo.SPLIT),a(Eo.ALTERNATIVE),m.configureModelElement(o,ge.LABEL,TAe,E_),m.configureModelElement(o,ge.COMMENT,MAe,km,{disable:[oS,i4,y_]}),u(ge.GENERIC),u(ge.SCRIPT),u(ge.SOAP),u(ge.REST),u(ge.DB),u(ge.EMAIL),u(ge.THIRD_PARTY),u(ge.THIRD_PARTY_RULE),u(ge.PROGRAM,{enable:[D3]}),u(ge.TRIGGER,{enable:[I3]}),u(ge.HD,{enable:[wL]}),u(ge.USER,{enable:[AZ,wL]}),h(ge.SUB_PROCESS,{enable:[I3],disable:[y_]}),h(ge.EMBEDDED_PROCESS),h(ge.BPMN_GENERIC),h(ge.BPMN_MANUAL),h(ge.BPMN_RECEIVE),h(ge.BPMN_RULE),h(ge.BPMN_SCRIPT),h(ge.BPMN_SEND),h(ge.BPMN_SERVICE),h(ge.BPMN_USER),m.configureModelElement(o,sa.LANE,Ca,Dw),m.configureModelElement(o,sa.POOL,Ca,yL),m.configureModelElement(o,sa.LABEL,IZ,bL),m.overrideModelElement(o,jp.DEFAULT,$m,SL),m.configureModelElement(o,jp.ASSOCIATION,$m,EL),m.configureModelElement(o,jp.LABEL,pM,E_,{enable:[m.selectFeature,m.moveFeature]}),m.overrideModelElement(o,Wy.DEFAULT,Hu,E_,{enable:[m.selectFeature,m.moveFeature]});function r(g,y){m.configureModelElement(o,g,b_,Fm,y)}function s(g,y){m.configureModelElement(o,g,IAe,Fm,y)}function a(g,y){m.configureModelElement(o,g,MZ,Tw,y)}function u(g,y){m.configureModelElement(o,g,Bm,km,y)}function h(g,y){m.configureModelElement(o,g,Bm,vL,y||{enable:[I3,PZ,Mw],disable:[y_]})}});var XAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let AL=class extends m.DirectLabelEditTool{enable(){this.toDisposeOnDisable.push(this.keyTool.registerListener(this.createEditLabelKeyListener()))}};AL=XAe([le()],AL);var jZ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},RL;let ML=class{handle(e){if(m.isEditLabelAction(e))return m.SetUIExtensionVisibilityAction.create({extensionId:Ow.IVY_ID,visible:!0,contextElementsId:[e.labelId]})}};ML=jZ([le()],ML);var Ml;let Ow=(Ml=class extends m.EditLabelUI{id(){return RL.IVY_ID}configureAndAdd(e,t){super.configureAndAdd(e,t),e.style.top="3px"}},RL=Ml,x(Ml,"IVY_ID","ivyEditLabelUi"),Ml);Ow=RL=jZ([le()],Ow);var JAe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let IL=class extends Un{singleQuickAction(e){if(m.isWithEditableLabel(e)&&e.editableLabel)return{icon:N.Label,title:"Edit Label (L)",location:"Middle",sorting:"C",action:m.EditLabelAction.create(e.editableLabel.id),shortcut:"KeyL"}}};IL=JAe([le()],IL);const NZ=new m.FeatureModule((n,e,t)=>{m.configureCommand({bind:n,isBound:t},m.ApplyLabelEditCommand),n(m.TYPES.IEditLabelValidator).to(m.ServerEditLabelValidator),n(m.TYPES.IEditLabelValidationDecorator).to(m.BalloonLabelValidationDecorator),m.bindAsService(n,m.TYPES.IDefaultTool,AL),n(Ve.QuickActionProvider).to(IL)},{featureId:m.labelEditModule.featureId}),BZ=new m.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};m.configureActionHandler(i,m.EditLabelAction.KIND,ML),m.bindAsService(i,m.TYPES.IUIExtension,Ow)},{featureId:m.labelEditUiModule.featureId});var $Z=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},kZ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},FZ=function(n,e){return function(t,i){e(t,i,n)}},$s,qv,TL;(function(n){function e(t){return{kind:Lw.KIND,...t}}n.create=e})(TL||(TL={}));var xs;let Lw=(xs=class extends m.Command{constructor(t){super();x(this,"action");x(this,"executed",[]);x(this,"failed",[]);x(this,"lastExecutedElement");this.action=t}execute(t){var o;const i=t.root;return this.lastExecutedElement=i.index.getById(this.action.lastExecutedElementId),(o=this.action.oldElementExecutions)==null||o.forEach(r=>{const s=i.index.getById(r.elementId);if(s instanceof m.GChildElement&&Iw(s)){qV(s,0);const a=r.failed?$s.FAILED_CSS_CLASS:$s.EXECUTED_CSS_CLASS;m.removeCssClasses(s,a)}}),this.action.elementExecutions.forEach(r=>{const s=i.index.getById(r.elementId);s instanceof m.GChildElement&&Iw(s)&&(qV(s,r.count),r.failed?this.failed.push(s):this.executed.push(s))}),this.redo(t)}undo(t){return m.removeCssClassOfElements(this.executed,$s.EXECUTED_CSS_CLASS),m.removeCssClassOfElements(this.failed,$s.FAILED_CSS_CLASS),t.root}redo(t){return m.addCssClassToElements(this.executed,$s.EXECUTED_CSS_CLASS),m.addCssClassToElements(this.failed,$s.FAILED_CSS_CLASS),m.removeCssClassOfElements(this.executed,$s.LAST_EXECUTED_CSS_CLASS),this.lastExecutedElement&&m.addCssClasses(this.lastExecutedElement,$s.LAST_EXECUTED_CSS_CLASS),t.root}},$s=xs,x(xs,"KIND","executedFeedbackCommand"),x(xs,"EXECUTED_CSS_CLASS","executed"),x(xs,"LAST_EXECUTED_CSS_CLASS","last"),x(xs,"FAILED_CSS_CLASS","failed"),xs);Lw=$s=$Z([le(),FZ(0,be(m.TYPES.Action)),kZ("design:paramtypes",[Object])],Lw);var DL;(function(n){function e(t){return{kind:jw.KIND,...t}}n.create=e})(DL||(DL={}));var Ld;let jw=(Ld=class extends m.Command{constructor(t){super();x(this,"action");x(this,"stoppedElement");this.action=t}execute(t){const i=t.root,o=i.index.getById(this.action.oldStoppedElement);o instanceof m.GChildElement&&Iw(o)&&m.removeCssClasses(o,qv.STOPPED_CSS_CLASS);const r=i.index.getById(this.action.stoppedElement??"");return r instanceof m.GChildElement&&Iw(r)&&(this.stoppedElement=r),this.redo(t)}undo(t){return m.removeCssClasses(this.stoppedElement,qv.STOPPED_CSS_CLASS),t.root}redo(t){return m.addCssClasses(this.stoppedElement,qv.STOPPED_CSS_CLASS),t.root}},qv=Ld,x(Ld,"KIND","stoppedFeedbackCommand"),x(Ld,"STOPPED_CSS_CLASS","stopped"),Ld);jw=qv=$Z([le(),FZ(0,be(m.TYPES.Action)),kZ("design:paramtypes",[Object])],jw);function qV(n,e){n.executionCount=e}var hh=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},aS=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Sf=class{constructor(){x(this,"feedbackDispatcher");x(this,"actionDispatcher");x(this,"modelInitializationConstraint");x(this,"oldExecutions")}handle(e){if(Cw.is(e)){const t=TL.create({oldElementExecutions:this.oldExecutions,elementExecutions:e.elementExecutions,lastExecutedElementId:e.lastExecutedElementId});this.modelInitializationConstraint.onInitialized(()=>{e.elementExecutions.length>0?this.feedbackDispatcher.registerFeedback(this,[t]):this.feedbackDispatcher.deregisterFeedback(this,[t]),this.oldExecutions=e.elementExecutions})}}};hh([be(m.TYPES.IFeedbackActionDispatcher),aS("design:type",Object)],Sf.prototype,"feedbackDispatcher",void 0);hh([be(m.TYPES.IActionDispatcher),aS("design:type",Object)],Sf.prototype,"actionDispatcher",void 0);hh([be(m.ModelInitializationConstraint),aS("design:type",m.ModelInitializationConstraint)],Sf.prototype,"modelInitializationConstraint",void 0);Sf=hh([le()],Sf);let xm=class{constructor(){x(this,"feedbackDispatcher");x(this,"actionDispatcher");x(this,"oldStoppedElement")}handle(e){if(Pw.is(e)){const t=DL.create({oldStoppedElement:this.oldStoppedElement,stoppedElement:e.elementId});e.elementId&&e.elementId.length>0?this.feedbackDispatcher.registerFeedback(this,[t]):this.feedbackDispatcher.deregisterFeedback(this,[t]),this.oldStoppedElement=e.elementId??""}}};hh([be(m.TYPES.IFeedbackActionDispatcher),aS("design:type",Object)],xm.prototype,"feedbackDispatcher",void 0);hh([be(m.TYPES.IActionDispatcher),aS("design:type",Object)],xm.prototype,"actionDispatcher",void 0);xm=hh([le()],xm);const eRe=new m.FeatureModule((n,e,t)=>{n(Sf).toSelf().inSingletonScope(),n(xm).toSelf().inSingletonScope(),m.configureActionHandler({bind:n,isBound:t},Cw.KIND,Sf),m.configureActionHandler({bind:n,isBound:t},Pw.KIND,xm),m.configureCommand({bind:n,isBound:t},Lw),m.configureCommand({bind:n,isBound:t},jw)});var xZ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},tRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Nw=class extends m.GLSPCommandStack{constructor(){super(...arguments);x(this,"actionDispatcher")}undo(){return this.actionDispatcher().then(t=>t.dispatch(m.UndoAction.create())),this.thenUpdate()}redo(){return this.actionDispatcher().then(t=>t.dispatch(m.RedoAction.create())),this.thenUpdate()}};xZ([be(m.TYPES.IActionDispatcherProvider),tRe("design:type",Function)],Nw.prototype,"actionDispatcher",void 0);Nw=xZ([le()],Nw);var gM=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},HZ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Zy=class{constructor(){x(this,"actionDispatcher");x(this,"editorContext");x(this,"jumpStack",new Map)}handle(e){if(bf.is(e)&&!e.noViewportUpdate)return this.updateViewport(e),ct.SelectAllAction.create(!1)}updateViewport(e){const t=this.editorContext.modelRoot;if(e.elementId===""){const i=this.jumpStack.get(t.id.substring(0,t.id.lastIndexOf("-")));i&&this.actionDispatcher.dispatch(m.SetViewportAction.create(t.id,i,{animate:!1}))}else m.isViewport(t)&&this.jumpStack.set(this.editorContext.modelRoot.id,t)}};gM([be(m.TYPES.IActionDispatcher),HZ("design:type",m.GLSPActionDispatcher)],Zy.prototype,"actionDispatcher",void 0);gM([be(m.EditorContextService),HZ("design:type",m.EditorContextService)],Zy.prototype,"editorContext",void 0);Zy=gM([le()],Zy);let OL=class extends Un{singleQuickAction(e){if(LAe(e))return{icon:N.SubStart,title:"Jump (J)",location:"Middle",sorting:"A",action:bf.create({elementId:e.id}),readonlySupport:!0,shortcut:"KeyJ"}}};OL=gM([le()],OL);function Or(n,e){const t=n?["ivy",`ivy-${n}`]:[];return e&&t.push(...e),Ce("i",t)}function Ce(n,e,t){const i=document.createElement(n);return e&&i.classList.add(...e),t&&(i.textContent=t),i}class nRe{constructor(e,t){x(this,"state");x(this,"onclick");x(this,"input");this.state=e,this.onclick=t}create(){const e=Ce("label",["switch"]);return this.input=document.createElement("input"),this.input.type="checkbox",this.input.checked=this.state,this.input.onchange=t=>{var o;const i=((o=this.input)==null?void 0:o.checked)??!this.state;this.state=i,this.onclick(i)},e.appendChild(this.input),e.appendChild(Ce("span",["slider","round"])),e}switch(){var e;this.input&&(this.input.checked=!this.state,(e=this.input)==null||e.dispatchEvent(new UIEvent("change")))}}var vM=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},c4=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},O3,Il;let nc=(Il=class extends m.GLSPAbstractUIExtension{constructor(){super(...arguments);x(this,"actionDispatcher");x(this,"selectionService");x(this,"editorContext")}id(){return O3.ID}containerClass(){return"jump-out-container"}initializeContents(t){t.style.position="absolute"}onBeforeShow(t,i,...o){t.innerHTML="";const r=Ce("button",["jump-out-btn"]);r.title="Jump out (J)",r.appendChild(Or(N.JumpOut)),r.onclick=s=>this.actionDispatcher.dispatch(bf.create({elementId:""})),t.appendChild(r)}handle(t){(m.SetModelAction.is(t)||m.UpdateModelAction.is(t))&&this.actionDispatcher.dispatch(m.SetUIExtensionVisibilityAction.create({extensionId:O3.ID,visible:this.showJumpOutBtn(t.newRoot.id)}))}showJumpOutBtn(t){return t.includes("-")}},O3=Il,x(Il,"ID","jumpOutUi"),Il);vM([be(m.TYPES.IActionDispatcher),c4("design:type",Object)],nc.prototype,"actionDispatcher",void 0);vM([be(m.SelectionService),c4("design:type",m.SelectionService)],nc.prototype,"selectionService",void 0);vM([be(m.EditorContextService),c4("design:type",m.EditorContextService)],nc.prototype,"editorContext",void 0);nc=O3=vM([le()],nc);const iRe=new m.FeatureModule((n,e,t)=>{n(nc).toSelf().inSingletonScope(),n(m.TYPES.IUIExtension).toService(nc),m.configureActionHandler({bind:n,isBound:t},m.SetModelAction.KIND,nc),m.configureActionHandler({bind:n,isBound:t},m.UpdateModelAction.KIND,nc),n(Ve.QuickActionProvider).to(OL),m.configureActionHandler({bind:n,isBound:t},bf.KIND,Zy)});function KZ(n){if(!n.source||!n.target)return n.bounds;const e=n.source,t=n.target,i=[],o={x:0,y:0,width:0,height:0};i.push(m.Bounds.translate(o,m.Bounds.center(e.bounds))),i.push(...n.routingPoints.map(a=>m.Bounds.translate(o,{x:a.x,y:a.y}))),i.push(m.Bounds.translate(o,m.Bounds.center(t.bounds)));let r=i.reduce((a,u)=>m.Bounds.combine(a,u)),s=n;for(;s instanceof m.GChildElement;){const a=s.parent;r=a.localToParent(r),s=a}return r}function oRe(n){let e=m.Bounds.translate(n.labelBounds,n.position),t=n;for(;t instanceof m.GChildElement;){const i=t.parent;e=i.localToParent(e),t=i}return e}var VZ={exports:{}};(function(n){(function(){function e(p){var b={omitExtraWLInCodeBlocks:{defaultValue:!1,describe:"Omit the default extra whiteline added to code blocks",type:"boolean"},noHeaderId:{defaultValue:!1,describe:"Turn on/off generated header id",type:"boolean"},prefixHeaderId:{defaultValue:!1,describe:"Add a prefix to the generated header ids. Passing a string will prefix that string to the header id. Setting to true will add a generic 'section-' prefix",type:"string"},rawPrefixHeaderId:{defaultValue:!1,describe:'Setting this option to true will prevent showdown from modifying the prefix. This might result in malformed IDs (if, for instance, the " char is used in the prefix)',type:"boolean"},ghCompatibleHeaderId:{defaultValue:!1,describe:"Generate header ids compatible with github style (spaces are replaced with dashes, a bunch of non alphanumeric chars are removed)",type:"boolean"},rawHeaderId:{defaultValue:!1,describe:`Remove only spaces, ' and " from generated header ids (including prefixes), replacing them with dashes (-). WARNING: This might result in malformed ids`,type:"boolean"},headerLevelStart:{defaultValue:!1,describe:"The header blocks level start",type:"integer"},parseImgDimensions:{defaultValue:!1,describe:"Turn on/off image dimension parsing",type:"boolean"},simplifiedAutoLink:{defaultValue:!1,describe:"Turn on/off GFM autolink style",type:"boolean"},excludeTrailingPunctuationFromURLs:{defaultValue:!1,describe:"Excludes trailing punctuation from links generated with autoLinking",type:"boolean"},literalMidWordUnderscores:{defaultValue:!1,describe:"Parse midword underscores as literal underscores",type:"boolean"},literalMidWordAsterisks:{defaultValue:!1,describe:"Parse midword asterisks as literal asterisks",type:"boolean"},strikethrough:{defaultValue:!1,describe:"Turn on/off strikethrough support",type:"boolean"},tables:{defaultValue:!1,describe:"Turn on/off tables support",type:"boolean"},tablesHeaderId:{defaultValue:!1,describe:"Add an id to table headers",type:"boolean"},ghCodeBlocks:{defaultValue:!0,describe:"Turn on/off GFM fenced code blocks support",type:"boolean"},tasklists:{defaultValue:!1,describe:"Turn on/off GFM tasklist support",type:"boolean"},smoothLivePreview:{defaultValue:!1,describe:"Prevents weird effects in live previews due to incomplete input",type:"boolean"},smartIndentationFix:{defaultValue:!1,describe:"Tries to smartly fix indentation in es6 strings",type:"boolean"},disableForced4SpacesIndentedSublists:{defaultValue:!1,describe:"Disables the requirement of indenting nested sublists by 4 spaces",type:"boolean"},simpleLineBreaks:{defaultValue:!1,describe:"Parses simple line breaks as <br> (GFM Style)",type:"boolean"},requireSpaceBeforeHeadingText:{defaultValue:!1,describe:"Makes adding a space between `#` and the header text mandatory (GFM Style)",type:"boolean"},ghMentions:{defaultValue:!1,describe:"Enables github @mentions",type:"boolean"},ghMentionsLink:{defaultValue:"https://github.com/{u}",describe:"Changes the link generated by @mentions. Only applies if ghMentions option is enabled.",type:"string"},encodeEmails:{defaultValue:!0,describe:"Encode e-mail addresses through the use of Character Entities, transforming ASCII e-mail addresses into its equivalent decimal entities",type:"boolean"},openLinksInNewWindow:{defaultValue:!1,describe:"Open all links in new windows",type:"boolean"},backslashEscapesHTMLTags:{defaultValue:!1,describe:"Support for HTML Tag escaping. ex: <div>foo</div>",type:"boolean"},emoji:{defaultValue:!1,describe:"Enable emoji support. Ex: `this is a :smile: emoji`",type:"boolean"},underline:{defaultValue:!1,describe:"Enable support for underline. Syntax is double or triple underscores: `__underline word__`. With this option enabled, underscores no longer parses into `<em>` and `<strong>`",type:"boolean"},ellipsis:{defaultValue:!0,describe:"Replaces three dots with the ellipsis unicode character",type:"boolean"},completeHTMLDocument:{defaultValue:!1,describe:"Outputs a complete html document, including `<html>`, `<head>` and `<body>` tags",type:"boolean"},metadata:{defaultValue:!1,describe:"Enable support for document metadata (defined at the top of the document between `«««` and `»»»` or between `---` and `---`).",type:"boolean"},splitAdjacentBlockquotes:{defaultValue:!1,describe:"Split adjacent blockquote blocks",type:"boolean"}};if(p===!1)return JSON.parse(JSON.stringify(b));var v={};for(var R in b)b.hasOwnProperty(R)&&(v[R]=b[R].defaultValue);return v}function t(){var p=e(!0),b={};for(var v in p)p.hasOwnProperty(v)&&(b[v]=!0);return b}var i={},o={},r={},s=e(!0),a="vanilla",u={github:{omitExtraWLInCodeBlocks:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,disableForced4SpacesIndentedSublists:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghCompatibleHeaderId:!0,ghMentions:!0,backslashEscapesHTMLTags:!0,emoji:!0,splitAdjacentBlockquotes:!0},original:{noHeaderId:!0,ghCodeBlocks:!1},ghost:{omitExtraWLInCodeBlocks:!0,parseImgDimensions:!0,simplifiedAutoLink:!0,excludeTrailingPunctuationFromURLs:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,smoothLivePreview:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghMentions:!1,encodeEmails:!0},vanilla:e(!0),allOn:t()};i.helper={},i.extensions={},i.setOption=function(p,b){return s[p]=b,this},i.getOption=function(p){return s[p]},i.getOptions=function(){return s},i.resetOptions=function(){s=e(!0)},i.setFlavor=function(p){if(!u.hasOwnProperty(p))throw Error(p+" flavor was not found");i.resetOptions();var b=u[p];a=p;for(var v in b)b.hasOwnProperty(v)&&(s[v]=b[v])},i.getFlavor=function(){return a},i.getFlavorOptions=function(p){if(u.hasOwnProperty(p))return u[p]},i.getDefaultOptions=function(p){return e(p)},i.subParser=function(p,b){if(i.helper.isString(p))if(typeof b<"u")o[p]=b;else{if(o.hasOwnProperty(p))return o[p];throw Error("SubParser named "+p+" not registered!")}},i.extension=function(p,b){if(!i.helper.isString(p))throw Error("Extension 'name' must be a string");if(p=i.helper.stdExtName(p),i.helper.isUndefined(b)){if(!r.hasOwnProperty(p))throw Error("Extension named "+p+" is not registered!");return r[p]}else{typeof b=="function"&&(b=b()),i.helper.isArray(b)||(b=[b]);var v=h(b,p);if(v.valid)r[p]=b;else throw Error(v.error)}},i.getAllExtensions=function(){return r},i.removeExtension=function(p){delete r[p]},i.resetExtensions=function(){r={}};function h(p,b){var v=b?"Error in "+b+" extension->":"Error in unnamed extension",R={valid:!0,error:""};i.helper.isArray(p)||(p=[p]);for(var D=0;D<p.length;++D){var j=v+" sub-extension "+D+": ",T=p[D];if(typeof T!="object")return R.valid=!1,R.error=j+"must be an object, but "+typeof T+" given",R;if(!i.helper.isString(T.type))return R.valid=!1,R.error=j+'property "type" must be a string, but '+typeof T.type+" given",R;var $=T.type=T.type.toLowerCase();if($==="language"&&($=T.type="lang"),$==="html"&&($=T.type="output"),$!=="lang"&&$!=="output"&&$!=="listener")return R.valid=!1,R.error=j+"type "+$+' is not recognized. Valid values: "lang/language", "output/html" or "listener"',R;if($==="listener"){if(i.helper.isUndefined(T.listeners))return R.valid=!1,R.error=j+'. Extensions of type "listener" must have a property called "listeners"',R}else if(i.helper.isUndefined(T.filter)&&i.helper.isUndefined(T.regex))return R.valid=!1,R.error=j+$+' extensions must define either a "regex" property or a "filter" method',R;if(T.listeners){if(typeof T.listeners!="object")return R.valid=!1,R.error=j+'"listeners" property must be an object but '+typeof T.listeners+" given",R;for(var Q in T.listeners)if(T.listeners.hasOwnProperty(Q)&&typeof T.listeners[Q]!="function")return R.valid=!1,R.error=j+'"listeners" property must be an hash of [event name]: [callback]. listeners.'+Q+" must be a function but "+typeof T.listeners[Q]+" given",R}if(T.filter){if(typeof T.filter!="function")return R.valid=!1,R.error=j+'"filter" must be a function, but '+typeof T.filter+" given",R}else if(T.regex){if(i.helper.isString(T.regex)&&(T.regex=new RegExp(T.regex,"g")),!(T.regex instanceof RegExp))return R.valid=!1,R.error=j+'"regex" property must either be a string or a RegExp object, but '+typeof T.regex+" given",R;if(i.helper.isUndefined(T.replace))return R.valid=!1,R.error=j+'"regex" extensions must implement a replace string or function',R}}return R}i.validateExtension=function(p){var b=h(p,null);return b.valid?!0:(console.warn(b.error),!1)},i.hasOwnProperty("helper")||(i.helper={}),i.helper.isString=function(p){return typeof p=="string"||p instanceof String},i.helper.isFunction=function(p){var b={};return p&&b.toString.call(p)==="[object Function]"},i.helper.isArray=function(p){return Array.isArray(p)},i.helper.isUndefined=function(p){return typeof p>"u"},i.helper.forEach=function(p,b){if(i.helper.isUndefined(p))throw new Error("obj param is required");if(i.helper.isUndefined(b))throw new Error("callback param is required");if(!i.helper.isFunction(b))throw new Error("callback param must be a function/closure");if(typeof p.forEach=="function")p.forEach(b);else if(i.helper.isArray(p))for(var v=0;v<p.length;v++)b(p[v],v,p);else if(typeof p=="object")for(var R in p)p.hasOwnProperty(R)&&b(p[R],R,p);else throw new Error("obj does not seem to be an array or an iterable object")},i.helper.stdExtName=function(p){return p.replace(/[_?*+\/\\.^-]/g,"").replace(/\s/g,"").toLowerCase()};function g(p,b){var v=b.charCodeAt(0);return"¨E"+v+"E"}i.helper.escapeCharactersCallback=g,i.helper.escapeCharacters=function(p,b,v){var R="(["+b.replace(/([\[\]\\])/g,"\\$1")+"])";v&&(R="\\\\"+R);var D=new RegExp(R,"g");return p=p.replace(D,g),p},i.helper.unescapeHTMLEntities=function(p){return p.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")};var y=function(p,b,v,R){var D=R||"",j=D.indexOf("g")>-1,T=new RegExp(b+"|"+v,"g"+D.replace(/g/g,"")),$=new RegExp(b,D.replace(/g/g,"")),Q=[],K,Z,H,M,Y;do for(K=0;H=T.exec(p);)if($.test(H[0]))K++||(Z=T.lastIndex,M=Z-H[0].length);else if(K&&!--K){Y=H.index+H[0].length;var te={left:{start:M,end:Z},match:{start:Z,end:H.index},right:{start:H.index,end:Y},wholeMatch:{start:M,end:Y}};if(Q.push(te),!j)return Q}while(K&&(T.lastIndex=Z));return Q};i.helper.matchRecursiveRegExp=function(p,b,v,R){for(var D=y(p,b,v,R),j=[],T=0;T<D.length;++T)j.push([p.slice(D[T].wholeMatch.start,D[T].wholeMatch.end),p.slice(D[T].match.start,D[T].match.end),p.slice(D[T].left.start,D[T].left.end),p.slice(D[T].right.start,D[T].right.end)]);return j},i.helper.replaceRecursiveRegExp=function(p,b,v,R,D){if(!i.helper.isFunction(b)){var j=b;b=function(){return j}}var T=y(p,v,R,D),$=p,Q=T.length;if(Q>0){var K=[];T[0].wholeMatch.start!==0&&K.push(p.slice(0,T[0].wholeMatch.start));for(var Z=0;Z<Q;++Z)K.push(b(p.slice(T[Z].wholeMatch.start,T[Z].wholeMatch.end),p.slice(T[Z].match.start,T[Z].match.end),p.slice(T[Z].left.start,T[Z].left.end),p.slice(T[Z].right.start,T[Z].right.end))),Z<Q-1&&K.push(p.slice(T[Z].wholeMatch.end,T[Z+1].wholeMatch.start));T[Q-1].wholeMatch.end<p.length&&K.push(p.slice(T[Q-1].wholeMatch.end)),$=K.join("")}return $},i.helper.regexIndexOf=function(p,b,v){if(!i.helper.isString(p))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";if(!(b instanceof RegExp))throw"InvalidArgumentError: second parameter of showdown.helper.regexIndexOf function must be an instance of RegExp";var R=p.substring(v||0).search(b);return R>=0?R+(v||0):R},i.helper.splitAtIndex=function(p,b){if(!i.helper.isString(p))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";return[p.substring(0,b),p.substring(b)]},i.helper.encodeEmailAddress=function(p){var b=[function(v){return"&#"+v.charCodeAt(0)+";"},function(v){return"&#x"+v.charCodeAt(0).toString(16)+";"},function(v){return v}];return p=p.replace(/./g,function(v){if(v==="@")v=b[Math.floor(Math.random()*2)](v);else{var R=Math.random();v=R>.9?b[2](v):R>.45?b[1](v):b[0](v)}return v}),p},i.helper.padEnd=function(b,v,R){return v=v>>0,R=String(R||" "),b.length>v?String(b):(v=v-b.length,v>R.length&&(R+=R.repeat(v/R.length)),String(b)+R.slice(0,v))},typeof console>"u"&&(console={warn:function(p){alert(p)},log:function(p){alert(p)},error:function(p){throw p}}),i.helper.regexes={asteriskDashAndColon:/([*_:~])/g},i.helper.emojis={"+1":"👍","-1":"👎",100:"💯",1234:"🔢","1st_place_medal":"🥇","2nd_place_medal":"🥈","3rd_place_medal":"🥉","8ball":"🎱",a:"🅰️",ab:"🆎",abc:"🔤",abcd:"🔡",accept:"🉑",aerial_tramway:"🚡",airplane:"✈️",alarm_clock:"⏰",alembic:"⚗️",alien:"👽",ambulance:"🚑",amphora:"🏺",anchor:"⚓️",angel:"👼",anger:"💢",angry:"😠",anguished:"😧",ant:"🐜",apple:"🍎",aquarius:"♒️",aries:"♈️",arrow_backward:"◀️",arrow_double_down:"⏬",arrow_double_up:"⏫",arrow_down:"⬇️",arrow_down_small:"🔽",arrow_forward:"▶️",arrow_heading_down:"⤵️",arrow_heading_up:"⤴️",arrow_left:"⬅️",arrow_lower_left:"↙️",arrow_lower_right:"↘️",arrow_right:"➡️",arrow_right_hook:"↪️",arrow_up:"⬆️",arrow_up_down:"↕️",arrow_up_small:"🔼",arrow_upper_left:"↖️",arrow_upper_right:"↗️",arrows_clockwise:"🔃",arrows_counterclockwise:"🔄",art:"🎨",articulated_lorry:"🚛",artificial_satellite:"🛰",astonished:"😲",athletic_shoe:"👟",atm:"🏧",atom_symbol:"⚛️",avocado:"🥑",b:"🅱️",baby:"👶",baby_bottle:"🍼",baby_chick:"🐤",baby_symbol:"🚼",back:"🔙",bacon:"🥓",badminton:"🏸",baggage_claim:"🛄",baguette_bread:"🥖",balance_scale:"⚖️",balloon:"🎈",ballot_box:"🗳",ballot_box_with_check:"☑️",bamboo:"🎍",banana:"🍌",bangbang:"‼️",bank:"🏦",bar_chart:"📊",barber:"💈",baseball:"⚾️",basketball:"🏀",basketball_man:"⛹️",basketball_woman:"⛹️&zwj;♀️",bat:"🦇",bath:"🛀",bathtub:"🛁",battery:"🔋",beach_umbrella:"🏖",bear:"🐻",bed:"🛏",bee:"🐝",beer:"🍺",beers:"🍻",beetle:"🐞",beginner:"🔰",bell:"🔔",bellhop_bell:"🛎",bento:"🍱",biking_man:"🚴",bike:"🚲",biking_woman:"🚴&zwj;♀️",bikini:"👙",biohazard:"☣️",bird:"🐦",birthday:"🎂",black_circle:"⚫️",black_flag:"🏴",black_heart:"🖤",black_joker:"🃏",black_large_square:"⬛️",black_medium_small_square:"◾️",black_medium_square:"◼️",black_nib:"✒️",black_small_square:"▪️",black_square_button:"🔲",blonde_man:"👱",blonde_woman:"👱&zwj;♀️",blossom:"🌼",blowfish:"🐡",blue_book:"📘",blue_car:"🚙",blue_heart:"💙",blush:"😊",boar:"🐗",boat:"⛵️",bomb:"💣",book:"📖",bookmark:"🔖",bookmark_tabs:"📑",books:"📚",boom:"💥",boot:"👢",bouquet:"💐",bowing_man:"🙇",bow_and_arrow:"🏹",bowing_woman:"🙇&zwj;♀️",bowling:"🎳",boxing_glove:"🥊",boy:"👦",bread:"🍞",bride_with_veil:"👰",bridge_at_night:"🌉",briefcase:"💼",broken_heart:"💔",bug:"🐛",building_construction:"🏗",bulb:"💡",bullettrain_front:"🚅",bullettrain_side:"🚄",burrito:"🌯",bus:"🚌",business_suit_levitating:"🕴",busstop:"🚏",bust_in_silhouette:"👤",busts_in_silhouette:"👥",butterfly:"🦋",cactus:"🌵",cake:"🍰",calendar:"📆",call_me_hand:"🤙",calling:"📲",camel:"🐫",camera:"📷",camera_flash:"📸",camping:"🏕",cancer:"♋️",candle:"🕯",candy:"🍬",canoe:"🛶",capital_abcd:"🔠",capricorn:"♑️",car:"🚗",card_file_box:"🗃",card_index:"📇",card_index_dividers:"🗂",carousel_horse:"🎠",carrot:"🥕",cat:"🐱",cat2:"🐈",cd:"💿",chains:"⛓",champagne:"🍾",chart:"💹",chart_with_downwards_trend:"📉",chart_with_upwards_trend:"📈",checkered_flag:"🏁",cheese:"🧀",cherries:"🍒",cherry_blossom:"🌸",chestnut:"🌰",chicken:"🐔",children_crossing:"🚸",chipmunk:"🐿",chocolate_bar:"🍫",christmas_tree:"🎄",church:"⛪️",cinema:"🎦",circus_tent:"🎪",city_sunrise:"🌇",city_sunset:"🌆",cityscape:"🏙",cl:"🆑",clamp:"🗜",clap:"👏",clapper:"🎬",classical_building:"🏛",clinking_glasses:"🥂",clipboard:"📋",clock1:"🕐",clock10:"🕙",clock1030:"🕥",clock11:"🕚",clock1130:"🕦",clock12:"🕛",clock1230:"🕧",clock130:"🕜",clock2:"🕑",clock230:"🕝",clock3:"🕒",clock330:"🕞",clock4:"🕓",clock430:"🕟",clock5:"🕔",clock530:"🕠",clock6:"🕕",clock630:"🕡",clock7:"🕖",clock730:"🕢",clock8:"🕗",clock830:"🕣",clock9:"🕘",clock930:"🕤",closed_book:"📕",closed_lock_with_key:"🔐",closed_umbrella:"🌂",cloud:"☁️",cloud_with_lightning:"🌩",cloud_with_lightning_and_rain:"⛈",cloud_with_rain:"🌧",cloud_with_snow:"🌨",clown_face:"🤡",clubs:"♣️",cocktail:"🍸",coffee:"☕️",coffin:"⚰️",cold_sweat:"😰",comet:"☄️",computer:"💻",computer_mouse:"🖱",confetti_ball:"🎊",confounded:"😖",confused:"😕",congratulations:"㊗️",construction:"🚧",construction_worker_man:"👷",construction_worker_woman:"👷&zwj;♀️",control_knobs:"🎛",convenience_store:"🏪",cookie:"🍪",cool:"🆒",policeman:"👮",copyright:"©️",corn:"🌽",couch_and_lamp:"🛋",couple:"👫",couple_with_heart_woman_man:"💑",couple_with_heart_man_man:"👨&zwj;❤️&zwj;👨",couple_with_heart_woman_woman:"👩&zwj;❤️&zwj;👩",couplekiss_man_man:"👨&zwj;❤️&zwj;💋&zwj;👨",couplekiss_man_woman:"💏",couplekiss_woman_woman:"👩&zwj;❤️&zwj;💋&zwj;👩",cow:"🐮",cow2:"🐄",cowboy_hat_face:"🤠",crab:"🦀",crayon:"🖍",credit_card:"💳",crescent_moon:"🌙",cricket:"🏏",crocodile:"🐊",croissant:"🥐",crossed_fingers:"🤞",crossed_flags:"🎌",crossed_swords:"⚔️",crown:"👑",cry:"😢",crying_cat_face:"😿",crystal_ball:"🔮",cucumber:"🥒",cupid:"💘",curly_loop:"➰",currency_exchange:"💱",curry:"🍛",custard:"🍮",customs:"🛃",cyclone:"🌀",dagger:"🗡",dancer:"💃",dancing_women:"👯",dancing_men:"👯&zwj;♂️",dango:"🍡",dark_sunglasses:"🕶",dart:"🎯",dash:"💨",date:"📅",deciduous_tree:"🌳",deer:"🦌",department_store:"🏬",derelict_house:"🏚",desert:"🏜",desert_island:"🏝",desktop_computer:"🖥",male_detective:"🕵️",diamond_shape_with_a_dot_inside:"💠",diamonds:"♦️",disappointed:"😞",disappointed_relieved:"😥",dizzy:"💫",dizzy_face:"😵",do_not_litter:"🚯",dog:"🐶",dog2:"🐕",dollar:"💵",dolls:"🎎",dolphin:"🐬",door:"🚪",doughnut:"🍩",dove:"🕊",dragon:"🐉",dragon_face:"🐲",dress:"👗",dromedary_camel:"🐪",drooling_face:"🤤",droplet:"💧",drum:"🥁",duck:"🦆",dvd:"📀","e-mail":"📧",eagle:"🦅",ear:"👂",ear_of_rice:"🌾",earth_africa:"🌍",earth_americas:"🌎",earth_asia:"🌏",egg:"🥚",eggplant:"🍆",eight_pointed_black_star:"✴️",eight_spoked_asterisk:"✳️",electric_plug:"🔌",elephant:"🐘",email:"✉️",end:"🔚",envelope_with_arrow:"📩",euro:"💶",european_castle:"🏰",european_post_office:"🏤",evergreen_tree:"🌲",exclamation:"❗️",expressionless:"😑",eye:"👁",eye_speech_bubble:"👁&zwj;🗨",eyeglasses:"👓",eyes:"👀",face_with_head_bandage:"🤕",face_with_thermometer:"🤒",fist_oncoming:"👊",factory:"🏭",fallen_leaf:"🍂",family_man_woman_boy:"👪",family_man_boy:"👨&zwj;👦",family_man_boy_boy:"👨&zwj;👦&zwj;👦",family_man_girl:"👨&zwj;👧",family_man_girl_boy:"👨&zwj;👧&zwj;👦",family_man_girl_girl:"👨&zwj;👧&zwj;👧",family_man_man_boy:"👨&zwj;👨&zwj;👦",family_man_man_boy_boy:"👨&zwj;👨&zwj;👦&zwj;👦",family_man_man_girl:"👨&zwj;👨&zwj;👧",family_man_man_girl_boy:"👨&zwj;👨&zwj;👧&zwj;👦",family_man_man_girl_girl:"👨&zwj;👨&zwj;👧&zwj;👧",family_man_woman_boy_boy:"👨&zwj;👩&zwj;👦&zwj;👦",family_man_woman_girl:"👨&zwj;👩&zwj;👧",family_man_woman_girl_boy:"👨&zwj;👩&zwj;👧&zwj;👦",family_man_woman_girl_girl:"👨&zwj;👩&zwj;👧&zwj;👧",family_woman_boy:"👩&zwj;👦",family_woman_boy_boy:"👩&zwj;👦&zwj;👦",family_woman_girl:"👩&zwj;👧",family_woman_girl_boy:"👩&zwj;👧&zwj;👦",family_woman_girl_girl:"👩&zwj;👧&zwj;👧",family_woman_woman_boy:"👩&zwj;👩&zwj;👦",family_woman_woman_boy_boy:"👩&zwj;👩&zwj;👦&zwj;👦",family_woman_woman_girl:"👩&zwj;👩&zwj;👧",family_woman_woman_girl_boy:"👩&zwj;👩&zwj;👧&zwj;👦",family_woman_woman_girl_girl:"👩&zwj;👩&zwj;👧&zwj;👧",fast_forward:"⏩",fax:"📠",fearful:"😨",feet:"🐾",female_detective:"🕵️&zwj;♀️",ferris_wheel:"🎡",ferry:"⛴",field_hockey:"🏑",file_cabinet:"🗄",file_folder:"📁",film_projector:"📽",film_strip:"🎞",fire:"🔥",fire_engine:"🚒",fireworks:"🎆",first_quarter_moon:"🌓",first_quarter_moon_with_face:"🌛",fish:"🐟",fish_cake:"🍥",fishing_pole_and_fish:"🎣",fist_raised:"✊",fist_left:"🤛",fist_right:"🤜",flags:"🎏",flashlight:"🔦",fleur_de_lis:"⚜️",flight_arrival:"🛬",flight_departure:"🛫",floppy_disk:"💾",flower_playing_cards:"🎴",flushed:"😳",fog:"🌫",foggy:"🌁",football:"🏈",footprints:"👣",fork_and_knife:"🍴",fountain:"⛲️",fountain_pen:"🖋",four_leaf_clover:"🍀",fox_face:"🦊",framed_picture:"🖼",free:"🆓",fried_egg:"🍳",fried_shrimp:"🍤",fries:"🍟",frog:"🐸",frowning:"😦",frowning_face:"☹️",frowning_man:"🙍&zwj;♂️",frowning_woman:"🙍",middle_finger:"🖕",fuelpump:"⛽️",full_moon:"🌕",full_moon_with_face:"🌝",funeral_urn:"⚱️",game_die:"🎲",gear:"⚙️",gem:"💎",gemini:"♊️",ghost:"👻",gift:"🎁",gift_heart:"💝",girl:"👧",globe_with_meridians:"🌐",goal_net:"🥅",goat:"🐐",golf:"⛳️",golfing_man:"🏌️",golfing_woman:"🏌️&zwj;♀️",gorilla:"🦍",grapes:"🍇",green_apple:"🍏",green_book:"📗",green_heart:"💚",green_salad:"🥗",grey_exclamation:"❕",grey_question:"❔",grimacing:"😬",grin:"😁",grinning:"😀",guardsman:"💂",guardswoman:"💂&zwj;♀️",guitar:"🎸",gun:"🔫",haircut_woman:"💇",haircut_man:"💇&zwj;♂️",hamburger:"🍔",hammer:"🔨",hammer_and_pick:"⚒",hammer_and_wrench:"🛠",hamster:"🐹",hand:"✋",handbag:"👜",handshake:"🤝",hankey:"💩",hatched_chick:"🐥",hatching_chick:"🐣",headphones:"🎧",hear_no_evil:"🙉",heart:"❤️",heart_decoration:"💟",heart_eyes:"😍",heart_eyes_cat:"😻",heartbeat:"💓",heartpulse:"💗",hearts:"♥️",heavy_check_mark:"✔️",heavy_division_sign:"➗",heavy_dollar_sign:"💲",heavy_heart_exclamation:"❣️",heavy_minus_sign:"➖",heavy_multiplication_x:"✖️",heavy_plus_sign:"➕",helicopter:"🚁",herb:"🌿",hibiscus:"🌺",high_brightness:"🔆",high_heel:"👠",hocho:"🔪",hole:"🕳",honey_pot:"🍯",horse:"🐴",horse_racing:"🏇",hospital:"🏥",hot_pepper:"🌶",hotdog:"🌭",hotel:"🏨",hotsprings:"♨️",hourglass:"⌛️",hourglass_flowing_sand:"⏳",house:"🏠",house_with_garden:"🏡",houses:"🏘",hugs:"🤗",hushed:"😯",ice_cream:"🍨",ice_hockey:"🏒",ice_skate:"⛸",icecream:"🍦",id:"🆔",ideograph_advantage:"🉐",imp:"👿",inbox_tray:"📥",incoming_envelope:"📨",tipping_hand_woman:"💁",information_source:"ℹ️",innocent:"😇",interrobang:"⁉️",iphone:"📱",izakaya_lantern:"🏮",jack_o_lantern:"🎃",japan:"🗾",japanese_castle:"🏯",japanese_goblin:"👺",japanese_ogre:"👹",jeans:"👖",joy:"😂",joy_cat:"😹",joystick:"🕹",kaaba:"🕋",key:"🔑",keyboard:"⌨️",keycap_ten:"🔟",kick_scooter:"🛴",kimono:"👘",kiss:"💋",kissing:"😗",kissing_cat:"😽",kissing_closed_eyes:"😚",kissing_heart:"😘",kissing_smiling_eyes:"😙",kiwi_fruit:"🥝",koala:"🐨",koko:"🈁",label:"🏷",large_blue_circle:"🔵",large_blue_diamond:"🔷",large_orange_diamond:"🔶",last_quarter_moon:"🌗",last_quarter_moon_with_face:"🌜",latin_cross:"✝️",laughing:"😆",leaves:"🍃",ledger:"📒",left_luggage:"🛅",left_right_arrow:"↔️",leftwards_arrow_with_hook:"↩️",lemon:"🍋",leo:"♌️",leopard:"🐆",level_slider:"🎚",libra:"♎️",light_rail:"🚈",link:"🔗",lion:"🦁",lips:"👄",lipstick:"💄",lizard:"🦎",lock:"🔒",lock_with_ink_pen:"🔏",lollipop:"🍭",loop:"➿",loud_sound:"🔊",loudspeaker:"📢",love_hotel:"🏩",love_letter:"💌",low_brightness:"🔅",lying_face:"🤥",m:"Ⓜ️",mag:"🔍",mag_right:"🔎",mahjong:"🀄️",mailbox:"📫",mailbox_closed:"📪",mailbox_with_mail:"📬",mailbox_with_no_mail:"📭",man:"👨",man_artist:"👨&zwj;🎨",man_astronaut:"👨&zwj;🚀",man_cartwheeling:"🤸&zwj;♂️",man_cook:"👨&zwj;🍳",man_dancing:"🕺",man_facepalming:"🤦&zwj;♂️",man_factory_worker:"👨&zwj;🏭",man_farmer:"👨&zwj;🌾",man_firefighter:"👨&zwj;🚒",man_health_worker:"👨&zwj;⚕️",man_in_tuxedo:"🤵",man_judge:"👨&zwj;⚖️",man_juggling:"🤹&zwj;♂️",man_mechanic:"👨&zwj;🔧",man_office_worker:"👨&zwj;💼",man_pilot:"👨&zwj;✈️",man_playing_handball:"🤾&zwj;♂️",man_playing_water_polo:"🤽&zwj;♂️",man_scientist:"👨&zwj;🔬",man_shrugging:"🤷&zwj;♂️",man_singer:"👨&zwj;🎤",man_student:"👨&zwj;🎓",man_teacher:"👨&zwj;🏫",man_technologist:"👨&zwj;💻",man_with_gua_pi_mao:"👲",man_with_turban:"👳",tangerine:"🍊",mans_shoe:"👞",mantelpiece_clock:"🕰",maple_leaf:"🍁",martial_arts_uniform:"🥋",mask:"😷",massage_woman:"💆",massage_man:"💆&zwj;♂️",meat_on_bone:"🍖",medal_military:"🎖",medal_sports:"🏅",mega:"📣",melon:"🍈",memo:"📝",men_wrestling:"🤼&zwj;♂️",menorah:"🕎",mens:"🚹",metal:"🤘",metro:"🚇",microphone:"🎤",microscope:"🔬",milk_glass:"🥛",milky_way:"🌌",minibus:"🚐",minidisc:"💽",mobile_phone_off:"📴",money_mouth_face:"🤑",money_with_wings:"💸",moneybag:"💰",monkey:"🐒",monkey_face:"🐵",monorail:"🚝",moon:"🌔",mortar_board:"🎓",mosque:"🕌",motor_boat:"🛥",motor_scooter:"🛵",motorcycle:"🏍",motorway:"🛣",mount_fuji:"🗻",mountain:"⛰",mountain_biking_man:"🚵",mountain_biking_woman:"🚵&zwj;♀️",mountain_cableway:"🚠",mountain_railway:"🚞",mountain_snow:"🏔",mouse:"🐭",mouse2:"🐁",movie_camera:"🎥",moyai:"🗿",mrs_claus:"🤶",muscle:"💪",mushroom:"🍄",musical_keyboard:"🎹",musical_note:"🎵",musical_score:"🎼",mute:"🔇",nail_care:"💅",name_badge:"📛",national_park:"🏞",nauseated_face:"🤢",necktie:"👔",negative_squared_cross_mark:"❎",nerd_face:"🤓",neutral_face:"😐",new:"🆕",new_moon:"🌑",new_moon_with_face:"🌚",newspaper:"📰",newspaper_roll:"🗞",next_track_button:"⏭",ng:"🆖",no_good_man:"🙅&zwj;♂️",no_good_woman:"🙅",night_with_stars:"🌃",no_bell:"🔕",no_bicycles:"🚳",no_entry:"⛔️",no_entry_sign:"🚫",no_mobile_phones:"📵",no_mouth:"😶",no_pedestrians:"🚷",no_smoking:"🚭","non-potable_water":"🚱",nose:"👃",notebook:"📓",notebook_with_decorative_cover:"📔",notes:"🎶",nut_and_bolt:"🔩",o:"⭕️",o2:"🅾️",ocean:"🌊",octopus:"🐙",oden:"🍢",office:"🏢",oil_drum:"🛢",ok:"🆗",ok_hand:"👌",ok_man:"🙆&zwj;♂️",ok_woman:"🙆",old_key:"🗝",older_man:"👴",older_woman:"👵",om:"🕉",on:"🔛",oncoming_automobile:"🚘",oncoming_bus:"🚍",oncoming_police_car:"🚔",oncoming_taxi:"🚖",open_file_folder:"📂",open_hands:"👐",open_mouth:"😮",open_umbrella:"☂️",ophiuchus:"⛎",orange_book:"📙",orthodox_cross:"☦️",outbox_tray:"📤",owl:"🦉",ox:"🐂",package:"📦",page_facing_up:"📄",page_with_curl:"📃",pager:"📟",paintbrush:"🖌",palm_tree:"🌴",pancakes:"🥞",panda_face:"🐼",paperclip:"📎",paperclips:"🖇",parasol_on_ground:"⛱",parking:"🅿️",part_alternation_mark:"〽️",partly_sunny:"⛅️",passenger_ship:"🛳",passport_control:"🛂",pause_button:"⏸",peace_symbol:"☮️",peach:"🍑",peanuts:"🥜",pear:"🍐",pen:"🖊",pencil2:"✏️",penguin:"🐧",pensive:"😔",performing_arts:"🎭",persevere:"😣",person_fencing:"🤺",pouting_woman:"🙎",phone:"☎️",pick:"⛏",pig:"🐷",pig2:"🐖",pig_nose:"🐽",pill:"💊",pineapple:"🍍",ping_pong:"🏓",pisces:"♓️",pizza:"🍕",place_of_worship:"🛐",plate_with_cutlery:"🍽",play_or_pause_button:"⏯",point_down:"👇",point_left:"👈",point_right:"👉",point_up:"☝️",point_up_2:"👆",police_car:"🚓",policewoman:"👮&zwj;♀️",poodle:"🐩",popcorn:"🍿",post_office:"🏣",postal_horn:"📯",postbox:"📮",potable_water:"🚰",potato:"🥔",pouch:"👝",poultry_leg:"🍗",pound:"💷",rage:"😡",pouting_cat:"😾",pouting_man:"🙎&zwj;♂️",pray:"🙏",prayer_beads:"📿",pregnant_woman:"🤰",previous_track_button:"⏮",prince:"🤴",princess:"👸",printer:"🖨",purple_heart:"💜",purse:"👛",pushpin:"📌",put_litter_in_its_place:"🚮",question:"❓",rabbit:"🐰",rabbit2:"🐇",racehorse:"🐎",racing_car:"🏎",radio:"📻",radio_button:"🔘",radioactive:"☢️",railway_car:"🚃",railway_track:"🛤",rainbow:"🌈",rainbow_flag:"🏳️&zwj;🌈",raised_back_of_hand:"🤚",raised_hand_with_fingers_splayed:"🖐",raised_hands:"🙌",raising_hand_woman:"🙋",raising_hand_man:"🙋&zwj;♂️",ram:"🐏",ramen:"🍜",rat:"🐀",record_button:"⏺",recycle:"♻️",red_circle:"🔴",registered:"®️",relaxed:"☺️",relieved:"😌",reminder_ribbon:"🎗",repeat:"🔁",repeat_one:"🔂",rescue_worker_helmet:"⛑",restroom:"🚻",revolving_hearts:"💞",rewind:"⏪",rhinoceros:"🦏",ribbon:"🎀",rice:"🍚",rice_ball:"🍙",rice_cracker:"🍘",rice_scene:"🎑",right_anger_bubble:"🗯",ring:"💍",robot:"🤖",rocket:"🚀",rofl:"🤣",roll_eyes:"🙄",roller_coaster:"🎢",rooster:"🐓",rose:"🌹",rosette:"🏵",rotating_light:"🚨",round_pushpin:"📍",rowing_man:"🚣",rowing_woman:"🚣&zwj;♀️",rugby_football:"🏉",running_man:"🏃",running_shirt_with_sash:"🎽",running_woman:"🏃&zwj;♀️",sa:"🈂️",sagittarius:"♐️",sake:"🍶",sandal:"👡",santa:"🎅",satellite:"📡",saxophone:"🎷",school:"🏫",school_satchel:"🎒",scissors:"✂️",scorpion:"🦂",scorpius:"♏️",scream:"😱",scream_cat:"🙀",scroll:"📜",seat:"💺",secret:"㊙️",see_no_evil:"🙈",seedling:"🌱",selfie:"🤳",shallow_pan_of_food:"🥘",shamrock:"☘️",shark:"🦈",shaved_ice:"🍧",sheep:"🐑",shell:"🐚",shield:"🛡",shinto_shrine:"⛩",ship:"🚢",shirt:"👕",shopping:"🛍",shopping_cart:"🛒",shower:"🚿",shrimp:"🦐",signal_strength:"📶",six_pointed_star:"🔯",ski:"🎿",skier:"⛷",skull:"💀",skull_and_crossbones:"☠️",sleeping:"😴",sleeping_bed:"🛌",sleepy:"😪",slightly_frowning_face:"🙁",slightly_smiling_face:"🙂",slot_machine:"🎰",small_airplane:"🛩",small_blue_diamond:"🔹",small_orange_diamond:"🔸",small_red_triangle:"🔺",small_red_triangle_down:"🔻",smile:"😄",smile_cat:"😸",smiley:"😃",smiley_cat:"😺",smiling_imp:"😈",smirk:"😏",smirk_cat:"😼",smoking:"🚬",snail:"🐌",snake:"🐍",sneezing_face:"🤧",snowboarder:"🏂",snowflake:"❄️",snowman:"⛄️",snowman_with_snow:"☃️",sob:"😭",soccer:"⚽️",soon:"🔜",sos:"🆘",sound:"🔉",space_invader:"👾",spades:"♠️",spaghetti:"🍝",sparkle:"❇️",sparkler:"🎇",sparkles:"✨",sparkling_heart:"💖",speak_no_evil:"🙊",speaker:"🔈",speaking_head:"🗣",speech_balloon:"💬",speedboat:"🚤",spider:"🕷",spider_web:"🕸",spiral_calendar:"🗓",spiral_notepad:"🗒",spoon:"🥄",squid:"🦑",stadium:"🏟",star:"⭐️",star2:"🌟",star_and_crescent:"☪️",star_of_david:"✡️",stars:"🌠",station:"🚉",statue_of_liberty:"🗽",steam_locomotive:"🚂",stew:"🍲",stop_button:"⏹",stop_sign:"🛑",stopwatch:"⏱",straight_ruler:"📏",strawberry:"🍓",stuck_out_tongue:"😛",stuck_out_tongue_closed_eyes:"😝",stuck_out_tongue_winking_eye:"😜",studio_microphone:"🎙",stuffed_flatbread:"🥙",sun_behind_large_cloud:"🌥",sun_behind_rain_cloud:"🌦",sun_behind_small_cloud:"🌤",sun_with_face:"🌞",sunflower:"🌻",sunglasses:"😎",sunny:"☀️",sunrise:"🌅",sunrise_over_mountains:"🌄",surfing_man:"🏄",surfing_woman:"🏄&zwj;♀️",sushi:"🍣",suspension_railway:"🚟",sweat:"😓",sweat_drops:"💦",sweat_smile:"😅",sweet_potato:"🍠",swimming_man:"🏊",swimming_woman:"🏊&zwj;♀️",symbols:"🔣",synagogue:"🕍",syringe:"💉",taco:"🌮",tada:"🎉",tanabata_tree:"🎋",taurus:"♉️",taxi:"🚕",tea:"🍵",telephone_receiver:"📞",telescope:"🔭",tennis:"🎾",tent:"⛺️",thermometer:"🌡",thinking:"🤔",thought_balloon:"💭",ticket:"🎫",tickets:"🎟",tiger:"🐯",tiger2:"🐅",timer_clock:"⏲",tipping_hand_man:"💁&zwj;♂️",tired_face:"😫",tm:"™️",toilet:"🚽",tokyo_tower:"🗼",tomato:"🍅",tongue:"👅",top:"🔝",tophat:"🎩",tornado:"🌪",trackball:"🖲",tractor:"🚜",traffic_light:"🚥",train:"🚋",train2:"🚆",tram:"🚊",triangular_flag_on_post:"🚩",triangular_ruler:"📐",trident:"🔱",triumph:"😤",trolleybus:"🚎",trophy:"🏆",tropical_drink:"🍹",tropical_fish:"🐠",truck:"🚚",trumpet:"🎺",tulip:"🌷",tumbler_glass:"🥃",turkey:"🦃",turtle:"🐢",tv:"📺",twisted_rightwards_arrows:"🔀",two_hearts:"💕",two_men_holding_hands:"👬",two_women_holding_hands:"👭",u5272:"🈹",u5408:"🈴",u55b6:"🈺",u6307:"🈯️",u6708:"🈷️",u6709:"🈶",u6e80:"🈵",u7121:"🈚️",u7533:"🈸",u7981:"🈲",u7a7a:"🈳",umbrella:"☔️",unamused:"😒",underage:"🔞",unicorn:"🦄",unlock:"🔓",up:"🆙",upside_down_face:"🙃",v:"✌️",vertical_traffic_light:"🚦",vhs:"📼",vibration_mode:"📳",video_camera:"📹",video_game:"🎮",violin:"🎻",virgo:"♍️",volcano:"🌋",volleyball:"🏐",vs:"🆚",vulcan_salute:"🖖",walking_man:"🚶",walking_woman:"🚶&zwj;♀️",waning_crescent_moon:"🌘",waning_gibbous_moon:"🌖",warning:"⚠️",wastebasket:"🗑",watch:"⌚️",water_buffalo:"🐃",watermelon:"🍉",wave:"👋",wavy_dash:"〰️",waxing_crescent_moon:"🌒",wc:"🚾",weary:"😩",wedding:"💒",weight_lifting_man:"🏋️",weight_lifting_woman:"🏋️&zwj;♀️",whale:"🐳",whale2:"🐋",wheel_of_dharma:"☸️",wheelchair:"♿️",white_check_mark:"✅",white_circle:"⚪️",white_flag:"🏳️",white_flower:"💮",white_large_square:"⬜️",white_medium_small_square:"◽️",white_medium_square:"◻️",white_small_square:"▫️",white_square_button:"🔳",wilted_flower:"🥀",wind_chime:"🎐",wind_face:"🌬",wine_glass:"🍷",wink:"😉",wolf:"🐺",woman:"👩",woman_artist:"👩&zwj;🎨",woman_astronaut:"👩&zwj;🚀",woman_cartwheeling:"🤸&zwj;♀️",woman_cook:"👩&zwj;🍳",woman_facepalming:"🤦&zwj;♀️",woman_factory_worker:"👩&zwj;🏭",woman_farmer:"👩&zwj;🌾",woman_firefighter:"👩&zwj;🚒",woman_health_worker:"👩&zwj;⚕️",woman_judge:"👩&zwj;⚖️",woman_juggling:"🤹&zwj;♀️",woman_mechanic:"👩&zwj;🔧",woman_office_worker:"👩&zwj;💼",woman_pilot:"👩&zwj;✈️",woman_playing_handball:"🤾&zwj;♀️",woman_playing_water_polo:"🤽&zwj;♀️",woman_scientist:"👩&zwj;🔬",woman_shrugging:"🤷&zwj;♀️",woman_singer:"👩&zwj;🎤",woman_student:"👩&zwj;🎓",woman_teacher:"👩&zwj;🏫",woman_technologist:"👩&zwj;💻",woman_with_turban:"👳&zwj;♀️",womans_clothes:"👚",womans_hat:"👒",women_wrestling:"🤼&zwj;♀️",womens:"🚺",world_map:"🗺",worried:"😟",wrench:"🔧",writing_hand:"✍️",x:"❌",yellow_heart:"💛",yen:"💴",yin_yang:"☯️",yum:"😋",zap:"⚡️",zipper_mouth_face:"🤐",zzz:"💤",octocat:'<img alt=":octocat:" height="20" width="20" align="absmiddle" src="https://assets-cdn.github.com/images/icons/emoji/octocat.png">',showdown:`<span style="font-family: 'Anonymous Pro', monospace; text-decoration: underline; text-decoration-style: dashed; text-decoration-color: #3e8b8a;text-underline-position: under;">S</span>`},i.Converter=function(p){var b={},v=[],R=[],D={},j=a,T={parsed:{},raw:"",format:""};$();function $(){p=p||{};for(var M in s)s.hasOwnProperty(M)&&(b[M]=s[M]);if(typeof p=="object")for(var Y in p)p.hasOwnProperty(Y)&&(b[Y]=p[Y]);else throw Error("Converter expects the passed parameter to be an object, but "+typeof p+" was passed instead.");b.extensions&&i.helper.forEach(b.extensions,Q)}function Q(M,Y){if(Y=Y||null,i.helper.isString(M))if(M=i.helper.stdExtName(M),Y=M,i.extensions[M]){console.warn("DEPRECATION WARNING: "+M+" is an old extension that uses a deprecated loading method.Please inform the developer that the extension should be updated!"),K(i.extensions[M],M);return}else if(!i.helper.isUndefined(r[M]))M=r[M];else throw Error('Extension "'+M+'" could not be loaded. It was either not found or is not a valid extension.');typeof M=="function"&&(M=M()),i.helper.isArray(M)||(M=[M]);var te=h(M,Y);if(!te.valid)throw Error(te.error);for(var ue=0;ue<M.length;++ue){switch(M[ue].type){case"lang":v.push(M[ue]);break;case"output":R.push(M[ue]);break}if(M[ue].hasOwnProperty("listeners"))for(var Re in M[ue].listeners)M[ue].listeners.hasOwnProperty(Re)&&Z(Re,M[ue].listeners[Re])}}function K(M,Y){typeof M=="function"&&(M=M(new i.Converter)),i.helper.isArray(M)||(M=[M]);var te=h(M,Y);if(!te.valid)throw Error(te.error);for(var ue=0;ue<M.length;++ue)switch(M[ue].type){case"lang":v.push(M[ue]);break;case"output":R.push(M[ue]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}function Z(M,Y){if(!i.helper.isString(M))throw Error("Invalid argument in converter.listen() method: name must be a string, but "+typeof M+" given");if(typeof Y!="function")throw Error("Invalid argument in converter.listen() method: callback must be a function, but "+typeof Y+" given");D.hasOwnProperty(M)||(D[M]=[]),D[M].push(Y)}function H(M){var Y=M.match(/^\s*/)[0].length,te=new RegExp("^\\s{0,"+Y+"}","gm");return M.replace(te,"")}this._dispatch=function(Y,te,ue,Re){if(D.hasOwnProperty(Y))for(var ae=0;ae<D[Y].length;++ae){var ot=D[Y][ae](Y,te,this,ue,Re);ot&&typeof ot<"u"&&(te=ot)}return te},this.listen=function(M,Y){return Z(M,Y),this},this.makeHtml=function(M){if(!M)return M;var Y={gHtmlBlocks:[],gHtmlMdBlocks:[],gHtmlSpans:[],gUrls:{},gTitles:{},gDimensions:{},gListLevel:0,hashLinkCounts:{},langExtensions:v,outputModifiers:R,converter:this,ghCodeBlocks:[],metadata:{parsed:{},raw:"",format:""}};return M=M.replace(/¨/g,"¨T"),M=M.replace(/\$/g,"¨D"),M=M.replace(/\r\n/g,`
`),M=M.replace(/\r/g,`
`),M=M.replace(/\u00A0/g,"&nbsp;"),b.smartIndentationFix&&(M=H(M)),M=`

`+M+`

`,M=i.subParser("detab")(M,b,Y),M=M.replace(/^[ \t]+$/mg,""),i.helper.forEach(v,function(te){M=i.subParser("runExtension")(te,M,b,Y)}),M=i.subParser("metadata")(M,b,Y),M=i.subParser("hashPreCodeTags")(M,b,Y),M=i.subParser("githubCodeBlocks")(M,b,Y),M=i.subParser("hashHTMLBlocks")(M,b,Y),M=i.subParser("hashCodeTags")(M,b,Y),M=i.subParser("stripLinkDefinitions")(M,b,Y),M=i.subParser("blockGamut")(M,b,Y),M=i.subParser("unhashHTMLSpans")(M,b,Y),M=i.subParser("unescapeSpecialChars")(M,b,Y),M=M.replace(/¨D/g,"$$"),M=M.replace(/¨T/g,"¨"),M=i.subParser("completeHTMLDocument")(M,b,Y),i.helper.forEach(R,function(te){M=i.subParser("runExtension")(te,M,b,Y)}),T=Y.metadata,M},this.makeMarkdown=this.makeMd=function(M,Y){if(M=M.replace(/\r\n/g,`
`),M=M.replace(/\r/g,`
`),M=M.replace(/>[ \t]+</,">¨NBSP;<"),!Y)if(window&&window.document)Y=window.document;else throw new Error("HTMLParser is undefined. If in a webworker or nodejs environment, you need to provide a WHATWG DOM and HTML such as JSDOM");var te=Y.createElement("div");te.innerHTML=M;var ue={preList:et(te)};Ft(te);for(var Re=te.childNodes,ae="",ot=0;ot<Re.length;ot++)ae+=i.subParser("makeMarkdown.node")(Re[ot],ue);function Ft(ht){for(var wt=0;wt<ht.childNodes.length;++wt){var Ot=ht.childNodes[wt];Ot.nodeType===3?!/\S/.test(Ot.nodeValue)&&!/^[ ]+$/.test(Ot.nodeValue)?(ht.removeChild(Ot),--wt):(Ot.nodeValue=Ot.nodeValue.split(`
`).join(" "),Ot.nodeValue=Ot.nodeValue.replace(/(\s)+/g,"$1")):Ot.nodeType===1&&Ft(Ot)}}function et(ht){for(var wt=ht.querySelectorAll("pre"),Ot=[],vt=0;vt<wt.length;++vt)if(wt[vt].childElementCount===1&&wt[vt].firstChild.tagName.toLowerCase()==="code"){var At=wt[vt].firstChild.innerHTML.trim(),bi=wt[vt].firstChild.getAttribute("data-language")||"";if(bi==="")for(var Wt=wt[vt].firstChild.className.split(" "),Ze=0;Ze<Wt.length;++Ze){var ii=Wt[Ze].match(/^language-(.+)$/);if(ii!==null){bi=ii[1];break}}At=i.helper.unescapeHTMLEntities(At),Ot.push(At),wt[vt].outerHTML='<precode language="'+bi+'" precodenum="'+vt.toString()+'"></precode>'}else Ot.push(wt[vt].innerHTML),wt[vt].innerHTML="",wt[vt].setAttribute("prenum",vt.toString());return Ot}return ae},this.setOption=function(M,Y){b[M]=Y},this.getOption=function(M){return b[M]},this.getOptions=function(){return b},this.addExtension=function(M,Y){Y=Y||null,Q(M,Y)},this.useExtension=function(M){Q(M)},this.setFlavor=function(M){if(!u.hasOwnProperty(M))throw Error(M+" flavor was not found");var Y=u[M];j=M;for(var te in Y)Y.hasOwnProperty(te)&&(b[te]=Y[te])},this.getFlavor=function(){return j},this.removeExtension=function(M){i.helper.isArray(M)||(M=[M]);for(var Y=0;Y<M.length;++Y){for(var te=M[Y],ue=0;ue<v.length;++ue)v[ue]===te&&v.splice(ue,1);for(var Re=0;Re<R.length;++Re)R[Re]===te&&R.splice(Re,1)}},this.getAllExtensions=function(){return{language:v,output:R}},this.getMetadata=function(M){return M?T.raw:T.parsed},this.getMetadataFormat=function(){return T.format},this._setMetadataPair=function(M,Y){T.parsed[M]=Y},this._setMetadataFormat=function(M){T.format=M},this._setMetadataRaw=function(M){T.raw=M}},i.subParser("anchors",function(p,b,v){p=v.converter._dispatch("anchors.before",p,b,v);var R=function(D,j,T,$,Q,K,Z){if(i.helper.isUndefined(Z)&&(Z=""),T=T.toLowerCase(),D.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)$="";else if(!$)if(T||(T=j.toLowerCase().replace(/ ?\n/g," ")),$="#"+T,!i.helper.isUndefined(v.gUrls[T]))$=v.gUrls[T],i.helper.isUndefined(v.gTitles[T])||(Z=v.gTitles[T]);else return D;$=$.replace(i.helper.regexes.asteriskDashAndColon,i.helper.escapeCharactersCallback);var H='<a href="'+$+'"';return Z!==""&&Z!==null&&(Z=Z.replace(/"/g,"&quot;"),Z=Z.replace(i.helper.regexes.asteriskDashAndColon,i.helper.escapeCharactersCallback),H+=' title="'+Z+'"'),b.openLinksInNewWindow&&!/^#/.test($)&&(H+=' rel="noopener noreferrer" target="¨E95Eblank"'),H+=">"+j+"</a>",H};return p=p.replace(/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g,R),p=p.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,R),p=p.replace(/\[((?:\[[^\]]*]|[^\[\]])*)]()[ \t]*\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,R),p=p.replace(/\[([^\[\]]+)]()()()()()/g,R),b.ghMentions&&(p=p.replace(/(^|\s)(\\)?(@([a-z\d]+(?:[a-z\d.-]+?[a-z\d]+)*))/gmi,function(D,j,T,$,Q){if(T==="\\")return j+$;if(!i.helper.isString(b.ghMentionsLink))throw new Error("ghMentionsLink option must be a string");var K=b.ghMentionsLink.replace(/\{u}/g,Q),Z="";return b.openLinksInNewWindow&&(Z=' rel="noopener noreferrer" target="¨E95Eblank"'),j+'<a href="'+K+'"'+Z+">"+$+"</a>"})),p=v.converter._dispatch("anchors.after",p,b,v),p});var S=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+?\.[^'">\s]+?)()(\1)?(?=\s|$)(?!["<>])/gi,w=/([*~_]+|\b)(((https?|ftp|dict):\/\/|www\.)[^'">\s]+\.[^'">\s]+?)([.!?,()\[\]])?(\1)?(?=\s|$)(?!["<>])/gi,P=/()<(((https?|ftp|dict):\/\/|www\.)[^'">\s]+)()>()/gi,E=/(^|\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-/=?^_`{|}~.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?=$|\s)/gmi,A=/<()(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,L=function(p){return function(b,v,R,D,j,T,$){R=R.replace(i.helper.regexes.asteriskDashAndColon,i.helper.escapeCharactersCallback);var Q=R,K="",Z="",H=v||"",M=$||"";return/^www\./i.test(R)&&(R=R.replace(/^www\./i,"http://www.")),p.excludeTrailingPunctuationFromURLs&&T&&(K=T),p.openLinksInNewWindow&&(Z=' rel="noopener noreferrer" target="¨E95Eblank"'),H+'<a href="'+R+'"'+Z+">"+Q+"</a>"+K+M}},B=function(p,b){return function(v,R,D){var j="mailto:";return R=R||"",D=i.subParser("unescapeSpecialChars")(D,p,b),p.encodeEmails?(j=i.helper.encodeEmailAddress(j+D),D=i.helper.encodeEmailAddress(D)):j=j+D,R+'<a href="'+j+'">'+D+"</a>"}};i.subParser("autoLinks",function(p,b,v){return p=v.converter._dispatch("autoLinks.before",p,b,v),p=p.replace(P,L(b)),p=p.replace(A,B(b,v)),p=v.converter._dispatch("autoLinks.after",p,b,v),p}),i.subParser("simplifiedAutoLinks",function(p,b,v){return b.simplifiedAutoLink&&(p=v.converter._dispatch("simplifiedAutoLinks.before",p,b,v),b.excludeTrailingPunctuationFromURLs?p=p.replace(w,L(b)):p=p.replace(S,L(b)),p=p.replace(E,B(b,v)),p=v.converter._dispatch("simplifiedAutoLinks.after",p,b,v)),p}),i.subParser("blockGamut",function(p,b,v){return p=v.converter._dispatch("blockGamut.before",p,b,v),p=i.subParser("blockQuotes")(p,b,v),p=i.subParser("headers")(p,b,v),p=i.subParser("horizontalRule")(p,b,v),p=i.subParser("lists")(p,b,v),p=i.subParser("codeBlocks")(p,b,v),p=i.subParser("tables")(p,b,v),p=i.subParser("hashHTMLBlocks")(p,b,v),p=i.subParser("paragraphs")(p,b,v),p=v.converter._dispatch("blockGamut.after",p,b,v),p}),i.subParser("blockQuotes",function(p,b,v){p=v.converter._dispatch("blockQuotes.before",p,b,v),p=p+`

`;var R=/(^ {0,3}>[ \t]?.+\n(.+\n)*\n*)+/gm;return b.splitAdjacentBlockquotes&&(R=/^ {0,3}>[\s\S]*?(?:\n\n)/gm),p=p.replace(R,function(D){return D=D.replace(/^[ \t]*>[ \t]?/gm,""),D=D.replace(/¨0/g,""),D=D.replace(/^[ \t]+$/gm,""),D=i.subParser("githubCodeBlocks")(D,b,v),D=i.subParser("blockGamut")(D,b,v),D=D.replace(/(^|\n)/g,"$1  "),D=D.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(j,T){var $=T;return $=$.replace(/^  /mg,"¨0"),$=$.replace(/¨0/g,""),$}),i.subParser("hashBlock")(`<blockquote>
`+D+`
</blockquote>`,b,v)}),p=v.converter._dispatch("blockQuotes.after",p,b,v),p}),i.subParser("codeBlocks",function(p,b,v){p=v.converter._dispatch("codeBlocks.before",p,b,v),p+="¨0";var R=/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=¨0))/g;return p=p.replace(R,function(D,j,T){var $=j,Q=T,K=`
`;return $=i.subParser("outdent")($,b,v),$=i.subParser("encodeCode")($,b,v),$=i.subParser("detab")($,b,v),$=$.replace(/^\n+/g,""),$=$.replace(/\n+$/g,""),b.omitExtraWLInCodeBlocks&&(K=""),$="<pre><code>"+$+K+"</code></pre>",i.subParser("hashBlock")($,b,v)+Q}),p=p.replace(/¨0/,""),p=v.converter._dispatch("codeBlocks.after",p,b,v),p}),i.subParser("codeSpans",function(p,b,v){return p=v.converter._dispatch("codeSpans.before",p,b,v),typeof p>"u"&&(p=""),p=p.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(R,D,j,T){var $=T;return $=$.replace(/^([ \t]*)/g,""),$=$.replace(/[ \t]*$/g,""),$=i.subParser("encodeCode")($,b,v),$=D+"<code>"+$+"</code>",$=i.subParser("hashHTMLSpans")($,b,v),$}),p=v.converter._dispatch("codeSpans.after",p,b,v),p}),i.subParser("completeHTMLDocument",function(p,b,v){if(!b.completeHTMLDocument)return p;p=v.converter._dispatch("completeHTMLDocument.before",p,b,v);var R="html",D=`<!DOCTYPE HTML>
`,j="",T=`<meta charset="utf-8">
`,$="",Q="";typeof v.metadata.parsed.doctype<"u"&&(D="<!DOCTYPE "+v.metadata.parsed.doctype+`>
`,R=v.metadata.parsed.doctype.toString().toLowerCase(),(R==="html"||R==="html5")&&(T='<meta charset="utf-8">'));for(var K in v.metadata.parsed)if(v.metadata.parsed.hasOwnProperty(K))switch(K.toLowerCase()){case"doctype":break;case"title":j="<title>"+v.metadata.parsed.title+`</title>
`;break;case"charset":R==="html"||R==="html5"?T='<meta charset="'+v.metadata.parsed.charset+`">
`:T='<meta name="charset" content="'+v.metadata.parsed.charset+`">
`;break;case"language":case"lang":$=' lang="'+v.metadata.parsed[K]+'"',Q+='<meta name="'+K+'" content="'+v.metadata.parsed[K]+`">
`;break;default:Q+='<meta name="'+K+'" content="'+v.metadata.parsed[K]+`">
`}return p=D+"<html"+$+`>
<head>
`+j+T+Q+`</head>
<body>
`+p.trim()+`
</body>
</html>`,p=v.converter._dispatch("completeHTMLDocument.after",p,b,v),p}),i.subParser("detab",function(p,b,v){return p=v.converter._dispatch("detab.before",p,b,v),p=p.replace(/\t(?=\t)/g,"    "),p=p.replace(/\t/g,"¨A¨B"),p=p.replace(/¨B(.+?)¨A/g,function(R,D){for(var j=D,T=4-j.length%4,$=0;$<T;$++)j+=" ";return j}),p=p.replace(/¨A/g,"    "),p=p.replace(/¨B/g,""),p=v.converter._dispatch("detab.after",p,b,v),p}),i.subParser("ellipsis",function(p,b,v){return b.ellipsis&&(p=v.converter._dispatch("ellipsis.before",p,b,v),p=p.replace(/\.\.\./g,"…"),p=v.converter._dispatch("ellipsis.after",p,b,v)),p}),i.subParser("emoji",function(p,b,v){if(!b.emoji)return p;p=v.converter._dispatch("emoji.before",p,b,v);var R=/:([\S]+?):/g;return p=p.replace(R,function(D,j){return i.helper.emojis.hasOwnProperty(j)?i.helper.emojis[j]:D}),p=v.converter._dispatch("emoji.after",p,b,v),p}),i.subParser("encodeAmpsAndAngles",function(p,b,v){return p=v.converter._dispatch("encodeAmpsAndAngles.before",p,b,v),p=p.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;"),p=p.replace(/<(?![a-z\/?$!])/gi,"&lt;"),p=p.replace(/</g,"&lt;"),p=p.replace(/>/g,"&gt;"),p=v.converter._dispatch("encodeAmpsAndAngles.after",p,b,v),p}),i.subParser("encodeBackslashEscapes",function(p,b,v){return p=v.converter._dispatch("encodeBackslashEscapes.before",p,b,v),p=p.replace(/\\(\\)/g,i.helper.escapeCharactersCallback),p=p.replace(/\\([`*_{}\[\]()>#+.!~=|:-])/g,i.helper.escapeCharactersCallback),p=v.converter._dispatch("encodeBackslashEscapes.after",p,b,v),p}),i.subParser("encodeCode",function(p,b,v){return p=v.converter._dispatch("encodeCode.before",p,b,v),p=p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/([*_{}\[\]\\=~-])/g,i.helper.escapeCharactersCallback),p=v.converter._dispatch("encodeCode.after",p,b,v),p}),i.subParser("escapeSpecialCharsWithinTagAttributes",function(p,b,v){p=v.converter._dispatch("escapeSpecialCharsWithinTagAttributes.before",p,b,v);var R=/<\/?[a-z\d_:-]+(?:[\s]+[\s\S]+?)?>/gi,D=/<!(--(?:(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>/gi;return p=p.replace(R,function(j){return j.replace(/(.)<\/?code>(?=.)/g,"$1`").replace(/([\\`*_~=|])/g,i.helper.escapeCharactersCallback)}),p=p.replace(D,function(j){return j.replace(/([\\`*_~=|])/g,i.helper.escapeCharactersCallback)}),p=v.converter._dispatch("escapeSpecialCharsWithinTagAttributes.after",p,b,v),p}),i.subParser("githubCodeBlocks",function(p,b,v){return b.ghCodeBlocks?(p=v.converter._dispatch("githubCodeBlocks.before",p,b,v),p+="¨0",p=p.replace(/(?:^|\n)(?: {0,3})(```+|~~~+)(?: *)([^\s`~]*)\n([\s\S]*?)\n(?: {0,3})\1/g,function(R,D,j,T){var $=b.omitExtraWLInCodeBlocks?"":`
`;return T=i.subParser("encodeCode")(T,b,v),T=i.subParser("detab")(T,b,v),T=T.replace(/^\n+/g,""),T=T.replace(/\n+$/g,""),T="<pre><code"+(j?' class="'+j+" language-"+j+'"':"")+">"+T+$+"</code></pre>",T=i.subParser("hashBlock")(T,b,v),`

¨G`+(v.ghCodeBlocks.push({text:R,codeblock:T})-1)+`G

`}),p=p.replace(/¨0/,""),v.converter._dispatch("githubCodeBlocks.after",p,b,v)):p}),i.subParser("hashBlock",function(p,b,v){return p=v.converter._dispatch("hashBlock.before",p,b,v),p=p.replace(/(^\n+|\n+$)/g,""),p=`

¨K`+(v.gHtmlBlocks.push(p)-1)+`K

`,p=v.converter._dispatch("hashBlock.after",p,b,v),p}),i.subParser("hashCodeTags",function(p,b,v){p=v.converter._dispatch("hashCodeTags.before",p,b,v);var R=function(D,j,T,$){var Q=T+i.subParser("encodeCode")(j,b,v)+$;return"¨C"+(v.gHtmlSpans.push(Q)-1)+"C"};return p=i.helper.replaceRecursiveRegExp(p,R,"<code\\b[^>]*>","</code>","gim"),p=v.converter._dispatch("hashCodeTags.after",p,b,v),p}),i.subParser("hashElement",function(p,b,v){return function(R,D){var j=D;return j=j.replace(/\n\n/g,`
`),j=j.replace(/^\n/,""),j=j.replace(/\n+$/g,""),j=`

¨K`+(v.gHtmlBlocks.push(j)-1)+`K

`,j}}),i.subParser("hashHTMLBlocks",function(p,b,v){p=v.converter._dispatch("hashHTMLBlocks.before",p,b,v);var R=["pre","div","h1","h2","h3","h4","h5","h6","blockquote","table","dl","ol","ul","script","noscript","form","fieldset","iframe","math","style","section","header","footer","nav","article","aside","address","audio","canvas","figure","hgroup","output","video","p"],D=function(M,Y,te,ue){var Re=M;return te.search(/\bmarkdown\b/)!==-1&&(Re=te+v.converter.makeHtml(Y)+ue),`

¨K`+(v.gHtmlBlocks.push(Re)-1)+`K

`};b.backslashEscapesHTMLTags&&(p=p.replace(/\\<(\/?[^>]+?)>/g,function(M,Y){return"&lt;"+Y+"&gt;"}));for(var j=0;j<R.length;++j)for(var T,$=new RegExp("^ {0,3}(<"+R[j]+"\\b[^>]*>)","im"),Q="<"+R[j]+"\\b[^>]*>",K="</"+R[j]+">";(T=i.helper.regexIndexOf(p,$))!==-1;){var Z=i.helper.splitAtIndex(p,T),H=i.helper.replaceRecursiveRegExp(Z[1],D,Q,K,"im");if(H===Z[1])break;p=Z[0].concat(H)}return p=p.replace(/(\n {0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,i.subParser("hashElement")(p,b,v)),p=i.helper.replaceRecursiveRegExp(p,function(M){return`

¨K`+(v.gHtmlBlocks.push(M)-1)+`K

`},"^ {0,3}<!--","-->","gm"),p=p.replace(/(?:\n\n)( {0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,i.subParser("hashElement")(p,b,v)),p=v.converter._dispatch("hashHTMLBlocks.after",p,b,v),p}),i.subParser("hashHTMLSpans",function(p,b,v){p=v.converter._dispatch("hashHTMLSpans.before",p,b,v);function R(D){return"¨C"+(v.gHtmlSpans.push(D)-1)+"C"}return p=p.replace(/<[^>]+?\/>/gi,function(D){return R(D)}),p=p.replace(/<([^>]+?)>[\s\S]*?<\/\1>/g,function(D){return R(D)}),p=p.replace(/<([^>]+?)\s[^>]+?>[\s\S]*?<\/\1>/g,function(D){return R(D)}),p=p.replace(/<[^>]+?>/gi,function(D){return R(D)}),p=v.converter._dispatch("hashHTMLSpans.after",p,b,v),p}),i.subParser("unhashHTMLSpans",function(p,b,v){p=v.converter._dispatch("unhashHTMLSpans.before",p,b,v);for(var R=0;R<v.gHtmlSpans.length;++R){for(var D=v.gHtmlSpans[R],j=0;/¨C(\d+)C/.test(D);){var T=RegExp.$1;if(D=D.replace("¨C"+T+"C",v.gHtmlSpans[T]),j===10){console.error("maximum nesting of 10 spans reached!!!");break}++j}p=p.replace("¨C"+R+"C",D)}return p=v.converter._dispatch("unhashHTMLSpans.after",p,b,v),p}),i.subParser("hashPreCodeTags",function(p,b,v){p=v.converter._dispatch("hashPreCodeTags.before",p,b,v);var R=function(D,j,T,$){var Q=T+i.subParser("encodeCode")(j,b,v)+$;return`

¨G`+(v.ghCodeBlocks.push({text:D,codeblock:Q})-1)+`G

`};return p=i.helper.replaceRecursiveRegExp(p,R,"^ {0,3}<pre\\b[^>]*>\\s*<code\\b[^>]*>","^ {0,3}</code>\\s*</pre>","gim"),p=v.converter._dispatch("hashPreCodeTags.after",p,b,v),p}),i.subParser("headers",function(p,b,v){p=v.converter._dispatch("headers.before",p,b,v);var R=isNaN(parseInt(b.headerLevelStart))?1:parseInt(b.headerLevelStart),D=b.smoothLivePreview?/^(.+)[ \t]*\n={2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n=+[ \t]*\n+/gm,j=b.smoothLivePreview?/^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n-+[ \t]*\n+/gm;p=p.replace(D,function(Q,K){var Z=i.subParser("spanGamut")(K,b,v),H=b.noHeaderId?"":' id="'+$(K)+'"',M=R,Y="<h"+M+H+">"+Z+"</h"+M+">";return i.subParser("hashBlock")(Y,b,v)}),p=p.replace(j,function(Q,K){var Z=i.subParser("spanGamut")(K,b,v),H=b.noHeaderId?"":' id="'+$(K)+'"',M=R+1,Y="<h"+M+H+">"+Z+"</h"+M+">";return i.subParser("hashBlock")(Y,b,v)});var T=b.requireSpaceBeforeHeadingText?/^(#{1,6})[ \t]+(.+?)[ \t]*#*\n+/gm:/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm;p=p.replace(T,function(Q,K,Z){var H=Z;b.customizedHeaderId&&(H=Z.replace(/\s?\{([^{]+?)}\s*$/,""));var M=i.subParser("spanGamut")(H,b,v),Y=b.noHeaderId?"":' id="'+$(Z)+'"',te=R-1+K.length,ue="<h"+te+Y+">"+M+"</h"+te+">";return i.subParser("hashBlock")(ue,b,v)});function $(Q){var K,Z;if(b.customizedHeaderId){var H=Q.match(/\{([^{]+?)}\s*$/);H&&H[1]&&(Q=H[1])}return K=Q,i.helper.isString(b.prefixHeaderId)?Z=b.prefixHeaderId:b.prefixHeaderId===!0?Z="section-":Z="",b.rawPrefixHeaderId||(K=Z+K),b.ghCompatibleHeaderId?K=K.replace(/ /g,"-").replace(/&amp;/g,"").replace(/¨T/g,"").replace(/¨D/g,"").replace(/[&+$,\/:;=?@"#{}|^¨~\[\]`\\*)(%.!'<>]/g,"").toLowerCase():b.rawHeaderId?K=K.replace(/ /g,"-").replace(/&amp;/g,"&").replace(/¨T/g,"¨").replace(/¨D/g,"$").replace(/["']/g,"-").toLowerCase():K=K.replace(/[^\w]/g,"").toLowerCase(),b.rawPrefixHeaderId&&(K=Z+K),v.hashLinkCounts[K]?K=K+"-"+v.hashLinkCounts[K]++:v.hashLinkCounts[K]=1,K}return p=v.converter._dispatch("headers.after",p,b,v),p}),i.subParser("horizontalRule",function(p,b,v){p=v.converter._dispatch("horizontalRule.before",p,b,v);var R=i.subParser("hashBlock")("<hr />",b,v);return p=p.replace(/^ {0,2}( ?-){3,}[ \t]*$/gm,R),p=p.replace(/^ {0,2}( ?\*){3,}[ \t]*$/gm,R),p=p.replace(/^ {0,2}( ?_){3,}[ \t]*$/gm,R),p=v.converter._dispatch("horizontalRule.after",p,b,v),p}),i.subParser("images",function(p,b,v){p=v.converter._dispatch("images.before",p,b,v);var R=/!\[([^\]]*?)][ \t]*()\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,D=/!\[([^\]]*?)][ \t]*()\([ \t]?<([^>]*)>(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(?:(["'])([^"]*?)\6))?[ \t]?\)/g,j=/!\[([^\]]*?)][ \t]*()\([ \t]?<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,T=/!\[([^\]]*?)] ?(?:\n *)?\[([\s\S]*?)]()()()()()/g,$=/!\[([^\[\]]+)]()()()()()/g;function Q(Z,H,M,Y,te,ue,Re,ae){return Y=Y.replace(/\s/g,""),K(Z,H,M,Y,te,ue,Re,ae)}function K(Z,H,M,Y,te,ue,Re,ae){var ot=v.gUrls,Ft=v.gTitles,et=v.gDimensions;if(M=M.toLowerCase(),ae||(ae=""),Z.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)Y="";else if(Y===""||Y===null)if((M===""||M===null)&&(M=H.toLowerCase().replace(/ ?\n/g," ")),Y="#"+M,!i.helper.isUndefined(ot[M]))Y=ot[M],i.helper.isUndefined(Ft[M])||(ae=Ft[M]),i.helper.isUndefined(et[M])||(te=et[M].width,ue=et[M].height);else return Z;H=H.replace(/"/g,"&quot;").replace(i.helper.regexes.asteriskDashAndColon,i.helper.escapeCharactersCallback),Y=Y.replace(i.helper.regexes.asteriskDashAndColon,i.helper.escapeCharactersCallback);var ht='<img src="'+Y+'" alt="'+H+'"';return ae&&i.helper.isString(ae)&&(ae=ae.replace(/"/g,"&quot;").replace(i.helper.regexes.asteriskDashAndColon,i.helper.escapeCharactersCallback),ht+=' title="'+ae+'"'),te&&ue&&(te=te==="*"?"auto":te,ue=ue==="*"?"auto":ue,ht+=' width="'+te+'"',ht+=' height="'+ue+'"'),ht+=" />",ht}return p=p.replace(T,K),p=p.replace(j,Q),p=p.replace(D,K),p=p.replace(R,K),p=p.replace($,K),p=v.converter._dispatch("images.after",p,b,v),p}),i.subParser("italicsAndBold",function(p,b,v){p=v.converter._dispatch("italicsAndBold.before",p,b,v);function R(D,j,T){return j+D+T}return b.literalMidWordUnderscores?(p=p.replace(/\b___(\S[\s\S]*?)___\b/g,function(D,j){return R(j,"<strong><em>","</em></strong>")}),p=p.replace(/\b__(\S[\s\S]*?)__\b/g,function(D,j){return R(j,"<strong>","</strong>")}),p=p.replace(/\b_(\S[\s\S]*?)_\b/g,function(D,j){return R(j,"<em>","</em>")})):(p=p.replace(/___(\S[\s\S]*?)___/g,function(D,j){return/\S$/.test(j)?R(j,"<strong><em>","</em></strong>"):D}),p=p.replace(/__(\S[\s\S]*?)__/g,function(D,j){return/\S$/.test(j)?R(j,"<strong>","</strong>"):D}),p=p.replace(/_([^\s_][\s\S]*?)_/g,function(D,j){return/\S$/.test(j)?R(j,"<em>","</em>"):D})),b.literalMidWordAsterisks?(p=p.replace(/([^*]|^)\B\*\*\*(\S[\s\S]*?)\*\*\*\B(?!\*)/g,function(D,j,T){return R(T,j+"<strong><em>","</em></strong>")}),p=p.replace(/([^*]|^)\B\*\*(\S[\s\S]*?)\*\*\B(?!\*)/g,function(D,j,T){return R(T,j+"<strong>","</strong>")}),p=p.replace(/([^*]|^)\B\*(\S[\s\S]*?)\*\B(?!\*)/g,function(D,j,T){return R(T,j+"<em>","</em>")})):(p=p.replace(/\*\*\*(\S[\s\S]*?)\*\*\*/g,function(D,j){return/\S$/.test(j)?R(j,"<strong><em>","</em></strong>"):D}),p=p.replace(/\*\*(\S[\s\S]*?)\*\*/g,function(D,j){return/\S$/.test(j)?R(j,"<strong>","</strong>"):D}),p=p.replace(/\*([^\s*][\s\S]*?)\*/g,function(D,j){return/\S$/.test(j)?R(j,"<em>","</em>"):D})),p=v.converter._dispatch("italicsAndBold.after",p,b,v),p}),i.subParser("lists",function(p,b,v){function R(T,$){v.gListLevel++,T=T.replace(/\n{2,}$/,`
`),T+="¨0";var Q=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0| {0,3}([*+-]|\d+[.])[ \t]+))/gm,K=/\n[ \t]*\n(?!¨0)/.test(T);return b.disableForced4SpacesIndentedSublists&&(Q=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0|\2([*+-]|\d+[.])[ \t]+))/gm),T=T.replace(Q,function(Z,H,M,Y,te,ue,Re){Re=Re&&Re.trim()!=="";var ae=i.subParser("outdent")(te,b,v),ot="";return ue&&b.tasklists&&(ot=' class="task-list-item" style="list-style-type: none;"',ae=ae.replace(/^[ \t]*\[(x|X| )?]/m,function(){var Ft='<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';return Re&&(Ft+=" checked"),Ft+=">",Ft})),ae=ae.replace(/^([-*+]|\d\.)[ \t]+[\S\n ]*/g,function(Ft){return"¨A"+Ft}),H||ae.search(/\n{2,}/)>-1?(ae=i.subParser("githubCodeBlocks")(ae,b,v),ae=i.subParser("blockGamut")(ae,b,v)):(ae=i.subParser("lists")(ae,b,v),ae=ae.replace(/\n$/,""),ae=i.subParser("hashHTMLBlocks")(ae,b,v),ae=ae.replace(/\n\n+/g,`

`),K?ae=i.subParser("paragraphs")(ae,b,v):ae=i.subParser("spanGamut")(ae,b,v)),ae=ae.replace("¨A",""),ae="<li"+ot+">"+ae+`</li>
`,ae}),T=T.replace(/¨0/g,""),v.gListLevel--,$&&(T=T.replace(/\s+$/,"")),T}function D(T,$){if($==="ol"){var Q=T.match(/^ *(\d+)\./);if(Q&&Q[1]!=="1")return' start="'+Q[1]+'"'}return""}function j(T,$,Q){var K=b.disableForced4SpacesIndentedSublists?/^ ?\d+\.[ \t]/gm:/^ {0,3}\d+\.[ \t]/gm,Z=b.disableForced4SpacesIndentedSublists?/^ ?[*+-][ \t]/gm:/^ {0,3}[*+-][ \t]/gm,H=$==="ul"?K:Z,M="";if(T.search(H)!==-1)(function te(ue){var Re=ue.search(H),ae=D(T,$);Re!==-1?(M+=`

<`+$+ae+`>
`+R(ue.slice(0,Re),!!Q)+"</"+$+`>
`,$=$==="ul"?"ol":"ul",H=$==="ul"?K:Z,te(ue.slice(Re))):M+=`

<`+$+ae+`>
`+R(ue,!!Q)+"</"+$+`>
`})(T);else{var Y=D(T,$);M=`

<`+$+Y+`>
`+R(T,!!Q)+"</"+$+`>
`}return M}return p=v.converter._dispatch("lists.before",p,b,v),p+="¨0",v.gListLevel?p=p.replace(/^(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(T,$,Q){var K=Q.search(/[*+-]/g)>-1?"ul":"ol";return j($,K,!0)}):p=p.replace(/(\n\n|^\n?)(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,function(T,$,Q,K){var Z=K.search(/[*+-]/g)>-1?"ul":"ol";return j(Q,Z,!1)}),p=p.replace(/¨0/,""),p=v.converter._dispatch("lists.after",p,b,v),p}),i.subParser("metadata",function(p,b,v){if(!b.metadata)return p;p=v.converter._dispatch("metadata.before",p,b,v);function R(D){v.metadata.raw=D,D=D.replace(/&/g,"&amp;").replace(/"/g,"&quot;"),D=D.replace(/\n {4}/g," "),D.replace(/^([\S ]+): +([\s\S]+?)$/gm,function(j,T,$){return v.metadata.parsed[T]=$,""})}return p=p.replace(/^\s*«««+(\S*?)\n([\s\S]+?)\n»»»+\n/,function(D,j,T){return R(T),"¨M"}),p=p.replace(/^\s*---+(\S*?)\n([\s\S]+?)\n---+\n/,function(D,j,T){return j&&(v.metadata.format=j),R(T),"¨M"}),p=p.replace(/¨M/g,""),p=v.converter._dispatch("metadata.after",p,b,v),p}),i.subParser("outdent",function(p,b,v){return p=v.converter._dispatch("outdent.before",p,b,v),p=p.replace(/^(\t|[ ]{1,4})/gm,"¨0"),p=p.replace(/¨0/g,""),p=v.converter._dispatch("outdent.after",p,b,v),p}),i.subParser("paragraphs",function(p,b,v){p=v.converter._dispatch("paragraphs.before",p,b,v),p=p.replace(/^\n+/g,""),p=p.replace(/\n+$/g,"");for(var R=p.split(/\n{2,}/g),D=[],j=R.length,T=0;T<j;T++){var $=R[T];$.search(/¨(K|G)(\d+)\1/g)>=0?D.push($):$.search(/\S/)>=0&&($=i.subParser("spanGamut")($,b,v),$=$.replace(/^([ \t]*)/g,"<p>"),$+="</p>",D.push($))}for(j=D.length,T=0;T<j;T++){for(var Q="",K=D[T],Z=!1;/¨(K|G)(\d+)\1/.test(K);){var H=RegExp.$1,M=RegExp.$2;H==="K"?Q=v.gHtmlBlocks[M]:Z?Q=i.subParser("encodeCode")(v.ghCodeBlocks[M].text,b,v):Q=v.ghCodeBlocks[M].codeblock,Q=Q.replace(/\$/g,"$$$$"),K=K.replace(/(\n\n)?¨(K|G)\d+\2(\n\n)?/,Q),/^<pre\b[^>]*>\s*<code\b[^>]*>/.test(K)&&(Z=!0)}D[T]=K}return p=D.join(`
`),p=p.replace(/^\n+/g,""),p=p.replace(/\n+$/g,""),v.converter._dispatch("paragraphs.after",p,b,v)}),i.subParser("runExtension",function(p,b,v,R){if(p.filter)b=p.filter(b,R.converter,v);else if(p.regex){var D=p.regex;D instanceof RegExp||(D=new RegExp(D,"g")),b=b.replace(D,p.replace)}return b}),i.subParser("spanGamut",function(p,b,v){return p=v.converter._dispatch("spanGamut.before",p,b,v),p=i.subParser("codeSpans")(p,b,v),p=i.subParser("escapeSpecialCharsWithinTagAttributes")(p,b,v),p=i.subParser("encodeBackslashEscapes")(p,b,v),p=i.subParser("images")(p,b,v),p=i.subParser("anchors")(p,b,v),p=i.subParser("autoLinks")(p,b,v),p=i.subParser("simplifiedAutoLinks")(p,b,v),p=i.subParser("emoji")(p,b,v),p=i.subParser("underline")(p,b,v),p=i.subParser("italicsAndBold")(p,b,v),p=i.subParser("strikethrough")(p,b,v),p=i.subParser("ellipsis")(p,b,v),p=i.subParser("hashHTMLSpans")(p,b,v),p=i.subParser("encodeAmpsAndAngles")(p,b,v),b.simpleLineBreaks?/\n\n¨K/.test(p)||(p=p.replace(/\n+/g,`<br />
`)):p=p.replace(/  +\n/g,`<br />
`),p=v.converter._dispatch("spanGamut.after",p,b,v),p}),i.subParser("strikethrough",function(p,b,v){function R(D){return b.simplifiedAutoLink&&(D=i.subParser("simplifiedAutoLinks")(D,b,v)),"<del>"+D+"</del>"}return b.strikethrough&&(p=v.converter._dispatch("strikethrough.before",p,b,v),p=p.replace(/(?:~){2}([\s\S]+?)(?:~){2}/g,function(D,j){return R(j)}),p=v.converter._dispatch("strikethrough.after",p,b,v)),p}),i.subParser("stripLinkDefinitions",function(p,b,v){var R=/^ {0,3}\[([^\]]+)]:[ \t]*\n?[ \t]*<?([^>\s]+)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=¨0))/gm,D=/^ {0,3}\[([^\]]+)]:[ \t]*\n?[ \t]*<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n\n|(?=¨0)|(?=\n\[))/gm;p+="¨0";var j=function(T,$,Q,K,Z,H,M){return $=$.toLowerCase(),p.toLowerCase().split($).length-1<2?T:(Q.match(/^data:.+?\/.+?;base64,/)?v.gUrls[$]=Q.replace(/\s/g,""):v.gUrls[$]=i.subParser("encodeAmpsAndAngles")(Q,b,v),H?H+M:(M&&(v.gTitles[$]=M.replace(/"|'/g,"&quot;")),b.parseImgDimensions&&K&&Z&&(v.gDimensions[$]={width:K,height:Z}),""))};return p=p.replace(D,j),p=p.replace(R,j),p=p.replace(/¨0/,""),p}),i.subParser("tables",function(p,b,v){if(!b.tables)return p;var R=/^ {0,3}\|?.+\|.+\n {0,3}\|?[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:[-=]){2,}[\s\S]+?(?:\n\n|¨0)/gm,D=/^ {0,3}\|.+\|[ \t]*\n {0,3}\|[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*\n( {0,3}\|.+\|[ \t]*\n)*(?:\n|¨0)/gm;function j(Z){return/^:[ \t]*--*$/.test(Z)?' style="text-align:left;"':/^--*[ \t]*:[ \t]*$/.test(Z)?' style="text-align:right;"':/^:[ \t]*--*[ \t]*:$/.test(Z)?' style="text-align:center;"':""}function T(Z,H){var M="";return Z=Z.trim(),(b.tablesHeaderId||b.tableHeaderId)&&(M=' id="'+Z.replace(/ /g,"_").toLowerCase()+'"'),Z=i.subParser("spanGamut")(Z,b,v),"<th"+M+H+">"+Z+`</th>
`}function $(Z,H){var M=i.subParser("spanGamut")(Z,b,v);return"<td"+H+">"+M+`</td>
`}function Q(Z,H){for(var M=`<table>
<thead>
<tr>
`,Y=Z.length,te=0;te<Y;++te)M+=Z[te];for(M+=`</tr>
</thead>
<tbody>
`,te=0;te<H.length;++te){M+=`<tr>
`;for(var ue=0;ue<Y;++ue)M+=H[te][ue];M+=`</tr>
`}return M+=`</tbody>
</table>
`,M}function K(Z){var H,M=Z.split(`
`);for(H=0;H<M.length;++H)/^ {0,3}\|/.test(M[H])&&(M[H]=M[H].replace(/^ {0,3}\|/,"")),/\|[ \t]*$/.test(M[H])&&(M[H]=M[H].replace(/\|[ \t]*$/,"")),M[H]=i.subParser("codeSpans")(M[H],b,v);var Y=M[0].split("|").map(function(ht){return ht.trim()}),te=M[1].split("|").map(function(ht){return ht.trim()}),ue=[],Re=[],ae=[],ot=[];for(M.shift(),M.shift(),H=0;H<M.length;++H)M[H].trim()!==""&&ue.push(M[H].split("|").map(function(ht){return ht.trim()}));if(Y.length<te.length)return Z;for(H=0;H<te.length;++H)ae.push(j(te[H]));for(H=0;H<Y.length;++H)i.helper.isUndefined(ae[H])&&(ae[H]=""),Re.push(T(Y[H],ae[H]));for(H=0;H<ue.length;++H){for(var Ft=[],et=0;et<Re.length;++et)i.helper.isUndefined(ue[H][et]),Ft.push($(ue[H][et],ae[et]));ot.push(Ft)}return Q(Re,ot)}return p=v.converter._dispatch("tables.before",p,b,v),p=p.replace(/\\(\|)/g,i.helper.escapeCharactersCallback),p=p.replace(R,K),p=p.replace(D,K),p=v.converter._dispatch("tables.after",p,b,v),p}),i.subParser("underline",function(p,b,v){return b.underline&&(p=v.converter._dispatch("underline.before",p,b,v),b.literalMidWordUnderscores?(p=p.replace(/\b___(\S[\s\S]*?)___\b/g,function(R,D){return"<u>"+D+"</u>"}),p=p.replace(/\b__(\S[\s\S]*?)__\b/g,function(R,D){return"<u>"+D+"</u>"})):(p=p.replace(/___(\S[\s\S]*?)___/g,function(R,D){return/\S$/.test(D)?"<u>"+D+"</u>":R}),p=p.replace(/__(\S[\s\S]*?)__/g,function(R,D){return/\S$/.test(D)?"<u>"+D+"</u>":R})),p=p.replace(/(_)/g,i.helper.escapeCharactersCallback),p=v.converter._dispatch("underline.after",p,b,v)),p}),i.subParser("unescapeSpecialChars",function(p,b,v){return p=v.converter._dispatch("unescapeSpecialChars.before",p,b,v),p=p.replace(/¨E(\d+)E/g,function(R,D){var j=parseInt(D);return String.fromCharCode(j)}),p=v.converter._dispatch("unescapeSpecialChars.after",p,b,v),p}),i.subParser("makeMarkdown.blockquote",function(p,b){var v="";if(p.hasChildNodes())for(var R=p.childNodes,D=R.length,j=0;j<D;++j){var T=i.subParser("makeMarkdown.node")(R[j],b);T!==""&&(v+=T)}return v=v.trim(),v="> "+v.split(`
`).join(`
> `),v}),i.subParser("makeMarkdown.codeBlock",function(p,b){var v=p.getAttribute("language"),R=p.getAttribute("precodenum");return"```"+v+`
`+b.preList[R]+"\n```"}),i.subParser("makeMarkdown.codeSpan",function(p){return"`"+p.innerHTML+"`"}),i.subParser("makeMarkdown.emphasis",function(p,b){var v="";if(p.hasChildNodes()){v+="*";for(var R=p.childNodes,D=R.length,j=0;j<D;++j)v+=i.subParser("makeMarkdown.node")(R[j],b);v+="*"}return v}),i.subParser("makeMarkdown.header",function(p,b,v){var R=new Array(v+1).join("#"),D="";if(p.hasChildNodes()){D=R+" ";for(var j=p.childNodes,T=j.length,$=0;$<T;++$)D+=i.subParser("makeMarkdown.node")(j[$],b)}return D}),i.subParser("makeMarkdown.hr",function(){return"---"}),i.subParser("makeMarkdown.image",function(p){var b="";return p.hasAttribute("src")&&(b+="!["+p.getAttribute("alt")+"](",b+="<"+p.getAttribute("src")+">",p.hasAttribute("width")&&p.hasAttribute("height")&&(b+=" ="+p.getAttribute("width")+"x"+p.getAttribute("height")),p.hasAttribute("title")&&(b+=' "'+p.getAttribute("title")+'"'),b+=")"),b}),i.subParser("makeMarkdown.links",function(p,b){var v="";if(p.hasChildNodes()&&p.hasAttribute("href")){var R=p.childNodes,D=R.length;v="[";for(var j=0;j<D;++j)v+=i.subParser("makeMarkdown.node")(R[j],b);v+="](",v+="<"+p.getAttribute("href")+">",p.hasAttribute("title")&&(v+=' "'+p.getAttribute("title")+'"'),v+=")"}return v}),i.subParser("makeMarkdown.list",function(p,b,v){var R="";if(!p.hasChildNodes())return"";for(var D=p.childNodes,j=D.length,T=p.getAttribute("start")||1,$=0;$<j;++$)if(!(typeof D[$].tagName>"u"||D[$].tagName.toLowerCase()!=="li")){var Q="";v==="ol"?Q=T.toString()+". ":Q="- ",R+=Q+i.subParser("makeMarkdown.listItem")(D[$],b),++T}return R+=`
<!-- -->
`,R.trim()}),i.subParser("makeMarkdown.listItem",function(p,b){for(var v="",R=p.childNodes,D=R.length,j=0;j<D;++j)v+=i.subParser("makeMarkdown.node")(R[j],b);return/\n$/.test(v)?v=v.split(`
`).join(`
    `).replace(/^ {4}$/gm,"").replace(/\n\n+/g,`

`):v+=`
`,v}),i.subParser("makeMarkdown.node",function(p,b,v){v=v||!1;var R="";if(p.nodeType===3)return i.subParser("makeMarkdown.txt")(p,b);if(p.nodeType===8)return"<!--"+p.data+`-->

`;if(p.nodeType!==1)return"";var D=p.tagName.toLowerCase();switch(D){case"h1":v||(R=i.subParser("makeMarkdown.header")(p,b,1)+`

`);break;case"h2":v||(R=i.subParser("makeMarkdown.header")(p,b,2)+`

`);break;case"h3":v||(R=i.subParser("makeMarkdown.header")(p,b,3)+`

`);break;case"h4":v||(R=i.subParser("makeMarkdown.header")(p,b,4)+`

`);break;case"h5":v||(R=i.subParser("makeMarkdown.header")(p,b,5)+`

`);break;case"h6":v||(R=i.subParser("makeMarkdown.header")(p,b,6)+`

`);break;case"p":v||(R=i.subParser("makeMarkdown.paragraph")(p,b)+`

`);break;case"blockquote":v||(R=i.subParser("makeMarkdown.blockquote")(p,b)+`

`);break;case"hr":v||(R=i.subParser("makeMarkdown.hr")(p,b)+`

`);break;case"ol":v||(R=i.subParser("makeMarkdown.list")(p,b,"ol")+`

`);break;case"ul":v||(R=i.subParser("makeMarkdown.list")(p,b,"ul")+`

`);break;case"precode":v||(R=i.subParser("makeMarkdown.codeBlock")(p,b)+`

`);break;case"pre":v||(R=i.subParser("makeMarkdown.pre")(p,b)+`

`);break;case"table":v||(R=i.subParser("makeMarkdown.table")(p,b)+`

`);break;case"code":R=i.subParser("makeMarkdown.codeSpan")(p,b);break;case"em":case"i":R=i.subParser("makeMarkdown.emphasis")(p,b);break;case"strong":case"b":R=i.subParser("makeMarkdown.strong")(p,b);break;case"del":R=i.subParser("makeMarkdown.strikethrough")(p,b);break;case"a":R=i.subParser("makeMarkdown.links")(p,b);break;case"img":R=i.subParser("makeMarkdown.image")(p,b);break;default:R=p.outerHTML+`

`}return R}),i.subParser("makeMarkdown.paragraph",function(p,b){var v="";if(p.hasChildNodes())for(var R=p.childNodes,D=R.length,j=0;j<D;++j)v+=i.subParser("makeMarkdown.node")(R[j],b);return v=v.trim(),v}),i.subParser("makeMarkdown.pre",function(p,b){var v=p.getAttribute("prenum");return"<pre>"+b.preList[v]+"</pre>"}),i.subParser("makeMarkdown.strikethrough",function(p,b){var v="";if(p.hasChildNodes()){v+="~~";for(var R=p.childNodes,D=R.length,j=0;j<D;++j)v+=i.subParser("makeMarkdown.node")(R[j],b);v+="~~"}return v}),i.subParser("makeMarkdown.strong",function(p,b){var v="";if(p.hasChildNodes()){v+="**";for(var R=p.childNodes,D=R.length,j=0;j<D;++j)v+=i.subParser("makeMarkdown.node")(R[j],b);v+="**"}return v}),i.subParser("makeMarkdown.table",function(p,b){var v="",R=[[],[]],D=p.querySelectorAll("thead>tr>th"),j=p.querySelectorAll("tbody>tr"),T,$;for(T=0;T<D.length;++T){var Q=i.subParser("makeMarkdown.tableCell")(D[T],b),K="---";if(D[T].hasAttribute("style")){var Z=D[T].getAttribute("style").toLowerCase().replace(/\s/g,"");switch(Z){case"text-align:left;":K=":---";break;case"text-align:right;":K="---:";break;case"text-align:center;":K=":---:";break}}R[0][T]=Q.trim(),R[1][T]=K}for(T=0;T<j.length;++T){var H=R.push([])-1,M=j[T].getElementsByTagName("td");for($=0;$<D.length;++$){var Y=" ";typeof M[$]<"u"&&(Y=i.subParser("makeMarkdown.tableCell")(M[$],b)),R[H].push(Y)}}var te=3;for(T=0;T<R.length;++T)for($=0;$<R[T].length;++$){var ue=R[T][$].length;ue>te&&(te=ue)}for(T=0;T<R.length;++T){for($=0;$<R[T].length;++$)T===1?R[T][$].slice(-1)===":"?R[T][$]=i.helper.padEnd(R[T][$].slice(-1),te-1,"-")+":":R[T][$]=i.helper.padEnd(R[T][$],te,"-"):R[T][$]=i.helper.padEnd(R[T][$],te);v+="| "+R[T].join(" | ")+` |
`}return v.trim()}),i.subParser("makeMarkdown.tableCell",function(p,b){var v="";if(!p.hasChildNodes())return"";for(var R=p.childNodes,D=R.length,j=0;j<D;++j)v+=i.subParser("makeMarkdown.node")(R[j],b,!0);return v.trim()}),i.subParser("makeMarkdown.txt",function(p){var b=p.nodeValue;return b=b.replace(/ +/g," "),b=b.replace(/¨NBSP;/g," "),b=i.helper.unescapeHTMLEntities(b),b=b.replace(/([*_~|`])/g,"\\$1"),b=b.replace(/^(\s*)>/g,"\\$1>"),b=b.replace(/^#/gm,"\\#"),b=b.replace(/^(\s*)([-=]{3,})(\s*)$/,"$1\\$2$3"),b=b.replace(/^( {0,3}\d+)\./gm,"$1\\."),b=b.replace(/^( {0,3})([+-])/gm,"$1\\$2"),b=b.replace(/]([\s]*)\(/g,"\\]$1\\("),b=b.replace(/^ {0,3}\[([\S \t]*?)]:/gm,"\\[$1]:"),b});var U=this;n.exports?n.exports=i:U.showdown=i}).call(f)})(VZ);var rRe=VZ.exports;const YE=new Map([[We.START,N.Start],[We.START_SIGNAL,N.StartSignalOutline],[We.START_PROGRAM,N.StartProgramOutline],[We.START_ERROR,N.ErrorStart],[We.START_SUB,N.SubStartOutline],[We.START_WS,N.WsStartOutline],[We.START_HD,N.InitStartOutline],[We.START_HD_METHOD,N.MethodStartOutline],[We.START_HD_EVENT,N.EventStartOutline],[We.START_THIRD_PARTY,N.Extension],[ir.INTERMEDIATE_TASK,N.TaskDoubleOutline],[ir.INTERMEDIATE_WAIT,N.ClockOutline],[ir.INTERMEDIATE_THIRD_PARTY,N.Extension],[Ea.BOUNDARY_ERROR,N.ErrorStart],[Ea.BOUNDARY_SIGNAL,N.StartSignalOutline],[bn.END,N.ProcessEnd],[bn.END_PAGE,N.EndPageOutline],[bn.END_ERROR,N.ErrorEnd],[bn.END_SUB,N.SubEndOutline],[bn.END_WS,N.WsStartOutline],[bn.END_HD,N.ProcessEnd],[bn.END_HD_EXIT,N.ExitEndOutline],[Eo.ALTERNATIVE,N.AlternativeGateways],[Eo.SPLIT,N.JoinGateways],[Eo.JOIN,N.JoinGateways],[Eo.TASK,N.JoinTasksGateways],[ge.USER,N.UserTaskOutline],[ge.HD,N.UserDialogOutline],[ge.SCRIPT,N.ScriptFileOutline],[ge.EMBEDDED_PROCESS,N.SubActivitiesDashed],[ge.SUB_PROCESS,N.SubActivities],[ge.TRIGGER,N.TriggerOutline],[ge.DB,N.DatabaseOutline],[ge.SOAP,N.WebService],[ge.REST,N.RestClientOutline],[ge.EMAIL,N.EMailOutline],[ge.THIRD_PARTY,N.Extension],[ge.THIRD_PARTY_RULE,N.RuleOutline],[ge.PROGRAM,N.ProgramOutline],[ge.BPMN_GENERIC,N.SubActivitiesDashed],[ge.BPMN_USER,N.SubUserOutline],[ge.BPMN_MANUAL,N.SubManualOutline],[ge.BPMN_SCRIPT,N.SubScriptOutline],[ge.BPMN_SERVICE,N.SubWebService],[ge.BPMN_RULE,N.SubRuleOutline],[ge.BPMN_SEND,N.SubSendOutline],[ge.BPMN_RECEIVE,N.SubReceiveOutline],[ge.COMMENT,N.NoteOutline],[sa.POOL,N.PoolSwimlanes],[sa.LANE,N.LaneSwimlanes]]);class sRe{constructor(){x(this,"menuCssClass",["bar-menu","simple-menu"]);x(this,"bodyDiv")}create(e){return this.bodyDiv=Ce("div",this.menuCssClass),e.appendChild(this.bodyDiv),this.createMenuBody(this.bodyDiv),this.bodyDiv}remove(){var e;(e=this.bodyDiv)==null||e.remove()}}const Ho=class Ho{constructor(e,t,i){x(this,"actionDispatcher");x(this,"action");x(this,"paletteItems");x(this,"menuCssClass",["bar-menu"]);x(this,"paletteItemsCopy",[]);x(this,"bodyDiv");x(this,"searchField");x(this,"itemsDiv");this.actionDispatcher=e,this.action=t,this.paletteItems=i,this.paletteItemsCopy=JSON.parse(JSON.stringify(this.paletteItems))}create(e){return this.bodyDiv=Ce("div",this.menuCssClass),e.appendChild(this.bodyDiv),this.action.customCssClass&&this.bodyDiv.classList.add(this.action.customCssClass),this.action.showSearch&&this.bodyDiv.appendChild(this.createPaletteItemSearchField()),this.createItemsDiv(this.bodyDiv),this.appendMenuParts(this.bodyDiv),this.bodyDiv}remove(){var e;(e=this.bodyDiv)==null||e.remove()}appendMenuParts(e){}createPaletteItemSearchField(){const e=Ce("div",["bar-menu-search"]);return e.appendChild(Or(N.Search)),this.searchField=Ce("input",["menu-search-input"]),this.searchField.type="text",this.searchField.placeholder="Search",this.searchField.onkeyup=t=>this.filterKeyUp(t),this.searchField.onkeydown=t=>this.clearSearchInputOnEscape(t),setTimeout(()=>{var t;return(t=this.searchField)==null?void 0:t.focus()},1),e.appendChild(this.searchField),e}filterKeyUp(e){var t;Gi(e,"ArrowUp")||Gi(e,"ArrowLeft")?this.navigateUpOrDown(-1):Gi(e,"ArrowDown")||Gi(e,"ArrowRight")?this.navigateUpOrDown(1):Gi(e,"Enter")?this.triggerItem():this.requestFilterUpdate(((t=this.searchField)==null?void 0:t.value)??"")}clearSearchInputOnEscape(e){Gi(e,"Escape")&&this.searchField&&(this.searchField.value="",this.requestFilterUpdate(""))}requestFilterUpdate(e){this.paletteItems=JSON.parse(JSON.stringify(this.paletteItemsCopy));const t=[];for(const i of this.paletteItems)if(i.children){const o=i.children.filter(r=>r.label.toLowerCase().includes(e.toLowerCase()));o.length>0&&(i.children.splice(0,i.children.length),o.forEach(r=>i.children.push(r)),t.push(i))}this.paletteItems=t,this.bodyDiv&&this.createItemsDiv(this.bodyDiv)}navigateUpOrDown(e){if(this.itemsDiv){const t=Array.from(this.itemsDiv.querySelectorAll(`.${Ho.ITEM_BUTTON}`)),i=t.filter(s=>s.classList.contains(Ho.ACTIVE_ELEMENT))[0];let o=t.indexOf(i)+e;o<0?o=t.length-1:o>=t.length&&(o=0);const r=t[o];this.focusButton(r),r==null||r.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}}triggerItem(){const e=this.currentItem();e==null||e.click()}createItemsDiv(e){const t=Ce("div",["bar-menu-items"]);let i=0;if(this.paletteItems.sort(m.compare).forEach(o=>{if(o.children){const r=this.createToolGroup(t,o);o.children.sort(m.compare).forEach(s=>r.appendChild(this.createToolButton(s,i++))),this.appendItemToGroup(r)}}),this.paletteItems.length===0){const o=Ce("div");o.innerText="No results found.",o.classList.add("no-result"),t.appendChild(o)}this.itemsDiv&&e.removeChild(this.itemsDiv),e.appendChild(t),this.itemsDiv=t,this.navigateUpOrDown(1)}appendItemToGroup(e){}createToolGroup(e,t){const i=Ce("div",[Ho.ITEM_GROUP]);i.id=t.id,e.appendChild(i);const o=Ce("div",["menu-group-header"]);o.textContent=t.label,i.appendChild(o);const r=Ce("div",["menu-group-items"]);return i.appendChild(r),i.appendChild(Ce("div",["menu-group-divider"])),r}createToolButton(e,t){const i=Ce("div",[Ho.ITEM_BUTTON]);i.tabIndex=t;const o=Ce("div",["menu-item-icon"]);o.appendChild(this.appendPaletteIcon(e)),i.appendChild(o);const r=Ce("div",["menu-item-text"]);return r.appendChild(Ce("span",["menu-item-label"],e.label)),"info"in e&&typeof e.info=="string"&&r.appendChild(Ce("span",["menu-item-info"],e.info)),i.appendChild(r),i.onclick=s=>this.actionDispatcher.dispatchAll(this.toolButtonOnClick(e)),i.onmouseenter=s=>this.focusButton(i),"description"in e&&typeof e.description=="string"&&e.description!=="undefined"?i.title=e.description:i.title=e.label,this.appendToToolButton(r,e),i}appendToToolButton(e,t){}focusButton(e){var t;(t=this.currentItem())==null||t.classList.remove(Ho.ACTIVE_ELEMENT),e==null||e.classList.add(Ho.ACTIVE_ELEMENT)}currentItem(){var e;return(e=this.itemsDiv)==null?void 0:e.querySelector(`.${Ho.ITEM_BUTTON}.${Ho.ACTIVE_ELEMENT}`)}appendPaletteIcon(e){if(!e.icon)return Or();const t=this.resolveIcon(e.icon);if(t)return Or(t);const i=Ce("img");return i.src=e.icon,i}resolveIcon(e){return e.startsWith(ge.THIRD_PARTY)?YE.get(ge.THIRD_PARTY):e.startsWith(We.START_THIRD_PARTY)?YE.get(We.START_THIRD_PARTY):e.startsWith(ir.INTERMEDIATE_THIRD_PARTY)?YE.get(ir.INTERMEDIATE_THIRD_PARTY):YE.get(e)}};x(Ho,"ACTIVE_ELEMENT","focus"),x(Ho,"ITEM_GROUP","menu-group"),x(Ho,"ITEM_BUTTON","menu-item");let Qy=Ho;class aRe{constructor(e,t,i){x(this,"actionDispatcher");x(this,"elementIds");x(this,"editUi");x(this,"item");x(this,"colorNameInput");x(this,"colorInput");x(this,"colorPickerInput");x(this,"colorPickerDecorator");x(this,"deleteBtn");this.actionDispatcher=e,this.elementIds=t,this.editUi=this.createEditUi(i)}showEditUi(e){this.item=e,this.setInputValue(this.colorNameInput,e==null?void 0:e.label),this.setInputValue(this.colorInput,e==null?void 0:e.icon),this.setInputValue(this.colorPickerInput,e==null?void 0:e.icon),this.colorPickerDecorator&&(this.colorPickerDecorator.style.backgroundColor=(e==null?void 0:e.icon)??""),this.deleteBtn&&(this.deleteBtn.style.display=e?"block":"none"),this.editUi.style.display="block"}setInputValue(e,t){e&&(e.value=t??"")}createEditUi(e){const t=Ce("div",["edit-color"]);return t.appendChild(this.createBody()),t.appendChild(this.createFooter()),e.appendChild(t),t}createBody(){const e=Ce("div",["edit-color-body"]),[t,i]=this.createInput("Name",this.colorNameInput);e.appendChild(t),this.colorNameInput=i;const[o,r]=this.createInput("Color",this.colorInput,!0);return e.appendChild(o),this.colorInput=r,e}createInput(e,t,i=!1){const o=`input-${e}`,r=Ce("div",["edit-color-input"]),s=Ce("label");if(s.htmlFor=o,s.textContent=e,r.appendChild(s),t=document.createElement("input"),t.name=e,t.id=o,i){const a=Ce("div",["color-picker"]);this.colorPickerDecorator=Ce("span",["decorator"]),this.colorPickerInput=document.createElement("input"),this.colorPickerDecorator.onclick=()=>this.colorPickerInput.click(),this.colorPickerInput.type="color",this.colorPickerInput.onchange=u=>this.colorInputChange(u.target),t.onchange=u=>this.colorInputChange(u.target),a.appendChild(this.colorPickerDecorator),a.appendChild(this.colorPickerInput),a.appendChild(t),r.appendChild(a)}else r.appendChild(t);return[r,t]}colorInputChange(e){if(e instanceof HTMLInputElement){const t=e.value;this.colorPickerInput.value=t,this.colorPickerDecorator.style.backgroundColor=t,this.colorInput.value=t}}createFooter(){const e=Ce("footer",["edit-color-footer"]);this.deleteBtn=Ce("button",["edit-color-delete"]),this.deleteBtn.textContent="Delete",this.deleteBtn.autofocus=!0,this.deleteBtn.type="button",this.deleteBtn.onclick=()=>this.deleteColor();const t=Ce("button",["edit-color-save"]);return t.textContent="Save",t.type="button",t.onclick=i=>this.validateInputsAndRun(()=>this.changeColor()),e.appendChild(this.deleteBtn),e.appendChild(t),e}validateInputsAndRun(e){const t=this.validateInput(this.colorNameInput),i=this.validateInput(this.colorInput);t&&i&&e()}validateInput(e){if(e){if(e.value==="")return e.classList.add("error"),!1;e.classList.remove("error")}return!0}deleteColor(){this.item&&this.actionDispatcher.dispatch(zy.deleteColor({elementIds:this.elementIds,oldColor:this.item.label}))}changeColor(){var i,o;const e=((i=this.colorNameInput)==null?void 0:i.value)??"",t=((o=this.colorInput)==null?void 0:o.value)??"";this.actionDispatcher.dispatch(zy.create({elementIds:this.elementIds,color:t,colorName:e}))}}var Cs;(function(n){n.KIND="showQuickActionMenu";function e(o){return{kind:n.KIND,...o}}n.create=e;function t(){return e({elementIds:[],paletteItems:()=>[],actions:(o,r)=>[]})}n.empty=t;function i(o){return m.Action.hasKind(o,n.KIND)}n.is=i})(Cs||(Cs={}));class cRe extends Qy{constructor(t,i,o){super(t,i,o);x(this,"actionDispatcher");x(this,"action");x(this,"paletteItems");x(this,"menuCssClass",["bar-menu","quick-action-bar-menu"]);x(this,"editUi");this.actionDispatcher=t,this.action=i,this.paletteItems=o}appendMenuParts(t){this.action.isEditable&&(this.editUi=new aRe(this.actionDispatcher,this.action.elementIds,t))}remove(){var t;(t=this.bodyDiv)==null||t.remove()}appendItemToGroup(t){if(this.action.isEditable){const i=Ce("div",[Qy.ITEM_BUTTON,"new-color-btn"]);i.appendChild(Ce("span",["new-color-icon","ivy",`ivy-${N.Plus}`])),i.insertAdjacentText("beforeend","New Color"),i.onclick=()=>{var o;return(o=this.editUi)==null?void 0:o.showEditUi()},i.onmouseenter=o=>this.focusButton(i),t.appendChild(i)}}toolButtonOnClick(t){return this.action.actions(t,this.action.elementIds)}appendToToolButton(t,i){this.action.isEditable&&i.label!=="default"&&t.appendChild(this.createEditButton(i))}createEditButton(t){const i=Or(N.Edit,["color-edit-button"]);return i.title="Edit Color",i.onclick=o=>{var r;o.stopPropagation(),(r=this.editUi)==null||r.showEditUi(t)},i}appendPaletteIcon(t){if(this.action.isEditable)if(t.icon&&t.icon.length>0){const i=Ce("span",["color-icon"]);return i.style.backgroundColor=t.icon,i}else return Ce("span",["empty-icon"]);return super.appendPaletteIcon(t)}}var Hm;(function(n){n.KIND="showSimpleQuickActionMenu";function e(i){return{kind:n.KIND,...i}}n.create=e;function t(i){return m.Action.hasKind(i,n.KIND)}n.is=t})(Hm||(Hm={}));class dRe extends sRe{constructor(t){super();x(this,"action");this.action=t}createMenuBody(t){const i=Ce("div",["bar-menu-text"]);if(t.appendChild(i),this.action.title&&i.appendChild(this.createTitle(this.action.title)),this.action.markers.forEach(o=>i.appendChild(this.createMarker(o))),this.action.text&&i.appendChild(this.createDescription(this.action.text)),this.action.info)for(const[o,r]of Object.entries(this.action.info))i.appendChild(this.addInfo(o,r));i.appendChild(this.createInfo("PID",this.action.elementId))}addInfo(t,i){switch(i.type){case"STRING":return this.createInfo(t,i.value);case"CODE":return this.createCodeInfo(t,i.value)}}createTitle(t){const i=Ce("p",["simple-menu-header"]);return i.textContent=t,i}createCodeInfo(t,i){const o=Ce("p",["simple-menu-text","simple-menu-small"]),r=Ce("strong");r.textContent=`${t}: `,o.prepend(r);const s=Ce("pre");return s.textContent=i,o.appendChild(s),o}createInfo(t,i){const o=Ce("p",["simple-menu-text","simple-menu-small"]),r=Ce("strong");return o.textContent=i,r.textContent=`${t}: `,o.prepend(r),o}createDescription(t){const o=new rRe.Converter({simpleLineBreaks:!0}).makeHtml(t),r=document.createElement("template");r.innerHTML=o;const s=Ce("div",["simple-menu-text"]);for(const a of r.content.childNodes)s.appendChild(a);return s}createMarker(t){const i=Ce("div",["menu-marker"]);return t.issues.forEach(o=>i.appendChild(this.createIssue(o))),i}createIssue(t){const i=Ce("div",["menu-issue"]),o=Ce("div",["menu-issue-title"]);o.appendChild(Or(this.ivyIconForSeverity(t.severity)));const r=Ce("span");r.textContent=t.severity==="error"?"Error":"Caution",o.appendChild(r),i.appendChild(o);const s=Ce("p",["menu-issue-message"]);return s.textContent=t.message,i.appendChild(s),i}ivyIconForSeverity(t){switch(t){case"info":return N.InfoCircle;case"warning":return N.Caution;case"error":return N.ErrorXMark}}}var ph=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Wd=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},fp,Tl;let Bt=(Tl=class extends m.GLSPAbstractUIExtension{constructor(){super(...arguments);x(this,"activeQuickActions",[]);x(this,"activeQuickActionBtn");x(this,"quickActionBar");x(this,"quickActionMenu");x(this,"actionDispatcherProvider");x(this,"selectionService");x(this,"mouseTool");x(this,"editorContext");x(this,"quickActionProviders")}id(){return fp.ID}init(){this.selectionService.onSelectionChanged(t=>this.selectionChanged(t.root,t.selectedElements)),this.mouseTool.register(new uRe(this))}containerClass(){return"quick-actions-container"}getActiveQuickActions(){return this.activeQuickActions}initializeContents(t){t.style.position="absolute",t.onwheel=i=>i.ctrlKey?i.preventDefault():!0}selectionChanged(t,i){var o;(o=this.editorContext.modelRoot.cssClasses)!=null&&o.includes(m.CursorCSS.MARQUEE)||i.length<1?this.hideUi():this.showUi()}handle(t){Cs.is(t)&&this.showItemMenu(t),Hm.is(t)&&this.showSimpleMenu(t),m.RemoveMarqueeAction.is(t)&&this.editorContext.selectedElements.length>0&&this.showUi()}showSimpleMenu(t){this.removeMenu(),this.quickActionMenu=new dRe(t),this.createMenu(this.quickActionMenu)}async showItemMenu(t){this.removeMenu(),t.elementIds.length>0?(this.quickActionMenu=new cRe(await this.actionDispatcherProvider(),t,t.paletteItems()),this.createMenu(this.quickActionMenu)):this.setActiveQuickActionBtn()}createMenu(t){if(this.quickActionBar){const i=t.create(this.containerElement);i.offsetWidth>this.quickActionBar.offsetWidth?(i.classList.add("border-radius"),this.quickActionBar.classList.add("no-bottom-border-radius"),this.shiftBar(i,8)):this.shiftBar(i,24)}}removeMenu(){var t;(t=this.quickActionMenu)==null||t.remove(),this.quickActionMenu=void 0}showUi(){this.activeQuickActions=[],this.actionDispatcherProvider().then(t=>t.dispatch(m.SetUIExtensionVisibilityAction.create({extensionId:fp.ID,visible:!0,contextElementsId:[...this.selectionService.getSelectedElementIDs()]})))}hideUi(){this.activeQuickActions=[],this.actionDispatcherProvider().then(t=>t.dispatch(m.SetUIExtensionVisibilityAction.create({extensionId:fp.ID,visible:!1})))}onBeforeShow(t,i,...o){t.innerHTML="";const r=lRe(o,i),s=r.filter(a=>!(a instanceof m.GRoutableElement)||!(a instanceof $m));if(s.length>1)this.showMultiQuickActionUi(t,s);else if(r.length===1&&r[0]instanceof m.GEdge&&RZ(r[0]))this.showEdgeQuickActionUi(t,r[0]);else{const a=fRe(s);this.showSingleQuickActionUi(t,a)}}showMultiQuickActionUi(t,i){if(this.activeQuickActions=this.loadMultiQuickActions(i),this.activeQuickActions.length===0)return;const o=i.filter(r=>!(r instanceof pM)).map(m.getAbsoluteBounds).filter(m.Bounds.isValid).reduce(m.Bounds.combine);this.quickActionBar=this.createQuickActionsBar(t,o,!0),this.createQuickActions(this.quickActionBar,this.activeQuickActions),this.shiftBar(this.quickActionBar)}showSingleQuickActionUi(t,i){if(m.isNotUndefined(i)){if(this.activeQuickActions=this.loadSingleQuickActions(i),this.activeQuickActions.length===0)return;this.quickActionBar=this.createQuickActionsBar(t,m.getAbsoluteBounds(i)),this.createQuickActions(this.quickActionBar,this.activeQuickActions),this.shiftBar(this.quickActionBar)}}showEdgeQuickActionUi(t,i){if(m.isNotUndefined(i)&&!i.id.endsWith("_feedback_edge")&&i.source&&i.target){if(this.activeQuickActions=this.loadSingleQuickActions(i),this.activeQuickActions.length===0)return;const o=KZ(i);this.quickActionBar=this.createQuickActionsBar(t,o),this.createQuickActions(this.quickActionBar,this.activeQuickActions),this.shiftBar(this.quickActionBar)}}shiftBar(t,i=16){const o=t.getBoundingClientRect();let r=o.width/2;const s=o.x+o.width+i-r,a=this.getParentContainer();s>a.offsetWidth&&(r+=s-a.offsetWidth);const u=o.x-i;r>u&&(r=u),t.style.marginLeft=`${-r}px`}createQuickActionsBar(t,i,o=!1){if(t.style.left=`${i.x+i.width/2}px`,t.style.top=`${i.y+i.height}px`,o){const s=Ce("div",["multi-selection-box"]);s.style.marginLeft=`-${i.width/2}px`,s.style.marginTop=`-${i.height}px`,s.style.height=`${i.height+10}px`,s.style.width=`${i.width+10}px`,t.appendChild(s)}const r=Ce("div",["quick-actions-bar"]);return t.appendChild(r),r}createQuickActions(t,i){this.createQuickActionGroup(t,i,"Left"),this.createQuickActionGroup(t,i,"Middle"),this.createQuickActionGroup(t,i,"Right"),this.setContainerVisible(!0)}createQuickActionGroup(t,i,o){const r=Ce("div",["quick-actions-group"]);i.filter(s=>s.location===o).sort((s,a)=>s.sorting.localeCompare(a.sorting)).forEach(s=>{r.appendChild(this.createQuickActionBtn(s))}),r.children.length>0&&t.appendChild(r)}createQuickActionBtn(t){const i=Ce("button");i.appendChild(Or(t.icon)),i.title=t.title;const o=[t.action];return t.letQuickActionsOpen||o.push(m.SetUIExtensionVisibilityAction.create({extensionId:fp.ID,visible:!1})),t.removeSelection&&o.push(m.SelectAllAction.create(!1)),i.onclick=()=>this.triggerQuickActionBtn(i,o),i}triggerQuickActionBtn(t,i){this.activeQuickActionBtn===t&&this.quickActionMenu?(this.setActiveQuickActionBtn(),this.removeMenu()):(this.setActiveQuickActionBtn(t),this.actionDispatcherProvider().then(o=>o.dispatchAll(i)))}setActiveQuickActionBtn(t){var i,o;(i=this.activeQuickActionBtn)==null||i.classList.remove("active"),this.activeQuickActionBtn=t,(o=this.activeQuickActionBtn)==null||o.classList.add("active")}loadSingleQuickActions(t){return this.filterQuickActions(this.quickActionProviders.map(i=>i.singleQuickAction(t)))}loadMultiQuickActions(t){return this.filterQuickActions(this.quickActionProviders.map(i=>i.multiQuickAction(t)))}filterQuickActions(t){return t.filter(m.isNotUndefined).filter(i=>!this.isReadonly()||i.readonlySupport)}isReadonly(){return this.editorContext.isReadonly}},fp=Tl,x(Tl,"ID","quickActionsUi"),Tl);ph([be(m.TYPES.IActionDispatcherProvider),Wd("design:type",Function)],Bt.prototype,"actionDispatcherProvider",void 0);ph([be(m.SelectionService),Wd("design:type",m.SelectionService)],Bt.prototype,"selectionService",void 0);ph([be(m.GLSPMouseTool),Wd("design:type",m.GLSPMouseTool)],Bt.prototype,"mouseTool",void 0);ph([be(m.EditorContextService),Wd("design:type",m.EditorContextService)],Bt.prototype,"editorContext",void 0);ph([w6(Ve.QuickActionProvider),Wd("design:type",Array)],Bt.prototype,"quickActionProviders",void 0);ph([qw(),Wd("design:type",Function),Wd("design:paramtypes",[]),Wd("design:returntype",void 0)],Bt.prototype,"init",null);Bt=fp=ph([le()],Bt);class uRe extends m.MouseListener{constructor(t){super();x(this,"quickActionUi");this.quickActionUi=t}wheel(t,i){return this.quickActionUi.showUi(),[]}}function lRe(n,e){return n.map(t=>e.index.getById(t)).filter(m.isNotUndefined)}function fRe(n,e){return n.filter(RZ)[0]}var _M=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},d4=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Km=class extends m.KeyListener{constructor(){super(...arguments);x(this,"selectionService");x(this,"movementRestrictor");x(this,"gridManager")}keyDown(t,i){const o=this.moveDelta(i);return o===void 0?[]:this.selectionService.hasSelectedElements()?this.moveElements(o):this.moveGraph(t,o)}moveDelta(t){if(Gi(t,"ArrowUp"))return{x:0,y:-this.gridManager.grid.y};if(Gi(t,"ArrowDown"))return{x:0,y:this.gridManager.grid.y};if(Gi(t,"ArrowLeft"))return{x:-this.gridManager.grid.x,y:0};if(Gi(t,"ArrowRight"))return{x:this.gridManager.grid.x,y:0}}moveGraph(t,i){const o=m.findParentByFeature(t,m.isViewport);if(o===void 0)return[];const r={scroll:{x:o.scroll.x+i.x,y:o.scroll.y+i.y},zoom:o.zoom};return[m.SetViewportAction.create(o.id,r,{animate:!1})]}moveElements(t){let i=m.getElements(this.selectionService.getModelRoot().index,Array.from(this.selectionService.getSelectedElementIDs()),m.isBoundsAware);if(i=i.filter(r=>!this.isChildOfSelected(i,r)).filter(r=>r.hasFeature(m.boundsFeature)),i.length===0)return[];const o=i.filter(r=>this.isMovementAllowed(r,t)).map(r=>this.getElementAndUpdatedBound(r,t));return o.length!==i.length?[]:[ct.ChangeBoundsOperation.create(o),m.SetUIExtensionVisibilityAction.create({extensionId:Bt.ID,visible:!0,contextElementsId:[...i.map(r=>r.id)]})]}isChildOfSelected(t,i){return i instanceof m.GChildElement&&t.includes(i.parent)}isMovementAllowed(t,i){if(this.movementRestrictor){const o=this.updatePosition(t,i);return this.movementRestrictor.validate(t,o)}return!0}getElementAndUpdatedBound(t,i){const o=m.toElementAndBounds(t);return o.newPosition=this.updatePosition(t,i),o}updatePosition(t,i){return{x:t.bounds.x+i.x,y:t.bounds.y+i.y}}};_M([be(m.SelectionService),d4("design:type",m.SelectionService)],Km.prototype,"selectionService",void 0);_M([be(m.TYPES.IMovementRestrictor),Wm(),d4("design:type",Object)],Km.prototype,"movementRestrictor",void 0);_M([be(m.TYPES.IGridManager),d4("design:type",Object)],Km.prototype,"gridManager",void 0);Km=_M([le()],Km);var u4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},zZ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Vm=class extends m.KeyListener{constructor(){super(...arguments);x(this,"selectionService");x(this,"quickActionUi")}keyDown(t,i){return Gi(i,"KeyJ")&&this.isJumpOutActive()?[bf.create({elementId:""})]:[]}isJumpOutActive(){return this.selectionService.getModelRoot().id.includes("-")&&!this.isJumpIntoActive()}isJumpIntoActive(){return this.quickActionUi.getActiveQuickActions().map(t=>t.action).map(t=>t.kind).some(t=>t==="jumpInto")}};u4([be(m.SelectionService),zZ("design:type",m.SelectionService)],Vm.prototype,"selectionService",void 0);u4([be(Bt),zZ("design:type",Bt)],Vm.prototype,"quickActionUi",void 0);Vm=u4([le()],Vm);var GZ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},hRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Xy=class extends m.KeyListener{constructor(){super(...arguments);x(this,"quickActionUi")}keyDown(t,i){const o=this.quickActionUi.getActiveQuickActions().filter(r=>r.shortcut&&Gi(i,r.shortcut));return o.length===1&&!o[0].letQuickActionsOpen?[o[0].action,m.SetUIExtensionVisibilityAction.create({extensionId:Bt.ID,visible:!1})]:o.map(r=>r.action)}};GZ([be(Bt),hRe("design:type",Bt)],Xy.prototype,"quickActionUi",void 0);Xy=GZ([le()],Xy);const UZ=new m.FeatureModule(n=>{n(m.TYPES.KeyListener).to(Km),n(m.TYPES.KeyListener).to(Xy),n(m.TYPES.KeyListener).to(Vm)});var pRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let LL=class extends Un{singleQuickAction(e){if(e instanceof Ca&&e.type===sa.POOL)return{icon:N.LaneSwimlanes,title:"Create Lane",location:"Right",sorting:"A",letQuickActionsOpen:!0,action:m.CreateNodeOperation.create(sa.LANE,{containerId:e.id})}}};LL=pRe([le()],LL);const YZ=new m.FeatureModule((n,e,t)=>{n(Ve.QuickActionProvider).to(LL)});var qZ={exports:{}};/*!
 * Toastify js 1.12.0
 * https://github.com/apvarun/toastify-js
 * @license MIT licensed
 *
 * Copyright (C) 2018 Varun A P
 */(function(n){(function(e,t){n.exports?n.exports=t():e.Toastify=t()})(f,function(e){var t=function(s){return new t.lib.init(s)},i="1.12.0";t.defaults={oldestFirst:!0,text:"Toastify is awesome!",node:void 0,duration:3e3,selector:void 0,callback:function(){},destination:void 0,newWindow:!1,close:!1,gravity:"toastify-top",positionLeft:!1,position:"",backgroundColor:"",avatar:"",className:"",stopOnFocus:!0,onClick:function(){},offset:{x:0,y:0},escapeMarkup:!0,ariaLive:"polite",style:{background:""}},t.lib=t.prototype={toastify:i,constructor:t,init:function(s){return s||(s={}),this.options={},this.toastElement=null,this.options.text=s.text||t.defaults.text,this.options.node=s.node||t.defaults.node,this.options.duration=s.duration===0?0:s.duration||t.defaults.duration,this.options.selector=s.selector||t.defaults.selector,this.options.callback=s.callback||t.defaults.callback,this.options.destination=s.destination||t.defaults.destination,this.options.newWindow=s.newWindow||t.defaults.newWindow,this.options.close=s.close||t.defaults.close,this.options.gravity=s.gravity==="bottom"?"toastify-bottom":t.defaults.gravity,this.options.positionLeft=s.positionLeft||t.defaults.positionLeft,this.options.position=s.position||t.defaults.position,this.options.backgroundColor=s.backgroundColor||t.defaults.backgroundColor,this.options.avatar=s.avatar||t.defaults.avatar,this.options.className=s.className||t.defaults.className,this.options.stopOnFocus=s.stopOnFocus===void 0?t.defaults.stopOnFocus:s.stopOnFocus,this.options.onClick=s.onClick||t.defaults.onClick,this.options.offset=s.offset||t.defaults.offset,this.options.escapeMarkup=s.escapeMarkup!==void 0?s.escapeMarkup:t.defaults.escapeMarkup,this.options.ariaLive=s.ariaLive||t.defaults.ariaLive,this.options.style=s.style||t.defaults.style,s.backgroundColor&&(this.options.style.background=s.backgroundColor),this},buildToast:function(){if(!this.options)throw"Toastify is not initialized";var s=document.createElement("div");s.className="toastify on "+this.options.className,this.options.position?s.className+=" toastify-"+this.options.position:this.options.positionLeft===!0?(s.className+=" toastify-left",console.warn("Property `positionLeft` will be depreciated in further versions. Please use `position` instead.")):s.className+=" toastify-right",s.className+=" "+this.options.gravity,this.options.backgroundColor&&console.warn('DEPRECATION NOTICE: "backgroundColor" is being deprecated. Please use the "style.background" property.');for(var a in this.options.style)s.style[a]=this.options.style[a];if(this.options.ariaLive&&s.setAttribute("aria-live",this.options.ariaLive),this.options.node&&this.options.node.nodeType===Node.ELEMENT_NODE)s.appendChild(this.options.node);else if(this.options.escapeMarkup?s.innerText=this.options.text:s.innerHTML=this.options.text,this.options.avatar!==""){var u=document.createElement("img");u.src=this.options.avatar,u.className="toastify-avatar",this.options.position=="left"||this.options.positionLeft===!0?s.appendChild(u):s.insertAdjacentElement("afterbegin",u)}if(this.options.close===!0){var h=document.createElement("button");h.type="button",h.setAttribute("aria-label","Close"),h.className="toast-close",h.innerHTML="&#10006;",h.addEventListener("click",(function(A){A.stopPropagation(),this.removeElement(this.toastElement),window.clearTimeout(this.toastElement.timeOutValue)}).bind(this));var g=window.innerWidth>0?window.innerWidth:screen.width;(this.options.position=="left"||this.options.positionLeft===!0)&&g>360?s.insertAdjacentElement("afterbegin",h):s.appendChild(h)}if(this.options.stopOnFocus&&this.options.duration>0){var y=this;s.addEventListener("mouseover",function(A){window.clearTimeout(s.timeOutValue)}),s.addEventListener("mouseleave",function(){s.timeOutValue=window.setTimeout(function(){y.removeElement(s)},y.options.duration)})}if(typeof this.options.destination<"u"&&s.addEventListener("click",(function(A){A.stopPropagation(),this.options.newWindow===!0?window.open(this.options.destination,"_blank"):window.location=this.options.destination}).bind(this)),typeof this.options.onClick=="function"&&typeof this.options.destination>"u"&&s.addEventListener("click",(function(A){A.stopPropagation(),this.options.onClick()}).bind(this)),typeof this.options.offset=="object"){var S=o("x",this.options),w=o("y",this.options),P=this.options.position=="left"?S:"-"+S,E=this.options.gravity=="toastify-top"?w:"-"+w;s.style.transform="translate("+P+","+E+")"}return s},showToast:function(){this.toastElement=this.buildToast();var s;if(typeof this.options.selector=="string"?s=document.getElementById(this.options.selector):this.options.selector instanceof HTMLElement||typeof ShadowRoot<"u"&&this.options.selector instanceof ShadowRoot?s=this.options.selector:s=document.body,!s)throw"Root element is not defined";var a=t.defaults.oldestFirst?s.firstChild:s.lastChild;return s.insertBefore(this.toastElement,a),t.reposition(),this.options.duration>0&&(this.toastElement.timeOutValue=window.setTimeout((function(){this.removeElement(this.toastElement)}).bind(this),this.options.duration)),this},hideToast:function(){this.toastElement.timeOutValue&&clearTimeout(this.toastElement.timeOutValue),this.removeElement(this.toastElement)},removeElement:function(s){s.className=s.className.replace(" on",""),window.setTimeout((function(){this.options.node&&this.options.node.parentNode&&this.options.node.parentNode.removeChild(this.options.node),s.parentNode&&s.parentNode.removeChild(s),this.options.callback.call(s),t.reposition()}).bind(this),400)}},t.reposition=function(){for(var s={top:15,bottom:15},a={top:15,bottom:15},u={top:15,bottom:15},h=document.getElementsByClassName("toastify"),g,y=0;y<h.length;y++){r(h[y],"toastify-top")===!0?g="toastify-top":g="toastify-bottom";var S=h[y].offsetHeight;g=g.substr(9,g.length-1);var w=15,P=window.innerWidth>0?window.innerWidth:screen.width;P<=360?(h[y].style[g]=u[g]+"px",u[g]+=S+w):r(h[y],"toastify-left")===!0?(h[y].style[g]=s[g]+"px",s[g]+=S+w):(h[y].style[g]=a[g]+"px",a[g]+=S+w)}return this};function o(s,a){return a.offset[s]?isNaN(a.offset[s])?a.offset[s]:a.offset[s]+"px":"0px"}function r(s,a){return!s||typeof a!="string"?!1:!!(s.className&&s.className.trim().split(/\s+/gi).indexOf(a)>-1)}return t.lib.init.prototype=t.lib,t})})(qZ);var mRe=qZ.exports;const WZ=Roe(mRe);var gRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let Cd=class{constructor(){x(this,"duration",2e3);x(this,"messageToast");x(this,"progressMessages",new Map)}handle(e){if(m.MessageAction.is(e))return this.updateToast(e.message,e.severity);if(m.StartProgressAction.is(e))return this.updateToast(this.progress(e),"INFO");if(m.UpdateProgressAction.is(e))return this.updateToast(this.progress(e),"INFO");if(m.EndProgressAction.is(e))return this.updateToast(this.progress(e),"NONE")}progress(e){m.StartProgressAction.is(e)&&this.progressMessages.set(e.progressId,e.title);let t=this.progressMessages.get(e.progressId)??"";e.message&&(t+=t.length>0?`${t}: ${e.message}`:e.message);const i=m.EndProgressAction.is(e)?void 0:e.percentage;return i&&i>0&&(t+=t.length>0?`${t} (${i}%)`:`${i}%`),m.EndProgressAction.is(e)&&this.progressMessages.delete(e.progressId),t}message(e){var t;(t=this.messageToast)==null||t.hideToast(),e.severity!=="NONE"&&(this.messageToast=this.createToast(e.message,e.severity),this.messageToast.showToast())}updateToast(e,t){var i;(i=this.messageToast)==null||i.hideToast(),t!=="NONE"&&(this.messageToast=this.createToast(e,t),this.messageToast.showToast())}createToast(e,t){return WZ({text:e,close:!0,gravity:"bottom",position:"left",className:`severity-${t}`,duration:t==="ERROR"?void 0:this.duration})}};Cd=gRe([le()],Cd);const vRe=new m.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};n(Cd).toSelf().inSingletonScope(),m.configureActionHandler(o,m.StatusAction.KIND,Cd),m.configureActionHandler(o,m.MessageAction.KIND,Cd),m.configureActionHandler(o,m.StartProgressAction.KIND,Cd),m.configureActionHandler(o,m.UpdateProgressAction.KIND,Cd),m.configureActionHandler(o,m.EndProgressAction.KIND,Cd)}),_Re=()=>({hideSensitiveInfo:!1});function yRe(n,e){const t=n.get(Ve.IvyViewerOptions);return Pz(t,e),t}var bRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let jL=class extends m.GLSPSvgExporter{getBounds(e){const t=[];return e.index.all().filter(i=>i.root!==i).filter(i=>!(i instanceof IZ)).forEach(i=>{i instanceof m.GNode&&t.push(m.getAbsoluteBounds(i)),i instanceof Hu&&i.text.length>0&&t.push(oRe(i)),i instanceof m.GEdge&&t.push(KZ(i))}),t.filter(m.Bounds.isValid).reduce(m.Bounds.combine)}};jL=bRe([le()],jL);var ZZ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},SRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Bw=class extends m.ChangeBoundsManager{constructor(){super(...arguments);x(this,"selectionService")}addMoveFeedback(t,i,o,r){return super.addMoveFeedback(t,i,o,r),this.hideQuickUIFeedback(t),t}addResizeFeedback(t,i,o,r){return super.addResizeFeedback(t,i,o,r),this.hideQuickUIFeedback(t),t}hideQuickUIFeedback(t){t.add(m.SetUIExtensionVisibilityAction.create({extensionId:Bt.ID,visible:!1}),m.SetUIExtensionVisibilityAction.create({extensionId:Bt.ID,visible:!0,contextElementsId:[...this.selectionService.getSelectedElementIDs()]}))}};ZZ([be(m.SelectionService),SRe("design:type",m.SelectionService)],Bw.prototype,"selectionService",void 0);Bw=ZZ([le()],Bw);var ERe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let NL=class extends m.RankedSelectMouseListener{mouseUp(e,t){return this.isMouseDown?super.mouseUp(e,t):[]}};NL=ERe([le()],NL);const QZ=new m.FeatureModule((n,e,t,i)=>{const o={bind:n,unbind:e,isBound:t,rebind:i};m.configureCommand(o,m.ShowChangeBoundsToolResizeFeedbackCommand),m.configureCommand(o,m.HideChangeBoundsToolResizeFeedbackCommand),m.bindAsService(o,m.TYPES.IDefaultTool,m.ChangeBoundsTool),m.bindAsService(o,m.TYPES.IChangeBoundsManager,Bw),m.configureView(o,m.GResizeHandle.TYPE,CL)},{featureId:m.changeBoundsToolModule.featureId}),CRe=new m.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};m.bindAsService(i,m.TYPES.HiddenVNodePostprocessor,m.ExportSvgPostprocessor),m.configureCommand(i,m.ExportSvgCommand),m.bindAsService(i,m.TYPES.SvgExporter,jL)},{featureId:m.exportModule.featureId}),PRe=new m.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};m.configureCommand(i,m.SelectCommand),m.configureCommand(i,m.SelectAllCommand),m.configureCommand(i,m.SelectFeedbackCommand),m.bindAsService(i,m.TYPES.MouseListener,NL)},{featureId:m.selectModule.featureId});var XZ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},wRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let $d=class{constructor(){x(this,"actionDispatcher");x(this,"paletteItems",[])}getPaletteItems(){return this.paletteItems}handle(e){Sa.is(e)&&this.updateColorPalette(),Sw.is(e)&&(this.paletteItems=e.paletteItems,this.actionDispatcher.dispatch(Cs.empty()))}async updateColorPalette(){this.actionDispatcher.request(m.RequestContextActions.create({contextId:"ivy-tool-color-palette",editorContext:{selectedElementIds:[]}})).then(e=>{m.SetContextActions.is(e)&&(this.paletteItems=e.actions.map(t=>t))})}};XZ([be(m.TYPES.IActionDispatcher),wRe("design:type",m.GLSPActionDispatcher)],$d.prototype,"actionDispatcher",void 0);$d=XZ([le()],$d);var l4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},JZ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Jy=class{constructor(){x(this,"colors");x(this,"actionDispatcher");x(this,"actions",(e,t)=>[zy.changeColor({elementIds:t,color:e.icon,colorName:e.label})])}singleQuickAction(e){return this.quickAction([e.id],()=>this.colors.getPaletteItems())}multiQuickAction(e){return this.quickAction(e.map(t=>t.id),()=>this.colors.getPaletteItems())}quickAction(e,t){return{icon:N.ColorDrop,title:"Select color",location:"Middle",sorting:"Z",action:Cs.create({elementIds:e,paletteItems:t,actions:this.actions,customCssClass:"colors-menu",isEditable:!0}),letQuickActionsOpen:!0,readonlySupport:!1}}};l4([be(Ve.ColorPalette),JZ("design:type",$d)],Jy.prototype,"colors",void 0);l4([be(m.TYPES.IActionDispatcher),JZ("design:type",m.GLSPActionDispatcher)],Jy.prototype,"actionDispatcher",void 0);Jy=l4([le()],Jy);var f4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},eQ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let zm=class extends Un{constructor(){super(...arguments);x(this,"actionDispatcher");x(this,"options")}singleQuickAction(t){if(!(t instanceof Ca||this.options.hideSensitiveInfo&&t instanceof m.GEdge))return{icon:N.InfoCircle,title:"Information (I)",location:"Left",sorting:"B",action:Hm.create({elementId:t.id,markers:this.markers(t),title:this.name(t),text:m.hasArgs(t)&&t.args?m.GArgument.getString(t,"desc"):"",info:this.info(t)}),letQuickActionsOpen:!0,readonlySupport:!0,shortcut:"KeyI"}}info(t){return m.hasArgs(t)&&t.args?t.args.info:void 0}name(t){var r;let i="";m.isWithEditableLabel(t)&&t.editableLabel&&(i=(r=t.editableLabel)==null?void 0:r.text);const o=this.nameAddition(t);return o&&(i+=o),i.length>0?i.trim():void 0}nameAddition(t){if(m.hasArgs(t)&&t.args){const i=m.GArgument.getString(t,"varName");if(i)return` [${i}]`;const o=m.GArgument.getString(t,"outerElement");if(o)return` [${o}]`}}markers(t){return t instanceof m.GChildElement?t.children.filter(i=>i instanceof m.GIssueMarker).map(i=>i):[]}};f4([be(m.TYPES.IActionDispatcher),eQ("design:type",m.GLSPActionDispatcher)],zm.prototype,"actionDispatcher",void 0);f4([be(Ve.IvyViewerOptions),eQ("design:type",Object)],zm.prototype,"options",void 0);zm=f4([le()],zm);var ARe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},BL;let Ef=BL=class{theme(){return document.documentElement.dataset.theme??BL.prefsColorScheme()}handle(e){if(Dm.is(e)){const t=document.documentElement;t.dataset.theme=e.theme,t.classList.remove("light","dark"),t.classList.add(e.theme)}}static prefsColorScheme(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}};Ef=BL=ARe([le()],Ef);var e0;(function(n){n.KIND="showToolBarOptionsMenu";function e(i){return{kind:n.KIND,id:"options_menu",...i}}n.create=e;function t(i){return m.Action.hasKind(i,n.KIND)}n.is=t})(e0||(e0={}));var yM=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},h4=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},yi;(function(n){n.Left="left",n.Middle="middle",n.Right="right"})(yi||(yi={}));function RRe(n,e){const t=n.sorting.localeCompare(e.sorting);return t!==0?t:n.title.localeCompare(e.title)}const MRe={icon:N.SelectionTool,title:"Selection Tool",sorting:"A",action:()=>m.EnableDefaultToolsAction.create(),id:"btn_default_tools",location:yi.Left,readonly:!0,switchFocus:!0},IRe={icon:N.MultiSelection,title:"Marquee Tool (Shift)",sorting:"B",action:()=>m.EnableToolsAction.create([m.MarqueeMouseTool.ID]),id:"btn_marquee_tools",location:yi.Left,readonly:!0,switchFocus:!0},TRe={icon:N.Undo,title:"Undo",sorting:"C",action:()=>m.UndoAction.create(),id:"btn_undo_tools",location:yi.Left},DRe={icon:N.Redo,title:"Redo",sorting:"D",action:()=>m.RedoAction.create(),id:"btn_redo_tools",location:yi.Left};let Gm=class{constructor(){x(this,"customIconHandler");x(this,"gridManager");x(this,"switchThemeHandler")}button(){const e=()=>this.customIconHandler.isShowCustomIcons,t=()=>this.gridManager.isGridVisible,i=this.switchThemeHandler?()=>this.switchThemeHandler.theme():void 0;return{icon:N.Settings,title:"Settings",sorting:"Y",action:()=>e0.create({customIconState:e,grid:t,theme:i}),id:"btn_options_menu",location:yi.Right,readonly:!0,switchFocus:!0}}};yM([be(kr),h4("design:type",kr)],Gm.prototype,"customIconHandler",void 0);yM([be(m.TYPES.IGridManager),h4("design:type",Object)],Gm.prototype,"gridManager",void 0);yM([be(Ef),Wm(),h4("design:type",Ef)],Gm.prototype,"switchThemeHandler",void 0);Gm=yM([le()],Gm);class ORe{constructor(e=N.DarkMode,t="Darkmode",i=o=>Dm.create({theme:o?"dark":"light"})){x(this,"icon");x(this,"label");x(this,"action");this.icon=e,this.label=t,this.action=i}}class LRe{constructor(e=N.GridDots,t="Grid",i=o=>m.ShowGridAction.create({show:o})){x(this,"icon");x(this,"label");x(this,"action");this.icon=e,this.label=t,this.action=i}}class jRe{constructor(e=N.CustomImage,t="Custom Icon",i=o=>Gy.create({showCustomIcons:o})){x(this,"icon");x(this,"label");x(this,"action");this.icon=e,this.label=t,this.action=i}}class NRe{constructor(e,t){x(this,"actionDispatcher");x(this,"showAction");x(this,"bodyDiv");this.actionDispatcher=e,this.showAction=t}create(e){this.bodyDiv=Ce("div",["tool-bar-options-menu"]),e.appendChild(this.bodyDiv),this.bodyDiv.appendChild(this.createHeader()),this.bodyDiv.appendChild(this.createOptions());const t=document.querySelector("#btn_options_menu");if(t){const i=e.offsetWidth,o=t.offsetLeft+t.offsetWidth/2;this.bodyDiv.style.setProperty("--menu-arrow-pos",`${i-o-15}px`)}return this.bodyDiv}createHeader(){const e=Ce("div",["tool-bar-options-header"]);e.appendChild(Or(N.Settings));const t=document.createElement("label");return t.textContent="Options",e.appendChild(t),e}createOptions(){const e=Ce("div",["tool-bar-options"]);return this.showAction.theme&&e.appendChild(this.createOption(new ORe,this.showAction.theme()==="dark")),e.appendChild(this.createOption(new LRe,this.showAction.grid())),e.appendChild(this.createOption(new jRe,this.showAction.customIconState())),e}createOption(e,t){const i=Ce("div",["tool-bar-option"]);i.appendChild(Or(e.icon));const o=document.createElement("label");o.textContent=e.label,i.appendChild(o);const r=new nRe(t,s=>this.actionDispatcher.dispatch(e.action(s)));return i.appendChild(r.create()),o.onclick=s=>r.switch(),i}remove(){var e;(e=this.bodyDiv)==null||e.remove()}}var Ps;(function(n){n.KIND="showToolBarMenu";function e(i){return{kind:n.KIND,...i}}n.create=e;function t(i){return m.Action.hasKind(i,n.KIND)}n.is=t})(Ps||(Ps={}));class BRe extends Qy{constructor(t,i,o){super(t,i,o);x(this,"actionDispatcher");x(this,"action");x(this,"paletteItems");x(this,"menuCssClass",["bar-menu","tool-bar-menu"]);this.actionDispatcher=t,this.action=i,this.paletteItems=o}toolButtonOnClick(t){return this.action.actions(t)}}var mh=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},Zd=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},$Re=function(n,e){return function(t,i){e(t,i,n)}},Wv;const WV="clicked";var Dl;let Zn=(Dl=class extends m.GLSPAbstractUIExtension{constructor(){super(...arguments);x(this,"actionDispatcher");x(this,"selectionService");x(this,"editorContext");x(this,"toolBarButtonProvider");x(this,"lastActivebutton");x(this,"defaultToolsButton");x(this,"toggleCustomIconsButton");x(this,"verticalAlignButton");x(this,"lastMenuAction");x(this,"toolBarMenu");x(this,"toDisposeOnDisable",new m.DisposableCollection);x(this,"toDisposeOnHide",new m.DisposableCollection)}id(){return Wv.ID}init(){this.toDisposeOnDisable.push(this.editorContext.onEditModeChanged(t=>this.editModeChanged(t.oldValue,t.newValue)))}containerClass(){return Wv.ID}initializeContents(t){this.createHeader(),this.lastActivebutton=this.defaultToolsButton,t.onwheel=i=>i.ctrlKey?i.preventDefault():!0}onBeforeShow(t,i){this.toDisposeOnHide.push(this.selectionService.onSelectionChanged(o=>this.selectionChanged(o.root,o.selectedElements)))}hide(){super.hide(),this.toDisposeOnHide.dispose()}createHeader(){const t=Ce("div",["tool-bar-header"]);t.appendChild(this.createLeftButtons()),t.appendChild(this.createMiddleButtons()),t.appendChild(this.createRightButtons()),this.containerElement.innerHTML="",this.containerElement.appendChild(t),this.changeActiveButton()}createLeftButtons(){const t=Ce("div",["left-buttons"]);if(this.defaultToolsButton=this.createToolButton(MRe),t.appendChild(this.defaultToolsButton),t.appendChild(this.createToolButton(IRe)),!this.editorContext.isReadonly){const i=Ce("div",["edit-buttons"]);i.appendChild(this.createToolButton(TRe)),i.appendChild(this.createToolButton(DRe)),t.appendChild(i)}return t}createMiddleButtons(){const t=Ce("div",["middle-buttons"]);return this.appendProvidedButtons(t,yi.Middle),t}createRightButtons(){const t=Ce("div",["right-buttons"]);return this.appendProvidedButtons(t,yi.Right),t}appendProvidedButtons(t,i){this.toolBarButtonProvider.map(o=>o.button()).filter(m.isNotUndefined).filter(o=>o.location===i).filter(o=>!this.editorContext.isReadonly||o.readonly).sort(RRe).forEach(o=>t.appendChild(this.createToolButton(o)))}createToolButton(t){const i=Ce("button",["tool-bar-button"]);return i.appendChild(Or(t.icon)),i.title=t.title,t.id&&(i.id=t.id),i.onclick=o=>{this.dispatchAction([t.action()]),t.switchFocus&&this.changeActiveButton(i)},this.createTitleToolButton(i,t)}createTitleToolButton(t,i){if(i.showTitle){const o=Ce("span",["tool-bar-title-button"]),r=document.createElement("label");return r.textContent=i.title,i.isNotMenu||t.appendChild(Or(N.Chevron)),o.appendChild(r),o.appendChild(t),o}return t}dispatchAction(t){this.actionDispatcher.dispatchAll(t.concat(m.SelectAllAction.create(!1)))}handle(t){if(m.EnableToolPaletteAction.is(t))return m.SetUIExtensionVisibilityAction.create({extensionId:Wv.ID,visible:!0});m.EnableDefaultToolsAction.is(t)&&(this.changeActiveButton(),this.restoreFocus()),e0.is(t)&&this.toggleOptionsMenu(t),Ps.is(t)&&this.toggleToolBarMenu(t),Sa.is(t)&&this.containerElement&&this.createHeader()}async toggleToolBarMenu(t){const i=await t.paletteItems();if(i.length!==0&&t.id!==this.lastMenuAction){this.toolBarMenu=new BRe(this.actionDispatcher,t,i);const o=this.toolBarMenu.create(this.containerElement);if(this.lastActivebutton){const r=o.offsetLeft+o.offsetWidth,s=this.lastActivebutton.offsetLeft+this.lastActivebutton.offsetWidth/2;o.style.setProperty("--menu-arrow-pos",`${r-s-6}px`)}this.setLastMenuAction(t.id)}else this.changeActiveButton(),this.setLastMenuAction(void 0)}toggleOptionsMenu(t){t.id!==this.lastMenuAction?(this.toolBarMenu=new NRe(this.actionDispatcher,t),this.toolBarMenu.create(this.containerElement),this.setLastMenuAction(t.id)):(this.changeActiveButton(),this.setLastMenuAction(void 0))}setLastMenuAction(t){this.lastMenuAction=t}changeActiveButton(t){var o;(o=this.lastActivebutton)==null||o.classList.remove(WV);let i=this.defaultToolsButton;t&&(i=t),i==null||i.classList.add(WV),this.lastActivebutton=i,this.hideMenus()}hideMenus(){var t;(t=this.toolBarMenu)==null||t.remove(),this.toolBarMenu=void 0}editModeChanged(t,i){this.containerElement&&this.createHeader()}selectionChanged(t,i){}disable(){this.toDisposeOnDisable.dispose()}},Wv=Dl,x(Dl,"ID","ivy-tool-bar"),Dl);mh([be(m.TYPES.IActionDispatcher),Zd("design:type",m.GLSPActionDispatcher)],Zn.prototype,"actionDispatcher",void 0);mh([be(m.SelectionService),Zd("design:type",m.SelectionService)],Zn.prototype,"selectionService",void 0);mh([be(m.EditorContextService),Zd("design:type",m.EditorContextService)],Zn.prototype,"editorContext",void 0);mh([w6(Ve.ToolBarButtonProvider),Zd("design:type",Array)],Zn.prototype,"toolBarButtonProvider",void 0);mh([qw(),Zd("design:type",Function),Zd("design:paramtypes",[]),Zd("design:returntype",void 0)],Zn.prototype,"init",null);Zn=Wv=mh([le()],Zn);let $L=class extends m.MouseListener{constructor(t){super();x(this,"toolBar");this.toolBar=t}mouseDown(t,i){return this.toolBar.changeActiveButton(),this.toolBar.setLastMenuAction(),[]}};$L=mh([le(),$Re(0,be(Zn)),Zd("design:paramtypes",[Zn])],$L);var tQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},kRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let $c=class{constructor(){x(this,"actionDispatcher");x(this,"paletteItems",[]);x(this,"extensionItems")}getPaletteItems(){return this.paletteItems}async getExtensionItems(){return this.extensionItems||(this.extensionItems=new Promise(e=>{this.actionDispatcher.request(m.RequestContextActions.create({contextId:"ivy-tool-extensions-palette",editorContext:{selectedElementIds:[]}})).then(t=>{m.SetContextActions.is(t)&&e(t.actions.map(i=>i))})})),this.extensionItems}handle(e){Sa.is(e)&&this.updateElementPalette()}async updateElementPalette(){this.actionDispatcher.request(m.RequestContextActions.create({contextId:Zn.ID,editorContext:{selectedElementIds:[]}})).then(e=>{m.SetContextActions.is(e)&&(this.paletteItems=e.actions.map(t=>t))})}};tQ([be(m.TYPES.IActionDispatcher),kRe("design:type",m.GLSPActionDispatcher)],$c.prototype,"actionDispatcher",void 0);$c=tQ([le()],$c);var cS=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},FRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};class dS extends Un{constructor(){super(...arguments);x(this,"paletteHandler");x(this,"element");x(this,"actions",(t,i)=>[m.SetUIExtensionVisibilityAction.create({extensionId:Bt.ID,visible:!1}),...t.actions.map(o=>xRe(o,i[0])).filter(m.isNotUndefined)])}singleQuickAction(t){if(this.element=t,!(!m.isConnectable(t)||!t.canConnect(new m.GEdge,"source")||t.type===ge.COMMENT))return this.quickAction()}hasOutgoingEdges(){return this.element instanceof m.GConnectableElement&&Array.from(this.element.outgoingEdges).length>0}paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(t=>!this.filterPaletteGroups().includes(t.id))}filterPaletteGroups(){const t=["event-start-group","swimlane-group"];return this.hasOutgoingEdges()&&t.push("event-end-group"),t}quickActionItem(){return{id:"",actions:[],label:"",sortString:""}}quickAction(){const t=this.quickActionItem();return{icon:t.icon,title:`${t.label} (A)`,location:"Right",sorting:t.sortString,action:Cs.create({elementIds:[this.element.id],paletteItems:this.paletteItems(),actions:this.actions}),readonlySupport:!1,letQuickActionsOpen:!0}}}cS([be($c),FRe("design:type",$c)],dS.prototype,"paletteHandler",void 0);let kL=class extends dS{paletteItems(){return()=>{const e=this.paletteHandler.getPaletteItems().filter(i=>this.filterPaletteGroups().includes(i.id)),t=HRe(this.element);return t&&e.push(t),e}}filterPaletteGroups(){const e=["event-intermediate-group"];return this.hasOutgoingEdges()||e.push("event-end-group"),e}quickActionItem(){return{label:"Events",icon:N.Start,sortString:"A",id:"",actions:[]}}};kL=cS([le()],kL);let FL=class extends dS{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(e=>e.id==="gateway-group")}quickActionItem(){return{label:"Gateways",icon:N.GatewaysGroup,sortString:"B",id:"",actions:[]}}};FL=cS([le()],FL);let xL=class extends dS{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(e=>e.id==="activity-group"||e.id==="interface-activity-group"||e.id==="bpmn-activity-group")}quickActionItem(){return{label:"Activities",icon:N.ActivitiesGroup,sortString:"C",id:"",actions:[]}}};xL=cS([le()],xL);let HL=class extends dS{quickAction(){return{icon:N.Task,title:"Create Node",location:"Hidden",sorting:"Z",action:Cs.create({elementIds:[this.element.id],paletteItems:this.paletteItems(),actions:this.actions,showSearch:!0}),letQuickActionsOpen:!0,readonlySupport:!1,shortcut:"KeyA"}}};HL=cS([le()],HL);function xRe(n,e){if(m.TriggerNodeCreationAction.is(n))return m.CreateNodeOperation.create(n.elementTypeId,{args:{previousElementId:e}});if(Vy.is(n))return n}function HRe(n){const e=[];if(wAe(n)&&e.push({id:"error-boundary",label:"Error Boundary",sortString:"A",actions:[Vy.create({elementId:n.id,eventKind:"error"})],icon:Ea.BOUNDARY_ERROR}),AAe(n)&&e.push({id:"signal-boundary",label:"Signal Boundary",sortString:"B",actions:[Vy.create({elementId:n.id,eventKind:"signal"})],icon:Ea.BOUNDARY_SIGNAL}),e.length!==0)return{id:"boundary-group",label:"Boundary Events",sortString:"Z",actions:[],children:e}}var nQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},KRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let xl=class{constructor(){x(this,"actionDispatcher");x(this,"paletteItems",[])}getPaletteItems(){return this.paletteItems}handle(e){Sa.is(e)&&this.updateActivityTypePalette()}async updateActivityTypePalette(){this.actionDispatcher.request(m.RequestContextActions.create({contextId:"ivy-tool-activity-type-palette",editorContext:{selectedElementIds:[]}})).then(e=>{m.SetContextActions.is(e)&&(this.paletteItems=e.actions.map(t=>t))})}};nQ([be(m.TYPES.IActionDispatcher),KRe("design:type",m.GLSPActionDispatcher)],xl.prototype,"actionDispatcher",void 0);xl=nQ([le()],xl);var p4=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},iQ=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let t0=class extends Un{constructor(){super(...arguments);x(this,"types");x(this,"actionDispatcher");x(this,"actions",(t,i)=>[nL.create({elementId:i[0],typeId:t.id}),Cs.empty()])}singleQuickAction(t){if(wZ(t))return{icon:N.ChangeType,title:"Select Activity Type",location:"Middle",sorting:"Y",action:Cs.create({elementIds:[t.id],paletteItems:()=>this.types.getPaletteItems(),actions:this.actions,customCssClass:"activity-type-menu"}),letQuickActionsOpen:!0,readonlySupport:!1}}};p4([be(Ve.ActivityTypesPalette),iQ("design:type",xl)],t0.prototype,"types",void 0);p4([be(m.TYPES.IActionDispatcher),iQ("design:type",m.GLSPActionDispatcher)],t0.prototype,"actionDispatcher",void 0);t0=p4([le()],t0);const oQ=new m.FeatureModule((n,e,t)=>{m.bindAsService(n,m.TYPES.IUIExtension,Bt),m.configureActionHandler({bind:n,isBound:t},Cs.KIND,Bt),m.configureActionHandler({bind:n,isBound:t},Hm.KIND,Bt),m.configureActionHandler({bind:n,isBound:t},m.RemoveMarqueeAction.KIND,Bt),VRe({bind:n,isBound:t}),zRe({bind:n}),GRe({bind:n,isBound:t}),URe({bind:n,isBound:t})});function VRe(n){n.bind(Lp).toSelf().inSingletonScope(),n.bind(m.TYPES.ITool).toService(Lp),m.configureActionHandler(n,jm.KIND,Lp)}function zRe(n){n.bind(Ve.QuickActionProvider).to(sL),n.bind(Ve.QuickActionProvider).to(zm),n.bind(Ve.QuickActionProvider).to(dL),n.bind(Ve.QuickActionProvider).to(aL),n.bind(Ve.QuickActionProvider).to(kL),n.bind(Ve.QuickActionProvider).to(FL),n.bind(Ve.QuickActionProvider).to(xL),n.bind(Ve.QuickActionProvider).to(HL)}function GRe(n){n.bind($d).toSelf().inSingletonScope(),n.bind(Ve.ColorPalette).toService($d),m.configureActionHandler(n,Sa.KIND,$d),m.configureActionHandler(n,Sw.KIND,$d),n.bind(Ve.QuickActionProvider).to(Jy)}function URe(n){n.bind(xl).toSelf().inSingletonScope(),n.bind(Ve.ActivityTypesPalette).toService(xl),m.configureActionHandler(n,Sa.KIND,xl),n.bind(Ve.QuickActionProvider).to(t0)}var Ku=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},YRe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let kc=class{constructor(){x(this,"paletteHandler");x(this,"actions",e=>[Ps.create({id:"",paletteItems:()=>[],actions:t=>[]}),...e.actions])}button(){return this.createToolBarButton(this.paletteItems())}paletteItems(){return()=>this.paletteHandler.getPaletteItems()}};Ku([be($c),YRe("design:type",$c)],kc.prototype,"paletteHandler",void 0);kc=Ku([le()],kc);let KL=class extends kc{createToolBarButton(e){const t="all_elements_menu";return{icon:N.Task,title:"All Elements",sorting:"A",action:()=>Ps.create({id:t,paletteItems:e,actions:this.actions,showSearch:!0}),id:`btn_${t}`,location:yi.Middle,switchFocus:!0,showTitle:!0}}};KL=Ku([le()],KL);let VL=class extends kc{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(e=>e.id.match(/event-[a-z]+-group/))}createToolBarButton(e){const t="events_menu";return{icon:N.Start,title:"Events",sorting:"B",action:()=>Ps.create({id:t,paletteItems:e,actions:this.actions}),id:`btn_${t}`,location:yi.Middle,switchFocus:!0,showTitle:!0}}};VL=Ku([le()],VL);let zL=class extends kc{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(e=>e.id==="gateway-group")}createToolBarButton(e){const t="gateways_menu";return{icon:N.GatewaysGroup,title:"Gateways",sorting:"C",action:()=>Ps.create({id:t,paletteItems:e,actions:this.actions}),id:`btn_${t}`,location:yi.Middle,switchFocus:!0,showTitle:!0}}};zL=Ku([le()],zL);let GL=class extends kc{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(e=>e.id==="activity-group"||e.id==="interface-activity-group"||e.id==="bpmn-activity-group")}createToolBarButton(e){const t="activities_menu";return{icon:N.ActivitiesGroup,title:"Activities",sorting:"D",action:()=>Ps.create({id:t,paletteItems:e,actions:this.actions}),id:`btn_${t}`,location:yi.Middle,switchFocus:!0,showTitle:!0}}};GL=Ku([le()],GL);let UL=class extends kc{paletteItems(){return()=>this.paletteHandler.getPaletteItems().filter(e=>e.id==="swimlane-group"||e.id==="annotation-group")}createToolBarButton(e){const t="artifacts_menu";return{icon:N.PoolSwimlanes,title:"Artifacts",sorting:"E",action:()=>Ps.create({id:t,paletteItems:e,actions:this.actions}),id:`btn_${t}`,location:yi.Middle,switchFocus:!0,showTitle:!0}}};UL=Ku([le()],UL);let YL=class extends kc{createToolBarButton(e){const t="extensions_menu";return{icon:N.Extension,title:"Extensions",sorting:"F",action:()=>Ps.create({id:t,paletteItems:()=>this.paletteHandler.getExtensionItems(),actions:this.actions,showSearch:!0,customCssClass:"menu-as-list"}),id:`btn_${t}`,location:yi.Middle,switchFocus:!0,showTitle:!0}}};YL=Ku([le()],YL);const rQ=new m.FeatureModule((n,e,t)=>{const i={bind:n,isBound:t};m.bindAsService(i,Ve.ToolBar,Zn),n(m.TYPES.IUIExtension).toService(Zn),m.configureActionHandler(i,m.EnableToolPaletteAction.KIND,Zn),m.configureActionHandler(i,Ps.KIND,Zn),m.configureActionHandler(i,e0.KIND,Zn),qRe(i),m.bindAsService(i,m.TYPES.MouseListener,$L),n(kr).toSelf().inSingletonScope(),m.configureActionHandler(i,Gy.KIND,kr),m.configureActionHandler(i,m.EnableDefaultToolsAction.KIND,Zn),m.configureActionHandler(i,Sa.KIND,Zn)},{featureId:m.toolPaletteModule.featureId});function qRe(n){n.bind($c).toSelf().inSingletonScope(),m.configureActionHandler(n,Sa.KIND,$c),n.bind(Ve.ToolBarButtonProvider).to(KL),n.bind(Ve.ToolBarButtonProvider).to(VL),n.bind(Ve.ToolBarButtonProvider).to(zL),n.bind(Ve.ToolBarButtonProvider).to(GL),n.bind(Ve.ToolBarButtonProvider).to(UL),n.bind(Ve.ToolBarButtonProvider).to(YL),n.bind(Ve.ToolBarButtonProvider).to(Gm)}var bM=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},C_=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let Qd=class extends m.GLSPScrollMouseListener{constructor(){super(...arguments);x(this,"quickActionUi");x(this,"mouseTool")}init(){this.mouseTool.registerListener(this)}mouseDown(t,i){return m.findParentByFeature(t,m.toTypeGuard(m.GResizeHandle))?[]:super.mouseDown(t,i)}mouseMove(t,i){const o=super.mouseMove(t,i);return this.lastScrollPosition&&this.quickActionUi.hideUi(),o}mouseUp(t,i){return this.lastScrollPosition&&this.quickActionUi.showUi(),super.mouseUp(t,i)}wheel(t,i){if(m.isCtrlOrCmd(i))return[];const o=m.findParentByFeature(t,m.isViewport),r={x:i.pageX,y:i.pageY};return i.shiftKey?r.x+=i.deltaY!==0?i.deltaY:i.deltaX:(r.x+=i.deltaX,r.y+=i.deltaY),o?this.dragCanvas(o,i,r):[]}};bM([be(Bt),C_("design:type",Bt)],Qd.prototype,"quickActionUi",void 0);bM([be(m.GLSPMouseTool),C_("design:type",m.GLSPMouseTool)],Qd.prototype,"mouseTool",void 0);bM([qw(),C_("design:type",Function),C_("design:paramtypes",[]),C_("design:returntype",void 0)],Qd.prototype,"init",null);Qd=bM([le()],Qd);class WRe{constructor(e,t=N.Center,i="centerBtn",o="Center",r=()=>m.CenterAction.create(e())){x(this,"elementIds");x(this,"icon");x(this,"id");x(this,"title");x(this,"action");this.elementIds=e,this.icon=t,this.id=i,this.title=o,this.action=r}}class ZRe{constructor(e=N.WindowMinimize,t="originBtn",i="Origin screen",o=()=>ww.create()){x(this,"icon");x(this,"id");x(this,"title");x(this,"action");this.icon=e,this.id=t,this.title=i,this.action=o}}class QRe{constructor(e=N.FitToScreen,t="fitToScreenBtn",i="Fit to screen",o=()=>m.FitToScreenAction.create([],{padding:10})){x(this,"icon");x(this,"id");x(this,"title");x(this,"action");this.icon=e,this.id=t,this.title=i,this.action=o}}var uS=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},SM=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},Zv,Ol;let Js=(Ol=class extends m.GLSPAbstractUIExtension{constructor(){super(...arguments);x(this,"actionDispatcher");x(this,"toolManager");x(this,"editorContext");x(this,"selectionService");x(this,"zoomLevel","100%");x(this,"zoomLevelElement")}id(){return Zv.ID}containerClass(){return Zv.ID}initializeContents(t){this.createBar(),t.onwheel=i=>i.ctrlKey?i.preventDefault():!0}createBar(){const t=Ce("div",["viewport-bar"]);t.appendChild(this.createViewportTools()),this.containerElement.appendChild(t)}createViewportTools(){const t=Ce("div",["viewport-bar-tools"]);return t.appendChild(this.createViewportButton(new ZRe)),t.appendChild(this.createViewportButton(new QRe)),t.appendChild(this.createViewportButton(new WRe(()=>[...this.selectionService.getSelectedElementIDs()]))),this.zoomLevelElement=document.createElement("label"),this.zoomLevelElement.textContent=this.zoomLevel,t.appendChild(this.zoomLevelElement),t}createViewportButton(t){const i=Ce("button");return i.appendChild(Or(t.icon)),i.id=t.id,i.title=t.title,i.onclick=()=>this.actionDispatcher.dispatch(t.action()).then(()=>{const o=this.editorContext.modelRoot;m.isViewport(o)&&this.actionDispatcher.dispatchAll([m.SetUIExtensionVisibilityAction.create({extensionId:Bt.ID,visible:!0,contextElementsId:[...this.selectionService.getSelectedElementIDs()]}),m.SetViewportAction.create(o.id,o,{})])}),i}handle(t){Yy.is(t)&&this.actionDispatcher.dispatch(m.SetUIExtensionVisibilityAction.create({extensionId:Zv.ID,visible:!0})),m.SetViewportAction.is(t)?this.updateZoomLevel(t.newViewport.zoom):Om.is(t)&&this.updateZoomLevel(t.zoom)}updateZoomLevel(t){this.zoomLevel=(t*100).toFixed(0).toString()+"%",this.zoomLevelElement&&(this.zoomLevelElement.textContent=this.zoomLevel)}},Zv=Ol,x(Ol,"ID","ivy-viewport-bar"),Ol);uS([be(m.TYPES.IActionDispatcher),SM("design:type",m.GLSPActionDispatcher)],Js.prototype,"actionDispatcher",void 0);uS([be(m.TYPES.IToolManager),SM("design:type",Object)],Js.prototype,"toolManager",void 0);uS([be(m.EditorContextService),SM("design:type",m.EditorContextService)],Js.prototype,"editorContext",void 0);uS([be(m.SelectionService),SM("design:type",m.SelectionService)],Js.prototype,"selectionService",void 0);Js=Zv=uS([le()],Js);var $1=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},lS=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},EM=function(n,e){return function(t,i){e(t,i,n)}},wD;let qL=(wD=class extends m.BoundsAwareViewportCommand{constructor(t){super(t.animate);x(this,"action");this.action=t}getElementIds(){return[]}initialize(t){if(!m.isViewport(t))return;this.oldViewport={scroll:t.scroll,zoom:t.zoom};const i=this.getNewViewport(m.Bounds.EMPTY,t);if(i){const{zoomLimits:o,horizontalScrollLimits:r,verticalScrollLimits:s}=this.viewerOptions;this.newViewport=m.limitViewport(i,t.canvasBounds,r,s,o)}}getNewViewport(t,i){return{zoom:1,scroll:{x:0,y:0}}}},x(wD,"KIND",ww.KIND),wD);qL=$1([le(),EM(0,be(m.TYPES.Action)),lS("design:paramtypes",[Object])],qL);function $w(n){return!!n&&m.isBoundsAware(n)&&!(n instanceof Hu)}function sQ(n){return m.isSelected(n)&&m.isBoundsAware(n)&&!(n instanceof Hu)}var AD;let WL=(AD=class extends m.FitToScreenCommand{constructor(t){super(t);x(this,"action");this.action=t}getNewViewport(t,i){if(!m.Dimension.isValid(i.canvasBounds))return;const o=m.Bounds.center(t),r=this.action.padding===void 0?0:2*this.action.padding,s=this.toolBarHeight();let a=Math.min(i.canvasBounds.width/(t.width+r),(i.canvasBounds.height-s)/(t.height+r));return this.action.maxZoom!==void 0&&(a=Math.min(a,this.action.maxZoom)),a===1/0&&(a=1),{scroll:{x:o.x-.5*i.canvasBounds.width/a,y:o.y-.5*(i.canvasBounds.height+s)/a},zoom:a}}toolBarHeight(){const t=document.querySelector('[id$="_'+Zn.ID+'"]');return t?t.getBoundingClientRect().height:0}initialize(t){if(m.isViewport(t)){this.oldViewport={scroll:t.scroll,zoom:t.zoom};const i=[];m.getElements(t.index,this.getElementIds(),$w).forEach(r=>i.push(this.boundsInViewport(r,r.bounds,t))),i.length===0&&m.forEachElement(t.index,sQ,r=>i.push(this.boundsInViewport(r,r.bounds,t))),i.length===0&&m.forEachElement(t.index,$w,r=>i.push(this.boundsInViewport(r,r.bounds,t)));const o=i.reduce((r,s)=>m.Bounds.combine(r,s),m.Bounds.EMPTY);if(m.Dimension.isValid(o)){const r=this.getNewViewport(o,t);if(r){const{zoomLimits:s,horizontalScrollLimits:a,verticalScrollLimits:u}=this.viewerOptions;this.newViewport=m.limitViewport(r,t.canvasBounds,a,u,s)}}}}},x(AD,"KIND",m.FitToScreenAction.KIND),AD);WL=$1([le(),EM(0,be(m.TYPES.Action)),lS("design:paramtypes",[Object])],WL);let kw=class extends m.CenterCommand{constructor(){super(...arguments);x(this,"selectionService")}getNewViewport(t,i){if(m.Dimension.isValid(i.canvasBounds))return super.getNewViewport(t,i)}initialize(t){if(!m.isViewport(t))return;this.oldViewport={scroll:t.scroll,zoom:t.zoom};const i=[];m.getElements(t.index,this.getElementIds(),$w).forEach(r=>i.push(this.boundsInViewport(r,r.bounds,t))),i.length===0&&m.forEachElement(t.index,sQ,r=>i.push(this.boundsInViewport(r,r.bounds,t))),i.length===0&&m.forEachElement(t.index,$w,r=>i.push(this.boundsInViewport(r,r.bounds,t)));const o=i.reduce((r,s)=>m.Bounds.combine(r,s),m.Bounds.EMPTY);if(m.Dimension.isValid(o)){const r=this.getNewViewport(o,t);if(r){const{zoomLimits:s,horizontalScrollLimits:a,verticalScrollLimits:u}=this.viewerOptions;this.newViewport=m.limitViewport(r,t.canvasBounds,a,u,s)}}}};$1([be(m.SelectionService),lS("design:type",m.SelectionService)],kw.prototype,"selectionService",void 0);kw=$1([le()],kw);var RD;let ZL=(RD=class extends m.BoundsAwareViewportCommand{constructor(t){super(t.animate);x(this,"action");this.action=t}getElementIds(){return this.action.elementIds}getNewViewport(t,i){if(m.Dimension.isValid(i.canvasBounds))return XRe(i.canvasBounds,m.isViewport(i)?i.scroll:m.Point.ORIGIN,m.Bounds.center(t),this.action.retainZoom&&m.isViewport(i)?i.zoom:1)}},x(RD,"KIND",qy.KIND),RD);ZL=$1([le(),EM(0,be(m.TYPES.Action)),lS("design:paramtypes",[Object])],ZL);function XRe(n,e,t,i){return{scroll:{x:ZV(n.width,e.x,t.x,i),y:ZV(n.height,e.y,t.y,i)},zoom:i}}function ZV(n,e,t,i){const o=t-e;return o>n||o<0?t-.5*n/i:e}var MD;let QL=(MD=class extends m.Command{constructor(t){super();x(this,"action");this.action=t}execute(t){const i=t.root;return m.isViewport(i)&&(i.zoom=this.action.zoom),i}undo(t){return t.logger.error(this,"Cannot undo a ivy viewport zoom command"),t.root}redo(t){return t.logger.error(this,"Cannot redo a ivy viewport zoom command"),t.root}},x(MD,"KIND",Om.KIND),MD);QL=$1([le(),EM(0,be(m.TYPES.Action)),lS("design:paramtypes",[Object])],QL);var JRe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let XL=class extends m.ZoomMouseListener{wheel(e,t){return m.isCtrlOrCmd(t)?super.wheel(e,t):[]}getZoomFactor(e){return e.deltaMode===e.DOM_DELTA_PAGE?Math.exp(-e.deltaY*.5):e.deltaMode===e.DOM_DELTA_LINE?Math.exp(-e.deltaY*.05):Math.exp(-e.deltaY*.003)}};XL=JRe([le()],XL);const eMe=new m.FeatureModule((n,e,t,i)=>{const o={bind:n,isBound:t,rebind:i};m.configureCommand(o,m.GetViewportCommand),m.configureCommand(o,m.SetViewportCommand),m.configureCommand(o,m.RepositionCommand),m.bindAsService(o,m.TYPES.IDiagramStartup,m.RestoreViewportHandler),m.configureActionHandler(o,m.EnableDefaultToolsAction.KIND,m.RestoreViewportHandler),m.configureActionHandler(o,m.FocusDomAction.KIND,m.RestoreViewportHandler),m.configureCommand(o,kw),m.configureCommand(o,WL),m.bindAsService(o,m.TYPES.MouseListener,XL),n(Qd).toSelf().inSingletonScope(),m.configureActionHandler(o,m.EnableToolsAction.KIND,Qd),m.configureActionHandler(o,m.EnableDefaultToolsAction.KIND,Qd),m.bindAsService(o,m.TYPES.IUIExtension,Js),m.configureActionHandler(o,Yy.KIND,Js),m.configureActionHandler(o,m.SetViewportAction.KIND,Js),m.configureActionHandler(o,Om.KIND,Js),m.configureCommand(o,qL),m.configureCommand(o,ZL),m.configureCommand(o,QL),m.bindAsService(o,m.TYPES.KeyListener,m.CenterKeyboardListener)},{featureId:m.viewportModule.featureId});var aQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let JL=class extends Un{singleQuickAction(e){if(wZ(e))return{icon:N.Unwrap,title:"Unwrap embedded subprocess (U)",location:"Middle",sorting:"B",action:oL.create({elementId:e.id}),shortcut:"KeyU"}}};JL=aQ([le()],JL);let e6=class{singleQuickAction(e){if(PAe(e))return this.quickAction([e.id])}multiQuickAction(e){const t=e.map(i=>i.id);if(t.length>0&&!e.find(i=>!CAe(i)))return this.quickAction(t)}quickAction(e){return{icon:N.WrapToSubprocess,title:"Wrap to embedded process (W)",location:"Middle",sorting:"B",action:iL.create({elementIds:e}),shortcut:"KeyW"}}};e6=aQ([le()],e6);const cQ=new m.FeatureModule(n=>{n(Ve.QuickActionProvider).to(JL),n(Ve.QuickActionProvider).to(e6)});var tMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},nMe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},iMe=function(n,e){return function(t,i){e(t,i,n)}};let t6=class extends m.BringToFrontCommand{constructor(t){super(t);x(this,"action");this.action=t}addToSelection(t){t instanceof Ca||this.selected.push({element:t,index:t.parent.children.indexOf(t)})}};t6=tMe([le(),iMe(0,be(m.TYPES.Action)),nMe("design:paramtypes",[Object])],t6);const oMe=new m.FeatureModule((n,e,t)=>{m.configureCommand({bind:n,isBound:t},t6)},{featureId:m.zorderModule.featureId});var rMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let n6=class extends m.MarqueeUtil{isMarkableNode(){return m.typeGuard(m.typeGuardOr(m.toTypeGuard(m.GNode),m.toTypeGuard(m.GLabel)),m.isSelectableAndBoundsAware)}getNodeBounds(e){return e instanceof pM?e.bounds:super.getNodeBounds(e)}};n6=rMe([le()],n6);function sMe(n,...e){const t=m.initializeDiagramContainer(new yz,{remove:[m.hoverModule,m.navigationModule,m.statusModule,m.contextMenuModule]},m.baseViewModule,m.helperLineModule,m.gridModule,{replace:eMe},{replace:OAe},{replace:oMe},{replace:rQ},{replace:NZ},{replace:BZ},{replace:QZ},{replace:CRe},{replace:PRe},QAe,oQ,cQ,iRe,YZ,yAe,eRe,CZ,UZ,vRe,...e);return m.bindOrRebind(t,m.TYPES.Grid).toConstantValue({x:8,y:8}),t.bind(Ve.IvyViewerOptions).toConstantValue(_Re()),t.bind(m.TYPES.IHelperLineOptions).toConstantValue({alignmentElementFilter:i=>!(i instanceof Ca)&&m.DEFAULT_ALIGNABLE_ELEMENT_FILTER(i)}),m.bindOrRebind(t,m.MarqueeUtil).to(n6).inSingletonScope(),m.bindOrRebind(t,m.TYPES.IMarqueeBehavior).toConstantValue({entireEdge:!0,entireElement:!0}),m.bindOrRebind(t,m.TYPES.ICommandStack).to(Nw).inSingletonScope(),m.bindOrRebind(t,m.TYPES.ILogger).to(m.ConsoleLogger).inSingletonScope(),m.bindOrRebind(t,m.TYPES.LogLevel).toConstantValue(m.LogLevel.warn),m.bindOrRebind(t,m.TYPES.ISnapper).to(m.GLSPCenterGridSnapper),m.overrideViewerOptions(t,{baseDiv:n,hiddenDiv:n+"_hidden"}),t}var aMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let i6=class extends Un{singleQuickAction(e){if(hL(e))return{icon:N.Bug,title:"Toggle Breakpoint (B)",location:"Left",sorting:"C",action:Y5.create({elementId:e.id}),letQuickActionsOpen:!0,readonlySupport:!0,shortcut:"KeyB"}}};i6=aMe([le()],i6);var dQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},cMe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)},dMe=function(n,e){return function(t,i){e(t,i,n)}},o6;(function(n){function e(t){return{kind:Fw.KIND,...t}}n.create=e})(o6||(o6={}));var ID;let Fw=(ID=class extends m.Command{constructor(t){super();x(this,"action");x(this,"showBreakpoints",[]);this.action=t}execute(t){var i;return(i=this.action.oldBreakpoints)==null||i.forEach(o=>{const r=t.root.index.getById(o.elementId);r instanceof m.GChildElement&&hL(r)&&pL(r)}),this.action.breakpoints.forEach(o=>{const r=t.root.index.getById(o.elementId);r instanceof m.GChildElement&&hL(r)&&this.showBreakpoints.push({element:r,condition:o.condition,disabled:o.disabled,globalDisabled:this.action.globalDisabled??!1})}),this.redo(t)}undo(t){for(const i of this.showBreakpoints)pL(i.element);return t.root}redo(t){for(const i of this.showBreakpoints)RAe(i.element,i.condition,i.disabled,i.globalDisabled);return t.root}},x(ID,"KIND","elementBreakpointFeedback"),ID);Fw=dQ([le(),dMe(0,be(m.TYPES.Action)),cMe("design:paramtypes",[Object])],Fw);let r6=class extends m.MouseListener{mouseUp(e,t){return e instanceof Nm?[q5.create({elementId:e.parent.id,disable:!e.disabled})]:[]}};r6=dQ([le()],r6);var uQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},uMe=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let n0=class{constructor(){x(this,"oldBreakpoints",[]);x(this,"feedbackDispatcher")}handle(e){if(bw.is(e)){const t=o6.create({breakpoints:e.elementBreakpoints,oldBreakpoints:this.oldBreakpoints,globalDisabled:e.globalDisabled});this.feedbackDispatcher.registerFeedback(this,[t]),this.oldBreakpoints=e.elementBreakpoints}}};uQ([be(m.TYPES.IFeedbackActionDispatcher),uMe("design:type",Object)],n0.prototype,"feedbackDispatcher",void 0);n0=uQ([le()],n0);var lMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};const qE={createElement:m.svg};let s6=class{render(e,t){var i;return m.isBoundsAware(e.parent)?qE.createElement("g",null,qE.createElement("circle",{"class-ivy-breakpoint-handle":!0,"class-disabled":e.disabled,"class-condition":((i=e.condition)==null?void 0:i.length)>0&&e.condition!=="true","class-mouseover":e.hoverFeedback,cx:-10,cy:9,r:4}),e.globalDisabled&&qE.createElement("line",{"class-ivy-breakpoint-handle-globaldisable":!0,x1:-15,y1:14,x2:-5,y2:4})):qE.createElement("g",null)}};s6=lMe([le()],s6);new m.FeatureModule((n,e,t)=>{n(n0).toSelf().inSingletonScope(),m.configureActionHandler({bind:n,isBound:t},bw.KIND,n0),m.configureCommand({bind:n,isBound:t},Fw),m.configureView({bind:n,isBound:t},Nm.TYPE,s6),n(Ve.QuickActionProvider).to(i6),n(m.TYPES.MouseListener).to(r6)});const fMe=new m.FeatureModule((n,e,t)=>{n(Ef).toSelf().inSingletonScope(),m.configureActionHandler({bind:n,isBound:t},Dm.KIND,Ef)});let hMe=class extends m.KeyListener{keyDown(e,t){return Gi(t,"KeyC")?[Ew.create()]:[]}};var pMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let a6=class{button(){return{icon:N.DatabaseLink,title:"Open Data Class (C)",sorting:"E",action:()=>Ew.create(),location:yi.Right,readonly:!0}}};a6=pMe([le()],a6);new m.FeatureModule(n=>{n(m.TYPES.KeyListener).to(hMe),n(Ve.ToolBarButtonProvider).to(a6)});function mMe(n){return n.hasFeature(m.openFeature)}var gMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let c6=class extends Un{singleQuickAction(e){if(mMe(e)&&e.type!==ge.COMMENT)return{icon:N.CustomImage,title:"Custom Icon",location:"Middle",sorting:"C",action:Q5.create(e.id)}}};c6=gMe([le()],c6);new m.FeatureModule(n=>{n(Ve.QuickActionProvider).to(c6)});class vMe extends m.KeyListener{keyDown(e,t){return Gi(t,"KeyF")?[Uy.create()]:[]}}var lQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r},_Me=function(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)};let xw=class{constructor(){x(this,"editorContext")}button(){try{if(m.hasArgs(this.editorContext.modelRoot)&&m.GArgument.getString(this.editorContext.modelRoot,"kind")==="html-dialog")return{icon:N.File,title:"Open Form Editor (F)",sorting:"F",action:()=>Uy.create(),location:yi.Right,readonly:!0}}catch(e){console.log("Couldn't load model root",e)}}};lQ([be(m.EditorContextService),_Me("design:type",m.EditorContextService)],xw.prototype,"editorContext",void 0);xw=lQ([le()],xw);var yMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let d6=class extends Un{singleQuickAction(e){if(WAe(e))return{icon:N.SubStart,title:"Open Form (J)",location:"Middle",sorting:"A",action:Uy.create({elementId:e.id}),readonlySupport:!0,shortcut:"KeyJ"}}};d6=yMe([le()],d6);new m.FeatureModule(n=>{n(m.TYPES.KeyListener).to(vMe),n(Ve.ToolBarButtonProvider).to(xw),n(Ve.QuickActionProvider).to(d6)});var bMe=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let u6=class extends Un{singleQuickAction(e){if(ZAe(e))return{icon:N.GoToSource,title:"Go To Source (S)",location:"Middle",sorting:"B",action:X5.create(e.id),readonlySupport:!0,shortcut:"KeyS"}}};u6=bMe([le()],u6);new m.FeatureModule(n=>{n(Ve.QuickActionProvider).to(u6)});var fQ=function(n,e,t,i){var o=arguments.length,r=o<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,t):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(n,e,t,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(r=(o<3?s(r):o>3?s(e,t,r):s(e,t))||r);return o>3&&r&&Object.defineProperty(e,t,r),r};let l6=class extends Un{singleQuickAction(e){if(e instanceof b_&&e.type===We.START){const t=m.GArgument.getString(e,"processStartUri")??"";return{icon:N.Play,title:"Start Process (X)",location:"Left",sorting:"A",action:eL.create(e.id,t),readonlySupport:!0,shortcut:"KeyX",removeSelection:!0}}}};l6=fQ([le()],l6);let f6=class extends Un{constructor(){super(...arguments);x(this,"supportedEventTypes",[We.START,We.START_ERROR,We.START_SUB,We.START_HD,We.START_HD_METHOD])}singleQuickAction(t){if(t instanceof b_&&this.isSearchViewAvailable(t.type))return{icon:N.Search,title:"Search callers of this process (O)",location:"Left",sorting:"B",action:tL.create(t.id),letQuickActionsOpen:!0,readonlySupport:!0,shortcut:"KeyO"}}isSearchViewAvailable(t){return this.supportedEventTypes.includes(t)}};f6=fQ([le()],f6);new m.FeatureModule(n=>{n(Ve.QuickActionProvider).to(l6),n(Ve.QuickActionProvider).to(f6)});class SMe extends m.BaseJsonrpcGLSPClient{error(e,...t){console.error(`[IvyJsonrpcGLSPClient] ${e}`,t),WZ({text:`${e}  (Click to reload)`,className:"severity-ERROR",duration:-1,close:!0,gravity:"bottom",position:"left",onClick:()=>window.location.reload()}).showToast()}handleConnectionError(e,t,i){this.error("Connection to server is erroring. Shutting down server.",e),this.stop(),this.state=m.ClientState.ServerError}handleConnectionClosed(){if(!(this.state===m.ClientState.Stopping||this.state===m.ClientState.Stopped)){try{this.resolvedConnection&&(this.resolvedConnection.dispose(),this.connectionPromise=void 0,this.resolvedConnection=void 0)}catch{}this.error("Connection to server got closed."),this.state=m.ClientState.ServerError}}}const EMe=new m.FeatureModule(n=>{n(m.TYPES.KeyListener).to(Xy),n(m.TYPES.KeyListener).to(Vm)});var CMe=Object.defineProperty,PMe=Object.getOwnPropertyDescriptor,wMe=(n,e,t,i)=>{for(var o=i>1?void 0:i?PMe(e,t):e,r=n.length-1,s;r>=0;r--)(s=n[r])&&(o=(i?s(e,t,o):s(o))||o);return i&&o&&CMe(e,t,o),o};let h6=class{handle(n){m.NavigateToExternalTargetAction.is(n)&&window.open(this.evaluateTargetUrl(n.target),"_self")}evaluateTargetUrl(n){const e=new URL(window.location.href);e.searchParams.set("pmv",this.evaluatePmv(n));const t=this.getArg(n,"processPid");if(t)e.searchParams.set("pid",t),e.searchParams.delete("file");else{const o=n.uri.substring(this.indexOfPmvSlashInUri(n.uri));e.searchParams.set("file",o),e.searchParams.delete("pid")}const i=this.getArg(n,m.NavigationTarget.ELEMENT_IDS);return i&&e.searchParams.set("select",i),e.toString()}evaluatePmv(n){const e=this.getArg(n,"pmv");return e||n.uri.substring(1,this.indexOfPmvSlashInUri(n.uri))}indexOfPmvSlashInUri(n){return n.indexOf("/",1)}getArg(n,e){if(n.args&&n.args[e])return n.args[e].toString()}};h6=wMe([le()],h6);const AMe=new m.FeatureModule((n,e,t)=>{m.configureActionHandler({bind:n,isBound:t},ct.NavigateToExternalTargetAction.KIND,h6)},{featureId:m.navigationModule.featureId}),RMe=new m.FeatureModule((n,e,t)=>{m.bindAsService(n,m.TYPES.IUIExtension,Bt),m.configureActionHandler({bind:n,isBound:t},Cs.KIND,Bt),m.configureActionHandler({bind:n,isBound:t},Hm.KIND,Bt),m.configureActionHandler({bind:n,isBound:t},m.RemoveMarqueeAction.KIND,Bt),n(Ve.QuickActionProvider).to(zm)});function MMe(){const n=window.location.protocol;if(n.startsWith("http")){const e=window.location.href;return e.substring(n.length+2,e.indexOf("/process-viewer"))}return"localhost:8081"}function IMe(){return window.location.protocol==="https:"||m4().get("secure")==="true"}function TMe(){return m4().get("mode")==="preview"}function m4(){return new URLSearchParams(window.location.search)}const Kw=class Kw extends m.GLabel{constructor(e=m.Bounds.EMPTY,t="",i="start",o=Kw.TYPE){super(),this.canvasBounds=e,this.caption=t,this.location=i,this.type=o}};x(Kw,"TYPE","diagram-caption");let Um=Kw;const Vw=class Vw extends pM{constructor(e="",t=0,i=[],o=Vw.TYPE){super(),this.text=e,this.relativeValue=t,this.segments=i,this.type=o}};x(Vw,"TYPE","edge:label:mining");let i0=Vw;var hQ=Object.defineProperty,DMe=Object.getOwnPropertyDescriptor,OMe=(n,e,t)=>e in n?hQ(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,pQ=(n,e,t,i)=>{for(var o=i>1?void 0:i?DMe(e,t):e,r=n.length-1,s;r>=0;r--)(s=n[r])&&(o=(i?s(e,t,o):s(o))||o);return i&&o&&hQ(e,t,o),o},LMe=(n,e)=>(t,i)=>e(t,i,n),jMe=(n,e,t)=>OMe(n,e+"",t),Ym;(n=>{n.KIND="minigCommand";function e(i){return{kind:n.KIND,...i}}n.create=e;function t(i){return m.Action.hasKind(i,n.KIND)}n.is=t})(Ym||(Ym={}));let o0=class extends m.Command{constructor(e){super();x(this,"startCaption");x(this,"endCaption");x(this,"edgeRouterRegistry");x(this,"getModelBounds",e=>e.children.filter(m.isBoundsAware).map(i=>i.bounds).reduce((i,o)=>m.Bounds.combine(i,o),m.Bounds.EMPTY));x(this,"moveExistingLabel",(e,t)=>{if(!e||e.text===""||t.length<2)return;const i=t[t.length-2],o=t[t.length-1],r={...e.position},s={x:o.x-(o.x-i.x)/2,y:o.y-(o.y-i.y)/2};Math.sqrt(Math.pow(r.x-s.x,2)+Math.pow(r.y-s.y,2))<30&&(o.x-i.x>0?r.x-=10:r.y-=10,e.position=r)});this.action=e}execute(e){const t=e.root;this.action.data.nodes.forEach(o=>{const r=t.index.getById(o.id);if(r instanceof $m){const s=this.edgeRouterRegistry.route(r,r.args),a=new i0(o.labelValue.toString(),o.relativeValue,s);this.moveExistingLabel(r.editableLabel,s),r.add(a)}});const i=this.getModelBounds(t);return this.startCaption=new Um(i,`Analysis of ${this.action.data.processName}`,"start"),this.endCaption=new Um(i,`${this.action.data.numberOfInstances} instances (investigation period: ${new Date(this.action.data.timeFrame.start).toDateString()} - ${new Date(this.action.data.timeFrame.end).toDateString()})`,"end"),t.add(this.startCaption),t.add(this.endCaption),t}undo(e){const t=e.root;return this.action.data.nodes.forEach(i=>{const o=t.index.getById(i.id);o instanceof $m&&o.args!==void 0&&(delete o.args.labelvalue,delete o.args.relativevalue)}),t.remove(this.startCaption),t.remove(this.endCaption),t}redo(e){return this.execute(e)}};jMe(o0,"KIND",Ym.KIND);pQ([be(d0.EdgeRouterRegistry)],o0.prototype,"edgeRouterRegistry",2);o0=pQ([le(),LMe(0,be(m.TYPES.Action))],o0);var NMe=Object.defineProperty,BMe=Object.getOwnPropertyDescriptor,CM=(n,e,t,i)=>{for(var o=i>1?void 0:i?BMe(e,t):e,r=n.length-1,s;r>=0;r--)(s=n[r])&&(o=(i?s(e,t,o):s(o))||o);return i&&o&&NMe(e,t,o),o};const mQ=Symbol("ContainerSymbol");let Cf=class{constructor(){x(this,"actionDispatcher");x(this,"options");x(this,"container")}async postModelInitialization(){await this.dispatchAfterModelInitialized(),TMe()||this.actionDispatcher.dispatch(Yy.create())}async dispatchAfterModelInitialized(){const n=[];return this.isNumeric(this.options.zoom)?(n.push(Om.create({zoom:+this.options.zoom/100})),n.push(...this.showElement(e=>m.CenterAction.create(e,{animate:!1,retainZoom:!0})))):n.push(...this.showElement(e=>qy.create({elementIds:e,animate:!1,retainZoom:!0}))),n.push(Dm.create({theme:this.options.theme})),n.push(Ym.create({data:await(await kMe(this.options.miningUrl)).json()})),this.actionDispatcher.dispatchAll(n)}showElement(n){if(this.options.highlight)return[n([this.options.highlight])];if(this.options.select){const e=this.options.select.split(m.NavigationTarget.ELEMENT_IDS_SEPARATOR);return[m.SelectAction.create({selectedElementsIDs:e}),n(e)]}return[]}isNumeric(n){return!isNaN(parseFloat(n))&&isFinite(n)}};CM([be(m.GLSPActionDispatcher)],Cf.prototype,"actionDispatcher",2);CM([be(m.TYPES.IDiagramOptions)],Cf.prototype,"options",2);CM([be(mQ)],Cf.prototype,"container",2);Cf=CM([le()],Cf);const $Me=new bz(n=>{n(m.TYPES.IDiagramStartup).toDynamicValue(e=>{const t=e.container.createChild();return t.bind(Cf).toSelf().inSingletonScope(),t.bind(mQ).toConstantValue(e.container),t.get(Cf)}).inSingletonScope()}),kMe=async n=>fetch(n);var FMe=Object.defineProperty,xMe=Object.getOwnPropertyDescriptor,g4=(n,e,t,i)=>{for(var o=i>1?void 0:i?xMe(e,t):e,r=n.length-1,s;r>=0;r--)(s=n[r])&&(o=(i?s(e,t,o):s(o))||o);return i&&o&&FMe(e,t,o),o};let r0=class{constructor(){x(this,"feedbackDispatcher");x(this,"modelInitializationConstraint")}handle(n){Ym.is(n.kind)&&this.modelInitializationConstraint.onInitialized(()=>{this.feedbackDispatcher.registerFeedback(this,[n])})}};g4([be(m.TYPES.IFeedbackActionDispatcher)],r0.prototype,"feedbackDispatcher",2);g4([be(m.ModelInitializationConstraint)],r0.prototype,"modelInitializationConstraint",2);r0=g4([le()],r0);var HMe=Object.defineProperty,KMe=Object.getOwnPropertyDescriptor,VMe=(n,e,t,i)=>{for(var o=i>1?void 0:i?KMe(e,t):e,r=n.length-1,s;r>=0;r--)(s=n[r])&&(o=(i?s(e,t,o):s(o))||o);return i&&o&&HMe(e,t,o),o};const QV={createElement:m.svg};let p6=class extends m.GLabelView{render(n,e){const t=n.canvasBounds.x;let i=n.canvasBounds.y-20;return n.location==="end"&&(i=n.canvasBounds.height+40),QV.createElement("g",null,QV.createElement("text",{"class-diagram-caption":!0,"class-sprotty-label":!0,x:t,y:i},n.caption))}};p6=VMe([le()],p6);var zMe=Object.defineProperty,GMe=Object.getOwnPropertyDescriptor,UMe=(n,e,t,i)=>{for(var o=i>1?void 0:i?GMe(e,t):e,r=n.length-1,s;r>=0;r--)(s=n[r])&&(o=(i?s(e,t,o):s(o))||o);return i&&o&&zMe(e,t,o),o};const CD={createElement:m.svg};let m6=class extends m.GLabelView{constructor(){super(...arguments);x(this,"getCircleProps",e=>{const t={r:10,color:"white",textColor:"black"};return e<=.25?(t.r=10,t.color="#c8f0d4"):e<=.5?(t.r=11,t.color="#87dea1"):e<=.75?(t.r=12,t.color="#4ccd73"):e<=1&&(t.r=13,t.color="#205630",t.textColor="#ffffff"),t})}render(e,t){if(e.segments.length<2)return;const i=this.getCircleProps(e.relativeValue),o=e.segments,r=o[o.length-2],s=o[o.length-1],a={x:s.x-(s.x-r.x)/2,y:s.y-(s.y-r.y)/2};return s.y-r.y===0?a.x-=3:a.y-=3,CD.createElement("g",null,CD.createElement("circle",{cy:a.y,cx:a.x,stroke:"var(--glsp-border)",fill:i.color,"stroke-width":"0",r:i.r}),CD.createElement("text",{style:{fill:i.textColor},"text-anchor":"middle",dy:"0.35em",x:a.x,y:a.y},e.text))}};m6=UMe([le()],m6);const YMe=new m.FeatureModule((n,e,t)=>{m.configureActionHandler({bind:n,isBound:t},Ym.KIND,r0),m.configureCommand({bind:n,isBound:t},o0),m.configureModelElement({bind:n,isBound:t},i0.TYPE,i0,m6),m.configureModelElement({bind:n,isBound:t},Um.TYPE,Um,p6)});function qMe(n){const e=sMe("sprotty",m.createDiagramOptionsModule(n),fMe,AMe,$Me,YMe,{remove:[NZ,BZ,QZ,cQ,YZ,CZ,m.deletionToolModule,m.edgeEditToolModule,m.nodeCreationToolModule,rQ]},{remove:oQ,add:RMe},{remove:UZ,add:EMe});return yRe(e,{hideSensitiveInfo:!0}),e}const Da=m4(),v4=Da.get("app")??"designer";let g6=Da.get("server");g6||(g6=MMe().replace(v4,""));const WMe=Da.get("miningUrl")??"http://localhost:3000/mock.json",ZMe=Da.get("pmv")??"",gQ=Da.get("pid")??"",vQ=Da.get("file")??"",XV=Da.get("highlight")??"",QMe=Da.get("select"),XMe=Da.get("zoom")??"",JMe=Da.get("theme")??Ef.prefsColorScheme(),v6="ivy-glsp-process-viewer",JV="ivy-glsp-process",eIe=ct.ApplicationIdProvider.get()+"_"+vQ+gQ,tIe=`${IMe()?"wss":"ws"}://${g6}/`,nIe=`${tIe}${v4}/${v6}`;let _6,PD;const iIe=new m.GLSPWebSocketProvider(nIe,{reconnectDelay:5e3,reconnectAttempts:120});iIe.listen({onConnection:_Q,onReconnect:oIe,logger:console});async function _Q(n,e=!1){_6=new SMe({id:v6,connectionProvider:n}),PD=qMe({clientId:eIe,diagramType:JV,glspClientProvider:async()=>_6,sourceUri:vQ,editMode:m.EditMode.READONLY,highlight:XV,select:QMe,zoom:XMe,theme:JMe,miningUrl:WMe}),await PD.get(m.DiagramLoader).load({requestModelOptions:{isReconnecting:e,app:v4,pmv:ZMe,pid:gQ,highlight:XV,readonly:!0,diagramType:JV},initializeParameters:{applicationId:ct.ApplicationIdProvider.get(),protocolVersion:ct.GLSPClient.protocolVersion}});const i=PD.get(m.GLSPActionDispatcher);if(e){const o=`Connection to the ${v6} glsp server got closed. Connection was successfully re-established.`,r=5e3,s="WARNING";i.dispatchAll([m.StatusAction.create(o,{severity:s,timeout:r}),m.MessageAction.create(o,{severity:s})])}}async function oIe(n){_6.stop(),_Q(n,!0)}
