<html xmlns="http://www.w3.org/1999/xhtml"
  xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html"
  xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:cc="http://xmlns.jcp.org/jsf/composite"
  xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui"
  xmlns:pe="http://primefaces.org/ui/extensions"
  xmlns:c="http://java.sun.com/jsp/jstl/core">
<cc:interface>
  <cc:attribute name="managedBean" required="true" />
  <cc:attribute name="isWidgetMode" default="false" />
</cc:interface>
<cc:implementation>
  <c:set var="managedBean" value="#{cc.attrs.managedBean}" />
  <h:panelGroup id="data-statistics" layout="block"
    rendered="#{not cc.attrs.isWidgetMode}">
    <p:treeTable var="node" styleClass="grid m-0" id="node"
      value="#{managedBean.filteredNodesTree}" scrollable="true"
      scrollHeight="300"
      emptyMessage="#{ivy.cms.co('/Dialogs/com/axonivy/solutions/process/analyser/ProcessesMonitor/NoRecordsFound')}">
      <p:column styleClass="col-2" sortBy="#{node.id}"
        headerText="#{ivy.cms.co('/Dialogs/com/axonivy/solutions/process/analyser/ProcessesMonitor/ElementId')}">
        <h:outputText value="#{node.id}" />
      </p:column>
      <p:column styleClass="col-2" sortable="true"
        sortBy="#{node.type.getCmsName()}"
        headerText="#{ivy.cms.co('/Dialogs/com/axonivy/solutions/process/analyser/ProcessesMonitor/Type')}">
        <h:outputText value="#{node.type.getCmsName()}" />
      </p:column>
      <p:column styleClass="col-4" sortBy="#{node.label}"
        headerText="#{ivy.cms.co('/Dialogs/com/axonivy/solutions/process/analyser/ProcessesMonitor/Label')}">
        <h:outputText value="#{node.label}" />
      </p:column>
      <p:column rendered="#{'FREQUENCY' == managedBean.selectedKpiType}"
        styleClass="col-2" sortBy="#{node.frequency}"
        exportValue="#{node.frequency}"
        headerText="#{ivy.cms.co('/Dialogs/com/axonivy/solutions/process/analyser/ProcessesMonitor/Frequency')}">
        <h:panelGroup layout="block" styleClass="colorable-cell"
          style="background-color: #{managedBean.getCalulatedCellColor(node.relativeValue)};
                  color: #{managedBean.getAccessibleTextColor(node.relativeValue)};">
          <h:outputText value="#{node.frequency}" />
        </h:panelGroup>
      </p:column>
      <p:column
        rendered="#{managedBean.isMedianDurationColumnVisible()}"
        styleClass="col-2" sortBy="#{node.medianDuration}"
        exportValue="#{node.formattedMedianDuration}"
        headerText="#{ivy.cms.co('/Dialogs/com/axonivy/solutions/process/analyser/ProcessesMonitor/MedianDuration')}">
        <h:panelGroup layout="block" styleClass="colorable-cell"
          style="background-color: #{managedBean.getCalulatedCellColor(node.relativeValue)};
                  color: #{managedBean.getAccessibleTextColor(node.relativeValue)};">
          <h:outputText value="#{node.formattedMedianDuration}" />
        </h:panelGroup>
      </p:column>
      <f:facet name="footer">
        <h:outputText
          value="#{ivy.cms.co('/Dialogs/com/axonivy/solutions/process/analyser/ProcessesMonitor/TotalElements', [managedBean.filteredNodes.size()])}"
          styleClass="col-12" />
      </f:facet>
    </p:treeTable>
    <br />
  </h:panelGroup>
</cc:implementation>
</html>
